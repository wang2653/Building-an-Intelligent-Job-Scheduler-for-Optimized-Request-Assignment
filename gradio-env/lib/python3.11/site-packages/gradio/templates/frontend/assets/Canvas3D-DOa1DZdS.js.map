{"version":3,"file":"Canvas3D-DOa1DZdS.js","sources":["../../../../node_modules/.pnpm/babylonjs@7.25.2/node_modules/babylonjs/babylon.js","../../../../node_modules/.pnpm/babylonjs-loaders@7.25.2/node_modules/babylonjs-loaders/babylonjs.loaders.js","../../../../js/model3D/shared/Canvas3D.svelte"],"sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"babylonjs\",[],t):\"object\"==typeof exports?exports.babylonjs=t():e.BABYLON=t()}(\"undefined\"!=typeof self?self:\"undefined\"!=typeof global?global:this,(()=>(()=>{\"use strict\";var e={82966:(e,t,r)=>{r.d(t,{G:()=>i});var n=r(81152),i=function(){function e(){this.hoverCursor=\"\",this.actions=[],this.isRecursive=!1,this.disposeWhenUnowned=!0}return Object.defineProperty(e,\"HasTriggers\",{get:function(){for(var t in e.Triggers)if(Object.prototype.hasOwnProperty.call(e.Triggers,t))return!0;return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"HasPickTriggers\",{get:function(){for(var t in e.Triggers)if(Object.prototype.hasOwnProperty.call(e.Triggers,t)){var r=parseInt(t);if(r>=n.Y.ACTION_OnPickTrigger&&r<=n.Y.ACTION_OnPickUpTrigger)return!0}return!1},enumerable:!1,configurable:!0}),e.HasSpecificTrigger=function(t){for(var r in e.Triggers)if(Object.prototype.hasOwnProperty.call(e.Triggers,r)&&parseInt(r)===t)return!0;return!1},e.Triggers={},e}()},35747:(e,t,r)=>{r.d(t,{X:()=>n});var n=function(){function e(e,t,r,n,i,o){this.source=e,this.pointerX=t,this.pointerY=r,this.meshUnderPointer=n,this.sourceEvent=i,this.additionalData=o}return e.CreateNew=function(t,r,n){var i=t.getScene();return new e(t,i.pointerX,i.pointerY,i.meshUnderPointer||t,r,n)},e.CreateNewFromSprite=function(t,r,n,i){return new e(t,r.pointerX,r.pointerY,r.meshUnderPointer,n,i)},e.CreateNewFromScene=function(t,r){return new e(null,t.pointerX,t.pointerY,t.meshUnderPointer,r)},e.CreateNewFromPrimitive=function(t,r,n,i){return new e(t,r.x,r.y,null,n,i)},e}()},62623:(e,t,r)=>{r.d(t,{R:()=>s,h:()=>a});var n=r(37943),i=r(7164),o=r(81152),a=function(){function e(e,t,r,i,o,a,s,l,c){void 0===i&&(i=0),void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),this._isAlreadyOwned=!1,this._isDisposed=!1,e&&e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=r,this._instanced=a,this._divisor=l||1,this._label=c,t instanceof n.n?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=s?i:i*Float32Array.BYTES_PER_ELEMENT,o||this.create()}return Object.defineProperty(e.prototype,\"isDisposed\",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.createVertexBuffer=function(e,t,r,n,i,o,a){void 0===o&&(o=!1);var l=o?t:t*Float32Array.BYTES_PER_ELEMENT,c=n?o?n:n*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new s(this._engine,this,e,this._updatable,!0,c,void 0===i?this._instanced:i,l,r,void 0,void 0,!0,this._divisor||a)},e.prototype.isUpdatable=function(){return this._updatable},e.prototype.getData=function(){return this._data},e.prototype.getBuffer=function(){return this._buffer},e.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},e.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e,this._label),this._data=e):this._buffer=this._engine.createVertexBuffer(e,void 0,this._label))},e.prototype._rebuild=function(){if(this._data)this._buffer=null,this.create(this._data);else{if(!this._buffer)return;if(this._buffer.capacity>0)return void(this._updatable?this._buffer=this._engine.createDynamicVertexBuffer(this._buffer.capacity,this._label):this._buffer=this._engine.createVertexBuffer(this._buffer.capacity,void 0,this._label));i.V.Warn('Missing data for buffer \"'.concat(this._label,'\" ').concat(this._buffer?\"(uniqueId: \"+this._buffer.uniqueId+\")\":\"\",\". Buffer reconstruction failed.\")),this._buffer=null}},e.prototype.update=function(e){this.create(e)},e.prototype.updateDirectly=function(e,t,r,n){void 0===n&&(n=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,n?t:t*Float32Array.BYTES_PER_ELEMENT,r?r*this.byteStride:void 0),this._data=0===t&&void 0===r?e:null)},e.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},e.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._isDisposed=!0,this._data=null,this._buffer=null)},e}(),s=function(){function e(t,r,n,i,o,s,l,c,u,h,d,f,p,_){var m,g,v,y,b;void 0===d&&(d=!1),void 0===f&&(f=!1),void 0===p&&(p=1),void 0===_&&(_=!1),this._isDisposed=!1;var S=!1;if(this.engine=t,\"object\"==typeof i&&null!==i?(S=null!==(m=i.updatable)&&void 0!==m&&m,o=i.postponeInternalCreation,s=i.stride,l=i.instanced,c=i.offset,u=i.size,h=i.type,d=null!==(g=i.normalized)&&void 0!==g&&g,f=null!==(v=i.useBytes)&&void 0!==v&&v,p=null!==(y=i.divisor)&&void 0!==y?y:1,_=null!==(b=i.takeBufferOwnership)&&void 0!==b&&b,this._label=i.label):S=!!i,r instanceof a?(this._buffer=r,this._ownsBuffer=_):(this._buffer=new a(t,r,S,s,o,l,f,p,this._label),this._ownsBuffer=!0),this.uniqueId=e._Counter++,this._kind=n,void 0===h){var T=this.getData();this.type=T?e.GetDataType(T):e.FLOAT}else this.type=h;var E=e.GetTypeByteLength(this.type);f?(this._size=u||(s?s/E:e.DeduceStride(n)),this.byteStride=s||this._buffer.byteStride||this._size*E,this.byteOffset=c||0):(this._size=u||s||e.DeduceStride(n),this.byteStride=s?s*E:this._buffer.byteStride||this._size*E,this.byteOffset=(c||0)*E),this.normalized=d,this._instanced=void 0!==l&&l,this._instanceDivisor=l?p:0,this._alignBuffer(),this._computeHashCode()}return Object.defineProperty(e.prototype,\"isDisposed\",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"instanceDivisor\",{get:function(){return this._instanceDivisor},set:function(e){var t=0!=e;this._instanceDivisor=e,t!==this._instanced&&(this._instanced=t,this._computeHashCode())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"_maxVerticesCount\",{get:function(){var e=this.getData();return e?Array.isArray(e)?e.length/(this.byteStride/4)-this.byteOffset/4:(e.byteLength-this.byteOffset)/this.byteStride:0},enumerable:!1,configurable:!0}),e.prototype._computeHashCode=function(){this.hashCode=(this.type-5120|0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)},e.prototype._rebuild=function(){var e;null===(e=this._buffer)||void 0===e||e._rebuild()},e.prototype.getKind=function(){return this._kind},e.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},e.prototype.getData=function(){return this._buffer.getData()},e.prototype.getFloatData=function(t,r){var n=this.getData();return n?e.GetFloatData(n,this._size,this.type,this.byteOffset,this.byteStride,this.normalized,t,r):null},e.prototype.getBuffer=function(){return this._buffer.getBuffer()},e.prototype.getWrapperBuffer=function(){return this._buffer},e.prototype.getStrideSize=function(){return this.byteStride/e.GetTypeByteLength(this.type)},e.prototype.getOffset=function(){return this.byteOffset/e.GetTypeByteLength(this.type)},e.prototype.getSize=function(t){return void 0===t&&(t=!1),t?this._size*e.GetTypeByteLength(this.type):this._size},e.prototype.getIsInstanced=function(){return this._instanced},e.prototype.getInstanceDivisor=function(){return this._instanceDivisor},e.prototype.create=function(e){this._buffer.create(e),this._alignBuffer()},e.prototype.update=function(e){this._buffer.update(e),this._alignBuffer()},e.prototype.updateDirectly=function(e,t,r){void 0===r&&(r=!1),this._buffer.updateDirectly(e,t,void 0,r),this._alignBuffer()},e.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose(),this._isDisposed=!0},e.prototype.forEach=function(t,r){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,r)},e.prototype._alignBuffer=function(){},e.DeduceStride=function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.ColorInstanceKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error(\"Invalid kind '\"+t+\"'\")}},e.GetDataType=function(t){return t instanceof Int8Array?e.BYTE:t instanceof Uint8Array?e.UNSIGNED_BYTE:t instanceof Int16Array?e.SHORT:t instanceof Uint16Array?e.UNSIGNED_SHORT:t instanceof Int32Array?e.INT:t instanceof Uint32Array?e.UNSIGNED_INT:e.FLOAT},e.GetTypeByteLength=function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error(\"Invalid type '\".concat(t,\"'\"))}},e.ForEach=function(t,r,n,i,o,a,s,l){if(t instanceof Array)for(var c=r/4,u=n/4,h=0;h<a;h+=i){for(var d=0;d<i;d++)l(t[c+d],h+d);c+=u}else{var f=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),p=e.GetTypeByteLength(o);for(h=0;h<a;h+=i){var _=r;for(d=0;d<i;d++)l(e._GetFloatValue(f,o,_,s),h+d),_+=p;r+=n}}},e._GetFloatValue=function(t,r,n,i){switch(r){case e.BYTE:var o=t.getInt8(n);return i&&(o=Math.max(o/127,-1)),o;case e.UNSIGNED_BYTE:return o=t.getUint8(n),i&&(o/=255),o;case e.SHORT:return o=t.getInt16(n,!0),i&&(o=Math.max(o/32767,-1)),o;case e.UNSIGNED_SHORT:return o=t.getUint16(n,!0),i&&(o/=65535),o;case e.INT:return t.getInt32(n,!0);case e.UNSIGNED_INT:return t.getUint32(n,!0);case e.FLOAT:return t.getFloat32(n,!0);default:throw new Error(\"Invalid component type \".concat(r))}},e.GetFloatData=function(t,r,n,o,a,s,l,c){var u=r*e.GetTypeByteLength(n),h=l*r;if(n!==e.FLOAT||a!==u){var d=new Float32Array(h);return e.ForEach(t,o,a,r,n,h,s,(function(e,t){return d[t]=e})),d}if(!(t instanceof Array||t instanceof Float32Array)||0!==o||t.length!==h){if(t instanceof Array){var f=o/4;return t.slice(f,f+h)}if(t instanceof ArrayBuffer)return new Float32Array(t,o,h);if(3&(f=t.byteOffset+o)&&(i.V.Warn(\"Float array must be aligned to 4-bytes border\"),c=!0),c){var p=new Uint8Array(h*Float32Array.BYTES_PER_ELEMENT),_=new Uint8Array(t.buffer,f,p.length);return p.set(_),new Float32Array(p.buffer)}return new Float32Array(t.buffer,f,h)}return c?t.slice():t},e._Counter=0,e.BYTE=o.Y.BYTE,e.UNSIGNED_BYTE=o.Y.UNSIGNED_BYTE,e.SHORT=o.Y.SHORT,e.UNSIGNED_SHORT=o.Y.UNSIGNED_SHORT,e.INT=o.Y.INT,e.UNSIGNED_INT=o.Y.UNSIGNED_INT,e.FLOAT=o.Y.FLOAT,e.PositionKind=o.Y.PositionKind,e.NormalKind=o.Y.NormalKind,e.TangentKind=o.Y.TangentKind,e.UVKind=o.Y.UVKind,e.UV2Kind=o.Y.UV2Kind,e.UV3Kind=o.Y.UV3Kind,e.UV4Kind=o.Y.UV4Kind,e.UV5Kind=o.Y.UV5Kind,e.UV6Kind=o.Y.UV6Kind,e.ColorKind=o.Y.ColorKind,e.ColorInstanceKind=o.Y.ColorInstanceKind,e.MatricesIndicesKind=o.Y.MatricesIndicesKind,e.MatricesWeightsKind=o.Y.MatricesWeightsKind,e.MatricesIndicesExtraKind=o.Y.MatricesIndicesExtraKind,e.MatricesWeightsExtraKind=o.Y.MatricesWeightsExtraKind,e}()},37943:(e,t,r)=>{r.d(t,{n:()=>n});var n=function(){function e(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=e._Counter++}return Object.defineProperty(e.prototype,\"underlyingResource\",{get:function(){return null},enumerable:!1,configurable:!0}),e._Counter=0,e}()},1554:(e,t,r)=>{r.d(t,{K:()=>i});var n=r(81152),i=function(){function e(e,t,r,i){void 0===r&&(r=n.Y.BUFFER_CREATIONFLAG_READWRITE),this._engine=e,this._label=i,this._engine._storageBuffers.push(this),this._create(t,r)}return e.prototype._create=function(e,t){this._bufferSize=e,this._creationFlags=t,this._buffer=this._engine.createStorageBuffer(e,t,this._label)},e.prototype._rebuild=function(){this._create(this._bufferSize,this._creationFlags)},e.prototype.getBuffer=function(){return this._buffer},e.prototype.update=function(e,t,r){this._buffer&&this._engine.updateStorageBuffer(this._buffer,e,t,r)},e.prototype.read=function(e,t,r,n){return this._engine.readFromStorageBuffer(this._buffer,e,t,r,n)},e.prototype.dispose=function(){var e=this._engine._storageBuffers,t=e.indexOf(this);-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._releaseBuffer(this._buffer),this._buffer=null},e}()},8004:(e,t,r)=>{r.d(t,{G:()=>o});var n=r(8046),i=r(62623),o=function(){function e(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}return e.prototype.getNormal=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!0),!this.pickedMesh||t&&!this.pickedMesh.isVerticesDataPresent(i.R.NormalKind))return null;var r,o=this.pickedMesh.getIndices();0===(null==o?void 0:o.length)&&(o=null);var a=n.AA.Vector3[0],s=n.AA.Vector3[1],l=n.AA.Vector3[2];if(t){var c=this.pickedMesh.getVerticesData(i.R.NormalKind),u=o?n.Pq.FromArrayToRef(c,3*o[3*this.faceId],a):a.copyFromFloats(c[3*this.faceId*3],c[3*this.faceId*3+1],c[3*this.faceId*3+2]),h=o?n.Pq.FromArrayToRef(c,3*o[3*this.faceId+1],s):s.copyFromFloats(c[3*(3*this.faceId+1)],c[3*(3*this.faceId+1)+1],c[3*(3*this.faceId+1)+2]),d=o?n.Pq.FromArrayToRef(c,3*o[3*this.faceId+2],l):l.copyFromFloats(c[3*(3*this.faceId+2)],c[3*(3*this.faceId+2)+1],c[3*(3*this.faceId+2)+2]);u=u.scale(this.bu),h=h.scale(this.bv),d=d.scale(1-this.bu-this.bv),r=new n.Pq(u.x+h.x+d.x,u.y+h.y+d.y,u.z+h.z+d.z)}else{var f=this.pickedMesh.getVerticesData(i.R.PositionKind),p=o?n.Pq.FromArrayToRef(f,3*o[3*this.faceId],a):a.copyFromFloats(f[3*this.faceId*3],f[3*this.faceId*3+1],f[3*this.faceId*3+2]),_=o?n.Pq.FromArrayToRef(f,3*o[3*this.faceId+1],s):s.copyFromFloats(f[3*(3*this.faceId+1)],f[3*(3*this.faceId+1)+1],f[3*(3*this.faceId+1)+2]),m=o?n.Pq.FromArrayToRef(f,3*o[3*this.faceId+2],l):l.copyFromFloats(f[3*(3*this.faceId+2)],f[3*(3*this.faceId+2)+1],f[3*(3*this.faceId+2)+2]),g=p.subtract(_),v=m.subtract(_);r=n.Pq.Cross(g,v)}var y=function(e,t){var r=e.getWorldMatrix();e.nonUniformScaling&&(n.AA.Matrix[0].copyFrom(r),(r=n.AA.Matrix[0]).setTranslationFromFloats(0,0,0),r.invert(),r.transposeToRef(n.AA.Matrix[1]),r=n.AA.Matrix[1]),n.Pq.TransformNormalToRef(t,r,t)};if(e&&y(this.pickedMesh,r),this.ray){var b=n.AA.Vector3[0].copyFrom(r);e||y(this.pickedMesh,b),n.Pq.Dot(b,this.ray.direction)>0&&r.negateInPlace()}return r.normalize(),r},e.prototype.getTextureCoordinates=function(e){if(void 0===e&&(e=i.R.UVKind),!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(e))return null;var t=this.pickedMesh.getIndices();if(!t)return null;var r=this.pickedMesh.getVerticesData(e);if(!r)return null;var o=n.I9.FromArray(r,2*t[3*this.faceId]),a=n.I9.FromArray(r,2*t[3*this.faceId+1]),s=n.I9.FromArray(r,2*t[3*this.faceId+2]);return o=o.scale(this.bu),a=a.scale(this.bv),s=s.scale(1-this.bu-this.bv),new n.I9(o.x+a.x+s.x,o.y+a.y+s.y)},e}()},51956:(e,t,r)=>{r.d(t,{p9:()=>i,rX:()=>n});var n=!1,i={get UseOpenGLOrientationForUV(){return n},set UseOpenGLOrientationForUV(e){n=e}}},75227:(e,t,r)=>{r.d(t,{H:()=>d});var n=r(78322),i=r(6174),o=r(12028),a=r(34623),s=r(50582),l=r(62273),c=r(7164),u=r(55204),h=r(37411),d=function(){function e(e,t,r,i){void 0===i&&(i={}),this._bindings={},this._samplers={},this._contextIsDirty=!1,this.fastMode=!1,this.onCompiled=null,this.onError=null,this.name=e,this._engine=t,this.uniqueId=l.K.UniqueId,t.enableGPUTimingMeasurements&&(this.gpuTimeInFrame=new h.e),this._engine.getCaps().supportComputeShaders?i.bindingsMapping?(this._context=t.createComputeContext(),this._shaderPath=r,this._options=(0,n.Cl)({bindingsMapping:{},defines:[]},i)):c.V.Error(\"You must provide the binding mappings as browsers don't support reflection for wgsl shaders yet!\"):c.V.Error(\"This engine does not support compute shaders!\")}return Object.defineProperty(e.prototype,\"options\",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shaderPath\",{get:function(){return this._shaderPath},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return\"ComputeShader\"},e.prototype.setTexture=function(e,t,r){void 0===r&&(r=!0);var n=this._bindings[e];this._bindings[e]={type:r?0:4,object:t,indexInGroupEntries:null==n?void 0:n.indexInGroupEntries},this._contextIsDirty||(this._contextIsDirty=!n||n.object!==t||n.type!==this._bindings[e].type)},e.prototype.setStorageTexture=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||r.object!==t),this._bindings[e]={type:1,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},e.prototype.setExternalTexture=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||r.object!==t),this._bindings[e]={type:6,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},e.prototype.setVideoTexture=function(e,t){return!!t.externalTexture&&(this.setExternalTexture(e,t.externalTexture),!0)},e.prototype.setUniformBuffer=function(t,r){var n=this._bindings[t];this._contextIsDirty||(this._contextIsDirty=!n||n.object!==r),this._bindings[t]={type:e._BufferIsDataBuffer(r)?7:2,object:r,indexInGroupEntries:null==n?void 0:n.indexInGroupEntries}},e.prototype.setStorageBuffer=function(t,r){var n=this._bindings[t];this._contextIsDirty||(this._contextIsDirty=!n||n.object!==r),this._bindings[t]={type:e._BufferIsDataBuffer(r)?7:3,object:r,indexInGroupEntries:null==n?void 0:n.indexInGroupEntries}},e.prototype.setTextureSampler=function(e,t){var r=this._bindings[e];this._contextIsDirty||(this._contextIsDirty=!r||!t.compareSampler(r.object)),this._bindings[e]={type:5,object:t,indexInGroupEntries:null==r?void 0:r.indexInGroupEntries}},e.prototype.isReady=function(){var e=this._effect;for(var t in this._bindings){var r=this._bindings[t],n=r.type,i=r.object;switch(n){case 0:case 4:case 1:case 6:if(!i.isReady())return!1}}var o=[],a=this._shaderPath;if(this._options.defines)for(var s=0;s<this._options.defines.length;s++)o.push(this._options.defines[s]);var l=o.join(\"\\n\");return this._cachedDefines!==l&&(this._cachedDefines=l,e=this._engine.createComputeEffect(a,{defines:l,entryPoint:this._options.entryPoint,onCompiled:this.onCompiled,onError:this.onError}),this._effect=e),!!e.isReady()},e.prototype.dispatch=function(e,t,r){return!(!this.fastMode&&!this._checkContext()||(this._engine.computeDispatch(this._effect,this._context,this._bindings,e,t,r,this._options.bindingsMapping,this.gpuTimeInFrame),0))},e.prototype.dispatchIndirect=function(t,r){if(void 0===r&&(r=0),!this.fastMode&&!this._checkContext())return!1;var n=e._BufferIsDataBuffer(t)?t:t.getBuffer();return this._engine.computeDispatchIndirect(this._effect,this._context,this._bindings,n,r,this._options.bindingsMapping,this.gpuTimeInFrame),!0},e.prototype._checkContext=function(){var e;if(!this.isReady())return!1;for(var t in this._bindings){var r=this._bindings[t];if(!this._options.bindingsMapping[t])throw new Error(\"ComputeShader ('\"+this.name+\"'): No binding mapping has been provided for the property '\"+t+\"'\");switch(r.type){case 0:var n=this._samplers[t],i=r.object;n&&i._texture&&n.compareSampler(i._texture)||(this._samplers[t]=(new u.u).setParameters(i.wrapU,i.wrapV,i.wrapR,i.anisotropicFilteringLevel,i._texture.samplingMode,null===(e=i._texture)||void 0===e?void 0:e._comparisonFunction),this._contextIsDirty=!0);break;case 6:this._contextIsDirty=!0;break;case 2:var o=r.object;o.getBuffer()!==r.buffer&&(r.buffer=o.getBuffer(),this._contextIsDirty=!0)}}return this._contextIsDirty&&(this._contextIsDirty=!1,this._context.clear()),!0},e.prototype.dispatchWhenReady=function(e,t,r,n){var i=this;return void 0===n&&(n=10),new Promise((function(o){var a=function(){i.dispatch(e,t,r)?o():setTimeout(a,n)};a()}))},e.prototype.serialize=function(){var e=o.p.Serialize(this);for(var t in e.options=this._options,e.shaderPath=this._shaderPath,e.bindings={},e.textures={},this._bindings){var r=this._bindings[t],n=r.object;switch(r.type){case 0:case 4:case 1:var i=n.serialize();i&&(e.textures[t]=i,e.bindings[t]={type:r.type})}}return e},e.Parse=function(t,r,n){var i=o.p.Parse((function(){return new e(t.name,r.getEngine(),t.shaderPath,t.options)}),t,r,n);for(var a in t.textures){var l=t.bindings[a],c=s.g.Parse(t.textures[a],r,n);0===l.type?i.setTexture(a,c):4===l.type?i.setTexture(a,c,!1):i.setStorageTexture(a,c)}return i},e._BufferIsDataBuffer=function(e){return void 0!==e.underlyingResource},(0,n.Cg)([(0,i.lK)()],e.prototype,\"name\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"fastMode\",void 0),e}();(0,a.Y5)(\"BABYLON.ComputeShader\",d)},18149:(e,t,r)=>{r.r(t),r.d(t,{ComputeShaderBoundingHelper:()=>c});var n=r(78322),i=r(75227),o=r(1554),a=r(62623),s=r(8046),l=r(75482);r(98519).l.ShadersStoreWGSL.boundingInfoComputeShader=\"struct Results {minX : atomic<i32>,\\nminY : atomic<i32>,\\nminZ : atomic<i32>,\\nmaxX : atomic<i32>,\\nmaxY : atomic<i32>,\\nmaxZ : atomic<i32>,\\ndummy1 : i32,\\ndummy2 : i32,};fn floatToBits(value: f32)->i32 {return bitcast<i32>(value);}\\nfn bitsToFloat(value: i32)->f32 {return bitcast<f32>(value);}\\nfn atomicMinFloat(atomicVar: ptr<storage,atomic<i32>,read_write>,value: f32) {let intValue=floatToBits(value);loop {let oldIntValue=atomicLoad(atomicVar);let oldValue=bitsToFloat(oldIntValue);if (value>=oldValue) {break;}\\nif (atomicCompareExchangeWeak(atomicVar,oldIntValue,intValue).old_value==oldIntValue) {break;}}}\\nfn atomicMaxFloat(atomicVar: ptr<storage,atomic<i32>,read_write>,value: f32) {let intValue=floatToBits(value);loop {let oldIntValue=atomicLoad(atomicVar);let oldValue=bitsToFloat(oldIntValue);if (value<=oldValue) {break;}\\nif (atomicCompareExchangeWeak(atomicVar,oldIntValue,intValue).old_value==oldIntValue) {break;}}}\\nfn readMatrixFromRawSampler(smp : texture_2d<f32>,index : f32)->mat4x4<f32>\\n{let offset=i32(index) *4; \\nlet m0=textureLoad(smp,vec2<i32>(offset+0,0),0);let m1=textureLoad(smp,vec2<i32>(offset+1,0),0);let m2=textureLoad(smp,vec2<i32>(offset+2,0),0);let m3=textureLoad(smp,vec2<i32>(offset+3,0),0);return mat4x4<f32>(m0,m1,m2,m3);}\\nconst identity=mat4x4f(\\nvec4f(1.0,0.0,0.0,0.0),\\nvec4f(0.0,1.0,0.0,0.0),\\nvec4f(0.0,0.0,1.0,0.0),\\nvec4f(0.0,0.0,0.0,1.0)\\n);struct Settings {morphTargetTextureInfo: vec3f,\\nmorphTargetCount: i32,\\nindexResult : u32,};@group(0) @binding(0) var<storage,read> positionBuffer : array<f32>;@group(0) @binding(1) var<storage,read_write> resultBuffer : array<Results>;@group(0) @binding(7) var<uniform> settings : Settings;\\n#if NUM_BONE_INFLUENCERS>0\\n@group(0) @binding(2) var boneSampler : texture_2d<f32>;@group(0) @binding(3) var<storage,read> indexBuffer : array<vec4f>;@group(0) @binding(4) var<storage,read> weightBuffer : array<vec4f>;\\n#if NUM_BONE_INFLUENCERS>4\\n@group(0) @binding(5) var<storage,read> indexExtraBuffer : array<vec4f>;@group(0) @binding(6) var<storage,read> weightExtraBuffer : array<vec4f>;\\n#endif\\n#endif\\n#ifdef MORPHTARGETS\\n@group(0) @binding(8) var morphTargets : texture_2d_array<f32>;@group(0) @binding(9) var<storage,read> morphTargetInfluences : array<f32>;@group(0) @binding(10) var<storage,read> morphTargetTextureIndices : array<f32>;\\n#endif\\n#ifdef MORPHTARGETS\\nfn readVector3FromRawSampler(targetIndex : i32,vertexIndex : u32)->vec3f\\n{ \\nlet vertexID=f32(vertexIndex)*settings.morphTargetTextureInfo.x;let y=floor(vertexID/settings.morphTargetTextureInfo.y);let x=vertexID-y*settings.morphTargetTextureInfo.y;let textureUV=vec2<i32>(i32(x),i32(y));return textureLoad(morphTargets,textureUV,i32(morphTargetTextureIndices[targetIndex]),0).xyz;}\\n#endif\\n@compute @workgroup_size(256,1,1)\\nfn main(@builtin(global_invocation_id) global_id : vec3<u32>) {let index=global_id.x;if (index>=arrayLength(&positionBuffer)/3) {return;}\\nlet position=vec3f(positionBuffer[index*3],positionBuffer[index*3+1],positionBuffer[index*3+2]);var finalWorld=identity;var positionUpdated=position;\\n#if NUM_BONE_INFLUENCERS>0\\nvar influence : mat4x4<f32>;let matricesIndices=indexBuffer[index];let matricesWeights=weightBuffer[index];influence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];\\n#if NUM_BONE_INFLUENCERS>1\\ninfluence=influence+readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];\\n#endif \\n#if NUM_BONE_INFLUENCERS>2\\ninfluence=influence+readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];\\n#endif \\n#if NUM_BONE_INFLUENCERS>3\\ninfluence=influence+readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];\\n#endif \\n#if NUM_BONE_INFLUENCERS>4\\nlet matricesIndicesExtra=indexExtraBuffer[index];let matricesWeightsExtra=weightExtraBuffer[index];influence=influence+readMatrixFromRawSampler(boneSampler,matricesIndicesExtra.x)*matricesWeightsExtra.x;\\n#if NUM_BONE_INFLUENCERS>5\\ninfluence=influence+readMatrixFromRawSampler(boneSampler,matricesIndicesExtra.y)*matricesWeightsExtra.y;\\n#endif \\n#if NUM_BONE_INFLUENCERS>6\\ninfluence=influence+readMatrixFromRawSampler(boneSampler,matricesIndicesExtra.z)*matricesWeightsExtra.z;\\n#endif \\n#if NUM_BONE_INFLUENCERS>7\\ninfluence=influence+readMatrixFromRawSampler(boneSampler,matricesIndicesExtra.w)*matricesWeightsExtra.w;\\n#endif \\n#endif \\nfinalWorld=finalWorld*influence;\\n#endif\\n#ifdef MORPHTARGETS\\nfor (var i=0; i<NUM_MORPH_INFLUENCERS; i=i+1) {if (i>=settings.morphTargetCount) {break;}\\npositionUpdated=positionUpdated+(readVector3FromRawSampler(i,index)-position)*morphTargetInfluences[i];}\\n#endif\\nvar worldPos=finalWorld*vec4f(positionUpdated.x,positionUpdated.y,positionUpdated.z,1.0);atomicMinFloat(&resultBuffer[settings.indexResult].minX,worldPos.x);atomicMinFloat(&resultBuffer[settings.indexResult].minY,worldPos.y);atomicMinFloat(&resultBuffer[settings.indexResult].minZ,worldPos.z);atomicMaxFloat(&resultBuffer[settings.indexResult].maxX,worldPos.x);atomicMaxFloat(&resultBuffer[settings.indexResult].maxY,worldPos.y);atomicMaxFloat(&resultBuffer[settings.indexResult].maxZ,worldPos.z);}\\n\";var c=function(){function e(e){this._computeShadersCache={},this._positionBuffers={},this._indexBuffers={},this._weightBuffers={},this._indexExtraBuffers={},this._weightExtraBuffers={},this._morphTargetInfluenceBuffers={},this._morphTargetTextureIndexBuffers={},this._ubos=[],this._uboIndex=0,this._processedMeshes=[],this._computeShaders=[],this._uniqueComputeShaders=new Set,this._resultBuffers=[],this._engine=e}return e.prototype._getComputeShader=function(e,t,r){var n,o=e.join(\"\\n\");if(this._computeShadersCache[o])n=this._computeShadersCache[o];else{var a={positionBuffer:{group:0,binding:0},resultBuffer:{group:0,binding:1},settings:{group:0,binding:7}};t&&(a.boneSampler={group:0,binding:2},a.indexBuffer={group:0,binding:3},a.weightBuffer={group:0,binding:4},a.indexExtraBuffer={group:0,binding:5},a.weightExtraBuffer={group:0,binding:6}),r&&(a.morphTargets={group:0,binding:8},a.morphTargetInfluences={group:0,binding:9},a.morphTargetTextureIndices={group:0,binding:10}),n=new i.H(\"boundingInfoCompute\".concat(t?\"_bones\":\"\").concat(r?\"_morphs\":\"\"),this._engine,\"boundingInfo\",{bindingsMapping:a,defines:e}),this._computeShadersCache[o]=n}return n},e.prototype._getUBO=function(){if(this._uboIndex>=this._ubos.length){var e=new l.D(this._engine);e.addFloat3(\"morphTargetTextureInfo\",0,0,0),e.addUniform(\"morphTargetCount\",1),e.addUniform(\"indexResult\",1),this._ubos.push(e)}return this._ubos[this._uboIndex++]},e.prototype._extractDataAndLink=function(e,t,r,n,i,a){var s,l,c=t.getTotalVertices();if(a[t.uniqueId])l=a[t.uniqueId];else{var u=null===(s=t.getVertexBuffer(r))||void 0===s?void 0:s.getFloatData(c);(l=new o.K(this._engine,Float32Array.BYTES_PER_ELEMENT*c*n)).update(u),a[t.uniqueId]=l}e.setStorageBuffer(i,l)},e.prototype._prepareStorage=function(e,t,r,n,i,a){var s;n[r]?s=n[r]:(s=new o.K(this._engine,Float32Array.BYTES_PER_ELEMENT*i),n[r]=s),s.update(a),e.setStorageBuffer(t,s)},e.prototype.processAsync=function(e){return(0,n.sH)(this,void 0,void 0,(function(){return(0,n.YH)(this,(function(t){switch(t.label){case 0:return[4,this.registerMeshListAsync(e)];case 1:return t.sent(),this.processMeshList(),[4,this.fetchResultsForMeshListAsync()];case 2:return t.sent(),[2]}}))}))},e.prototype.registerMeshListAsync=function(e){var t=this;this._disposeForMeshList(),Array.isArray(e)||(e=[e]);for(var r=0,n=0;n<e.length;n++)0!==(i=e[n]).getTotalVertices()&&i.getVertexBuffer&&i.getVertexBuffer(a.R.PositionKind)&&(this._processedMeshes.push(i),(l=i.morphTargetManager)&&(r=Math.max(r,l.numTargets)));for(n=0;n<this._processedMeshes.length;n++){var i,o=[\"\"],s=!1;(i=this._processedMeshes[n])&&i.useBones&&i.computeBonesUsingShaders&&i.skeleton&&(o.push(\"#define NUM_BONE_INFLUENCERS \"+i.numBoneInfluencers),s=!0);var l,c=this._getComputeShader(o,s,!1);if(this._uniqueComputeShaders.add(c),l=i.morphTargetManager){(o=o.slice()).push(\"#define MORPHTARGETS\"),o.push(\"#define NUM_MORPH_INFLUENCERS \"+r);var u=this._getComputeShader(o,s,!0);this._uniqueComputeShaders.add(u),this._computeShaders.push([c,u])}else this._computeShaders.push([c,c]);var h=this._getUBO();h.updateUInt(\"indexResult\",n),h.update()}return new Promise((function(e){var r=function(){for(var n=t._uniqueComputeShaders.keys(),i=n.next();!0!==i.done;i=n.next())if(!i.value.isReady())return void setTimeout(r,10);e()};r()}))},e.prototype.processMeshList=function(){if(0!==this._processedMeshes.length){this._uboIndex=0;var e=8*this._processedMeshes.length,t=new Float32Array(e),r=new o.K(this._engine,Float32Array.BYTES_PER_ELEMENT*e);this._resultBuffers.push(r);for(var n=0;n<this._processedMeshes.length;n++)t[8*n+0]=Number.POSITIVE_INFINITY,t[8*n+1]=Number.POSITIVE_INFINITY,t[8*n+2]=Number.POSITIVE_INFINITY,t[8*n+3]=Number.NEGATIVE_INFINITY,t[8*n+4]=Number.NEGATIVE_INFINITY,t[8*n+5]=Number.NEGATIVE_INFINITY;for(r.update(t),n=0;n<this._processedMeshes.length;n++){var i=this._processedMeshes[n],s=i.getTotalVertices(),l=this._computeShaders[n],c=l[0],u=l[1],h=i.morphTargetManager,d=h&&h.numInfluencers>0,f=d?u:c;if(this._extractDataAndLink(f,i,a.R.PositionKind,3,\"positionBuffer\",this._positionBuffers),i&&i.useBones&&i.computeBonesUsingShaders&&i.skeleton&&i.skeleton.useTextureToStoreBoneMatrices){this._extractDataAndLink(f,i,a.R.MatricesIndicesKind,4,\"indexBuffer\",this._indexBuffers),this._extractDataAndLink(f,i,a.R.MatricesWeightsKind,4,\"weightBuffer\",this._weightBuffers);var p=i.skeleton.getTransformMatrixTexture(i);f.setTexture(\"boneSampler\",p,!1),i.numBoneInfluencers>4&&(this._extractDataAndLink(f,i,a.R.MatricesIndicesExtraKind,4,\"indexExtraBuffer\",this._indexExtraBuffers),this._extractDataAndLink(f,i,a.R.MatricesWeightsExtraKind,4,\"weightExtraBuffer\",this._weightExtraBuffers))}var _=this._getUBO();if(d){var m=h._targetStoreTexture;f.setTexture(\"morphTargets\",m,!1),this._prepareStorage(f,\"morphTargetInfluences\",i.uniqueId,this._morphTargetInfluenceBuffers,h.numInfluencers,h.influences),this._prepareStorage(f,\"morphTargetTextureIndices\",i.uniqueId,this._morphTargetTextureIndexBuffers,h.numInfluencers,h._morphTargetTextureIndices),_.updateFloat3(\"morphTargetTextureInfo\",h._textureVertexStride,h._textureWidth,h._textureHeight),_.updateInt(\"morphTargetCount\",h.numInfluencers),_.update()}f.setStorageBuffer(\"resultBuffer\",r),f.setUniformBuffer(\"settings\",_),f.dispatch(Math.ceil(s/256)),this._engine.flushFramebuffer()}}},e.prototype.fetchResultsForMeshListAsync=function(){var e=this;return new Promise((function(t){for(var r=[],n=0,i=0;i<e._resultBuffers.length;i++){var o=e._resultBuffers[i].getBuffer();r.push(o),n+=o.capacity}var a=new Float32Array(n/Float32Array.BYTES_PER_ELEMENT),l=s.Pq.Zero(),c=s.Pq.Zero(),u={minimum:l,maximum:c};e._engine.readFromMultipleStorageBuffers(r,0,void 0,a,!0).then((function(){for(var r=0,n=0;n<e._resultBuffers.length;n++){for(var i=0;i<e._processedMeshes.length;i++){var o=e._processedMeshes[i];s.Pq.FromArrayToRef(a,r+8*i,l),s.Pq.FromArrayToRef(a,r+8*i+3,c),n>0&&(l.minimizeInPlace(o.getBoundingInfo().minimum),c.maximizeInPlace(o.getBoundingInfo().maximum)),o._refreshBoundingInfoDirect(u)}r+=8*e._processedMeshes.length}for(var h=0,d=e._resultBuffers;h<d.length;h++)d[h].dispose();e._resultBuffers=[],e._uboIndex=0,t()}))}))},e.prototype._disposeCache=function(e){for(var t in e)e[t].dispose()},e.prototype._disposeForMeshList=function(){for(var e=0,t=this._resultBuffers;e<t.length;e++)t[e].dispose();this._resultBuffers=[],this._processedMeshes=[],this._computeShaders=[],this._uniqueComputeShaders=new Set},e.prototype.dispose=function(){this._disposeCache(this._positionBuffers),this._positionBuffers={},this._disposeCache(this._indexBuffers),this._indexBuffers={},this._disposeCache(this._weightBuffers),this._weightBuffers={},this._disposeCache(this._morphTargetInfluenceBuffers),this._morphTargetInfluenceBuffers={},this._disposeCache(this._morphTargetTextureIndexBuffers),this._morphTargetTextureIndexBuffers={};for(var e=0,t=this._ubos;e<t.length;e++)t[e].dispose();this._ubos=[],this._computeShadersCache={},this._engine=void 0,this._disposeForMeshList()},e}()},37904:(e,t,r)=>{r.r(t),r.d(t,{TransformFeedbackBoundingHelper:()=>u});var n=r(62623),i=r(81152),o=r(85096),a=r(47424),s=r(8046),l=r(98519),c=(r(36470),r(64400),r(24444),r(67369),r(58266),r(84589),r(76898),r(49334),\"gpuTransformVertexShader\");l.l.ShadersStore[c]=\"attribute vec3 position;\\n#include<bonesDeclaration>\\n#include<bakedVertexAnimationDeclaration>\\n#include<morphTargetsVertexGlobalDeclaration>\\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\\nout vec3 outPosition;const mat4 identity=mat4(\\nvec4(1.0,0.0,0.0,0.0),\\nvec4(0.0,1.0,0.0,0.0),\\nvec4(0.0,0.0,1.0,0.0),\\nvec4(0.0,0.0,0.0,1.0)\\n);void main(void) {vec3 positionUpdated=position;\\n#include<morphTargetsVertexGlobal>\\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\\nmat4 finalWorld=identity;\\n#include<bonesVertex>\\n#include<bakedVertexAnimation>\\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);outPosition=worldPos.xyz;}\";l.l.ShadersStore.gpuTransformPixelShader=\"#version 300 es\\nvoid main() {discard;}\\n\";var u=function(){function e(e){this._buffers={},this._effects={},this._meshListCounter=0,this._engine=e}return e.prototype.processAsync=function(e){return Array.isArray(e)||(e=[e]),this._meshListCounter=0,this._processMeshList(e),Promise.resolve()},e.prototype._processMeshList=function(e){var t=this._engine.getCaps().parallelShaderCompile;this._engine.getCaps().parallelShaderCompile=void 0;for(var r=0;r<e.length;++r){var i=e[r];if(0!==i.getTotalVertices()&&i.getVertexBuffer&&i.getVertexBuffer(n.R.PositionKind)){var a=void 0,s=0,l=[],c=[],u=[n.R.PositionKind],h=[];if(i&&i.useBones&&i.computeBonesUsingShaders&&i.skeleton){u.push(n.R.MatricesIndicesKind),u.push(n.R.MatricesWeightsKind),i.numBoneInfluencers>4&&(u.push(n.R.MatricesIndicesExtraKind),u.push(n.R.MatricesWeightsExtraKind));var d=i.skeleton;l.push(\"#define NUM_BONE_INFLUENCERS \"+i.numBoneInfluencers),d.isUsingTextureForMatrices?(l.push(\"#define BONETEXTURE\"),-1===c.indexOf(\"boneTextureWidth\")&&c.push(\"boneTextureWidth\"),-1===h.indexOf(\"boneSampler\")&&h.push(\"boneSampler\")):(l.push(\"#define BonesPerMesh \"+(d.bones.length+1)),-1===c.indexOf(\"mBones\")&&c.push(\"mBones\"))}else l.push(\"#define NUM_BONE_INFLUENCERS 0\");var f=i?i.morphTargetManager:null;if(f){(s=f.numMaxInfluencers||f.numInfluencers)>0&&l.push(\"#define MORPHTARGETS\"),f.isUsingTextureForTargets&&(l.push(\"#define MORPHTARGETS_TEXTURE\"),-1===c.indexOf(\"morphTargetTextureIndices\")&&c.push(\"morphTargetTextureIndices\"),-1===h.indexOf(\"morphTargets\")&&h.push(\"morphTargets\")),l.push(\"#define NUM_MORPH_INFLUENCERS \"+s);for(var p=0;p<s;p++)u.push(n.R.PositionKind+p);s>0&&((c=c.slice()).push(\"morphTargetInfluences\"),c.push(\"morphTargetCount\"),c.push(\"morphTargetTextureInfo\"),c.push(\"morphTargetTextureIndices\"))}var _=i.bakedVertexAnimationManager;_&&_.isEnabled&&(l.push(\"#define BAKED_VERTEX_ANIMATION_TEXTURE\"),-1===c.indexOf(\"bakedVertexAnimationSettings\")&&c.push(\"bakedVertexAnimationSettings\"),-1===c.indexOf(\"bakedVertexAnimationTextureSizeInverted\")&&c.push(\"bakedVertexAnimationTextureSizeInverted\"),-1===c.indexOf(\"bakedVertexAnimationTime\")&&c.push(\"bakedVertexAnimationTime\"),-1===h.indexOf(\"bakedVertexAnimationTexture\")&&h.push(\"bakedVertexAnimationTexture\"),(0,o.J2)(u,i,l));var m=l.join(\"\\n\");if(this._effects[m])a=this._effects[m];else{var g={attributes:u,uniformsNames:c,uniformBuffersNames:[],samplers:h,defines:m,fallbacks:null,onCompiled:null,onError:null,indexParameters:{maxSimultaneousMorphTargets:s},maxSimultaneousLights:0,transformFeedbackVaryings:[\"outPosition\"]};a=this._engine.createEffect(\"gpuTransform\",g,this._engine),this._effects[m]=a}this._compute(i,a)}}this._engine.getCaps().parallelShaderCompile=t},e.prototype._compute=function(t,r){var s,l,c=this._engine,u=t.getTotalVertices();if(this._buffers[t.uniqueId])l=this._buffers[t.uniqueId];else{var h=new Float32Array(3*u);l=new n.h(t.getEngine(),h,!0,3),this._buffers[t.uniqueId]=l}r.getEngine().enableEffect(r),t._bindDirect(r,null,!0),(0,o.f$)(t,r);var d=t.morphTargetManager;d&&d.numInfluencers>0&&(0,o.nR)(t,r);var f=t.bakedVertexAnimationManager;f&&f.isEnabled&&(null===(s=t.bakedVertexAnimationManager)||void 0===s||s.bind(r,!1));var p=l.getData();if(c.bindTransformFeedbackBuffer(l.getBuffer()),c.setRasterizerState(!1),c.beginTransformFeedback(!0),c.drawArraysType(i.Y.MATERIAL_PointFillMode,0,u),c.endTransformFeedback(),c.setRasterizerState(!0),c.readTransformFeedbackBuffer(p),c.bindTransformFeedbackBuffer(null),0===this._meshListCounter)t._refreshBoundingInfo(p,null);else{var _=t.getBoundingInfo().boundingBox,m=(0,a.b)(p,0,u);e._Min.copyFrom(_.minimum).minimizeInPlace(m.minimum),e._Max.copyFrom(_.maximum).maximizeInPlace(m.maximum),t._refreshBoundingInfoDirect({minimum:e._Min,maximum:e._Max})}},e.prototype.registerMeshListAsync=function(e){return Array.isArray(e)||(e=[e]),this._meshList=e,this._meshListCounter=0,Promise.resolve()},e.prototype.processMeshList=function(){0!==this._meshList.length&&(this._processMeshList(this._meshList),this._meshListCounter++)},e.prototype.fetchResultsForMeshListAsync=function(){return this._meshListCounter=0,Promise.resolve()},e.prototype.dispose=function(){for(var e in this._buffers)this._buffers[e].dispose();this._buffers={},this._effects={},this._engine=null},e._Min=new s.Pq,e._Max=new s.Pq,e}()},45158:(e,t,r)=>{var n,i,o,a,s,l,c;r.d(t,{ST:()=>i,Ze:()=>o,bq:()=>n,dR:()=>c,h8:()=>a,pI:()=>s,sZ:()=>l}),function(e){e[e.Generic=0]=\"Generic\",e[e.Keyboard=1]=\"Keyboard\",e[e.Mouse=2]=\"Mouse\",e[e.Touch=3]=\"Touch\",e[e.DualShock=4]=\"DualShock\",e[e.Xbox=5]=\"Xbox\",e[e.Switch=6]=\"Switch\",e[e.DualSense=7]=\"DualSense\"}(n||(n={})),function(e){e[e.Horizontal=0]=\"Horizontal\",e[e.Vertical=1]=\"Vertical\",e[e.LeftClick=2]=\"LeftClick\",e[e.MiddleClick=3]=\"MiddleClick\",e[e.RightClick=4]=\"RightClick\",e[e.BrowserBack=5]=\"BrowserBack\",e[e.BrowserForward=6]=\"BrowserForward\",e[e.MouseWheelX=7]=\"MouseWheelX\",e[e.MouseWheelY=8]=\"MouseWheelY\",e[e.MouseWheelZ=9]=\"MouseWheelZ\",e[e.Move=12]=\"Move\"}(i||(i={})),function(e){e[e.Horizontal=0]=\"Horizontal\",e[e.Vertical=1]=\"Vertical\",e[e.LeftClick=2]=\"LeftClick\",e[e.MiddleClick=3]=\"MiddleClick\",e[e.RightClick=4]=\"RightClick\",e[e.BrowserBack=5]=\"BrowserBack\",e[e.BrowserForward=6]=\"BrowserForward\",e[e.MouseWheelX=7]=\"MouseWheelX\",e[e.MouseWheelY=8]=\"MouseWheelY\",e[e.MouseWheelZ=9]=\"MouseWheelZ\",e[e.DeltaHorizontal=10]=\"DeltaHorizontal\",e[e.DeltaVertical=11]=\"DeltaVertical\"}(o||(o={})),function(e){e[e.Cross=0]=\"Cross\",e[e.Circle=1]=\"Circle\",e[e.Square=2]=\"Square\",e[e.Triangle=3]=\"Triangle\",e[e.L1=4]=\"L1\",e[e.R1=5]=\"R1\",e[e.L2=6]=\"L2\",e[e.R2=7]=\"R2\",e[e.Share=8]=\"Share\",e[e.Options=9]=\"Options\",e[e.L3=10]=\"L3\",e[e.R3=11]=\"R3\",e[e.DPadUp=12]=\"DPadUp\",e[e.DPadDown=13]=\"DPadDown\",e[e.DPadLeft=14]=\"DPadLeft\",e[e.DPadRight=15]=\"DPadRight\",e[e.Home=16]=\"Home\",e[e.TouchPad=17]=\"TouchPad\",e[e.LStickXAxis=18]=\"LStickXAxis\",e[e.LStickYAxis=19]=\"LStickYAxis\",e[e.RStickXAxis=20]=\"RStickXAxis\",e[e.RStickYAxis=21]=\"RStickYAxis\"}(a||(a={})),function(e){e[e.Cross=0]=\"Cross\",e[e.Circle=1]=\"Circle\",e[e.Square=2]=\"Square\",e[e.Triangle=3]=\"Triangle\",e[e.L1=4]=\"L1\",e[e.R1=5]=\"R1\",e[e.L2=6]=\"L2\",e[e.R2=7]=\"R2\",e[e.Create=8]=\"Create\",e[e.Options=9]=\"Options\",e[e.L3=10]=\"L3\",e[e.R3=11]=\"R3\",e[e.DPadUp=12]=\"DPadUp\",e[e.DPadDown=13]=\"DPadDown\",e[e.DPadLeft=14]=\"DPadLeft\",e[e.DPadRight=15]=\"DPadRight\",e[e.Home=16]=\"Home\",e[e.TouchPad=17]=\"TouchPad\",e[e.LStickXAxis=18]=\"LStickXAxis\",e[e.LStickYAxis=19]=\"LStickYAxis\",e[e.RStickXAxis=20]=\"RStickXAxis\",e[e.RStickYAxis=21]=\"RStickYAxis\"}(s||(s={})),function(e){e[e.A=0]=\"A\",e[e.B=1]=\"B\",e[e.X=2]=\"X\",e[e.Y=3]=\"Y\",e[e.LB=4]=\"LB\",e[e.RB=5]=\"RB\",e[e.LT=6]=\"LT\",e[e.RT=7]=\"RT\",e[e.Back=8]=\"Back\",e[e.Start=9]=\"Start\",e[e.LS=10]=\"LS\",e[e.RS=11]=\"RS\",e[e.DPadUp=12]=\"DPadUp\",e[e.DPadDown=13]=\"DPadDown\",e[e.DPadLeft=14]=\"DPadLeft\",e[e.DPadRight=15]=\"DPadRight\",e[e.Home=16]=\"Home\",e[e.LStickXAxis=17]=\"LStickXAxis\",e[e.LStickYAxis=18]=\"LStickYAxis\",e[e.RStickXAxis=19]=\"RStickXAxis\",e[e.RStickYAxis=20]=\"RStickYAxis\"}(l||(l={})),function(e){e[e.B=0]=\"B\",e[e.A=1]=\"A\",e[e.Y=2]=\"Y\",e[e.X=3]=\"X\",e[e.L=4]=\"L\",e[e.R=5]=\"R\",e[e.ZL=6]=\"ZL\",e[e.ZR=7]=\"ZR\",e[e.Minus=8]=\"Minus\",e[e.Plus=9]=\"Plus\",e[e.LS=10]=\"LS\",e[e.RS=11]=\"RS\",e[e.DPadUp=12]=\"DPadUp\",e[e.DPadDown=13]=\"DPadDown\",e[e.DPadLeft=14]=\"DPadLeft\",e[e.DPadRight=15]=\"DPadRight\",e[e.Home=16]=\"Home\",e[e.Capture=17]=\"Capture\",e[e.LStickXAxis=18]=\"LStickXAxis\",e[e.LStickYAxis=19]=\"LStickYAxis\",e[e.RStickXAxis=20]=\"RStickXAxis\",e[e.RStickYAxis=21]=\"RStickYAxis\"}(c||(c={}))},84163:(e,t,r)=>{r.d(t,{c:()=>i});var n=r(66377),i=function(){function e(e,t,r){void 0===r&&(r=0),this.deviceType=t,this.deviceSlot=r,this.onInputChangedObservable=new n.cP,this._deviceInputSystem=e}return e.prototype.getInput=function(e){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,e)},e}()},67925:(e,t,r)=>{r.d(t,{Z:()=>_});var n=r(45158),i=r(66377),o=r(81152),a=r(50712),s=function(){function e(){}return e.CreateDeviceEvent=function(e,t,r,i,o,a,s){switch(e){case n.bq.Keyboard:return this._CreateKeyboardEvent(r,i,o,a);case n.bq.Mouse:if(r===n.ST.MouseWheelX||r===n.ST.MouseWheelY||r===n.ST.MouseWheelZ)return this._CreateWheelEvent(e,t,r,i,o,a);case n.bq.Touch:return this._CreatePointerEvent(e,t,r,i,o,a,s);default:throw\"Unable to generate event for device \".concat(n.bq[e])}},e._CreatePointerEvent=function(e,t,r,i,o,a,s){var l=this._CreateMouseEvent(e,t,r,i,o,a);e===n.bq.Mouse?(l.deviceType=n.bq.Mouse,l.pointerId=1,l.pointerType=\"mouse\"):(l.deviceType=n.bq.Touch,l.pointerId=null!=s?s:t,l.pointerType=\"touch\");var c=0;return c+=o.pollInput(e,t,n.ST.LeftClick),c+=2*o.pollInput(e,t,n.ST.RightClick),c+=4*o.pollInput(e,t,n.ST.MiddleClick),l.buttons=c,r===n.ST.Move?l.type=\"pointermove\":r>=n.ST.LeftClick&&r<=n.ST.RightClick&&(l.type=1===i?\"pointerdown\":\"pointerup\",l.button=r-2),l},e._CreateWheelEvent=function(e,t,r,i,o,s){var l=this._CreateMouseEvent(e,t,r,i,o,s);switch(l.pointerId=1,l.type=\"wheel\",l.deltaMode=a.s.DOM_DELTA_PIXEL,l.deltaX=0,l.deltaY=0,l.deltaZ=0,r){case n.ST.MouseWheelX:l.deltaX=i;break;case n.ST.MouseWheelY:l.deltaY=i;break;case n.ST.MouseWheelZ:l.deltaZ=i}return l},e._CreateMouseEvent=function(e,t,r,i,o,a){var s=this._CreateEvent(a),l=o.pollInput(e,t,n.ST.Horizontal),c=o.pollInput(e,t,n.ST.Vertical);return a?(s.movementX=0,s.movementY=0,s.offsetX=s.movementX-a.getBoundingClientRect().x,s.offsetY=s.movementY-a.getBoundingClientRect().y):(s.movementX=o.pollInput(e,t,10),s.movementY=o.pollInput(e,t,11),s.offsetX=0,s.offsetY=0),this._CheckNonCharacterKeys(s,o),s.clientX=l,s.clientY=c,s.x=l,s.y=c,s.deviceType=e,s.deviceSlot=t,s.inputIndex=r,s},e._CreateKeyboardEvent=function(e,t,r,i){var o=this._CreateEvent(i);return this._CheckNonCharacterKeys(o,r),o.deviceType=n.bq.Keyboard,o.deviceSlot=0,o.inputIndex=e,o.type=1===t?\"keydown\":\"keyup\",o.key=String.fromCharCode(e),o.keyCode=e,o},e._CheckNonCharacterKeys=function(e,t){var r=t.isDeviceAvailable(n.bq.Keyboard),i=r&&1===t.pollInput(n.bq.Keyboard,0,o.Y.INPUT_ALT_KEY),a=r&&1===t.pollInput(n.bq.Keyboard,0,o.Y.INPUT_CTRL_KEY),s=r&&(1===t.pollInput(n.bq.Keyboard,0,o.Y.INPUT_META_KEY1)||1===t.pollInput(n.bq.Keyboard,0,o.Y.INPUT_META_KEY2)||1===t.pollInput(n.bq.Keyboard,0,o.Y.INPUT_META_KEY3)),l=r&&1===t.pollInput(n.bq.Keyboard,0,o.Y.INPUT_SHIFT_KEY);e.altKey=i,e.ctrlKey=a,e.metaKey=s,e.shiftKey=l},e._CreateEvent=function(e){var t={preventDefault:function(){}};return t.target=e,t},e}(),l=function(){function e(e,t,r){var n=this;this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(e,t,(function(e,t,i,o){var a=s.CreateDeviceEvent(e,t,i,o,n);r(e,t,a)})):this._createDummyNativeInput()}return e.prototype.pollInput=function(e,t,r){return this._nativeInput.pollInput(e,t,r)},e.prototype.isDeviceAvailable=function(e){return e===n.bq.Mouse||e===n.bq.Touch},e.prototype.dispose=function(){this._nativeInput.dispose()},e.prototype._createDummyNativeInput=function(){return{pollInput:function(){return 0},isDeviceAvailable:function(){return!1},dispose:function(){}}},e}(),c=r(5153),u=r(44957),h=Object.keys(n.ST).length/2,d=function(){function e(e,t,r,n){var i=this;this._inputs=[],this._keyboardActive=!1,this._pointerActive=!1,this._usingSafari=u.S0.IsSafari(),this._usingMacOS=(0,c.XD)()&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),this._keyboardDownEvent=function(e){},this._keyboardUpEvent=function(e){},this._keyboardBlurEvent=function(e){},this._pointerMoveEvent=function(e){},this._pointerDownEvent=function(e){},this._pointerUpEvent=function(e){},this._pointerCancelEvent=function(e){},this._pointerWheelEvent=function(e){},this._pointerBlurEvent=function(e){},this._pointerMacOSChromeOutEvent=function(e){},this._eventsAttached=!1,this._mouseId=-1,this._isUsingFirefox=(0,c.XD)()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf(\"Firefox\"),this._isUsingChromium=(0,c.XD)()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf(\"Chrome\"),this._maxTouchPoints=0,this._pointerInputClearObserver=null,this._gamepadConnectedEvent=function(e){},this._gamepadDisconnectedEvent=function(e){},this._eventPrefix=u.S0.GetPointerPrefix(e),this._engine=e,this._onDeviceConnected=t,this._onDeviceDisconnected=r,this._onInputChanged=n,this._mouseId=this._isUsingFirefox?0:1,this._enableEvents(),this._usingMacOS&&(this._metaKeys=[]),this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=function(){i._enableEvents()})}return e.prototype.pollInput=function(e,t,r){var i=this._inputs[e][t];if(!i)throw\"Unable to find device \".concat(n.bq[e]);e>=n.bq.DualShock&&e<=n.bq.DualSense&&this._updateDevice(e,t,r);var o=i[r];if(void 0===o)throw\"Unable to find input \".concat(r,\" for device \").concat(n.bq[e],\" in slot \").concat(t);return r===n.ST.Move&&u.S0.Warn(\"Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data.\"),o},e.prototype.isDeviceAvailable=function(e){return void 0!==this._inputs[e]},e.prototype.dispose=function(){this._onDeviceConnected=function(){},this._onDeviceDisconnected=function(){},this._onInputChanged=function(){},delete this._engine._onEngineViewChanged,this._elementToAttachTo&&this._disableEvents()},e.prototype._enableEvents=function(){var e=null==this?void 0:this._engine.getInputElement();if(e&&(!this._eventsAttached||this._elementToAttachTo!==e)){if(this._disableEvents(),this._inputs)for(var t=0,r=this._inputs;t<r.length;t++){var n=r[t];if(n)for(var i in n){var o=n[+i];if(o)for(var a=0;a<o.length;a++)o[a]=0}}this._elementToAttachTo=e,this._elementToAttachTo.tabIndex=-1!==this._elementToAttachTo.tabIndex?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._eventsAttached=!0,this._checkForConnectedDevices()}},e.prototype._disableEvents=function(){this._elementToAttachTo&&(this._elementToAttachTo.removeEventListener(\"blur\",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener(\"blur\",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener(\"keydown\",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener(\"keyup\",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+\"move\",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+\"down\",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+\"up\",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+\"cancel\",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),this._usingMacOS&&this._isUsingChromium&&this._elementToAttachTo.removeEventListener(\"lostpointercapture\",this._pointerMacOSChromeOutEvent),window.removeEventListener(\"gamepadconnected\",this._gamepadConnectedEvent),window.removeEventListener(\"gamepaddisconnected\",this._gamepadDisconnectedEvent)),this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver),this._eventsAttached=!1},e.prototype._checkForConnectedDevices=function(){if(navigator.getGamepads)for(var e=0,t=navigator.getGamepads();e<t.length;e++){var r=t[e];r&&this._addGamePad(r)}\"function\"==typeof matchMedia&&matchMedia(\"(pointer:fine)\").matches&&this._addPointerDevice(n.bq.Mouse,0,0,0)},e.prototype._addGamePad=function(e){var t=this._getGamepadDeviceType(e.id),r=e.index;this._gamepads=this._gamepads||new Array(e.index+1),this._registerDevice(t,r,e.buttons.length+e.axes.length),this._gamepads[r]=t},e.prototype._addPointerDevice=function(e,t,r,n){this._pointerActive||(this._pointerActive=!0),this._registerDevice(e,t,h);var i=this._inputs[e][t];i[0]=r,i[1]=n},e.prototype._registerDevice=function(e,t,r){if(void 0===t)throw\"Unable to register device \".concat(n.bq[e],\" to undefined slot.\");if(this._inputs[e]||(this._inputs[e]={}),!this._inputs[e][t]){var i=new Array(r);i.fill(0),this._inputs[e][t]=i,this._onDeviceConnected(e,t)}},e.prototype._unregisterDevice=function(e,t){this._inputs[e][t]&&(delete this._inputs[e][t],this._onDeviceDisconnected(e,t))},e.prototype._handleKeyActions=function(){var e=this;this._keyboardDownEvent=function(t){e._keyboardActive||(e._keyboardActive=!0,e._registerDevice(n.bq.Keyboard,0,255));var r=e._inputs[n.bq.Keyboard][0];if(r){r[t.keyCode]=1;var i=t;i.inputIndex=t.keyCode,e._usingMacOS&&t.metaKey&&\"Meta\"!==t.key&&(e._metaKeys.includes(t.keyCode)||e._metaKeys.push(t.keyCode)),e._onInputChanged(n.bq.Keyboard,0,i)}},this._keyboardUpEvent=function(t){e._keyboardActive||(e._keyboardActive=!0,e._registerDevice(n.bq.Keyboard,0,255));var r=e._inputs[n.bq.Keyboard][0];if(r){r[t.keyCode]=0;var i=t;if(i.inputIndex=t.keyCode,e._usingMacOS&&\"Meta\"===t.key&&e._metaKeys.length>0){for(var o=0,a=e._metaKeys;o<a.length;o++){var l=a[o],c=s.CreateDeviceEvent(n.bq.Keyboard,0,l,0,e,e._elementToAttachTo);r[l]=0,e._onInputChanged(n.bq.Keyboard,0,c)}e._metaKeys.splice(0,e._metaKeys.length)}e._onInputChanged(n.bq.Keyboard,0,i)}},this._keyboardBlurEvent=function(){if(e._keyboardActive){for(var t=e._inputs[n.bq.Keyboard][0],r=0;r<t.length;r++)if(0!==t[r]){t[r]=0;var i=s.CreateDeviceEvent(n.bq.Keyboard,0,r,0,e,e._elementToAttachTo);e._onInputChanged(n.bq.Keyboard,0,i)}e._usingMacOS&&e._metaKeys.splice(0,e._metaKeys.length)}},this._elementToAttachTo.addEventListener(\"keydown\",this._keyboardDownEvent),this._elementToAttachTo.addEventListener(\"keyup\",this._keyboardUpEvent),this._elementToAttachTo.addEventListener(\"blur\",this._keyboardBlurEvent)},e.prototype._handlePointerActions=function(){var e=this;this._maxTouchPoints=(0,c.XD)()&&navigator.maxTouchPoints||2,this._activeTouchIds||(this._activeTouchIds=new Array(this._maxTouchPoints));for(var t=0;t<this._maxTouchPoints;t++)this._activeTouchIds[t]=-1;this._pointerMoveEvent=function(t){var r=e._getPointerType(t),i=r===n.bq.Mouse?0:e._activeTouchIds.indexOf(t.pointerId);if(r===n.bq.Touch&&-1===i){var o=e._activeTouchIds.indexOf(-1);if(!(o>=0))return void u.S0.Warn(\"Max number of touches exceeded.  Ignoring touches in excess of \".concat(e._maxTouchPoints));i=o,e._activeTouchIds[o]=t.pointerId,e._onDeviceConnected(r,i)}e._inputs[r]||(e._inputs[r]={}),e._inputs[r][i]||e._addPointerDevice(r,i,t.clientX,t.clientY);var a=e._inputs[r][i];if(a){var s=t;s.inputIndex=n.ST.Move,a[n.ST.Horizontal]=t.clientX,a[n.ST.Vertical]=t.clientY,r===n.bq.Touch&&0===a[n.ST.LeftClick]&&(a[n.ST.LeftClick]=1),void 0===t.pointerId&&(t.pointerId=e._mouseId),e._onInputChanged(r,i,s),e._usingSafari||-1===t.button||(s.inputIndex=t.button+2,a[t.button+2]=a[t.button+2]?0:1,e._onInputChanged(r,i,s))}},this._pointerDownEvent=function(t){var r=e._getPointerType(t),i=r===n.bq.Mouse?0:t.pointerId;if(r===n.bq.Touch){var o=e._activeTouchIds.indexOf(t.pointerId);if(-1===o&&(o=e._activeTouchIds.indexOf(-1)),!(o>=0))return void u.S0.Warn(\"Max number of touches exceeded.  Ignoring touches in excess of \".concat(e._maxTouchPoints));i=o,e._activeTouchIds[o]=t.pointerId}e._inputs[r]||(e._inputs[r]={}),e._inputs[r][i]?r===n.bq.Touch&&e._onDeviceConnected(r,i):e._addPointerDevice(r,i,t.clientX,t.clientY);var a=e._inputs[r][i];if(a){var s=a[n.ST.Horizontal],l=a[n.ST.Vertical];if(r===n.bq.Mouse){if(void 0===t.pointerId&&(t.pointerId=e._mouseId),!document.pointerLockElement)try{e._elementToAttachTo.setPointerCapture(e._mouseId)}catch(e){}}else if(t.pointerId&&!document.pointerLockElement)try{e._elementToAttachTo.setPointerCapture(t.pointerId)}catch(e){}a[n.ST.Horizontal]=t.clientX,a[n.ST.Vertical]=t.clientY,a[t.button+2]=1;var c=t;c.inputIndex=t.button+2,e._onInputChanged(r,i,c),s===t.clientX&&l===t.clientY||(c.inputIndex=n.ST.Move,e._onInputChanged(r,i,c))}},this._pointerUpEvent=function(t){var r,i,o,a,s,l=e._getPointerType(t),c=l===n.bq.Mouse?0:e._activeTouchIds.indexOf(t.pointerId);if(l===n.bq.Touch){if(-1===c)return;e._activeTouchIds[c]=-1}var u=null===(r=e._inputs[l])||void 0===r?void 0:r[c];if(u&&0!==u[t.button+2]){var h=u[n.ST.Horizontal],d=u[n.ST.Vertical];u[n.ST.Horizontal]=t.clientX,u[n.ST.Vertical]=t.clientY,u[t.button+2]=0;var f=t;void 0===t.pointerId&&(t.pointerId=e._mouseId),h===t.clientX&&d===t.clientY||(f.inputIndex=n.ST.Move,e._onInputChanged(l,c,f)),f.inputIndex=t.button+2,l===n.bq.Mouse&&e._mouseId>=0&&(null===(o=(i=e._elementToAttachTo).hasPointerCapture)||void 0===o?void 0:o.call(i,e._mouseId))?e._elementToAttachTo.releasePointerCapture(e._mouseId):t.pointerId&&(null===(s=(a=e._elementToAttachTo).hasPointerCapture)||void 0===s?void 0:s.call(a,t.pointerId))&&e._elementToAttachTo.releasePointerCapture(t.pointerId),e._onInputChanged(l,c,f),l===n.bq.Touch&&e._onDeviceDisconnected(l,c)}},this._pointerCancelEvent=function(t){var r,i,o,a;if(\"mouse\"===t.pointerType){var l=e._inputs[n.bq.Mouse][0];e._mouseId>=0&&(null===(i=(r=e._elementToAttachTo).hasPointerCapture)||void 0===i?void 0:i.call(r,e._mouseId))&&e._elementToAttachTo.releasePointerCapture(e._mouseId);for(var c=n.ST.LeftClick;c<=n.ST.BrowserForward;c++)if(1===l[c]){l[c]=0;var u=s.CreateDeviceEvent(n.bq.Mouse,0,c,0,e,e._elementToAttachTo);e._onInputChanged(n.bq.Mouse,0,u)}}else{var h=e._activeTouchIds.indexOf(t.pointerId);if(-1===h)return;(null===(a=(o=e._elementToAttachTo).hasPointerCapture)||void 0===a?void 0:a.call(o,t.pointerId))&&e._elementToAttachTo.releasePointerCapture(t.pointerId),e._inputs[n.bq.Touch][h][n.ST.LeftClick]=0,u=s.CreateDeviceEvent(n.bq.Touch,h,n.ST.LeftClick,0,e,e._elementToAttachTo,t.pointerId),e._onInputChanged(n.bq.Touch,h,u),e._activeTouchIds[h]=-1,e._onDeviceDisconnected(n.bq.Touch,h)}},this._wheelEventName=\"onwheel\"in document.createElement(\"div\")?\"wheel\":void 0!==document.onmousewheel?\"mousewheel\":\"DOMMouseScroll\";var r=!1,i=function(){};try{var o=Object.defineProperty({},\"passive\",{get:function(){r=!0}});this._elementToAttachTo.addEventListener(\"test\",i,o),this._elementToAttachTo.removeEventListener(\"test\",i,o)}catch(e){}this._pointerBlurEvent=function(){var t,r,i,o,a;if(e.isDeviceAvailable(n.bq.Mouse)){var l=e._inputs[n.bq.Mouse][0];e._mouseId>=0&&(null===(r=(t=e._elementToAttachTo).hasPointerCapture)||void 0===r?void 0:r.call(t,e._mouseId))&&e._elementToAttachTo.releasePointerCapture(e._mouseId);for(var c=n.ST.LeftClick;c<=n.ST.BrowserForward;c++)if(1===l[c]){l[c]=0;var u=s.CreateDeviceEvent(n.bq.Mouse,0,c,0,e,e._elementToAttachTo);e._onInputChanged(n.bq.Mouse,0,u)}}if(e.isDeviceAvailable(n.bq.Touch)){l=e._inputs[n.bq.Touch];for(var h=0;h<e._activeTouchIds.length;h++){var d=e._activeTouchIds[h];(null===(o=(i=e._elementToAttachTo).hasPointerCapture)||void 0===o?void 0:o.call(i,d))&&e._elementToAttachTo.releasePointerCapture(d),-1!==d&&1===(null===(a=l[h])||void 0===a?void 0:a[n.ST.LeftClick])&&(l[h][n.ST.LeftClick]=0,u=s.CreateDeviceEvent(n.bq.Touch,h,n.ST.LeftClick,0,e,e._elementToAttachTo,d),e._onInputChanged(n.bq.Touch,h,u),e._activeTouchIds[h]=-1,e._onDeviceDisconnected(n.bq.Touch,h))}}},this._pointerWheelEvent=function(t){var r=n.bq.Mouse;e._inputs[r]||(e._inputs[r]=[]),e._inputs[r][0]||(e._pointerActive=!0,e._registerDevice(r,0,h));var i=e._inputs[r][0];if(i){i[n.ST.MouseWheelX]=t.deltaX||0,i[n.ST.MouseWheelY]=t.deltaY||t.wheelDelta||0,i[n.ST.MouseWheelZ]=t.deltaZ||0;var o=t;void 0===t.pointerId&&(t.pointerId=e._mouseId),0!==i[n.ST.MouseWheelX]&&(o.inputIndex=n.ST.MouseWheelX,e._onInputChanged(r,0,o)),0!==i[n.ST.MouseWheelY]&&(o.inputIndex=n.ST.MouseWheelY,e._onInputChanged(r,0,o)),0!==i[n.ST.MouseWheelZ]&&(o.inputIndex=n.ST.MouseWheelZ,e._onInputChanged(r,0,o))}},this._usingMacOS&&this._isUsingChromium&&(this._pointerMacOSChromeOutEvent=function(t){t.buttons>1&&e._pointerCancelEvent(t)},this._elementToAttachTo.addEventListener(\"lostpointercapture\",this._pointerMacOSChromeOutEvent)),this._elementToAttachTo.addEventListener(this._eventPrefix+\"move\",this._pointerMoveEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+\"down\",this._pointerDownEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+\"up\",this._pointerUpEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+\"cancel\",this._pointerCancelEvent),this._elementToAttachTo.addEventListener(\"blur\",this._pointerBlurEvent),this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,!!r&&{passive:!1}),this._pointerInputClearObserver=this._engine.onEndFrameObservable.add((function(){if(e.isDeviceAvailable(n.bq.Mouse)){var t=e._inputs[n.bq.Mouse][0];t[n.ST.MouseWheelX]=0,t[n.ST.MouseWheelY]=0,t[n.ST.MouseWheelZ]=0}}))},e.prototype._handleGamepadActions=function(){var e=this;this._gamepadConnectedEvent=function(t){e._addGamePad(t.gamepad)},this._gamepadDisconnectedEvent=function(t){if(e._gamepads){var r=e._getGamepadDeviceType(t.gamepad.id),n=t.gamepad.index;e._unregisterDevice(r,n),delete e._gamepads[n]}},window.addEventListener(\"gamepadconnected\",this._gamepadConnectedEvent),window.addEventListener(\"gamepaddisconnected\",this._gamepadDisconnectedEvent)},e.prototype._updateDevice=function(e,t,r){var n=navigator.getGamepads()[t];if(n&&e===this._gamepads[t]){var i=this._inputs[e][t];r>=n.buttons.length?i[r]=n.axes[r-n.buttons.length].valueOf():i[r]=n.buttons[r].value}},e.prototype._getGamepadDeviceType=function(e){return-1!==e.indexOf(\"054c\")?-1!==e.indexOf(\"0ce6\")?n.bq.DualSense:n.bq.DualShock:-1!==e.indexOf(\"Xbox One\")||-1!==e.search(\"Xbox 360\")||-1!==e.search(\"xinput\")?n.bq.Xbox:-1!==e.indexOf(\"057e\")?n.bq.Switch:n.bq.Generic},e.prototype._getPointerType=function(e){var t=n.bq.Mouse;return(\"touch\"===e.pointerType||\"pen\"===e.pointerType||e.touches)&&(t=n.bq.Touch),t},e}(),f=r(84163),p=function(){function e(e){var t=this;this._registeredManagers=new Array,this._refCount=0,this.registerManager=function(e){for(var r=0;r<t._devices.length;r++){var n=t._devices[r];for(var i in n){var o=+i;e._addDevice(new f.c(t._deviceInputSystem,r,o))}}t._registeredManagers.push(e)},this.unregisterManager=function(e){var r=t._registeredManagers.indexOf(e);r>-1&&t._registeredManagers.splice(r,1)};var r=Object.keys(n.bq).length/2;this._devices=new Array(r);var i=function(e,r){t._devices[e]||(t._devices[e]=new Array),t._devices[e][r]||(t._devices[e][r]=r);for(var n=0,i=t._registeredManagers;n<i.length;n++){var o=i[n],a=new f.c(t._deviceInputSystem,e,r);o._addDevice(a)}},o=function(e,r){var n;(null===(n=t._devices[e])||void 0===n?void 0:n[r])&&delete t._devices[e][r];for(var i=0,o=t._registeredManagers;i<o.length;i++)o[i]._removeDevice(e,r)},a=function(e,r,n){if(n)for(var i=0,o=t._registeredManagers;i<o.length;i++)o[i]._onInputChanged(e,r,n)};\"undefined\"!=typeof _native?this._deviceInputSystem=new l(i,o,a):this._deviceInputSystem=new d(e,i,o,a)}return e.prototype.dispose=function(){this._deviceInputSystem.dispose()},e}(),_=function(){function e(e){var t=this,r=Object.keys(n.bq).length/2;this._devices=new Array(r),this._firstDevice=new Array(r),this._engine=e,this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new p(e)),this._engine._deviceSourceManager._refCount++,this.onDeviceConnectedObservable=new i.cP((function(e){for(var r=0,n=t._devices;r<n.length;r++){var i=n[r];if(i)for(var o=0,a=i;o<a.length;o++){var s=a[o];s&&t.onDeviceConnectedObservable.notifyObserver(e,s)}}})),this.onDeviceDisconnectedObservable=new i.cP,this._engine._deviceSourceManager.registerManager(this),this._onDisposeObserver=e.onDisposeObservable.add((function(){t.dispose()}))}return e.prototype.getDeviceSource=function(e,t){if(void 0===t){if(void 0===this._firstDevice[e])return null;t=this._firstDevice[e]}return this._devices[e]&&void 0!==this._devices[e][t]?this._devices[e][t]:null},e.prototype.getDeviceSources=function(e){return this._devices[e]?this._devices[e].filter((function(e){return!!e})):[]},e.prototype.dispose=function(){this.onDeviceConnectedObservable.clear(),this.onDeviceDisconnectedObservable.clear(),this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),--this._engine._deviceSourceManager._refCount<1&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager)),this._engine.onDisposeObservable.remove(this._onDisposeObserver)},e.prototype._addDevice=function(e){this._devices[e.deviceType]||(this._devices[e.deviceType]=new Array),this._devices[e.deviceType][e.deviceSlot]||(this._devices[e.deviceType][e.deviceSlot]=e,this._updateFirstDevices(e.deviceType)),this.onDeviceConnectedObservable.notifyObservers(e)},e.prototype._removeDevice=function(e,t){var r,n,i=null===(r=this._devices[e])||void 0===r?void 0:r[t];this.onDeviceDisconnectedObservable.notifyObservers(i),(null===(n=this._devices[e])||void 0===n?void 0:n[t])&&delete this._devices[e][t],this._updateFirstDevices(e)},e.prototype._onInputChanged=function(e,t,r){var n,i;null===(i=null===(n=this._devices[e])||void 0===n?void 0:n[t])||void 0===i||i.onInputChangedObservable.notifyObservers(r)},e.prototype._updateFirstDevices=function(e){switch(e){case n.bq.Keyboard:case n.bq.Mouse:this._firstDevice[e]=0;break;case n.bq.Touch:case n.bq.DualSense:case n.bq.DualShock:case n.bq.Xbox:case n.bq.Switch:case n.bq.Generic:delete this._firstDevice[e];var t=this._devices[e];if(t)for(var r=0;r<t.length;r++)if(t[r]){this._firstDevice[e]=r;break}}},e}()},19966:(e,t,r)=>{var n=r(19133),i=r(7164),o=r(17347),a=r(23885),s=r(82673),l=r(1235);s.$.prototype._partialLoadFile=function(e,t,r,n,i){void 0===i&&(i=null),this._loadFile(e,(function(e){r[t]=e,r._internalCount++,6===r._internalCount&&n(r)}),void 0,void 0,!0,(function(e,t){i&&e&&i(e.status+\" \"+e.statusText,t)}))},s.$.prototype._cascadeLoadFiles=function(e,t,r,n){void 0===n&&(n=null);var i=[];i._internalCount=0;for(var o=0;o<6;o++)this._partialLoadFile(r[o],o,i,t,n)},s.$.prototype._cascadeLoadImgs=function(e,t,r,n,i,o){void 0===i&&(i=null);var a=[];a._internalCount=0;for(var s=0;s<6;s++)this._partialLoadImg(n[s],s,a,e,t,r,i,o)},s.$.prototype._partialLoadImg=function(e,t,r,n,i,s,l,c){void 0===l&&(l=null);var u=(0,a.z)();(0,o.W$)(e,(function(e){r[t]=e,r._internalCount++,n&&n.removePendingData(u),6===r._internalCount&&s&&s(i,r)}),(function(e,t){n&&n.removePendingData(u),l&&l(e,t)}),n?n.offlineProvider:null,c),n&&n.addPendingData(u)},s.$.prototype.createCubeTextureBase=function(e,t,r,o,a,s,c,u,h,d,f,p,_,m,g,v){var y=this;void 0===a&&(a=null),void 0===s&&(s=null),void 0===u&&(u=null),void 0===h&&(h=!1),void 0===d&&(d=0),void 0===f&&(f=0),void 0===p&&(p=null),void 0===_&&(_=null),void 0===m&&(m=null),void 0===g&&(g=!1),void 0===v&&(v=null);var b=p||new n.h(this,7);b.isCube=!0,b.url=e,b.generateMipMaps=!o,b._lodGenerationScale=d,b._lodGenerationOffset=f,b._useSRGBBuffer=!!g&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!o),b!==p&&(b.label=e.substring(0,60)),this._doNotHandleContextLost||(b._extension=u,b._files=r,b._buffer=v);var S=e;this._transformTextureUrl&&!p&&(e=this._transformTextureUrl(e));var T=e.split(\"?\")[0],E=T.lastIndexOf(\".\"),x=u||(E>-1?T.substring(E).toLowerCase():\"\"),P=(0,l.gT)(x),C=function(n,l){e===S?s&&n&&s(n.status+\" \"+n.statusText,l):(i.V.Warn(\"Failed to load \".concat(e,\", falling back to the \").concat(S)),y.createCubeTextureBase(S,t,r,!!o,a,s,c,u,h,d,f,b,_,m,g,v))};if(P)P.then((function(n){var o=function(e){_&&_(b,e),n.loadCubeData(e,b,h,a,s)};v?o(v):r&&6===r.length?n.supportCascades?y._cascadeLoadFiles(t,(function(e){return o(e.map((function(e){return new Uint8Array(e)})))}),r,s):s?s(\"Textures type does not support cascades.\"):i.V.Warn(\"Texture loader does not support cascades.\"):y._loadFile(e,(function(e){return o(new Uint8Array(e))}),void 0,void 0,!0,C)}));else{if(!r||0===r.length)throw new Error(\"Cannot load cubemap because files were not defined, or the correct loader was not found.\");this._cascadeLoadImgs(t,b,(function(e,t){m&&m(e,t)}),r,s)}return this._internalTexturesCache.push(b),b}},20833:(e,t,r)=>{r(82673).$.prototype.createDepthStencilTexture=function(e,t,r){if(t.isCube){var n=e.width||e;return this._createDepthStencilCubeTexture(n,t)}return this._createDepthStencilTexture(e,t,r)}},71974:(e,t,r)=>{var n=r(78322),i=r(96352),o=r(19133),a=r(7164),s=r(81152),l=r(87074);i.w.prototype._createDepthStencilCubeTexture=function(e,t){var r=new o.h(this,12);if(r.isCube=!0,1===this.webGLVersion)return a.V.Error(\"Depth cube texture is not supported by WebGL 1.\"),r;var i=(0,n.Cl)({bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1},t),s=this._gl;this._bindTextureDirectly(s.TEXTURE_CUBE_MAP,r,!0),this._setupDepthStencilTexture(r,e,i.bilinearFiltering,i.comparisonFunction);for(var l=0;l<6;l++)i.generateStencil?s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,s.DEPTH24_STENCIL8,e,e,0,s.DEPTH_STENCIL,s.UNSIGNED_INT_24_8,null):s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,s.DEPTH_COMPONENT24,e,e,0,s.DEPTH_COMPONENT,s.UNSIGNED_INT,null);return this._bindTextureDirectly(s.TEXTURE_CUBE_MAP,null),this._internalTexturesCache.push(r),r},i.w.prototype._setCubeMapTextureParams=function(e,t,r){var n=this._gl;n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),e.samplingMode=t?s.Y.TEXTURE_TRILINEAR_SAMPLINGMODE:s.Y.TEXTURE_LINEAR_LINEAR,t&&this.getCaps().textureMaxLevel&&void 0!==r&&r>0&&(n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_LEVEL,r),e._maxLodLevel=r),this._bindTextureDirectly(n.TEXTURE_CUBE_MAP,null)},i.w.prototype.createCubeTexture=function(e,t,r,n,i,o,s,c,u,h,d,f,p,_,m){var g=this;void 0===i&&(i=null),void 0===o&&(o=null),void 0===c&&(c=null),void 0===u&&(u=!1),void 0===h&&(h=0),void 0===d&&(d=0),void 0===f&&(f=null),void 0===_&&(_=!1),void 0===m&&(m=null);var v=this._gl;return this.createCubeTextureBase(e,t,r,!!n,i,o,s,c,u,h,d,f,(function(e){return g._bindTextureDirectly(v.TEXTURE_CUBE_MAP,e,!0)}),(function(e,t){var r=g.needPOTTextures?(0,l.R)(t[0].width,g._caps.maxCubemapTextureSize):t[0].width,o=r,c=[v.TEXTURE_CUBE_MAP_POSITIVE_X,v.TEXTURE_CUBE_MAP_POSITIVE_Y,v.TEXTURE_CUBE_MAP_POSITIVE_Z,v.TEXTURE_CUBE_MAP_NEGATIVE_X,v.TEXTURE_CUBE_MAP_NEGATIVE_Y,v.TEXTURE_CUBE_MAP_NEGATIVE_Z];g._bindTextureDirectly(v.TEXTURE_CUBE_MAP,e,!0),g._unpackFlipY(!1);var u=s?g._getInternalFormat(s,e._useSRGBBuffer):e._useSRGBBuffer?g._glSRGBExtensionValues.SRGB8_ALPHA8:v.RGBA,h=s?g._getInternalFormat(s):v.RGBA;e._useSRGBBuffer&&1===g.webGLVersion&&(h=u);for(var d=0;d<c.length;d++)if(t[d].width!==r||t[d].height!==o){if(g._prepareWorkingCanvas(),!g._workingCanvas||!g._workingContext)return void a.V.Warn(\"Cannot create canvas to resize texture.\");g._workingCanvas.width=r,g._workingCanvas.height=o,g._workingContext.drawImage(t[d],0,0,t[d].width,t[d].height,0,0,r,o),v.texImage2D(c[d],0,u,h,v.UNSIGNED_BYTE,g._workingCanvas)}else v.texImage2D(c[d],0,u,h,v.UNSIGNED_BYTE,t[d]);n||v.generateMipmap(v.TEXTURE_CUBE_MAP),g._setCubeMapTextureParams(e,!n),e.width=r,e.height=o,e.isReady=!0,s&&(e.format=s),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear(),i&&i()}),!!_,m)},i.w.prototype.generateMipMapsForCubemap=function(e,t){if(void 0===t&&(t=!0),e.generateMipMaps){var r=this._gl;this._bindTextureDirectly(r.TEXTURE_CUBE_MAP,e,!0),r.generateMipmap(r.TEXTURE_CUBE_MAP),t&&this._bindTextureDirectly(r.TEXTURE_CUBE_MAP,null)}}},82345:(e,t,r)=>{r.d(t,{k:()=>o});var n=r(96352),i=r(81152);function o(e,t,r,n){switch(void 0===r&&(r=!1),e){case i.Y.TEXTURETYPE_BYTE:var o=(ArrayBuffer,new Int8Array(t));return n&&o.set(new Int8Array(n)),o;case i.Y.TEXTURETYPE_UNSIGNED_BYTE:var a=(ArrayBuffer,new Uint8Array(t));return n&&a.set(new Uint8Array(n)),a;case i.Y.TEXTURETYPE_SHORT:var s=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return n&&s.set(new Int16Array(n)),s;case i.Y.TEXTURETYPE_UNSIGNED_SHORT:case i.Y.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:case i.Y.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:case i.Y.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:case i.Y.TEXTURETYPE_HALF_FLOAT:var l=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return n&&l.set(new Uint16Array(n)),l;case i.Y.TEXTURETYPE_INT:var c=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return n&&c.set(new Int32Array(n)),c;case i.Y.TEXTURETYPE_UNSIGNED_INTEGER:case i.Y.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:case i.Y.TEXTURETYPE_UNSIGNED_INT_24_8:case i.Y.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:case i.Y.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:case i.Y.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV:var u=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return n&&u.set(new Uint32Array(n)),u;case i.Y.TEXTURETYPE_FLOAT:var h=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return n&&h.set(new Float32Array(n)),h}var d=(ArrayBuffer,new Uint8Array(t));return n&&d.set(new Uint8Array(n)),d}n.w.prototype._readTexturePixelsSync=function(e,t,r,n,i,a,s,l,c,u){var h,d;void 0===n&&(n=-1),void 0===i&&(i=0),void 0===a&&(a=null),void 0===s&&(s=!0),void 0===l&&(l=!1),void 0===c&&(c=0),void 0===u&&(u=0);var f=this._gl;if(!f)throw new Error(\"Engine does not have gl rendering context.\");if(!this._dummyFramebuffer){var p=f.createFramebuffer();if(!p)throw new Error(\"Unable to create dummy framebuffer\");this._dummyFramebuffer=p}f.bindFramebuffer(f.FRAMEBUFFER,this._dummyFramebuffer),n>-1?f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+n,null===(h=e._hardwareTexture)||void 0===h?void 0:h.underlyingResource,i):f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,null===(d=e._hardwareTexture)||void 0===d?void 0:d.underlyingResource,i);var _=void 0!==e.type?this._getWebGLTextureType(e.type):f.UNSIGNED_BYTE;return l?a||(a=o(e.type,4*t*r)):_===f.UNSIGNED_BYTE?(a||(a=new Uint8Array(4*t*r)),_=f.UNSIGNED_BYTE):(a||(a=new Float32Array(4*t*r)),_=f.FLOAT),s&&this.flushFramebuffer(),f.readPixels(c,u,t,r,f.RGBA,_,a),f.bindFramebuffer(f.FRAMEBUFFER,this._currentFramebuffer),a},n.w.prototype._readTexturePixels=function(e,t,r,n,i,o,a,s,l,c){return void 0===n&&(n=-1),void 0===i&&(i=0),void 0===o&&(o=null),void 0===a&&(a=!0),void 0===s&&(s=!1),void 0===l&&(l=0),void 0===c&&(c=0),Promise.resolve(this._readTexturePixelsSync(e,t,r,n,i,o,a,s,l,c))}},71073:(e,t,r)=>{var n=r(78322),i=r(19133),o=r(7164),a=r(96352),s=r(81152),l=function(e){function t(t,r,n,i,o){var a=e.call(this,t,r,n,i)||this;return a._framebuffer=null,a._depthStencilBuffer=null,a._MSAAFramebuffer=null,a._colorTextureArray=null,a._depthStencilTextureArray=null,a._disposeOnlyFramebuffers=!1,a._currentLOD=0,a._context=o,a}return(0,n.C6)(t,e),t.prototype._cloneRenderTargetWrapper=function(){var t=null;return this._colorTextureArray&&this._depthStencilTextureArray?(t=this._engine.createMultiviewRenderTargetTexture(this.width,this.height)).texture.isReady=!0:t=e.prototype._cloneRenderTargetWrapper.call(this),t},t.prototype._swapRenderTargetWrapper=function(t){e.prototype._swapRenderTargetWrapper.call(this,t),t._framebuffer=this._framebuffer,t._depthStencilBuffer=this._depthStencilBuffer,t._MSAAFramebuffer=this._MSAAFramebuffer,t._colorTextureArray=this._colorTextureArray,t._depthStencilTextureArray=this._depthStencilTextureArray,this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null},t.prototype.createDepthStencilTexture=function(t,r,n,i,o,a){if(void 0===t&&(t=0),void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===i&&(i=1),void 0===o&&(o=s.Y.TEXTUREFORMAT_DEPTH32_FLOAT),this._depthStencilBuffer){var l=this._engine,c=l._currentFramebuffer,u=this._context;l._bindUnboundFramebuffer(this._framebuffer),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,null),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,null),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.STENCIL_ATTACHMENT,u.RENDERBUFFER,null),l._bindUnboundFramebuffer(c),u.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null}return e.prototype.createDepthStencilTexture.call(this,t,r,n,i,o,a)},t.prototype.shareDepth=function(t){e.prototype.shareDepth.call(this,t);var r=this._context,n=this._depthStencilBuffer,i=t._MSAAFramebuffer||t._framebuffer,o=this._engine;t._depthStencilBuffer&&t._depthStencilBuffer!==n&&r.deleteRenderbuffer(t._depthStencilBuffer),t._depthStencilBuffer=n;var a=t._generateStencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;o._bindUnboundFramebuffer(i),r.framebufferRenderbuffer(r.FRAMEBUFFER,a,r.RENDERBUFFER,n),o._bindUnboundFramebuffer(null)},t.prototype._bindTextureRenderTarget=function(e,t,r,n){var i,o,a,s;if(void 0===t&&(t=0),void 0===n&&(n=0),e._hardwareTexture){var l=this._framebuffer,c=this._engine,u=c._currentFramebuffer;if(c._bindUnboundFramebuffer(l),c.webGLVersion>1){var h=(d=this._context)[\"COLOR_ATTACHMENT\"+t];e.is2DArray||e.is3D?(r=null!==(o=null!=r?r:null===(i=this.layerIndices)||void 0===i?void 0:i[t])&&void 0!==o?o:0,d.framebufferTextureLayer(d.FRAMEBUFFER,h,e._hardwareTexture.underlyingResource,n,r)):e.isCube?(r=null!==(s=null!=r?r:null===(a=this.faceIndices)||void 0===a?void 0:a[t])&&void 0!==s?s:0,d.framebufferTexture2D(d.FRAMEBUFFER,h,d.TEXTURE_CUBE_MAP_POSITIVE_X+r,e._hardwareTexture.underlyingResource,n)):d.framebufferTexture2D(d.FRAMEBUFFER,h,d.TEXTURE_2D,e._hardwareTexture.underlyingResource,n)}else{h=(d=this._context)[\"COLOR_ATTACHMENT\"+t+\"_WEBGL\"];var d,f=void 0!==r?d.TEXTURE_CUBE_MAP_POSITIVE_X+r:d.TEXTURE_2D;d.framebufferTexture2D(d.FRAMEBUFFER,h,f,e._hardwareTexture.underlyingResource,n)}c._bindUnboundFramebuffer(u)}},t.prototype.setTexture=function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=!0),e.prototype.setTexture.call(this,t,r,n),this._bindTextureRenderTarget(t,r)},t.prototype.setLayerAndFaceIndices=function(t,r){var n,i;if(e.prototype.setLayerAndFaceIndices.call(this,t,r),this.textures&&this.layerIndices&&this.faceIndices)for(var o=null!==(i=null===(n=this._attachments)||void 0===n?void 0:n.length)&&void 0!==i?i:this.textures.length,a=0;a<o;a++){var s=this.textures[a];s&&(s.is2DArray||s.is3D?this._bindTextureRenderTarget(s,a,this.layerIndices[a]):s.isCube?this._bindTextureRenderTarget(s,a,this.faceIndices[a]):this._bindTextureRenderTarget(s,a))}},t.prototype.setLayerAndFaceIndex=function(t,r,n){if(void 0===t&&(t=0),e.prototype.setLayerAndFaceIndex.call(this,t,r,n),this.textures&&this.layerIndices&&this.faceIndices){var i=this.textures[t];i.is2DArray||i.is3D?this._bindTextureRenderTarget(this.textures[t],t,this.layerIndices[t]):i.isCube&&this._bindTextureRenderTarget(this.textures[t],t,this.faceIndices[t])}},t.prototype.dispose=function(t){void 0===t&&(t=this._disposeOnlyFramebuffers);var r=this._context;t||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null)),this._framebuffer&&(r.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._depthStencilBuffer&&(r.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null),this._MSAAFramebuffer&&(r.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null),e.prototype.dispose.call(this,t)},t}(r(96925).v);r(20833),a.w.prototype._createHardwareRenderTargetWrapper=function(e,t,r){var n=new l(e,t,r,this,this._gl);return this._renderTargetWrapperCache.push(n),n},a.w.prototype.createRenderTargetTexture=function(e,t){var r,n,i=this._createHardwareRenderTargetWrapper(!1,!1,e),o=!0,a=!1,s=!1,l=void 0,c=1,u=void 0;void 0!==t&&\"object\"==typeof t&&(o=null===(r=t.generateDepthBuffer)||void 0===r||r,a=!!t.generateStencilBuffer,s=!!t.noColorAttachment,l=t.colorAttachment,c=null!==(n=t.samples)&&void 0!==n?n:1,u=t.label);var h=l||(s?null:this._createInternalTexture(e,t,!0,5)),d=e.width||e,f=e.height||e,p=this._currentFramebuffer,_=this._gl,m=_.createFramebuffer();return this._bindUnboundFramebuffer(m),i._depthStencilBuffer=this._setupFramebufferDepthAttachments(a,o,d,f),!h||h.is2DArray||h.is3D||_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,h._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(p),i.label=null!=u?u:\"RenderTargetWrapper\",i._framebuffer=m,i._generateDepthBuffer=o,i._generateStencilBuffer=a,i.setTextures(h),this.updateRenderTargetTextureSampleCount(i,c),i},a.w.prototype._createDepthStencilTexture=function(e,t,r){var a,l=this._gl,c=e.layers||0,u=e.depth||0,h=l.TEXTURE_2D;0!==c?h=l.TEXTURE_2D_ARRAY:0!==u&&(h=l.TEXTURE_3D);var d=new i.h(this,12);if(d.label=t.label,!this._caps.depthTextureExtension)return o.V.Error(\"Depth texture is not supported by your browser or hardware.\"),d;var f=(0,n.Cl)({bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1},t);if(this._bindTextureDirectly(h,d,!0),this._setupDepthStencilTexture(d,e,0!==f.comparisonFunction&&f.bilinearFiltering,f.comparisonFunction,f.samples),void 0!==f.depthTextureFormat){if(f.depthTextureFormat!==s.Y.TEXTUREFORMAT_DEPTH16&&f.depthTextureFormat!==s.Y.TEXTUREFORMAT_DEPTH24&&f.depthTextureFormat!==s.Y.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8&&f.depthTextureFormat!==s.Y.TEXTUREFORMAT_DEPTH24_STENCIL8&&f.depthTextureFormat!==s.Y.TEXTUREFORMAT_DEPTH32_FLOAT&&f.depthTextureFormat!==s.Y.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8)return o.V.Error(\"Depth texture \".concat(f.depthTextureFormat,\" format is not supported.\")),d;d.format=f.depthTextureFormat}else d.format=f.generateStencil?s.Y.TEXTUREFORMAT_DEPTH24_STENCIL8:s.Y.TEXTUREFORMAT_DEPTH24;var p=d.format===s.Y.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8||d.format===s.Y.TEXTUREFORMAT_DEPTH24_STENCIL8||d.format===s.Y.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8,_=l.UNSIGNED_INT;d.format===s.Y.TEXTUREFORMAT_DEPTH16?_=l.UNSIGNED_SHORT:d.format===s.Y.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8||d.format===s.Y.TEXTUREFORMAT_DEPTH24_STENCIL8?_=l.UNSIGNED_INT_24_8:d.format===s.Y.TEXTUREFORMAT_DEPTH32_FLOAT?_=l.FLOAT:d.format===s.Y.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8&&(_=l.FLOAT_32_UNSIGNED_INT_24_8_REV);var m=p?l.DEPTH_STENCIL:l.DEPTH_COMPONENT,g=this._getInternalFormatFromDepthTextureFormat(d.format,!0,p);return d.is2DArray?l.texImage3D(h,0,g,d.width,d.height,c,0,m,_,null):d.is3D?l.texImage3D(h,0,g,d.width,d.height,u,0,m,_,null):l.texImage2D(h,0,g,d.width,d.height,0,m,_,null),this._bindTextureDirectly(h,null),this._internalTexturesCache.push(d),r._depthStencilBuffer&&(l.deleteRenderbuffer(r._depthStencilBuffer),r._depthStencilBuffer=null),this._bindUnboundFramebuffer(null!==(a=r._MSAAFramebuffer)&&void 0!==a?a:r._framebuffer),r._generateStencilBuffer=p,r._depthStencilTextureWithStencil=p,r._depthStencilBuffer=this._setupFramebufferDepthAttachments(r._generateStencilBuffer,r._generateDepthBuffer,r.width,r.height,r.samples,d.format),this._bindUnboundFramebuffer(null),d},a.w.prototype.updateRenderTargetTextureSampleCount=function(e,t){var r,n;if(this.webGLVersion<2||!e)return 1;if(e.samples===t)return t;var i=this._gl;t=Math.min(t,this.getCaps().maxMSAASamples),e._depthStencilBuffer&&(i.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=null),e._MSAAFramebuffer&&(i.deleteFramebuffer(e._MSAAFramebuffer),e._MSAAFramebuffer=null);var o=null===(r=e.texture)||void 0===r?void 0:r._hardwareTexture;null==o||o.releaseMSAARenderBuffers();var a=i.createFramebuffer();if(!a)throw new Error(\"Unable to create multi sampled framebuffer\");if(e._MSAAFramebuffer=a,e.texture&&t>1&&\"function\"==typeof i.renderbufferStorageMultisample){this._bindUnboundFramebuffer(e._MSAAFramebuffer);var s=this._createRenderBuffer(e.texture.width,e.texture.height,t,-1,this._getRGBABufferInternalSizedFormat(e.texture.type,e.texture.format,e.texture._useSRGBBuffer),i.COLOR_ATTACHMENT0,!1);if(!s)throw new Error(\"Unable to create multi sampled framebuffer\");null==o||o.addMSAARenderBuffer(s)}this._bindUnboundFramebuffer(null!==(n=e._MSAAFramebuffer)&&void 0!==n?n:e._framebuffer),e.texture&&(e.texture.samples=t),e._samples=t;var l=e._depthStencilTexture?e._depthStencilTexture.format:void 0;return e._depthStencilBuffer=this._setupFramebufferDepthAttachments(e._generateStencilBuffer,e._generateDepthBuffer,e.width,e.height,t,l),this._bindUnboundFramebuffer(null),t},a.w.prototype._setupDepthStencilTexture=function(e,t,r,n,i){void 0===i&&(i=1);var o=t.width||t,a=t.height||t,l=t.layers||0,c=t.depth||0;e.baseWidth=o,e.baseHeight=a,e.width=o,e.height=a,e.is2DArray=l>0,e.depth=l||c,e.isReady=!0,e.samples=i,e.generateMipMaps=!1,e.samplingMode=r?s.Y.TEXTURE_BILINEAR_SAMPLINGMODE:s.Y.TEXTURE_NEAREST_SAMPLINGMODE,e.type=s.Y.TEXTURETYPE_UNSIGNED_INT,e._comparisonFunction=n;var u=this._gl,h=this._getTextureTarget(e),d=this._getSamplingParameters(e.samplingMode,!1);u.texParameteri(h,u.TEXTURE_MAG_FILTER,d.mag),u.texParameteri(h,u.TEXTURE_MIN_FILTER,d.min),u.texParameteri(h,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(h,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),this.webGLVersion>1&&(0===n?(u.texParameteri(h,u.TEXTURE_COMPARE_FUNC,s.Y.LEQUAL),u.texParameteri(h,u.TEXTURE_COMPARE_MODE,u.NONE)):(u.texParameteri(h,u.TEXTURE_COMPARE_FUNC,n),u.texParameteri(h,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE)))}},8864:(e,t,r)=>{var n=r(78322),i=r(19133),o=r(7164),a=r(81152);r(96352).w.prototype.createRenderTargetCubeTexture=function(e,t){var r=this._createHardwareRenderTargetWrapper(!1,!0,e),s=(0,n.Cl)({generateMipMaps:!0,generateDepthBuffer:!0,generateStencilBuffer:!1,type:a.Y.TEXTURETYPE_UNSIGNED_INT,samplingMode:a.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,format:a.Y.TEXTUREFORMAT_RGBA},t);s.generateStencilBuffer=s.generateDepthBuffer&&s.generateStencilBuffer,(s.type!==a.Y.TEXTURETYPE_FLOAT||this._caps.textureFloatLinearFiltering)&&(s.type!==a.Y.TEXTURETYPE_HALF_FLOAT||this._caps.textureHalfFloatLinearFiltering)||(s.samplingMode=a.Y.TEXTURE_NEAREST_SAMPLINGMODE);var l=this._gl,c=new i.h(this,5);this._bindTextureDirectly(l.TEXTURE_CUBE_MAP,c,!0);var u=this._getSamplingParameters(s.samplingMode,s.generateMipMaps);s.type!==a.Y.TEXTURETYPE_FLOAT||this._caps.textureFloat||(s.type=a.Y.TEXTURETYPE_UNSIGNED_INT,o.V.Warn(\"Float textures are not supported. Cube render target forced to TEXTURETYPE_UNESIGNED_BYTE type\")),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,u.mag),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,u.min),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);for(var h=0;h<6;h++)l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,this._getRGBABufferInternalSizedFormat(s.type,s.format),e,e,0,this._getInternalFormat(s.format),this._getWebGLTextureType(s.type),null);var d=l.createFramebuffer();return this._bindUnboundFramebuffer(d),r._depthStencilBuffer=this._setupFramebufferDepthAttachments(s.generateStencilBuffer,s.generateDepthBuffer,e,e),s.generateMipMaps&&l.generateMipmap(l.TEXTURE_CUBE_MAP),this._bindTextureDirectly(l.TEXTURE_CUBE_MAP,null),this._bindUnboundFramebuffer(null),r._framebuffer=d,r._generateDepthBuffer=s.generateDepthBuffer,r._generateStencilBuffer=s.generateStencilBuffer,c.width=e,c.height=e,c.isReady=!0,c.isCube=!0,c.samples=1,c.generateMipMaps=s.generateMipMaps,c.samplingMode=s.samplingMode,c.type=s.type,c.format=s.format,this._internalTexturesCache.push(c),r.setTextures(c),r}},64838:(e,t,r)=>{r(96352).w.prototype.setDepthStencilTexture=function(e,t,r,n){void 0!==e&&(t&&(this._boundUniforms[e]=t),r&&r.depthStencilTexture?this._setTexture(e,r,!1,!0,n):this._setTexture(e,null,void 0,void 0,n))}},59012:(e,t,r)=>{var n=r(96352),i=r(26218);n.w.prototype.createUniformBuffer=function(e,t){var r=this._gl.createBuffer();if(!r)throw new Error(\"Unable to create uniform buffer\");var n=new i.A(r);return this.bindUniformBuffer(n),e instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,e,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),n.references=1,n},n.w.prototype.createDynamicUniformBuffer=function(e,t){var r=this._gl.createBuffer();if(!r)throw new Error(\"Unable to create dynamic uniform buffer\");var n=new i.A(r);return this.bindUniformBuffer(n),e instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,e,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(e),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),n.references=1,n},n.w.prototype.updateUniformBuffer=function(e,t,r,n){this.bindUniformBuffer(e),void 0===r&&(r=0),void 0===n?t instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,r,t):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,r,new Float32Array(t)):t instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,t.subarray(r,r+n)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(t).subarray(r,r+n)),this.bindUniformBuffer(null)},n.w.prototype.bindUniformBuffer=function(e){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,e?e.underlyingResource:null)},n.w.prototype.bindUniformBufferBase=function(e,t,r){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,t,e?e.underlyingResource:null)},n.w.prototype.bindUniformBlock=function(e,t,r){var n=e.program,i=this._gl.getUniformBlockIndex(n,t);4294967295!==i&&this._gl.uniformBlockBinding(n,i,r)}},35930:(e,t,r)=>{r.d(t,{nO:()=>C,pB:()=>E,jC:()=>P,M0:()=>x,Iq:()=>N,J:()=>L});var n=function(){function e(){this.children=[]}return e.prototype.isValid=function(e){return!0},e.prototype.process=function(e,t){var r,n,i,o,a,s,l,c=\"\";if(this.line){var u=this.line,h=t.processor;if(h){h.lineProcessor&&(u=h.lineProcessor(u,t.isFragment,t.processingContext));var d=null!==(n=null===(r=t.processor)||void 0===r?void 0:r.attributeKeywordName)&&void 0!==n?n:\"attribute\",f=t.isFragment&&(null===(i=t.processor)||void 0===i?void 0:i.varyingFragmentKeywordName)?null===(o=t.processor)||void 0===o?void 0:o.varyingFragmentKeywordName:!t.isFragment&&(null===(a=t.processor)||void 0===a?void 0:a.varyingVertexKeywordName)?null===(s=t.processor)||void 0===s?void 0:s.varyingVertexKeywordName:\"varying\";!t.isFragment&&h.attributeProcessor&&this.line.startsWith(d)?u=h.attributeProcessor(this.line,e,t.processingContext):h.varyingProcessor&&((null===(l=h.varyingCheck)||void 0===l?void 0:l.call(h,this.line,t.isFragment))||!h.varyingCheck&&this.line.startsWith(f))?u=h.varyingProcessor(this.line,t.isFragment,e,t.processingContext):h.uniformProcessor&&h.uniformRegexp&&h.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(u=h.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):h.uniformBufferProcessor&&h.uniformBufferRegexp&&h.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(u=h.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):h.textureProcessor&&h.textureRegexp&&h.textureRegexp.test(this.line)?u=h.textureProcessor(this.line,t.isFragment,e,t.processingContext):(h.uniformProcessor||h.uniformBufferProcessor)&&this.line.startsWith(\"uniform\")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\\s+(?:(?:highp)?|(?:lowp)?)\\s*(\\S+)\\s+(\\S+)\\s*;/.test(this.line)?h.uniformProcessor&&(u=h.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):h.uniformBufferProcessor&&(u=h.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf(\"}\")&&(t.lookForClosingBracketForUniformBuffer=!1,h.endOfUniformBufferProcessor&&(u=h.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}c+=u+\"\\n\"}return this.children.forEach((function(r){c+=r.process(e,t)})),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||\"true\"),c},e}(),i=function(){function e(){this._lines=[]}return Object.defineProperty(e.prototype,\"currentLine\",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"canRead\",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"lines\",{set:function(e){this._lines.length=0;for(var t=0,r=e;t<r.length;t++){var n=r[t];if(n&&\"\\r\"!==n)if(\"#\"!==n[0]){var i=n.trim();if(i)if(i.startsWith(\"//\"))this._lines.push(n);else{var o=i.indexOf(\";\");if(-1===o)this._lines.push(i);else if(o===i.length-1)i.length>1&&this._lines.push(i);else for(var a=n.split(\";\"),s=0;s<a.length;s++){var l=a[s];l&&(l=l.trim())&&this._lines.push(l+(s!==a.length-1?\";\":\"\"))}}}else this._lines.push(n)}},enumerable:!1,configurable:!0}),e}(),o=r(78322),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.C6)(t,e),t.prototype.process=function(e,t){for(var r=0;r<this.children.length;r++){var n=this.children[r];if(n.isValid(e))return n.process(e,t)}return\"\"},t}(n),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.C6)(t,e),t.prototype.isValid=function(e){return this.testExpression.isTrue(e)},t}(n),l=function(){function e(){}return e.prototype.isTrue=function(e){return!0},e.postfixToInfix=function(t){for(var r=[],n=0,i=t;n<i.length;n++){var o=i[n];if(void 0===e._OperatorPriority[o])r.push(o);else{var a=r[r.length-1],s=r[r.length-2];r.length-=2,r.push(\"(\".concat(s).concat(o).concat(a,\")\"))}}return r[r.length-1]},e.infixToPostfix=function(t){var r=e._InfixToPostfixCache.get(t);if(r)return r.accessTime=Date.now(),r.result;if(!(t.includes(\"&&\")||t.includes(\"||\")||t.includes(\")\")||t.includes(\"(\")))return[t];for(var n=[],i=-1,o=function(){\"\"!==(u=u.trim())&&(n.push(u),u=\"\")},a=function(t){i<e._Stack.length-1&&(e._Stack[++i]=t)},s=function(){return e._Stack[i]},l=function(){return-1===i?\"!!INVALID EXPRESSION!!\":e._Stack[i--]},c=0,u=\"\";c<t.length;){var h=t.charAt(c),d=c<t.length-1?t.substring(c,2+c):\"\";if(\"(\"===h)u=\"\",a(h);else if(\")\"===h){for(o();-1!==i&&\"(\"!==s();)n.push(l());l()}else if(e._OperatorPriority[d]>1){for(o();-1!==i&&e._OperatorPriority[s()]>=e._OperatorPriority[d];)n.push(l());a(d),c++}else u+=h;c++}for(o();-1!==i;)\"(\"===s()?l():n.push(l());return e._InfixToPostfixCache.size>=e.InfixToPostfixCacheLimitSize&&e.ClearCache(),e._InfixToPostfixCache.set(t,{result:n,accessTime:Date.now()}),n},e.ClearCache=function(){for(var t=Array.from(e._InfixToPostfixCache.entries()).sort((function(e,t){return e[1].accessTime-t[1].accessTime})),r=0;r<e.InfixToPostfixCacheCleanupSize;r++)e._InfixToPostfixCache.delete(t[r][0])},e.InfixToPostfixCacheLimitSize=5e4,e.InfixToPostfixCacheCleanupSize=25e3,e._InfixToPostfixCache=new Map,e._OperatorPriority={\")\":0,\"(\":1,\"||\":2,\"&&\":3},e._Stack=[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],e}(),c=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this)||this;return n.define=t,n.not=r,n}return(0,o.C6)(t,e),t.prototype.isTrue=function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t},t}(l),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.C6)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)},t}(l),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.C6)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)},t}(l),d=function(e){function t(t,r,n){var i=e.call(this)||this;return i.define=t,i.operand=r,i.testValue=n,i}return(0,o.C6)(t,e),t.prototype.isTrue=function(e){var t=e[this.define];void 0===t&&(t=this.define);var r=!1,n=parseInt(t),i=parseInt(this.testValue);switch(this.operand){case\">\":r=n>i;break;case\"<\":r=n<i;break;case\"<=\":r=n<=i;break;case\">=\":r=n>=i;break;case\"==\":r=n===i;break;case\"!=\":r=n!==i}return r},t}(l),f=r(41190),p=r(24894),_=/defined\\s*?\\((.+?)\\)/g,m=/defined\\s*?\\[(.+?)\\]/g,g=/#include\\s?<(.+)>(\\((.*)\\))*(\\[(.*)\\])*/g,v=/__decl__/,y=/light\\{X\\}.(\\w*)/g,b=/\\{X\\}/g,S=[],T=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function E(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}function x(e,t,r,n){var i;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),N(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?\"fragment\":\"vertex\",e,t.defines));var i=function(e,t,r){var n=function(e,t){var r;if(null===(r=t.processor)||void 0===r?void 0:r.noPrecision)return e;var n=t.shouldUseHighPrecisionShader;return-1===e.indexOf(\"precision highp float\")?e=n?\"precision highp float;\\n\"+e:\"precision mediump float;\\n\"+e:n||(e=e.replace(\"precision highp float\",\"precision mediump float\")),e}(e,t);if(!t.processor)return n;if(0===t.processor.shaderLanguage&&-1!==n.indexOf(\"#version 3\")&&(n=n.replace(\"#version 300 es\",\"\"),!t.processor.parseGLES3))return n;var i=t.defines,o=D(t,r);return t.processor.preProcessor&&(n=t.processor.preProcessor(n,i,o,t.isFragment,t.processingContext)),n=O(n,o,t),t.processor.postProcessor&&(n=t.processor.postProcessor(n,i,t.isFragment,t.processingContext,r?{drawBuffersExtensionDisabled:!r.getCaps().drawBuffersExtension}:{})),(null==r?void 0:r._features.needShaderCodeInlining)&&(n=r.inlineShaderCode(n)),n}(e,t,n);r(i,e)}))}function P(e,t,r,n){var i;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),N(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?\"fragment\":\"vertex\",e,t.defines));var i=function(e,t,r){var n,i,o=e,a=t.defines,s=D(t,r);return(null===(n=t.processor)||void 0===n?void 0:n.preProcessor)&&(o=t.processor.preProcessor(o,a,s,t.isFragment,t.processingContext)),o=O(o,s,t),(null===(i=t.processor)||void 0===i?void 0:i.postProcessor)&&(o=t.processor.postProcessor(o,a,t.isFragment,t.processingContext,r?{drawBuffersExtensionDisabled:!r.getCaps().drawBuffersExtension}:{})),r._features.needShaderCodeInlining&&(o=r.inlineShaderCode(o)),o}(e,t,n);r(i,e)}))}function C(e,t,r){return r.processor&&r.processor.finalizeShaders?r.processor.finalizeShaders(e,t,r.processingContext):{vertexCode:e,fragmentCode:t}}function A(e){var t=/defined\\((.+)\\)/.exec(e);if(t&&t.length)return new c(t[1].trim(),\"!\"===e[0]);for(var r=\"\",n=0,i=0,o=[\"==\",\"!=\",\">=\",\"<=\",\"<\",\">\"];i<o.length&&(r=o[i],!((n=e.indexOf(r))>-1));i++);if(-1===n)return new c(e);var a=e.substring(0,n).trim(),s=e.substring(n+r.length).trim();return new d(a,r,s)}function R(e,t){var r=new s,n=e.substring(0,t),i=e.substring(t);return i=i.substring(0,(i.indexOf(\"//\")+1||i.length+1)-1).trim(),r.testExpression=\"#ifdef\"===n?new c(i):\"#ifndef\"===n?new c(i,!0):function(e){e=e.replace(_,\"defined[$1]\");for(var t=[],r=0,n=l.infixToPostfix(e);r<n.length;r++){var i=n[r];if(\"||\"!==i&&\"&&\"!==i)t.push(i);else if(t.length>=2){var o=t[t.length-1],a=t[t.length-2];t.length-=2;var s=\"&&\"==i?new h:new u;\"string\"==typeof o&&(o=o.replace(m,\"defined($1)\")),\"string\"==typeof a&&(a=a.replace(m,\"defined($1)\")),s.leftOperand=\"string\"==typeof a?A(a):a,s.rightOperand=\"string\"==typeof o?A(o):o,t.push(s)}}var c=t[t.length-1];return\"string\"==typeof c&&(c=c.replace(m,\"defined($1)\")),\"string\"==typeof c?A(c):c}(i),r}function I(e,t,r){for(var i=e.currentLine;M(e,r);){var o=(i=e.currentLine).substring(0,5).toLowerCase();if(\"#else\"===o){var a=new n;return t.children.push(a),void M(e,a)}if(\"#elif\"===o){var s=R(i,5);t.children.push(s),r=s}}}function M(e,t){for(;e.canRead;){e.lineIndex++;var r=e.currentLine;if(r.indexOf(\"#\")>=0){var i=T.exec(r);if(i&&i.length){switch(i[0]){case\"#ifdef\":var o=new a;t.children.push(o);var s=R(r,6);o.children.push(s),I(e,o,s);break;case\"#else\":case\"#elif\":return!0;case\"#endif\":return!1;case\"#ifndef\":o=new a,t.children.push(o),s=R(r,7),o.children.push(s),I(e,o,s);break;case\"#if\":o=new a,s=R(r,3),t.children.push(o),o.children.push(s),I(e,o,s)}continue}}var l=new n;if(l.line=r,t.children.push(l),\"#\"===r[0]&&\"d\"===r[1]){var c=r.replace(\";\",\"\").split(\" \");l.additionalDefineKey=c[1],3===c.length&&(l.additionalDefineValue=c[2])}}return!1}function O(e,t,r){var o=new n,a=new i;return a.lineIndex=-1,a.lines=e.split(\"\\n\"),M(a,o),o.process(t,r)}function D(e,t){for(var r,n={},i=0,o=e.defines;i<o.length;i++){var a=o[i].replace(\"#define\",\"\").replace(\";\",\"\").trim().split(\" \");n[a[0]]=a.length>1?a[1]:\"\"}return 0===(null===(r=e.processor)||void 0===r?void 0:r.shaderLanguage)&&(n.GL_ES=\"true\"),n.__VERSION__=e.version,n[e.platformName]=\"true\",(0,p.xt)(n,null==t?void 0:t.isNDCHalfZRange,null==t?void 0:t.useReverseDepthBuffer,null==t?void 0:t.useExactSrgbConversions),n}function N(e,t,r){var n;for(S.length=0;null!==(n=g.exec(e));)S.push(n);for(var i=String(e),o=[e],a=!1,s=function(e){var n=e[1];if(-1!==n.indexOf(\"__decl__\")&&(n=n.replace(v,\"\"),t.supportsUniformBuffers&&(n=n.replace(\"Vertex\",\"Ubo\").replace(\"Fragment\",\"Ubo\")),n+=\"Declaration\"),!t.includesShadersStore[n]){var i=t.shadersRepository+\"ShadersInclude/\"+n+\".fx\";return L.loadFile(i,(function(e){t.includesShadersStore[n]=e,N(o.join(\"\"),t,r)})),{value:void 0}}var s=t.includesShadersStore[n];if(e[2])for(var l=e[3].split(\",\"),c=0;c<l.length;c+=2){var u=new RegExp(l[c],\"g\"),h=l[c+1];s=s.replace(u,h)}if(e[4]){var d=e[5];if(-1!==d.indexOf(\"..\")){var f=d.split(\"..\"),p=parseInt(f[0]),_=parseInt(f[1]),m=s.slice(0);s=\"\",isNaN(_)&&(_=t.indexParameters[f[1]]);for(var g=p;g<_;g++)t.supportsUniformBuffers||(m=m.replace(y,(function(e,t){return t+\"{X}\"}))),s+=m.replace(b,g.toString())+\"\\n\"}else t.supportsUniformBuffers||(s=s.replace(y,(function(e,t){return t+\"{X}\"}))),s=s.replace(b,d)}for(var S=[],T=0,E=o;T<E.length;T++){var x=E[T].split(e[0]);for(g=0;g<x.length-1;g++)S.push(x[g]),S.push(s);S.push(x[x.length-1])}o=S,a=a||s.indexOf(\"#include<\")>=0||s.indexOf(\"#include <\")>=0},l=0,c=S;l<c.length;l++){var u=s(c[l]);if(\"object\"==typeof u)return u.value}S.length=0,i=o.join(\"\"),a?N(i.toString(),t,r):r(i)}var L={loadFile:function(e,t,r,n,i,o){throw(0,f.n)(\"FileTools\")}}},24054:(e,t,r)=>{r.d(t,{B:()=>i});var n=/(flat\\s)?\\s*varying\\s*.*/,i=function(){function e(){this.shaderLanguage=0}return e.prototype.attributeProcessor=function(e){return e.replace(\"attribute\",\"in\")},e.prototype.varyingCheck=function(e,t){return n.test(e)},e.prototype.varyingProcessor=function(e,t){return e.replace(\"varying\",t?\"in\":\"out\")},e.prototype.postProcessor=function(e,t,r){var n=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,\"\")).replace(/texture2D\\s*\\(/g,\"texture(\"),r){var i=-1!==e.search(/layout *\\(location *= *0\\) *out/g);e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\\s*\\(/g,\"textureLod(\")).replace(/textureCubeLodEXT\\s*\\(/g,\"textureLod(\")).replace(/textureCube\\s*\\(/g,\"texture(\")).replace(/gl_FragDepthEXT/g,\"gl_FragDepth\")).replace(/gl_FragColor/g,\"glFragColor\")).replace(/gl_FragData/g,\"glFragData\")).replace(/void\\s+?main\\s*\\(/g,(n||i?\"\":\"layout(location = 0) out vec4 glFragColor;\\n\")+\"void main(\")}else if(-1!==t.indexOf(\"#define MULTIVIEW\"))return\"#extension GL_OVR_multiview2 : require\\nlayout (num_views = 2) in;\\n\"+e;return e},e}()},90519:(e,t,r)=>{r.d(t,{d:()=>n});var n=function(){function e(e,t){if(void 0===e&&(e=null),this._MSAARenderBuffers=null,this._context=t,!e&&!(e=t.createTexture()))throw new Error(\"Unable to create webGL texture\");this.set(e)}return Object.defineProperty(e.prototype,\"underlyingResource\",{get:function(){return this._webGLTexture},enumerable:!1,configurable:!0}),e.prototype.setUsage=function(){},e.prototype.set=function(e){this._webGLTexture=e},e.prototype.reset=function(){this._webGLTexture=null,this._MSAARenderBuffers=null},e.prototype.addMSAARenderBuffer=function(e){this._MSAARenderBuffers||(this._MSAARenderBuffers=[]),this._MSAARenderBuffers.push(e)},e.prototype.releaseMSAARenderBuffers=function(){if(this._MSAARenderBuffers){for(var e=0,t=this._MSAARenderBuffers;e<t.length;e++){var r=t[e];this._context.deleteRenderbuffer(r)}this._MSAARenderBuffers=null}},e.prototype.getMSAARenderBuffer=function(e){var t,r;return void 0===e&&(e=0),null!==(r=null===(t=this._MSAARenderBuffers)||void 0===t?void 0:t[e])&&void 0!==r?r:null},e.prototype.release=function(){this.releaseMSAARenderBuffers(),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()},e}()},14737:(e,t,r)=>{r.d(t,{x:()=>n});var n=function(){function e(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}return Object.defineProperty(e.prototype,\"isAsync\",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isReady\",{get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))},enumerable:!1,configurable:!0}),e.prototype._handlesSpectorRebuildCallback=function(e){e&&this.program&&e(this.program)},e.prototype.setEngine=function(e){this.engine=e},e.prototype._fillEffectInformation=function(e,t,r,n,i,o,a,s){var l,c=this.engine;if(c.supportsUniformBuffers)for(var u in t)e.bindUniformBlock(u,t[u]);for(this.engine.getUniforms(this,r).forEach((function(e,t){n[r[t]]=e})),this._uniforms=n,l=0;l<i.length;l++)null==e.getUniform(i[l])&&(i.splice(l,1),l--);i.forEach((function(e,t){o[e]=t}));for(var h=0,d=c.getAttributes(this,a);h<d.length;h++){var f=d[h];s.push(f)}},e.prototype.dispose=function(){this._uniforms={},this._isDisposed=!0},e.prototype._cacheMatrix=function(e,t){var r=this._valueCache[e],n=t.updateFlag;return(void 0===r||r!==n)&&(this._valueCache[e]=n,!0)},e.prototype._cacheFloat2=function(e,t,r){var n=this._valueCache[e];if(!n||2!==n.length)return n=[t,r],this._valueCache[e]=n,!0;var i=!1;return n[0]!==t&&(n[0]=t,i=!0),n[1]!==r&&(n[1]=r,i=!0),i},e.prototype._cacheFloat3=function(e,t,r,n){var i=this._valueCache[e];if(!i||3!==i.length)return i=[t,r,n],this._valueCache[e]=i,!0;var o=!1;return i[0]!==t&&(i[0]=t,o=!0),i[1]!==r&&(i[1]=r,o=!0),i[2]!==n&&(i[2]=n,o=!0),o},e.prototype._cacheFloat4=function(e,t,r,n,i){var o=this._valueCache[e];if(!o||4!==o.length)return o=[t,r,n,i],this._valueCache[e]=o,!0;var a=!1;return o[0]!==t&&(o[0]=t,a=!0),o[1]!==r&&(o[1]=r,a=!0),o[2]!==n&&(o[2]=n,a=!0),o[3]!==i&&(o[3]=i,a=!0),a},e.prototype.setInt=function(e,t){var r=this._valueCache[e];void 0!==r&&r===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setInt2=function(e,t,r){this._cacheFloat2(e,t,r)&&(this.engine.setInt2(this._uniforms[e],t,r)||(this._valueCache[e]=null))},e.prototype.setInt3=function(e,t,r,n){this._cacheFloat3(e,t,r,n)&&(this.engine.setInt3(this._uniforms[e],t,r,n)||(this._valueCache[e]=null))},e.prototype.setInt4=function(e,t,r,n,i){this._cacheFloat4(e,t,r,n,i)&&(this.engine.setInt4(this._uniforms[e],t,r,n,i)||(this._valueCache[e]=null))},e.prototype.setIntArray=function(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)},e.prototype.setIntArray2=function(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)},e.prototype.setIntArray3=function(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)},e.prototype.setIntArray4=function(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)},e.prototype.setUInt=function(e,t){var r=this._valueCache[e];void 0!==r&&r===t||this.engine.setUInt(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setUInt2=function(e,t,r){this._cacheFloat2(e,t,r)&&(this.engine.setUInt2(this._uniforms[e],t,r)||(this._valueCache[e]=null))},e.prototype.setUInt3=function(e,t,r,n){this._cacheFloat3(e,t,r,n)&&(this.engine.setUInt3(this._uniforms[e],t,r,n)||(this._valueCache[e]=null))},e.prototype.setUInt4=function(e,t,r,n,i){this._cacheFloat4(e,t,r,n,i)&&(this.engine.setUInt4(this._uniforms[e],t,r,n,i)||(this._valueCache[e]=null))},e.prototype.setUIntArray=function(e,t){this._valueCache[e]=null,this.engine.setUIntArray(this._uniforms[e],t)},e.prototype.setUIntArray2=function(e,t){this._valueCache[e]=null,this.engine.setUIntArray2(this._uniforms[e],t)},e.prototype.setUIntArray3=function(e,t){this._valueCache[e]=null,this.engine.setUIntArray3(this._uniforms[e],t)},e.prototype.setUIntArray4=function(e,t){this._valueCache[e]=null,this.engine.setUIntArray4(this._uniforms[e],t)},e.prototype.setArray=function(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)},e.prototype.setArray2=function(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)},e.prototype.setArray3=function(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)},e.prototype.setArray4=function(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)},e.prototype.setMatrices=function(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))},e.prototype.setMatrix=function(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.asArray())||(this._valueCache[e]=null))},e.prototype.setMatrix3x3=function(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)},e.prototype.setMatrix2x2=function(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)},e.prototype.setFloat=function(e,t){var r=this._valueCache[e];void 0!==r&&r===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setVector2=function(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))},e.prototype.setFloat2=function(e,t,r){this._cacheFloat2(e,t,r)&&(this.engine.setFloat2(this._uniforms[e],t,r)||(this._valueCache[e]=null))},e.prototype.setVector3=function(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))},e.prototype.setFloat3=function(e,t,r,n){this._cacheFloat3(e,t,r,n)&&(this.engine.setFloat3(this._uniforms[e],t,r,n)||(this._valueCache[e]=null))},e.prototype.setVector4=function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))},e.prototype.setQuaternion=function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))},e.prototype.setFloat4=function(e,t,r,n,i){this._cacheFloat4(e,t,r,n,i)&&(this.engine.setFloat4(this._uniforms[e],t,r,n,i)||(this._valueCache[e]=null))},e.prototype.setColor3=function(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))},e.prototype.setColor4=function(e,t,r){this._cacheFloat4(e,t.r,t.g,t.b,r)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,r)||(this._valueCache[e]=null))},e.prototype.setDirectColor4=function(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))},e.prototype._getVertexShaderCode=function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null},e.prototype._getFragmentShaderCode=function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null},e}()},37411:(e,t,r)=>{r.d(t,{e:()=>i});var n=r(70511),i=function(){function e(){this._gpuTimeInFrameId=-1,this.counter=new n.A}return e.prototype._addDuration=function(e,t){e<this._gpuTimeInFrameId||(this._gpuTimeInFrameId!==e?(this.counter._fetchResult(),this.counter.fetchNewFrame(),this.counter.addCount(t,!1),this._gpuTimeInFrameId=e):this.counter.addCount(t,!1))},e}()},24894:(e,t,r)=>{r.d(t,{W0:()=>a,iL:()=>o,sg:()=>i,xt:()=>s});var n=r(41190),i=(r(5153),{});function o(e,t,r){return void 0===r&&(r=\"\"),r+(t?t+\"\\n\":\"\")+e}function a(e,t,r,o,a,s,l){var c=l||i.loadFile;if(c)return c(e,t,r,o,a,s);throw(0,n.n)(\"FileTools\")}function s(e,t,r,n){if(e)return t?e.IS_NDC_HALF_ZRANGE=\"\":delete e.IS_NDC_HALF_ZRANGE,r?e.USE_REVERSE_DEPTHBUFFER=\"\":delete e.USE_REVERSE_DEPTHBUFFER,void(n?e.USE_EXACT_SRGB_CONVERSIONS=\"\":delete e.USE_EXACT_SRGB_CONVERSIONS);var i=\"\";return t&&(i+=\"#define IS_NDC_HALF_ZRANGE\"),r&&(i&&(i+=\"\\n\"),i+=\"#define USE_REVERSE_DEPTHBUFFER\"),n&&(i&&(i+=\"\\n\"),i+=\"#define USE_EXACT_SRGB_CONVERSIONS\"),i}},82673:(e,t,r)=>{r.d(t,{$:()=>S,r:()=>b});var n=r(78322),i=r(66614),o=r(7164),a=r(74239),s=r(16106),l=r(85258),c=r(48424),u=r(75781),h=r(3911),d=r(69329),f=r(41190),p=r(19133),_=r(5153),m=r(81152),g=r(66377),v=r(24894),y=r(1235);function b(e,t){if((0,_.BA)()){var r=(t||window).requestAnimationFrame;if(\"function\"==typeof r)return r(e)}else if(\"function\"==typeof requestAnimationFrame)return requestAnimationFrame(e);return setTimeout(e,16)}var S=function(){function e(e,t,r){var n,o,a,f,p,v,y,b,S,T,E,x=this;this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new c.N,this._stencilStateComposer=new u.u,this._stencilState=new h.K,this._alphaState=new d.i,this._alphaMode=m.Y.ALPHA_ADD,this._alphaEquation=m.Y.ALPHA_DISABLE,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new g.cP,this.onCanvasFocusObservable=new g.cP,this.onNewSceneAddedObservable=new g.cP,this.onResizeObservable=new g.cP,this.onCanvasPointerOutObservable=new g.cP,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=m.Y.RENDERPASS_MAIN,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new g.cP,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=function(){return x._renderLoop()},this.onBeforeShaderCompilationObservable=new g.cP,this.onAfterShaderCompilationObservable=new g.cP,this.onBeginFrameObservable=new g.cP,this.onEndFrameObservable=new g.cP,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new g.cP,this.onContextRestoredObservable=new g.cP,this._name=\"\",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=[\"main\"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.onDisposeObservable=new g.cP,i.q.Instances.push(this),this.startTime=l.j.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,s.I.SetMatrixPrecision(!!t.useHighPrecisionMatrix),(0,_.XD)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=null!=r&&r,t.antialias=null!=e?e:t.antialias,t.deterministicLockstep=null!==(n=t.deterministicLockstep)&&void 0!==n&&n,t.lockstepMaxSteps=null!==(o=t.lockstepMaxSteps)&&void 0!==o?o:4,t.timeStep=null!==(a=t.timeStep)&&void 0!==a?a:1/60,t.audioEngine=null===(f=t.audioEngine)||void 0===f||f,t.stencil=null===(p=t.stencil)||void 0===p||p,this._audioContext=null!==(y=null===(v=t.audioEngineOptions)||void 0===v?void 0:v.audioContext)&&void 0!==y?y:null,this._audioDestination=null!==(S=null===(b=t.audioEngineOptions)||void 0===b?void 0:b.audioDestination)&&void 0!==S?S:null,this.premultipliedAlpha=null===(T=t.premultipliedAlpha)||void 0===T||T,this._doNotHandleContextLost=!!t.doNotHandleContextLost,this._isStencilEnable=!!t.stencil,this.useExactSrgbConversions=null!==(E=t.useExactSrgbConversions)&&void 0!==E&&E;var P=(0,_.BA)()&&window.devicePixelRatio||1,C=t.limitDeviceRatio||P;r=r||t.adaptToDeviceRatio||!1,this._hardwareScalingLevel=r?1/Math.min(C,P):1,this._lastDevicePixelRatio=P,this._creationOptions=t}return Object.defineProperty(e.prototype,\"frameId\",{get:function(){return this._frameId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isWebGPU\",{get:function(){return this._isWebGPU},enumerable:!1,configurable:!0}),e.prototype._getShaderProcessor=function(e){return this._shaderProcessor},Object.defineProperty(e.prototype,\"shaderPlatformName\",{get:function(){return this._shaderPlatformName},enumerable:!1,configurable:!0}),e.prototype._clearEmptyResources=function(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null},Object.defineProperty(e.prototype,\"useReverseDepthBuffer\",{get:function(){return this._useReverseDepthBuffer},set:function(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?m.Y.GEQUAL:m.Y.LEQUAL)},enumerable:!1,configurable:!0}),e.prototype.setColorWrite=function(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)},e.prototype.getColorWrite=function(){return this._colorWrite},Object.defineProperty(e.prototype,\"depthCullingState\",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"alphaState\",{get:function(){return this._alphaState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"stencilState\",{get:function(){return this._stencilState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"stencilStateComposer\",{get:function(){return this._stencilStateComposer},enumerable:!1,configurable:!0}),e.prototype._getGlobalDefines=function(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE=\"\":delete e.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER=\"\":delete e.USE_REVERSE_DEPTHBUFFER,void(this.useExactSrgbConversions?e.USE_EXACT_SRGB_CONVERSIONS=\"\":delete e.USE_EXACT_SRGB_CONVERSIONS);var t=\"\";return this.isNDCHalfZRange&&(t+=\"#define IS_NDC_HALF_ZRANGE\"),this.useReverseDepthBuffer&&(t&&(t+=\"\\n\"),t+=\"#define USE_REVERSE_DEPTHBUFFER\"),this.useExactSrgbConversions&&(t&&(t+=\"\\n\"),t+=\"#define USE_EXACT_SRGB_CONVERSIONS\"),t},e.prototype._rebuildInternalTextures=function(){for(var e=0,t=this._internalTexturesCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildRenderTargetWrappers=function(){for(var e=0,t=this._renderTargetWrapperCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e];t._pipelineContext=null,t._prepareEffect()}a.M.ResetCache()},e.prototype._rebuildGraphicsResources=function(){var e;this.wipeCaches(!0),this._rebuildEffects(),null===(e=this._rebuildComputeEffects)||void 0===e||e.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)},e.prototype._flagContextRestored=function(){o.V.Warn(this.name+\" context successfully restored.\"),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1},e.prototype._restoreEngineAfterContextLost=function(e){var t=this;setTimeout((function(){return(0,n.sH)(t,void 0,void 0,(function(){var t,r,i,o;return(0,n.YH)(this,(function(n){switch(n.label){case 0:return this._clearEmptyResources(),t=this._depthCullingState.depthTest,r=this._depthCullingState.depthFunc,i=this._depthCullingState.depthMask,o=this._stencilState.stencilTest,[4,e()];case 1:return n.sent(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=r,this._depthCullingState.depthMask=i,this._stencilState.stencilTest=o,this._flagContextRestored(),[2]}}))}))}),0)},Object.defineProperty(e.prototype,\"isDisposed\",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"snapshotRendering\",{get:function(){return!1},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"snapshotRenderingMode\",{get:function(){return m.Y.SNAPSHOTRENDERING_STANDARD},set:function(e){},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return\"AbstractEngine\"},Object.defineProperty(e.prototype,\"emptyTexture\",{get:function(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,m.Y.TEXTUREFORMAT_RGBA,!1,!1,m.Y.TEXTURE_NEAREST_SAMPLINGMODE)),this._emptyTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"emptyTexture3D\",{get:function(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,m.Y.TEXTUREFORMAT_RGBA,!1,!1,m.Y.TEXTURE_NEAREST_SAMPLINGMODE)),this._emptyTexture3D},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"emptyTexture2DArray\",{get:function(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,m.Y.TEXTUREFORMAT_RGBA,!1,!1,m.Y.TEXTURE_NEAREST_SAMPLINGMODE)),this._emptyTexture2DArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"emptyCubeTexture\",{get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,m.Y.TEXTUREFORMAT_RGBA,m.Y.TEXTURETYPE_UNSIGNED_INT,!1,!1,m.Y.TEXTURE_NEAREST_SAMPLINGMODE)}return this._emptyCubeTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"activeRenderLoops\",{get:function(){return this._activeRenderLoops},enumerable:!1,configurable:!0}),e.prototype.stopRenderLoop=function(e){if(!e)return this._activeRenderLoops.length=0,void this._cancelFrame();var t=this._activeRenderLoops.indexOf(e);t>=0&&(this._activeRenderLoops.splice(t,1),0==this._activeRenderLoops.length&&this._cancelFrame())},e.prototype._cancelFrame=function(){if(0!==this._frameHandler){var e=this._frameHandler;if(this._frameHandler=0,(0,_.BA)()){var t=(this.getHostWindow()||window).cancelAnimationFrame;if(\"function\"==typeof t)return t(e)}else if(\"function\"==typeof cancelAnimationFrame)return cancelAnimationFrame(e);return clearTimeout(e)}},e.prototype.beginFrame=function(){this.onBeginFrameObservable.notifyObservers(this)},e.prototype.endFrame=function(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)},e.prototype._renderLoop=function(){if(this._frameHandler=0,!this._contextWasLost){var e=!0;(this._isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))},e.prototype._renderFrame=function(){for(var e=0;e<this._activeRenderLoops.length;e++)(0,this._activeRenderLoops[e])()},e.prototype._renderViews=function(){return!1},e.prototype._queueNewFrame=function(e,t){return b(e,t)},e.prototype.runRenderLoop=function(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},e.prototype.getDepthBuffer=function(){return this._depthCullingState.depthTest},e.prototype.setDepthBuffer=function(e){this._depthCullingState.depthTest=e},e.prototype.setZOffset=function(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e},e.prototype.getZOffset=function(){var e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e},e.prototype.setZOffsetUnits=function(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e},e.prototype.getZOffsetUnits=function(){var e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e},e.prototype.getHostWindow=function(){return(0,_.BA)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null},Object.defineProperty(e.prototype,\"compatibilityMode\",{get:function(){return this._compatibilityMode},set:function(e){this._compatibilityMode=!0},enumerable:!1,configurable:!0}),e.prototype._rebuildTextures=function(){for(var e=0,t=this.scenes;e<t.length;e++)t[e]._rebuildTextures();for(var r=0,n=this._virtualScenes;r<n.length;r++)n[r]._rebuildTextures()},e.prototype._releaseRenderTargetWrapper=function(e){var t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)},Object.defineProperty(e.prototype,\"currentViewport\",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),e.prototype.setViewport=function(e,t,r){var n=t||this.getRenderWidth(),i=r||this.getRenderHeight(),o=e.x||0,a=e.y||0;this._cachedViewport=e,this._viewport(o*n,a*i,n*e.width,i*e.height)},e.prototype.createCanvasImage=function(){return document.createElement(\"img\")},Object.defineProperty(e.prototype,\"description\",{get:function(){var e=this.name+this.version;return this._caps.parallelShaderCompile&&(e+=\" - Parallel shader compilation\"),e},enumerable:!1,configurable:!0}),e.prototype._createTextureBase=function(t,r,a,s,l,c,u,h,d,f,_,g,v,b,S,T){var E=this;void 0===l&&(l=m.Y.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===c&&(c=null),void 0===u&&(u=null),void 0===f&&(f=null),void 0===_&&(_=null),void 0===g&&(g=null),void 0===v&&(v=null);var x=\"data:\"===(t=t||\"\").substr(0,5),P=\"blob:\"===t.substr(0,5),C=x&&-1!==t.indexOf(\";base64,\"),A=_||new p.h(this,1);A!==_&&(A.label=t.substring(0,60));var R=t;!this._transformTextureUrl||C||_||f||(t=this._transformTextureUrl(t)),R!==t&&(A._originalUrl=R);var I=t.lastIndexOf(\".\"),M=v||(I>-1?t.substring(I).toLowerCase():\"\");M.indexOf(\"?\")>-1&&(M=M.split(\"?\")[0]);var O=(0,y.gT)(M,b);s&&s.addPendingData(A),A.url=t,A.generateMipMaps=!r,A.samplingMode=l,A.invertY=a,A._useSRGBBuffer=this._getUseSRGBBuffer(!!T,r),this._doNotHandleContextLost||(A._buffer=f);var D=null;c&&!_&&(D=A.onLoadedObservable.add(c)),_||this._internalTexturesCache.push(A);var N=function(e,n){s&&s.removePendingData(A),t===R?(D&&A.onLoadedObservable.remove(D),i.q.UseFallbackTexture&&t!==i.q.FallbackTexture&&E._createTextureBase(i.q.FallbackTexture,r,A.invertY,s,l,null,u,h,d,f,A),e=(e||\"Unknown error\")+(i.q.UseFallbackTexture?\" - Fallback texture was used\":\"\"),A.onErrorObservable.notifyObservers({message:e,exception:n}),u&&u(e,n)):(o.V.Warn(\"Failed to load \".concat(t,\", falling back to \").concat(R)),E._createTextureBase(R,r,A.invertY,s,l,c,u,h,d,f,A,g,v,b,S,T))};if(O){var L=function(e){return(0,n.sH)(E,void 0,void 0,(function(){return(0,n.YH)(this,(function(t){switch(t.label){case 0:return[4,O];case 1:return t.sent().loadData(e,A,(function(e,t,r,n,i,o){o?N(\"TextureLoader failed to load data\"):h(A,M,s,{width:e,height:t},A.invertY,!r,n,(function(){return i(),!1}),l)}),S),[2]}}))}))};f?f instanceof ArrayBuffer?L(new Uint8Array(f)):ArrayBuffer.isView(f)?L(f):u&&u(\"Unable to load: only ArrayBuffer or ArrayBufferView is supported\",null):this._loadFile(t,(function(e){return L(new Uint8Array(e))}),void 0,s?s.offlineProvider:void 0,!0,(function(e,t){N(\"Unable to load \"+(e&&e.responseURL,t))}))}else{var F=function(e){P&&!E._doNotHandleContextLost&&(A._buffer=e),h(A,M,s,e,A.invertY,r,!1,d,l)};!x||C?f&&(\"string\"==typeof f.decoding||f.close)?F(f):e._FileToolsLoadImage(t||\"\",F,N,s?s.offlineProvider:null,b,A.invertY&&this._features.needsInvertingBitmap?{imageOrientation:\"flipY\"}:void 0):\"string\"==typeof f||f instanceof ArrayBuffer||ArrayBuffer.isView(f)||f instanceof Blob?e._FileToolsLoadImage(f,F,N,s?s.offlineProvider:null,b,A.invertY&&this._features.needsInvertingBitmap?{imageOrientation:\"flipY\"}:void 0):f&&F(f)}return A},e.prototype._rebuildBuffers=function(){for(var e=0,t=this._uniformBuffers;e<t.length;e++)t[e]._rebuildAfterContextLost()},Object.defineProperty(e.prototype,\"_shouldUseHighPrecisionShader\",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0}),e.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:(0,_.Nf)()?document:null},e.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache},e.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache.length=0},e.prototype.getCaps=function(){return this._caps},e.prototype.resetTextureCache=function(){for(var e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1},Object.defineProperty(e.prototype,\"name\",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"NpmPackage\",{get:function(){return\"babylonjs@7.25.2\"},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"Version\",{get:function(){return\"7.25.2\"},enumerable:!1,configurable:!0}),e.prototype.getRenderingCanvas=function(){return this._renderingCanvas},e.prototype.getAudioContext=function(){return this._audioContext},e.prototype.getAudioDestination=function(){return this._audioDestination},e.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e,this.resize()},e.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},Object.defineProperty(e.prototype,\"doNotHandleContextLost\",{get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isStencilEnable\",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0}),e.prototype.getCreationOptions=function(){return this._creationOptions},e.prototype.resize=function(e){var t,r;if(void 0===e&&(e=!1),this.adaptToDeviceRatio){var n=(0,_.BA)()&&window.devicePixelRatio||1,i=this._lastDevicePixelRatio/n;this._lastDevicePixelRatio=n,this._hardwareScalingLevel*=i}if((0,_.BA)()&&(0,_.Nf)())if(this._renderingCanvas){var o=this._renderingCanvas.getBoundingClientRect?this._renderingCanvas.getBoundingClientRect():{width:this._renderingCanvas.width*this._hardwareScalingLevel,height:this._renderingCanvas.height*this._hardwareScalingLevel};t=this._renderingCanvas.clientWidth||o.width||this._renderingCanvas.width||100,r=this._renderingCanvas.clientHeight||o.height||this._renderingCanvas.height||100}else t=window.innerWidth,r=window.innerHeight;else t=this._renderingCanvas?this._renderingCanvas.width:100,r=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(t/this._hardwareScalingLevel,r/this._hardwareScalingLevel,e)},e.prototype.setSize=function(e,t,r){if(void 0===r&&(r=!1),!this._renderingCanvas)return!1;if(e|=0,t|=0,!r&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t)return!1;if(this._renderingCanvas.width=e,this._renderingCanvas.height=t,this.scenes){for(var n=0;n<this.scenes.length;n++)for(var i=this.scenes[n],o=0;o<i.cameras.length;o++)i.cameras[o]._currentRenderId=0;this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0},e.prototype.createRawTexture=function(e,t,r,n,i,o,a,s,l,c,u){throw(0,f.n)(\"engine.rawTexture\")},e.prototype.createRawCubeTexture=function(e,t,r,n,i,o,a,s){throw(0,f.n)(\"engine.rawTexture\")},e.prototype.createRawTexture3D=function(e,t,r,n,i,o,a,s,l,c,u){throw(0,f.n)(\"engine.rawTexture\")},e.prototype.createRawTexture2DArray=function(e,t,r,n,i,o,a,s,l,c,u){throw(0,f.n)(\"engine.rawTexture\")},e.prototype._sharedInit=function(e){this._renderingCanvas=e},e.prototype._setupMobileChecks=function(){var e=this;navigator&&navigator.userAgent&&(this._checkForMobile=function(){var t=navigator.userAgent;e.hostInformation.isMobile=-1!==t.indexOf(\"Mobile\")||-1!==t.indexOf(\"Mac\")&&(0,_.Nf)()&&\"ontouchend\"in document},this._checkForMobile(),(0,_.BA)()&&window.addEventListener(\"resize\",this._checkForMobile))},e.prototype.createVideoElement=function(e){return document.createElement(\"video\")},e.prototype._reportDrawCall=function(e){var t;void 0===e&&(e=1),null===(t=this._drawCalls)||void 0===t||t.addCount(e,!1)},e.prototype.getFps=function(){return this._fps},e.prototype.getDeltaTime=function(){return this._deltaTime},e.prototype.isDeterministicLockStep=function(){return this._deterministicLockstep},e.prototype.getLockstepMaxSteps=function(){return this._lockstepMaxSteps},e.prototype.getTimeStep=function(){return 1e3*this._timeStep},e.prototype._createImageBitmapFromSource=function(e,t){throw new Error(\"createImageBitmapFromSource is not implemented\")},e.prototype.createImageBitmap=function(e,t){return createImageBitmap(e,t)},e.prototype.resizeImageBitmap=function(e,t,r){throw new Error(\"resizeImageBitmap is not implemented\")},e.prototype.getFontOffset=function(e){throw new Error(\"getFontOffset is not implemented\")},e._CreateCanvas=function(e,t){if(\"undefined\"==typeof document)return new OffscreenCanvas(e,t);var r=document.createElement(\"canvas\");return r.width=e,r.height=t,r},e.prototype.createCanvas=function(t,r){return e._CreateCanvas(t,r)},e._FileToolsLoadImage=function(e,t,r,n,i,o){throw(0,f.n)(\"FileTools\")},e.prototype._loadFile=function(e,t,r,n,i,o){var a=this,s=(0,v.W0)(e,t,r,n,i,o);return this._activeRequests.push(s),s.onCompleteObservable.add((function(){var e=a._activeRequests.indexOf(s);-1!==e&&a._activeRequests.splice(e,1)})),s},e._FileToolsLoadFile=function(e,t,r,n,i,o){if(v.sg.loadFile)return v.sg.loadFile(e,t,r,n,i,o);throw(0,f.n)(\"FileTools\")},e.prototype.dispose=function(){var e;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),a.M.ResetCache();for(var t=0,r=this._activeRequests;t<r.length;t++)r[t].abort();this._boundRenderFunction=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),(0,_.BA)()&&window.removeEventListener(\"resize\",this._checkForMobile);var n=i.q.Instances.indexOf(this);n>=0&&i.q.Instances.splice(n,1),i.q.Instances.length||(i.q.OnEnginesDisposedObservable.notifyObservers(this),i.q.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()},e.DefaultLoadingScreenFactory=function(e){throw(0,f.n)(\"LoadingScreen\")},e.MarkAllMaterialsAsDirty=function(e,t){for(var r=0;r<i.q.Instances.length;r++)for(var n=i.q.Instances[r],o=0;o<n.scenes.length;o++)n.scenes[o].markAllMaterialsAsDirty(e,t)},e._RenderPassIdCounter=0,e._RescalePostProcessFactory=null,e.CollisionsEpsilon=.001,e.QueueNewFrame=b,e}()},81152:(e,t,r)=>{r.d(t,{Y:()=>n});var n=function(){function e(){}return e.AUTOSAMPLERSUFFIX=\"Sampler\",e.DISABLEUA=\"#define DISABLE_UNIFORMITY_ANALYSIS\",e.ALPHA_DISABLE=0,e.ALPHA_ADD=1,e.ALPHA_COMBINE=2,e.ALPHA_SUBTRACT=3,e.ALPHA_MULTIPLY=4,e.ALPHA_MAXIMIZED=5,e.ALPHA_ONEONE=6,e.ALPHA_PREMULTIPLIED=7,e.ALPHA_PREMULTIPLIED_PORTERDUFF=8,e.ALPHA_INTERPOLATE=9,e.ALPHA_SCREENMODE=10,e.ALPHA_ONEONE_ONEONE=11,e.ALPHA_ALPHATOCOLOR=12,e.ALPHA_REVERSEONEMINUS=13,e.ALPHA_SRC_DSTONEMINUSSRCALPHA=14,e.ALPHA_ONEONE_ONEZERO=15,e.ALPHA_EXCLUSION=16,e.ALPHA_LAYER_ACCUMULATE=17,e.ALPHA_EQUATION_ADD=0,e.ALPHA_EQUATION_SUBSTRACT=1,e.ALPHA_EQUATION_REVERSE_SUBTRACT=2,e.ALPHA_EQUATION_MAX=3,e.ALPHA_EQUATION_MIN=4,e.ALPHA_EQUATION_DARKEN=5,e.DELAYLOADSTATE_NONE=0,e.DELAYLOADSTATE_LOADED=1,e.DELAYLOADSTATE_LOADING=2,e.DELAYLOADSTATE_NOTLOADED=4,e.NEVER=512,e.ALWAYS=519,e.LESS=513,e.EQUAL=514,e.LEQUAL=515,e.GREATER=516,e.GEQUAL=518,e.NOTEQUAL=517,e.KEEP=7680,e.ZERO=0,e.REPLACE=7681,e.INCR=7682,e.DECR=7683,e.INVERT=5386,e.INCR_WRAP=34055,e.DECR_WRAP=34056,e.TEXTURE_CLAMP_ADDRESSMODE=0,e.TEXTURE_WRAP_ADDRESSMODE=1,e.TEXTURE_MIRROR_ADDRESSMODE=2,e.TEXTURE_CREATIONFLAG_STORAGE=1,e.TEXTUREFORMAT_ALPHA=0,e.TEXTUREFORMAT_LUMINANCE=1,e.TEXTUREFORMAT_LUMINANCE_ALPHA=2,e.TEXTUREFORMAT_RGB=4,e.TEXTUREFORMAT_RGBA=5,e.TEXTUREFORMAT_RED=6,e.TEXTUREFORMAT_R=6,e.TEXTUREFORMAT_RG=7,e.TEXTUREFORMAT_RED_INTEGER=8,e.TEXTUREFORMAT_R_INTEGER=8,e.TEXTUREFORMAT_RG_INTEGER=9,e.TEXTUREFORMAT_RGB_INTEGER=10,e.TEXTUREFORMAT_RGBA_INTEGER=11,e.TEXTUREFORMAT_BGRA=12,e.TEXTUREFORMAT_DEPTH24_STENCIL8=13,e.TEXTUREFORMAT_DEPTH32_FLOAT=14,e.TEXTUREFORMAT_DEPTH16=15,e.TEXTUREFORMAT_DEPTH24=16,e.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17,e.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18,e.TEXTUREFORMAT_STENCIL8=19,e.TEXTUREFORMAT_UNDEFINED=4294967295,e.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492,e.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493,e.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495,e.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494,e.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779,e.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919,e.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778,e.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918,e.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777,e.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776,e.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917,e.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916,e.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808,e.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840,e.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196,e.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492,e.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493,e.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,e.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,e.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496,e.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,e.TEXTURETYPE_UNSIGNED_BYTE=0,e.TEXTURETYPE_UNSIGNED_INT=0,e.TEXTURETYPE_FLOAT=1,e.TEXTURETYPE_HALF_FLOAT=2,e.TEXTURETYPE_BYTE=3,e.TEXTURETYPE_SHORT=4,e.TEXTURETYPE_UNSIGNED_SHORT=5,e.TEXTURETYPE_INT=6,e.TEXTURETYPE_UNSIGNED_INTEGER=7,e.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,e.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,e.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,e.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,e.TEXTURETYPE_UNSIGNED_INT_24_8=12,e.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,e.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,e.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,e.TEXTURETYPE_UNDEFINED=16,e.TEXTURE_2D=3553,e.TEXTURE_2D_ARRAY=35866,e.TEXTURE_CUBE_MAP=34067,e.TEXTURE_CUBE_MAP_ARRAY=3735928559,e.TEXTURE_3D=32879,e.TEXTURE_NEAREST_SAMPLINGMODE=1,e.TEXTURE_NEAREST_NEAREST=1,e.TEXTURE_BILINEAR_SAMPLINGMODE=2,e.TEXTURE_LINEAR_LINEAR=2,e.TEXTURE_TRILINEAR_SAMPLINGMODE=3,e.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,e.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,e.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,e.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,e.TEXTURE_NEAREST_LINEAR=7,e.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,e.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,e.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,e.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,e.TEXTURE_LINEAR_NEAREST=12,e.TEXTURE_EXPLICIT_MODE=0,e.TEXTURE_SPHERICAL_MODE=1,e.TEXTURE_PLANAR_MODE=2,e.TEXTURE_CUBIC_MODE=3,e.TEXTURE_PROJECTION_MODE=4,e.TEXTURE_SKYBOX_MODE=5,e.TEXTURE_INVCUBIC_MODE=6,e.TEXTURE_EQUIRECTANGULAR_MODE=7,e.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,e.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,e.TEXTURE_FILTERING_QUALITY_OFFLINE=4096,e.TEXTURE_FILTERING_QUALITY_HIGH=64,e.TEXTURE_FILTERING_QUALITY_MEDIUM=16,e.TEXTURE_FILTERING_QUALITY_LOW=8,e.SCALEMODE_FLOOR=1,e.SCALEMODE_NEAREST=2,e.SCALEMODE_CEILING=3,e.MATERIAL_TextureDirtyFlag=1,e.MATERIAL_LightDirtyFlag=2,e.MATERIAL_FresnelDirtyFlag=4,e.MATERIAL_AttributesDirtyFlag=8,e.MATERIAL_MiscDirtyFlag=16,e.MATERIAL_PrePassDirtyFlag=32,e.MATERIAL_AllDirtyFlag=63,e.MATERIAL_TriangleFillMode=0,e.MATERIAL_WireFrameFillMode=1,e.MATERIAL_PointFillMode=2,e.MATERIAL_PointListDrawMode=3,e.MATERIAL_LineListDrawMode=4,e.MATERIAL_LineLoopDrawMode=5,e.MATERIAL_LineStripDrawMode=6,e.MATERIAL_TriangleStripDrawMode=7,e.MATERIAL_TriangleFanDrawMode=8,e.MATERIAL_ClockWiseSideOrientation=0,e.MATERIAL_CounterClockWiseSideOrientation=1,e.ACTION_NothingTrigger=0,e.ACTION_OnPickTrigger=1,e.ACTION_OnLeftPickTrigger=2,e.ACTION_OnRightPickTrigger=3,e.ACTION_OnCenterPickTrigger=4,e.ACTION_OnPickDownTrigger=5,e.ACTION_OnDoublePickTrigger=6,e.ACTION_OnPickUpTrigger=7,e.ACTION_OnPickOutTrigger=16,e.ACTION_OnLongPressTrigger=8,e.ACTION_OnPointerOverTrigger=9,e.ACTION_OnPointerOutTrigger=10,e.ACTION_OnEveryFrameTrigger=11,e.ACTION_OnIntersectionEnterTrigger=12,e.ACTION_OnIntersectionExitTrigger=13,e.ACTION_OnKeyDownTrigger=14,e.ACTION_OnKeyUpTrigger=15,e.PARTICLES_BILLBOARDMODE_Y=2,e.PARTICLES_BILLBOARDMODE_ALL=7,e.PARTICLES_BILLBOARDMODE_STRETCHED=8,e.PARTICLES_BILLBOARDMODE_STRETCHED_LOCAL=9,e.MESHES_CULLINGSTRATEGY_STANDARD=0,e.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,e.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,e.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,e.SCENELOADER_NO_LOGGING=0,e.SCENELOADER_MINIMAL_LOGGING=1,e.SCENELOADER_SUMMARY_LOGGING=2,e.SCENELOADER_DETAILED_LOGGING=3,e.PREPASS_IRRADIANCE_TEXTURE_TYPE=0,e.PREPASS_POSITION_TEXTURE_TYPE=1,e.PREPASS_VELOCITY_TEXTURE_TYPE=2,e.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3,e.PREPASS_COLOR_TEXTURE_TYPE=4,e.PREPASS_DEPTH_TEXTURE_TYPE=5,e.PREPASS_NORMAL_TEXTURE_TYPE=6,e.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7,e.PREPASS_WORLD_NORMAL_TEXTURE_TYPE=8,e.PREPASS_LOCAL_POSITION_TEXTURE_TYPE=9,e.PREPASS_SCREENSPACE_DEPTH_TEXTURE_TYPE=10,e.PREPASS_VELOCITY_LINEAR_TEXTURE_TYPE=11,e.BUFFER_CREATIONFLAG_READ=1,e.BUFFER_CREATIONFLAG_WRITE=2,e.BUFFER_CREATIONFLAG_READWRITE=3,e.BUFFER_CREATIONFLAG_UNIFORM=4,e.BUFFER_CREATIONFLAG_VERTEX=8,e.BUFFER_CREATIONFLAG_INDEX=16,e.BUFFER_CREATIONFLAG_STORAGE=32,e.BUFFER_CREATIONFLAG_INDIRECT=64,e.RENDERPASS_MAIN=0,e.INPUT_ALT_KEY=18,e.INPUT_CTRL_KEY=17,e.INPUT_META_KEY1=91,e.INPUT_META_KEY2=92,e.INPUT_META_KEY3=93,e.INPUT_SHIFT_KEY=16,e.SNAPSHOTRENDERING_STANDARD=0,e.SNAPSHOTRENDERING_FAST=1,e.PERSPECTIVE_CAMERA=0,e.ORTHOGRAPHIC_CAMERA=1,e.FOVMODE_VERTICAL_FIXED=0,e.FOVMODE_HORIZONTAL_FIXED=1,e.RIG_MODE_NONE=0,e.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,e.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,e.RIG_MODE_STEREOSCOPIC_INTERLACED=14,e.RIG_MODE_VR=20,e.RIG_MODE_CUSTOM=22,e.MAX_SUPPORTED_UV_SETS=6,e.GL_ALPHA_EQUATION_ADD=32774,e.GL_ALPHA_EQUATION_MIN=32775,e.GL_ALPHA_EQUATION_MAX=32776,e.GL_ALPHA_EQUATION_SUBTRACT=32778,e.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779,e.GL_ALPHA_FUNCTION_SRC=768,e.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769,e.GL_ALPHA_FUNCTION_SRC_ALPHA=770,e.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771,e.GL_ALPHA_FUNCTION_DST_ALPHA=772,e.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773,e.GL_ALPHA_FUNCTION_DST_COLOR=774,e.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775,e.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776,e.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769,e.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770,e.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771,e.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772,e.SnippetUrl=\"https://snippet.babylonjs.com\",e.FOGMODE_NONE=0,e.FOGMODE_EXP=1,e.FOGMODE_EXP2=2,e.FOGMODE_LINEAR=3,e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.PositionKind=\"position\",e.NormalKind=\"normal\",e.TangentKind=\"tangent\",e.UVKind=\"uv\",e.UV2Kind=\"uv2\",e.UV3Kind=\"uv3\",e.UV4Kind=\"uv4\",e.UV5Kind=\"uv5\",e.UV6Kind=\"uv6\",e.ColorKind=\"color\",e.ColorInstanceKind=\"instanceColor\",e.MatricesIndicesKind=\"matricesIndices\",e.MatricesWeightsKind=\"matricesWeights\",e.MatricesIndicesExtraKind=\"matricesIndicesExtra\",e.MatricesWeightsExtraKind=\"matricesWeightsExtra\",e}()},66614:(e,t,r)=>{r.d(t,{q:()=>i});var n=r(66377),i=function(){function e(){}return Object.defineProperty(e,\"LastCreatedEngine\",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"LastCreatedScene\",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0}),e.Instances=[],e.OnEnginesDisposedObservable=new n.cP,e._LastCreatedScene=null,e.UseFallbackTexture=!0,e.FallbackTexture=\"\",e}()},16106:(e,t,r)=>{r.d(t,{I:()=>n});var n=function(){function e(){}return e.SetMatrixPrecision=function(t){if(e.MatrixTrackPrecisionChange=!1,t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var r=0;r<e.MatrixTrackedMatrices.length;++r){var n=e.MatrixTrackedMatrices[r],i=n._m;n._m=new Array(16);for(var o=0;o<16;++o)n._m[o]=i[o]}e.MatrixUse64Bits=t,e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array,e.MatrixTrackedMatrices=null},e.MatrixUse64Bits=!1,e.MatrixTrackPrecisionChange=!0,e.MatrixCurrentType=Float32Array,e.MatrixTrackedMatrices=[],e}()},96925:(e,t,r)=>{r.d(t,{v:()=>i});var n=r(81152),i=function(){function e(e,t,r,n,i){this._textures=null,this._faceIndices=null,this._layerIndices=null,this._samples=1,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=e,this._isCube=t,this._size=r,this._engine=n,this._depthStencilTexture=null,this.label=i}return Object.defineProperty(e.prototype,\"depthStencilTexture\",{get:function(){return this._depthStencilTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"depthStencilTextureWithStencil\",{get:function(){return this._depthStencilTextureWithStencil},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isCube\",{get:function(){return this._isCube},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isMulti\",{get:function(){return this._isMulti},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"is2DArray\",{get:function(){return this.layers>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"is3D\",{get:function(){return this.depth>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"size\",{get:function(){return this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"width\",{get:function(){return this._size.width||this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"height\",{get:function(){return this._size.height||this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"layers\",{get:function(){return this._size.layers||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"depth\",{get:function(){return this._size.depth||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"texture\",{get:function(){var e,t;return null!==(t=null===(e=this._textures)||void 0===e?void 0:e[0])&&void 0!==t?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"textures\",{get:function(){return this._textures},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"faceIndices\",{get:function(){return this._faceIndices},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"layerIndices\",{get:function(){return this._layerIndices},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"samples\",{get:function(){return this._samples},enumerable:!1,configurable:!0}),e.prototype.setSamples=function(e,t,r){if(void 0===t&&(t=!0),void 0===r&&(r=!1),this.samples===e&&!r)return e;var n=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,e,t):this._engine.updateRenderTargetTextureSampleCount(this,e);return this._samples=e,n},e.prototype.setTextures=function(e){Array.isArray(e)?this._textures=e:this._textures=e?[e]:null},e.prototype.setTexture=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=!0),this._textures||(this._textures=[]),this._textures[t]!==e&&(this._textures[t]&&r&&this._textures[t].dispose(),this._textures[t]=e)},e.prototype.setLayerAndFaceIndices=function(e,t){this._layerIndices=e,this._faceIndices=t},e.prototype.setLayerAndFaceIndex=function(e,t,r){void 0===e&&(e=0),this._layerIndices||(this._layerIndices=[]),this._faceIndices||(this._faceIndices=[]),void 0!==t&&t>=0&&(this._layerIndices[e]=t),void 0!==r&&r>=0&&(this._faceIndices[e]=r)},e.prototype.createDepthStencilTexture=function(e,t,r,i,o,a){var s;return void 0===e&&(e=0),void 0===t&&(t=!0),void 0===r&&(r=!1),void 0===i&&(i=1),void 0===o&&(o=n.Y.TEXTUREFORMAT_DEPTH32_FLOAT),null===(s=this._depthStencilTexture)||void 0===s||s.dispose(),this._depthStencilTextureWithStencil=r,this._depthStencilTextureLabel=a,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:t,comparisonFunction:e,generateStencil:r,isCube:this._isCube,samples:i,depthTextureFormat:o,label:a},this),this._depthStencilTexture},e.prototype._shareDepth=function(e){this.shareDepth(e)},e.prototype.shareDepth=function(e){this._depthStencilTexture&&(e._depthStencilTexture&&e._depthStencilTexture.dispose(),e._depthStencilTexture=this._depthStencilTexture,e._depthStencilTextureWithStencil=this._depthStencilTextureWithStencil,this._depthStencilTexture.incrementReferences())},e.prototype._swapAndDie=function(e){this.texture&&this.texture._swapAndDie(e),this._textures=null,this.dispose(!0)},e.prototype._cloneRenderTargetWrapper=function(){var e,t,r,i,o,a,s,l,c=null;if(this._isMulti){var u=this.textures;if(u&&u.length>0){var h=!1,d=u.length,f=-1,p=u[u.length-1]._source;14!==p&&12!==p||(h=!0,f=u[u.length-1].format,d--);for(var _=[],m=[],g=[],v=[],y=[],b=[],S=[],T={},E=0;E<d;++E){var x=u[E];_.push(x.samplingMode),m.push(x.type),g.push(x.format),void 0!==(A=T[x.uniqueId])?(v.push(-1),S.push(0)):(T[x.uniqueId]=E,x.is2DArray?(v.push(n.Y.TEXTURE_2D_ARRAY),S.push(x.depth)):x.isCube?(v.push(n.Y.TEXTURE_CUBE_MAP),S.push(0)):x.is3D?(v.push(n.Y.TEXTURE_3D),S.push(x.depth)):(v.push(n.Y.TEXTURE_2D),S.push(0))),this._faceIndices&&y.push(null!==(e=this._faceIndices[E])&&void 0!==e?e:0),this._layerIndices&&b.push(null!==(t=this._layerIndices[E])&&void 0!==t?t:0)}var P={samplingModes:_,generateMipMaps:u[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:h,depthTextureFormat:f,types:m,formats:g,textureCount:d,targetTypes:v,faceIndex:y,layerIndex:b,layerCounts:S,label:this.label},C={width:this.width,height:this.height,depth:this.depth};for(c=this._engine.createMultipleRenderTarget(C,P),E=0;E<d;++E)if(-1===v[E]){var A=T[u[E].uniqueId];c.setTexture(c.textures[A],E)}}}else{var R={};R.generateDepthBuffer=this._generateDepthBuffer,R.generateMipMaps=null!==(i=null===(r=this.texture)||void 0===r?void 0:r.generateMipMaps)&&void 0!==i&&i,R.generateStencilBuffer=this._generateStencilBuffer,R.samplingMode=null===(o=this.texture)||void 0===o?void 0:o.samplingMode,R.type=null===(a=this.texture)||void 0===a?void 0:a.type,R.format=null===(s=this.texture)||void 0===s?void 0:s.format,R.noColorAttachment=!this._textures,R.label=this.label,this.isCube?c=this._engine.createRenderTargetCubeTexture(this.width,R):(C={width:this.width,height:this.height,layers:this.is2DArray||this.is3D?null===(l=this.texture)||void 0===l?void 0:l.depth:void 0},c=this._engine.createRenderTargetTexture(C,R)),c.texture&&(c.texture.isReady=!0)}return c},e.prototype._swapRenderTargetWrapper=function(e){if(this._textures&&e._textures)for(var t=0;t<this._textures.length;++t)this._textures[t]._swapAndDie(e._textures[t],!1),e._textures[t].isReady=!0;this._depthStencilTexture&&e._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(e._depthStencilTexture),e._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null},e.prototype._rebuild=function(){var e=this._cloneRenderTargetWrapper();if(e){if(this._depthStencilTexture){var t=this._depthStencilTexture.samplingMode,r=this._depthStencilTexture.format,i=t===n.Y.TEXTURE_BILINEAR_SAMPLINGMODE||t===n.Y.TEXTURE_TRILINEAR_SAMPLINGMODE||t===n.Y.TEXTURE_LINEAR_LINEAR_MIPNEAREST;e.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,i,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples,r,this._depthStencilTextureLabel)}this.samples>1&&e.setSamples(this.samples),e._swapRenderTargetWrapper(this),e.dispose()}},e.prototype.releaseTextures=function(){var e,t;if(this._textures)for(var r=0;null!==(t=r<(null===(e=this._textures)||void 0===e?void 0:e.length))&&void 0!==t&&t;++r)this._textures[r].dispose();this._textures=null},e.prototype.dispose=function(e){var t;void 0===e&&(e=!1),e||(null===(t=this._depthStencilTexture)||void 0===t||t.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)},e}()},98519:(e,t,r)=>{r.d(t,{l:()=>n});var n=function(){function e(){}return e.GetShadersRepository=function(t){return void 0===t&&(t=0),0===t?e.ShadersRepository:e.ShadersRepositoryWGSL},e.GetShadersStore=function(t){return void 0===t&&(t=0),0===t?e.ShadersStore:e.ShadersStoreWGSL},e.GetIncludesShadersStore=function(t){return void 0===t&&(t=0),0===t?e.IncludesShadersStore:e.IncludesShadersStoreWGSL},e.ShadersRepository=\"src/Shaders/\",e.ShadersStore={},e.IncludesShadersStore={},e.ShadersRepositoryWGSL=\"src/ShadersWGSL/\",e.ShadersStoreWGSL={},e.IncludesShadersStoreWGSL={},e}()},53399:(e,t,r)=>{r.d(t,{C5:()=>g,Cm:()=>l,EX:()=>u,GX:()=>h,N5:()=>s,YM:()=>p,bS:()=>v,kf:()=>c,tI:()=>d,tg:()=>f});var n=r(14737),i=r(24894),o=new WeakMap,a={_webGLVersion:2,cachedPipelines:{}};function s(e){var t=o.get(e);if(!t){if(!e)return a;t={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,cachedPipelines:{}},o.set(e,t)}return t}function l(e){o.delete(e)}function c(e,t,r,n,i,o){var a,l=s(n);return o||(o=null!==(a=l._createShaderProgramInjection)&&void 0!==a?a:d),o(e,m(t,\"vertex\",n,l._contextWasLost),m(r,\"fragment\",n,l._contextWasLost),n,i,l.validateShaderPrograms)}function u(e,t,r,n,i,o,a){var l;void 0===o&&(o=null);var c=s(i);a||(a=null!==(l=c._createShaderProgramInjection)&&void 0!==l?l:d);var u=c._webGLVersion>1?\"#version 300 es\\n#define WEBGL2 \\n\":\"\";return a(e,_(t,\"vertex\",n,u,i,c._contextWasLost),_(r,\"fragment\",n,u,i,c._contextWasLost),i,o,c.validateShaderPrograms)}function h(e,t){var r=new n.x,i=s(e);return i.parallelShaderCompile&&(r.isParallelCompiled=!0),r.context=i._context,r}function d(e,t,r,n,i,o){void 0===i&&(i=null);var a=n.createProgram();if(e.program=a,!a)throw new Error(\"Unable to create program\");return n.attachShader(a,t),n.attachShader(a,r),n.linkProgram(a),e.context=n,e.vertexShader=t,e.fragmentShader=r,e.isParallelCompiled||f(e,n,o),a}function f(e,t,r){var n=e.context,i=e.vertexShader,o=e.fragmentShader,a=e.program;if(!n.getProgramParameter(a,n.LINK_STATUS)){var s,l;if(!t.getShaderParameter(i,t.COMPILE_STATUS)&&(s=t.getShaderInfoLog(i)))throw e.vertexCompilationError=s,new Error(\"VERTEX SHADER \"+s);if(!t.getShaderParameter(o,t.COMPILE_STATUS)&&(s=t.getShaderInfoLog(o)))throw e.fragmentCompilationError=s,new Error(\"FRAGMENT SHADER \"+s);if(l=n.getProgramInfoLog(a))throw e.programLinkError=l,new Error(l)}if(r&&(n.validateProgram(a),!n.getProgramParameter(a,n.VALIDATE_STATUS)&&(l=n.getProgramInfoLog(a))))throw e.programValidationError=l,new Error(l);n.deleteShader(i),n.deleteShader(o),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function p(e,t,r,n,i,o,a,l,h,d,f,p,_){var m,g;void 0===d&&(d=\"\");var v=s(e.context);p||(p=null!==(m=v.createRawShaderProgramInjection)&&void 0!==m?m:c),_||(_=null!==(g=v.createShaderProgramInjection)&&void 0!==g?g:u);var y=e;y.program=n?p(y,t,r,y.context,h):_(y,t,r,l,y.context,h),y.program.__SPECTOR_rebuildProgram=a,f()}function _(e,t,r,n,o,a){return m((0,i.iL)(e,r,n),t,o,a)}function m(e,t,r,n){var i=r.createShader(\"vertex\"===t?r.VERTEX_SHADER:r.FRAGMENT_SHADER);if(!i){for(var o=r.NO_ERROR,a=r.NO_ERROR;(a=r.getError())!==r.NO_ERROR;)o=a;throw new Error(\"Something went wrong while creating a gl \".concat(t,\" shader object. gl error=\").concat(o,\", gl isContextLost=\").concat(r.isContextLost(),\", _contextWasLost=\").concat(n))}return r.shaderSource(i,e),r.compileShader(i),i}function g(e,t){t.useProgram(e)}function v(e,t){var r=e;if(r.isParallelCompiled){var n=r.onCompiled;r.onCompiled=function(){null==n||n(),t(e)}}else t(e)}},96352:(e,t,r)=>{r.d(t,{w:()=>b});var n=r(78322),i=r(53399),o=r(92118),a=r(7164),s=r(5153),l=function(){function e(){this.shaderLanguage=0}return e.prototype.postProcessor=function(e,t,r,n,i){return i.drawBuffersExtensionDisabled&&(e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,\"\")),e},e}(),c=r(24054),u=r(26218),h=r(87074),d=r(82673),f=r(81152),p=r(90519),_=r(19133),m=r(74239),g=r(24894),v=r(76320),y=function(){},b=function(e){function t(r,n,o,s){var u=this;if(o=o||{},(u=e.call(this,null!=n?n:o.antialias,o,s)||this)._name=\"WebGL\",u.forcePOTTextures=!1,u.validateShaderPrograms=!1,u.disableUniformBuffers=!1,u._webGLVersion=1,u._vertexAttribArraysEnabled=[],u._uintIndicesCurrentlySet=!1,u._currentBoundBuffer=new Array,u._currentFramebuffer=null,u._dummyFramebuffer=null,u._currentBufferPointers=new Array,u._currentInstanceLocations=new Array,u._currentInstanceBuffers=new Array,u._vaoRecordInProgress=!1,u._mustWipeVertexAttributes=!1,u._nextFreeTextureSlots=new Array,u._maxSimultaneousTextures=0,u._maxMSAASamplesOverride=null,u._unpackFlipYCached=null,u.enableUnpackFlipYCached=!0,u._boundUniforms={},!r)return u;var h=null;if(r.getContext){if(h=r,u._renderingCanvas=h,void 0===o.preserveDrawingBuffer&&(o.preserveDrawingBuffer=!1),void 0===o.xrCompatible&&(o.xrCompatible=!1),navigator&&navigator.userAgent){u._setupMobileChecks();for(var d=navigator.userAgent,f=0,p=t.ExceptionList;f<p.length;f++){var _=p[f],m=_.key,g=_.targets;if(new RegExp(m).test(d)){if(_.capture&&_.captureConstraint){var v=_.capture,b=_.captureConstraint,S=new RegExp(v).exec(d);if(S&&S.length>0&&parseInt(S[S.length-1])>=b)continue}for(var T=0,E=g;T<E.length;T++)switch(E[T]){case\"uniformBuffer\":u.disableUniformBuffers=!0;break;case\"vao\":u.disableVertexArrayObjects=!0;break;case\"antialias\":o.antialias=!1;break;case\"maxMSAASamples\":u._maxMSAASamplesOverride=1}}}}if(u._doNotHandleContextLost||(u._onContextLost=function(e){e.preventDefault(),u._contextWasLost=!0,a.V.Warn(\"WebGL context lost.\"),u.onContextLostObservable.notifyObservers(u)},u._onContextRestored=function(){u._restoreEngineAfterContextLost((function(){return u._initGLContext()}))},h.addEventListener(\"webglcontextlost\",u._onContextLost,!1),h.addEventListener(\"webglcontextrestored\",u._onContextRestored,!1),o.powerPreference=o.powerPreference||\"high-performance\"),u._badDesktopOS&&(o.xrCompatible=!1),!o.disableWebGL2Support)try{u._gl=h.getContext(\"webgl2\",o)||h.getContext(\"experimental-webgl2\",o),u._gl&&(u._webGLVersion=2,u._shaderPlatformName=\"WEBGL2\",u._gl.deleteQuery||(u._webGLVersion=1,u._shaderPlatformName=\"WEBGL1\"))}catch(e){}if(!u._gl){if(!h)throw new Error(\"The provided canvas is null or undefined.\");try{u._gl=h.getContext(\"webgl\",o)||h.getContext(\"experimental-webgl\",o)}catch(e){throw new Error(\"WebGL not supported\")}}if(!u._gl)throw new Error(\"WebGL not supported\")}else{u._gl=r,u._renderingCanvas=u._gl.canvas,u._gl.renderbufferStorageMultisample?(u._webGLVersion=2,u._shaderPlatformName=\"WEBGL2\"):u._shaderPlatformName=\"WEBGL1\";var x=u._gl.getContextAttributes();x&&(o.stencil=x.stencil)}u._gl.pixelStorei(u._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,u._gl.NONE),void 0!==o.useHighPrecisionFloats&&(u._highPrecisionShadersAllowed=o.useHighPrecisionFloats),u.resize(),u._initGLContext(),u._initFeatures();for(var P=0;P<u._caps.maxVertexAttribs;P++)u._currentBufferPointers[P]=new y;u._shaderProcessor=u.webGLVersion>1?new c.B:new l;var C=\"Babylon.js v\".concat(t.Version);a.V.Log(C+\" - \".concat(u.description)),u._renderingCanvas&&u._renderingCanvas.setAttribute&&u._renderingCanvas.setAttribute(\"data-engine\",C);var A=(0,i.N5)(u._gl);return A.validateShaderPrograms=u.validateShaderPrograms,A.parallelShaderCompile=u._caps.parallelShaderCompile,u}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"name\",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"version\",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),Object.defineProperty(t,\"ShadersRepository\",{get:function(){return m.M.ShadersRepository},set:function(e){m.M.ShadersRepository=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"supportsUniformBuffers\",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"needPOTTextures\",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_supportsHardwareTextureRescaling\",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"framebufferDimensionsObject\",{set:function(e){this._framebufferDimensionsObject=e},enumerable:!1,configurable:!0}),t.prototype.snapshotRenderingReset=function(){this.snapshotRendering=!1},t.prototype._clearEmptyResources=function(){this._dummyFramebuffer=null,e.prototype._clearEmptyResources.call(this)},t.prototype._getShaderProcessingContext=function(e){return null},t.prototype.areAllEffectsReady=function(){for(var e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0},t.prototype._initGLContext=function(){var e;this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension(\"KHR_parallel_shader_compile\")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension(\"OES_standard_derivatives\"),maxAnisotropy:1,astc:this._gl.getExtension(\"WEBGL_compressed_texture_astc\")||this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_astc\"),bptc:this._gl.getExtension(\"EXT_texture_compression_bptc\")||this._gl.getExtension(\"WEBKIT_EXT_texture_compression_bptc\"),s3tc:this._gl.getExtension(\"WEBGL_compressed_texture_s3tc\")||this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\"),s3tc_srgb:this._gl.getExtension(\"WEBGL_compressed_texture_s3tc_srgb\")||this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc_srgb\"),pvrtc:this._gl.getExtension(\"WEBGL_compressed_texture_pvrtc\")||this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_pvrtc\"),etc1:this._gl.getExtension(\"WEBGL_compressed_texture_etc1\")||this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc1\"),etc2:this._gl.getExtension(\"WEBGL_compressed_texture_etc\")||this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_etc\")||this._gl.getExtension(\"WEBGL_compressed_texture_es3_0\"),textureAnisotropicFilterExtension:this._gl.getExtension(\"EXT_texture_filter_anisotropic\")||this._gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\")||this._gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension(\"OES_element_index_uint\"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension(\"EXT_frag_depth\"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension(\"EXT_disjoint_timer_query_webgl2\")||this._gl.getExtension(\"EXT_disjoint_timer_query\"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension(\"EXT_color_buffer_float\")),supportFloatTexturesResolve:!1,rg11b10ufColorRenderable:!1,colorBufferHalfFloat:!!(this._webGLVersion>1&&this._gl.getExtension(\"EXT_color_buffer_half_float\")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension(\"OES_texture_float\")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension(\"OES_texture_half_float\")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension(\"EXT_shader_texture_lod\")),texelFetch:1!==this._webGLVersion,blendMinMax:!1,multiview:this._gl.getExtension(\"OVR_multiview2\"),oculusMultiview:this._gl.getExtension(\"OCULUS_multiview\"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS):128,disableMorphTargetTexture:!1},this._caps.supportFloatTexturesResolve=this._caps.colorBufferFloat,this._caps.rg11b10ufColorRenderable=this._caps.colorBufferFloat,this._glVersion=this._gl.getParameter(this._gl.VERSION);var t=this._gl.getExtension(\"WEBGL_debug_renderer_info\");if(null!=t&&(this._glRenderer=this._gl.getParameter(t.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(t.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||\"Unknown vendor\"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||\"Unknown renderer\"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=(null!==(e=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT))&&void 0!==e?e:0)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension(\"OES_texture_float_linear\")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension(\"OES_texture_half_float_linear\")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=null!==this._maxMSAASamplesOverride?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES),this._caps.maxDrawBuffers=this._gl.getParameter(this._gl.MAX_DRAW_BUFFERS);else{var r=this._gl.getExtension(\"WEBGL_draw_buffers\");if(null!==r){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=r.drawBuffersWEBGL.bind(r),this._caps.maxDrawBuffers=this._gl.getParameter(r.MAX_DRAW_BUFFERS_WEBGL),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var n=0;n<16;n++)this._gl[\"COLOR_ATTACHMENT\"+n+\"_WEBGL\"]=r[\"COLOR_ATTACHMENT\"+n+\"_WEBGL\"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var i=this._gl.getExtension(\"WEBGL_depth_texture\");null!=i&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=i.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var o=this._gl.getExtension(\"OES_vertex_array_object\");null!=o&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=o.createVertexArrayOES.bind(o),this._gl.bindVertexArray=o.bindVertexArrayOES.bind(o),this._gl.deleteVertexArray=o.deleteVertexArrayOES.bind(o))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var a=this._gl.getExtension(\"ANGLE_instanced_arrays\");null!=a?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=a.drawArraysInstancedANGLE.bind(a),this._gl.drawElementsInstanced=a.drawElementsInstancedANGLE.bind(a),this._gl.vertexAttribDivisor=a.vertexAttribDivisorANGLE.bind(a)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var s=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),l=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);s&&l&&(this._caps.highPrecisionShaderSupported=0!==s.precision&&0!==l.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var c=this._gl.getExtension(\"EXT_blend_minmax\");null!=c&&(this._caps.blendMinMax=!0,this._gl.MAX=c.MAX_EXT,this._gl.MIN=c.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:WebGL2RenderingContext.SRGB,SRGB8:WebGL2RenderingContext.SRGB8,SRGB8_ALPHA8:WebGL2RenderingContext.SRGB8_ALPHA8};else{var u=this._gl.getExtension(\"EXT_sRGB\");null!=u&&(this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:u.SRGB_EXT,SRGB8:u.SRGB_ALPHA_EXT,SRGB8_ALPHA8:u.SRGB_ALPHA_EXT})}if(this._creationOptions){var h=this._creationOptions.forceSRGBBufferSupportState;void 0!==h&&(this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&h)}}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var d=0;d<this._maxSimultaneousTextures;d++)this._nextFreeTextureSlots.push(d);\"Mali-G72\"===this._glRenderer&&(this._caps.disableMorphTargetTexture=!0)},t.prototype._initFeatures=function(){this._features={forceBitmapOverHTMLImageElement:\"undefined\"==typeof HTMLImageElement,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportIBLShadows:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,forceVertexBufferStrideAndOffsetMultiple4Bytes:!1,_checkNonFloatVertexBuffersDontRecreatePipelineContext:!1,_collectUbosUpdatedInFrame:!1}},Object.defineProperty(t.prototype,\"webGLVersion\",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return\"ThinEngine\"},t.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=this.createCanvas(1,1);var e=this._workingCanvas.getContext(\"2d\");e&&(this._workingContext=e)}},t.prototype.getInfo=function(){return this.getGlInfo()},t.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},t.prototype.extractDriverInfo=function(){var e=this.getGlInfo();return e&&e.renderer?e.renderer:\"\"},t.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth},t.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight},t.prototype.clear=function(e,r,n,i){var o,a;void 0===i&&(i=!1);var s=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=s;var l=0;if(r&&e){var c=!0;if(this._currentRenderTarget){var u=null===(o=this._currentRenderTarget.texture)||void 0===o?void 0:o.format;if(u===f.Y.TEXTUREFORMAT_RED_INTEGER||u===f.Y.TEXTUREFORMAT_RG_INTEGER||u===f.Y.TEXTUREFORMAT_RGB_INTEGER||u===f.Y.TEXTUREFORMAT_RGBA_INTEGER){var h=null===(a=this._currentRenderTarget.texture)||void 0===a?void 0:a.type;h===f.Y.TEXTURETYPE_UNSIGNED_INTEGER||h===f.Y.TEXTURETYPE_UNSIGNED_SHORT?(t._TempClearColorUint32[0]=255*e.r,t._TempClearColorUint32[1]=255*e.g,t._TempClearColorUint32[2]=255*e.b,t._TempClearColorUint32[3]=255*e.a,this._gl.clearBufferuiv(this._gl.COLOR,0,t._TempClearColorUint32),c=!1):(t._TempClearColorInt32[0]=255*e.r,t._TempClearColorInt32[1]=255*e.g,t._TempClearColorInt32[2]=255*e.b,t._TempClearColorInt32[3]=255*e.a,this._gl.clearBufferiv(this._gl.COLOR,0,t._TempClearColorInt32),c=!1)}}c&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),l|=this._gl.COLOR_BUFFER_BIT)}n&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),l|=this._gl.DEPTH_BUFFER_BIT),i&&(this._gl.clearStencil(0),l|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(l)},t.prototype._viewport=function(e,t,r,n){e===this._viewportCached.x&&t===this._viewportCached.y&&r===this._viewportCached.z&&n===this._viewportCached.w||(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=r,this._viewportCached.w=n,this._gl.viewport(e,t,r,n))},t.prototype.endFrame=function(){e.prototype.endFrame.call(this),this._badOS&&this.flushFramebuffer()},Object.defineProperty(t.prototype,\"performanceMonitor\",{get:function(){throw new Error(\"Not Supported by ThinEngine\")},enumerable:!1,configurable:!0}),t.prototype.bindFramebuffer=function(e,t,r,n,i,o,s){var l,c,u,h,d,f;void 0===t&&(t=0),void 0===o&&(o=0),void 0===s&&(s=0);var p=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(p._framebuffer);var _=this._gl;e.isMulti||(e.is2DArray||e.is3D?(_.framebufferTextureLayer(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,null===(l=e.texture._hardwareTexture)||void 0===l?void 0:l.underlyingResource,o,s),p._currentLOD=o):e.isCube?_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(c=e.texture._hardwareTexture)||void 0===c?void 0:c.underlyingResource,o):p._currentLOD!==o&&(_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,null===(u=e.texture._hardwareTexture)||void 0===u?void 0:u.underlyingResource,o),p._currentLOD=o));var m=e._depthStencilTexture;if(m){e.is3D&&(e.texture.width===m.width&&e.texture.height===m.height&&e.texture.depth===m.depth||a.V.Warn(\"Depth/Stencil attachment for 3D target must have same dimensions as color attachment\"));var g=e._depthStencilTextureWithStencil?_.DEPTH_STENCIL_ATTACHMENT:_.DEPTH_ATTACHMENT;e.is2DArray||e.is3D?_.framebufferTextureLayer(_.FRAMEBUFFER,g,null===(h=m._hardwareTexture)||void 0===h?void 0:h.underlyingResource,o,s):e.isCube?_.framebufferTexture2D(_.FRAMEBUFFER,g,_.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(d=m._hardwareTexture)||void 0===d?void 0:d.underlyingResource,o):_.framebufferTexture2D(_.FRAMEBUFFER,g,_.TEXTURE_2D,null===(f=m._hardwareTexture)||void 0===f?void 0:f.underlyingResource,o)}p._MSAAFramebuffer&&this._bindUnboundFramebuffer(p._MSAAFramebuffer),this._cachedViewport&&!i?this.setViewport(this._cachedViewport,r,n):(r||(r=e.width,o&&(r/=Math.pow(2,o))),n||(n=e.height,o&&(n/=Math.pow(2,o))),this._viewport(0,0,r,n)),this.wipeCaches()},t.prototype.setState=function(e,t,r,n,i,o,a){var s,l;void 0===t&&(t=0),void 0===n&&(n=!1),void 0===a&&(a=0),(this._depthCullingState.cull!==e||r)&&(this._depthCullingState.cull=e);var c=null===(l=null!==(s=this.cullBackFaces)&&void 0!==s?s:i)||void 0===l||l?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==c||r)&&(this._depthCullingState.cullFace=c),this.setZOffset(t),this.setZOffsetUnits(a);var u=n?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==u||r)&&(this._depthCullingState.frontFace=u),this._stencilStateComposer.stencilMaterial=o},t.prototype._bindUnboundFramebuffer=function(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)},t.prototype._currentFrameBufferIsDefaultFrameBuffer=function(){return null===this._currentFramebuffer},t.prototype.generateMipmaps=function(e){var t=this._getTextureTarget(e);this._bindTextureDirectly(t,e,!0),this._gl.generateMipmap(t),this._bindTextureDirectly(t,null)},t.prototype.unBindFramebuffer=function(e,t,r){var n;void 0===t&&(t=!1);var i=e;this._currentRenderTarget=null;var o=this._gl;if(i._MSAAFramebuffer){if(e.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(e,t,r);o.bindFramebuffer(o.READ_FRAMEBUFFER,i._MSAAFramebuffer),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,i._framebuffer),o.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,o.COLOR_BUFFER_BIT,o.NEAREST)}!(null===(n=e.texture)||void 0===n?void 0:n.generateMipMaps)||t||e.isCube||this.generateMipmaps(e.texture),r&&(i._MSAAFramebuffer&&this._bindUnboundFramebuffer(i._framebuffer),r()),this._bindUnboundFramebuffer(null)},t.prototype.flushFramebuffer=function(){this._gl.flush()},t.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},t.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null},t.prototype.createVertexBuffer=function(e,t,r){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)},t.prototype._createVertexBuffer=function(e,t){var r=this._gl.createBuffer();if(!r)throw new Error(\"Unable to create vertex buffer\");var n=new u.A(r);return this.bindArrayBuffer(n),\"number\"!=typeof e?e instanceof Array?(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t),n.capacity=4*e.length):(this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),n.capacity=e.byteLength):(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Uint8Array(e),t),n.capacity=e),this._resetVertexBufferBinding(),n.references=1,n},t.prototype.createDynamicVertexBuffer=function(e,t){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)},t.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null},t.prototype.createIndexBuffer=function(e,t,r){var n=this._gl.createBuffer(),i=new u.A(n);if(!n)throw new Error(\"Unable to create index buffer\");this.bindIndexBuffer(i);var o=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,o,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),i.references=1,i.is32Bits=4===o.BYTES_PER_ELEMENT,i},t.prototype._normalizeIndexData=function(e){if(2===e.BYTES_PER_ELEMENT)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)},t.prototype.bindArrayBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)},t.prototype.bindUniformBlock=function(e,t,r){var n=e.program,i=this._gl.getUniformBlockIndex(n,t);this._gl.uniformBlockBinding(n,i,r)},t.prototype.bindIndexBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)},t.prototype._bindBuffer=function(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)},t.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)},t.prototype._vertexAttribPointer=function(e,t,r,n,i,o,a){var s=this._currentBufferPointers[t];if(s){var l=!1;s.active?(s.buffer!==e&&(s.buffer=e,l=!0),s.size!==r&&(s.size=r,l=!0),s.type!==n&&(s.type=n,l=!0),s.normalized!==i&&(s.normalized=i,l=!0),s.stride!==o&&(s.stride=o,l=!0),s.offset!==a&&(s.offset=a,l=!0)):(l=!0,s.active=!0,s.index=t,s.size=r,s.type=n,s.normalized=i,s.stride=o,s.offset=a,s.buffer=e),(l||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),n===this._gl.UNSIGNED_INT||n===this._gl.INT?this._gl.vertexAttribIPointer(t,r,n,o,a):this._gl.vertexAttribPointer(t,r,n,i,o,a))}},t.prototype._bindIndexBufferWithCache=function(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)},t.prototype._bindVertexBuffersAttributes=function(e,t,r){var n=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var i=0;i<n.length;i++){var o=t.getAttributeLocation(i);if(o>=0){var a=n[i],s=null;if(r&&(s=r[a]),s||(s=e[a]),!s)continue;this._gl.enableVertexAttribArray(o),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[o]=!0);var l=s.getBuffer();l&&(this._vertexAttribPointer(l,o,s.getSize(),s.type,s.normalized,s.byteStride,s.byteOffset),s.getIsInstanced()&&(this._gl.vertexAttribDivisor(o,s.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(o),this._currentInstanceBuffers.push(l))))}}},t.prototype.recordVertexArrayObject=function(e,t,r,n){var i=this._gl.createVertexArray();if(!i)throw new Error(\"Unable to create VAO\");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(i),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,r,n),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),i},t.prototype.bindVertexArrayObject=function(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)},t.prototype.bindBuffersDirectly=function(e,t,r,n,i){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i;var o=i.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var a=0,s=0;s<o;s++)if(s<r.length){var l=i.getAttributeLocation(s);l>=0&&(this._gl.enableVertexAttribArray(l),this._vertexAttribArraysEnabled[l]=!0,this._vertexAttribPointer(e,l,r[s],this._gl.FLOAT,!1,n,a)),a+=4*r[s]}}this._bindIndexBufferWithCache(t)},t.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))},t.prototype.bindBuffers=function(e,t,r,n){this._cachedVertexBuffers===e&&this._cachedEffectForVertexBuffers===r||(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=r,this._bindVertexBuffersAttributes(e,r,n)),this._bindIndexBufferWithCache(t)},t.prototype.unbindInstanceAttributes=function(){for(var e,t=0,r=this._currentInstanceLocations.length;t<r;t++){var n=this._currentInstanceBuffers[t];e!=n&&n.references&&(e=n,this.bindArrayBuffer(n));var i=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(i,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},t.prototype.releaseVertexArrayObject=function(e){this._gl.deleteVertexArray(e)},t.prototype._releaseBuffer=function(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)},t.prototype._deleteBuffer=function(e){this._gl.deleteBuffer(e.underlyingResource)},t.prototype.updateAndBindInstancesBuffer=function(e,t,r){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==r[0].index)this.bindInstancesBuffer(e,r,!0);else for(var n=0;n<4;n++){var i=r[n];this._vertexAttribArraysEnabled[i]||(this._gl.enableVertexAttribArray(i),this._vertexAttribArraysEnabled[i]=!0),this._vertexAttribPointer(e,i,4,this._gl.FLOAT,!1,64,16*n),this._gl.vertexAttribDivisor(i,1),this._currentInstanceLocations.push(i),this._currentInstanceBuffers.push(e)}},t.prototype.bindInstancesBuffer=function(e,t,r){void 0===r&&(r=!0),this.bindArrayBuffer(e);var n=0;if(r)for(var i=0;i<t.length;i++)n+=4*(o=t[i]).attributeSize;for(i=0;i<t.length;i++){var o;void 0===(o=t[i]).index&&(o.index=this._currentEffect.getAttributeLocationByName(o.attributeName)),o.index<0||(this._vertexAttribArraysEnabled[o.index]||(this._gl.enableVertexAttribArray(o.index),this._vertexAttribArraysEnabled[o.index]=!0),this._vertexAttribPointer(e,o.index,o.attributeSize,o.attributeType||this._gl.FLOAT,o.normalized||!1,n,o.offset),this._gl.vertexAttribDivisor(o.index,void 0===o.divisor?1:o.divisor),this._currentInstanceLocations.push(o.index),this._currentInstanceBuffers.push(e))}},t.prototype.disableInstanceAttributeByName=function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}},t.prototype.disableInstanceAttribute=function(e){for(var t,r=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),r=!0,t=this._currentInstanceLocations.indexOf(e);r&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))},t.prototype.disableAttributeByIndex=function(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1},t.prototype.draw=function(e,t,r,n){this.drawElementsType(e?f.Y.MATERIAL_TriangleFillMode:f.Y.MATERIAL_WireFrameFillMode,t,r,n)},t.prototype.drawPointClouds=function(e,t,r){this.drawArraysType(f.Y.MATERIAL_PointFillMode,e,t,r)},t.prototype.drawUnIndexed=function(e,t,r,n){this.drawArraysType(e?f.Y.MATERIAL_TriangleFillMode:f.Y.MATERIAL_WireFrameFillMode,t,r,n)},t.prototype.drawElementsType=function(e,t,r,n){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e),o=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,a=this._uintIndicesCurrentlySet?4:2;n?this._gl.drawElementsInstanced(i,r,o,t*a,n):this._gl.drawElements(i,r,o,t*a)},t.prototype.drawArraysType=function(e,t,r,n){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e);n?this._gl.drawArraysInstanced(i,t,r,n):this._gl.drawArrays(i,t,r)},t.prototype._drawMode=function(e){switch(e){case f.Y.MATERIAL_TriangleFillMode:return this._gl.TRIANGLES;case f.Y.MATERIAL_PointFillMode:return this._gl.POINTS;case f.Y.MATERIAL_WireFrameFillMode:return this._gl.LINES;case f.Y.MATERIAL_PointListDrawMode:return this._gl.POINTS;case f.Y.MATERIAL_LineListDrawMode:return this._gl.LINES;case f.Y.MATERIAL_LineLoopDrawMode:return this._gl.LINE_LOOP;case f.Y.MATERIAL_LineStripDrawMode:return this._gl.LINE_STRIP;case f.Y.MATERIAL_TriangleStripDrawMode:return this._gl.TRIANGLE_STRIP;case f.Y.MATERIAL_TriangleFanDrawMode:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}},t.prototype._releaseEffect=function(e){this._compiledEffects[e._key]&&delete this._compiledEffects[e._key];var t=e.getPipelineContext();t&&this._deletePipelineContext(t)},t.prototype._deletePipelineContext=function(e){var t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,(0,v.mO)(t),this._gl.deleteProgram(t.program))},t.prototype._getGlobalDefines=function(e){return(0,g.xt)(e,this.isNDCHalfZRange,this.useReverseDepthBuffer,this.useExactSrgbConversions)},t.prototype.createEffect=function(e,t,r,n,o,a,s,l,c,u,h){var d,f,p;void 0===u&&(u=0);var _=\"string\"==typeof e?e:e.vertexToken||e.vertexSource||e.vertexElement||e.vertex,g=\"string\"==typeof e?e:e.fragmentToken||e.fragmentSource||e.fragmentElement||e.fragment,v=this._getGlobalDefines(),y=null!==(d=null!=o?o:t.defines)&&void 0!==d?d:\"\";v&&(y+=v);var b=_+\"+\"+g+\"@\"+y;if(this._compiledEffects[b]){var S=this._compiledEffects[b];return s&&S.isReady()&&s(S),S._refCount++,S}this._gl&&(0,i.N5)(this._gl);var T=new m.M(e,t,r,n,this,o,a,s,l,c,b,null!==(f=t.shaderLanguage)&&void 0!==f?f:u,null!==(p=t.extraInitializationsAsync)&&void 0!==p?p:h);return this._compiledEffects[b]=T,T},t.prototype._getShaderSource=function(e){return this._gl.getShaderSource(e)},t.prototype.createRawShaderProgram=function(e,t,r,n,o){void 0===o&&(o=null);var a=(0,i.N5)(this._gl);return a._contextWasLost=this._contextWasLost,a.validateShaderPrograms=this.validateShaderPrograms,(0,i.kf)(e,t,r,n||this._gl,o)},t.prototype.createShaderProgram=function(e,t,r,n,o,a){void 0===a&&(a=null);var s=(0,i.N5)(this._gl);return s._contextWasLost=this._contextWasLost,s.validateShaderPrograms=this.validateShaderPrograms,(0,i.EX)(e,t,r,n,o||this._gl,a)},t.prototype.inlineShaderCode=function(e){return e},t.prototype.createPipelineContext=function(e){this._gl&&((0,i.N5)(this._gl).parallelShaderCompile=this._caps.parallelShaderCompile);var t=(0,i.GX)(this._gl,e);return t.engine=this,t},t.prototype.createMaterialContext=function(){},t.prototype.createDrawContext=function(){},t.prototype._finalizePipelineContext=function(e){return(0,i.tg)(e,this._gl,this.validateShaderPrograms)},t.prototype._preparePipelineContext=function(e,t,r,n,o,a,s,l,c,u,h){var d=(0,i.N5)(this._gl);return d._contextWasLost=this._contextWasLost,d.validateShaderPrograms=this.validateShaderPrograms,d._createShaderProgramInjection=this._createShaderProgram.bind(this),d.createRawShaderProgramInjection=this.createRawShaderProgram.bind(this),d.createShaderProgramInjection=this.createShaderProgram.bind(this),d.loadFileInjection=this._loadFile.bind(this),(0,i.YM)(e,t,r,n,o,a,s,l,c,u,h)},t.prototype._createShaderProgram=function(e,t,r,n,o){return void 0===o&&(o=null),(0,i.tI)(e,t,r,n,o)},t.prototype._isRenderingStateCompiled=function(e){var t=e;return!(this._isDisposed||t._isDisposed||!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)||(this._finalizePipelineContext(t),0))},t.prototype._executeWhenRenderingStateIsCompiled=function(e,t){(0,i.bS)(e,t)},t.prototype.getUniforms=function(e,t){for(var r=new Array,n=e,i=0;i<t.length;i++)r.push(this._gl.getUniformLocation(n.program,t[i]));return r},t.prototype.getAttributes=function(e,t){for(var r=[],n=e,i=0;i<t.length;i++)try{r.push(this._gl.getAttribLocation(n.program,t[i]))}catch(e){r.push(-1)}return r},t.prototype.enableEffect=function(e){(e=null!==e&&(0,o.E)(e)?e.effect:e)&&e!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))},t.prototype.setInt=function(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)},t.prototype.setInt2=function(e,t,r){return!!e&&(this._gl.uniform2i(e,t,r),!0)},t.prototype.setInt3=function(e,t,r,n){return!!e&&(this._gl.uniform3i(e,t,r,n),!0)},t.prototype.setInt4=function(e,t,r,n,i){return!!e&&(this._gl.uniform4i(e,t,r,n,i),!0)},t.prototype.setIntArray=function(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)},t.prototype.setIntArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2iv(e,t),0))},t.prototype.setIntArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3iv(e,t),0))},t.prototype.setIntArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4iv(e,t),0))},t.prototype.setUInt=function(e,t){return!!e&&(this._gl.uniform1ui(e,t),!0)},t.prototype.setUInt2=function(e,t,r){return!!e&&(this._gl.uniform2ui(e,t,r),!0)},t.prototype.setUInt3=function(e,t,r,n){return!!e&&(this._gl.uniform3ui(e,t,r,n),!0)},t.prototype.setUInt4=function(e,t,r,n,i){return!!e&&(this._gl.uniform4ui(e,t,r,n,i),!0)},t.prototype.setUIntArray=function(e,t){return!!e&&(this._gl.uniform1uiv(e,t),!0)},t.prototype.setUIntArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2uiv(e,t),0))},t.prototype.setUIntArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3uiv(e,t),0))},t.prototype.setUIntArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4uiv(e,t),0))},t.prototype.setArray=function(e,t){return!(!e||t.length<1||(this._gl.uniform1fv(e,t),0))},t.prototype.setArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2fv(e,t),0))},t.prototype.setArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3fv(e,t),0))},t.prototype.setArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4fv(e,t),0))},t.prototype.setMatrices=function(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)},t.prototype.setMatrix3x3=function(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)},t.prototype.setMatrix2x2=function(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)},t.prototype.setFloat=function(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)},t.prototype.setFloat2=function(e,t,r){return!!e&&(this._gl.uniform2f(e,t,r),!0)},t.prototype.setFloat3=function(e,t,r,n){return!!e&&(this._gl.uniform3f(e,t,r,n),!0)},t.prototype.setFloat4=function(e,t,r,n,i){return!!e&&(this._gl.uniform4f(e,t,r,n,i),!0)},t.prototype.applyStates=function(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}},t.prototype.wipeCaches=function(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=f.Y.ALPHA_ADD,this._alphaEquation=f.Y.ALPHA_DISABLE,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))},t.prototype._getSamplingParameters=function(e,t){var r=this._gl,n=r.NEAREST,i=r.NEAREST;switch(e){case f.Y.TEXTURE_LINEAR_LINEAR_MIPNEAREST:n=r.LINEAR,i=t?r.LINEAR_MIPMAP_NEAREST:r.LINEAR;break;case f.Y.TEXTURE_LINEAR_LINEAR_MIPLINEAR:n=r.LINEAR,i=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;break;case f.Y.TEXTURE_NEAREST_NEAREST_MIPLINEAR:n=r.NEAREST,i=t?r.NEAREST_MIPMAP_LINEAR:r.NEAREST;break;case f.Y.TEXTURE_NEAREST_NEAREST_MIPNEAREST:n=r.NEAREST,i=t?r.NEAREST_MIPMAP_NEAREST:r.NEAREST;break;case f.Y.TEXTURE_NEAREST_LINEAR_MIPNEAREST:n=r.NEAREST,i=t?r.LINEAR_MIPMAP_NEAREST:r.LINEAR;break;case f.Y.TEXTURE_NEAREST_LINEAR_MIPLINEAR:n=r.NEAREST,i=t?r.LINEAR_MIPMAP_LINEAR:r.LINEAR;break;case f.Y.TEXTURE_NEAREST_LINEAR:n=r.NEAREST,i=r.LINEAR;break;case f.Y.TEXTURE_NEAREST_NEAREST:n=r.NEAREST,i=r.NEAREST;break;case f.Y.TEXTURE_LINEAR_NEAREST_MIPNEAREST:n=r.LINEAR,i=t?r.NEAREST_MIPMAP_NEAREST:r.NEAREST;break;case f.Y.TEXTURE_LINEAR_NEAREST_MIPLINEAR:n=r.LINEAR,i=t?r.NEAREST_MIPMAP_LINEAR:r.NEAREST;break;case f.Y.TEXTURE_LINEAR_LINEAR:n=r.LINEAR,i=r.LINEAR;break;case f.Y.TEXTURE_LINEAR_NEAREST:n=r.LINEAR,i=r.NEAREST}return{min:i,mag:n}},t.prototype._createTexture=function(){var e=this._gl.createTexture();if(!e)throw new Error(\"Unable to create texture\");return e},t.prototype._createHardwareTexture=function(){return new p.d(this._createTexture(),this._gl)},t.prototype._createInternalTexture=function(e,t,r,n){var i;void 0===r&&(r=!0),void 0===n&&(n=0);var o,s=!1,l=f.Y.TEXTURETYPE_UNSIGNED_INT,c=f.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,u=f.Y.TEXTUREFORMAT_RGBA,h=!1,d=1;void 0!==t&&\"object\"==typeof t?(s=!!t.generateMipMaps,l=void 0===t.type?f.Y.TEXTURETYPE_UNSIGNED_INT:t.type,c=void 0===t.samplingMode?f.Y.TEXTURE_TRILINEAR_SAMPLINGMODE:t.samplingMode,u=void 0===t.format?f.Y.TEXTUREFORMAT_RGBA:t.format,h=void 0!==t.useSRGBBuffer&&t.useSRGBBuffer,d=null!==(i=t.samples)&&void 0!==i?i:1,o=t.label):s=!!t,h&&(h=this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU)),(l!==f.Y.TEXTURETYPE_FLOAT||this._caps.textureFloatLinearFiltering)&&(l!==f.Y.TEXTURETYPE_HALF_FLOAT||this._caps.textureHalfFloatLinearFiltering)||(c=f.Y.TEXTURE_NEAREST_SAMPLINGMODE),l!==f.Y.TEXTURETYPE_FLOAT||this._caps.textureFloat||(l=f.Y.TEXTURETYPE_UNSIGNED_INT,a.V.Warn(\"Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE\"));var p=this._gl,m=new _.h(this,n),g=e.width||e,v=e.height||e,y=e.depth||0,b=e.layers||0,S=this._getSamplingParameters(c,s),T=0!==b?p.TEXTURE_2D_ARRAY:0!==y?p.TEXTURE_3D:p.TEXTURE_2D,E=this._getRGBABufferInternalSizedFormat(l,u,h),x=this._getInternalFormat(u),P=this._getWebGLTextureType(l);return this._bindTextureDirectly(T,m),0!==b?(m.is2DArray=!0,p.texImage3D(T,0,E,g,v,b,0,x,P,null)):0!==y?(m.is3D=!0,p.texImage3D(T,0,E,g,v,y,0,x,P,null)):p.texImage2D(T,0,E,g,v,0,x,P,null),p.texParameteri(T,p.TEXTURE_MAG_FILTER,S.mag),p.texParameteri(T,p.TEXTURE_MIN_FILTER,S.min),p.texParameteri(T,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(T,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),s&&this._gl.generateMipmap(T),this._bindTextureDirectly(T,null),m._useSRGBBuffer=h,m.baseWidth=g,m.baseHeight=v,m.width=g,m.height=v,m.depth=b,m.isReady=!0,m.samples=d,m.generateMipMaps=s,m.samplingMode=c,m.type=l,m.format=u,m.label=o,this._internalTexturesCache.push(m),m},t.prototype._getUseSRGBBuffer=function(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||t)},t.prototype.createTexture=function(e,t,r,i,o,a,s,l,c,u,h,d,p,m,g){var v=this;return void 0===o&&(o=f.Y.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=null),void 0===u&&(u=null),void 0===h&&(h=null),this._createTextureBase(e,t,r,i,o,a,s,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return v._prepareWebGLTexture.apply(v,(0,n.fX)((0,n.fX)([],e,!1),[u],!1))}),(function(e,t,r,n,o,a){var s=v._gl,l=r.width===e&&r.height===t;o._creationFlags=null!=m?m:0;var c=v._getTexImageParametersForCreateTexture(o.format,o._useSRGBBuffer);if(l)return s.texImage2D(s.TEXTURE_2D,0,c.internalFormat,c.format,c.type,r),!1;var u=v._caps.maxTextureSize;if(r.width>u||r.height>u||!v._supportsHardwareTextureRescaling)return v._prepareWorkingCanvas(),!(!v._workingCanvas||!v._workingContext||(v._workingCanvas.width=e,v._workingCanvas.height=t,v._workingContext.drawImage(r,0,0,r.width,r.height,0,0,e,t),s.texImage2D(s.TEXTURE_2D,0,c.internalFormat,c.format,c.type,v._workingCanvas),o.width=e,o.height=t,1));var h=new _.h(v,2);return v._bindTextureDirectly(s.TEXTURE_2D,h,!0),s.texImage2D(s.TEXTURE_2D,0,c.internalFormat,c.format,c.type,r),v._rescaleTexture(h,o,i,c.format,(function(){v._releaseTexture(h),v._bindTextureDirectly(s.TEXTURE_2D,o,!0),a()})),!0}),l,c,u,h,d,p,g)},t.prototype._getTexImageParametersForCreateTexture=function(e,t){var r,n;return 1===this.webGLVersion?n=r=this._getInternalFormat(e,t):(r=this._getInternalFormat(e,!1),n=this._getRGBABufferInternalSizedFormat(f.Y.TEXTURETYPE_UNSIGNED_BYTE,e,t)),{internalFormat:n,format:r,type:this._gl.UNSIGNED_BYTE}},t.prototype._rescaleTexture=function(e,t,r,n,i){},t.prototype._unpackFlipY=function(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))},t.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)},t.prototype._getTextureTarget=function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D},t.prototype.updateTextureSamplingMode=function(e,t,r){void 0===r&&(r=!1);var n=this._getTextureTarget(t),i=this._getSamplingParameters(e,t.useMipMaps||r);this._setTextureParameterInteger(n,this._gl.TEXTURE_MAG_FILTER,i.mag,t),this._setTextureParameterInteger(n,this._gl.TEXTURE_MIN_FILTER,i.min),r&&(t.generateMipMaps=!0,this._gl.generateMipmap(n)),this._bindTextureDirectly(n,null),t.samplingMode=e},t.prototype.updateTextureDimensions=function(e,t,r,n){void 0===n&&(n=1)},t.prototype.updateTextureWrappingMode=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==r&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(r),e),e._cachedWrapV=r),(e.is2DArray||e.is3D)&&null!==n&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(n),e),e._cachedWrapR=n),this._bindTextureDirectly(i,null)},t.prototype._uploadCompressedDataToTextureDirectly=function(e,t,r,n,i,o,a){void 0===o&&(o=0),void 0===a&&(a=0);var s=this._gl,l=s.TEXTURE_2D;if(e.isCube&&(l=s.TEXTURE_CUBE_MAP_POSITIVE_X+o),e._useSRGBBuffer)switch(t){case f.Y.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2:case f.Y.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL:this._caps.etc2?t=s.COMPRESSED_SRGB8_ETC2:e._useSRGBBuffer=!1;break;case f.Y.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC:this._caps.etc2?t=s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:e._useSRGBBuffer=!1;break;case f.Y.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM:t=s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case f.Y.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4:t=s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case f.Y.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case f.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case f.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(l,a,t,r,n,0,i)},t.prototype._uploadDataToTextureDirectly=function(e,t,r,n,i,o){void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=!1);var a=this._gl,s=this._getWebGLTextureType(e.type),l=this._getInternalFormat(e.format),c=void 0===i?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(i,e._useSRGBBuffer);this._unpackFlipY(e.invertY);var u=a.TEXTURE_2D;e.isCube&&(u=a.TEXTURE_CUBE_MAP_POSITIVE_X+r);var h=Math.round(Math.log(e.width)*Math.LOG2E),d=Math.round(Math.log(e.height)*Math.LOG2E),f=o?e.width:Math.pow(2,Math.max(h-n,0)),p=o?e.height:Math.pow(2,Math.max(d-n,0));a.texImage2D(u,n,c,f,p,0,l,s,t)},t.prototype.updateTextureData=function(e,t,r,n,i,o,a,s,l){void 0===a&&(a=0),void 0===s&&(s=0),void 0===l&&(l=!1);var c=this._gl,u=this._getWebGLTextureType(e.type),h=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var d=c.TEXTURE_2D,f=c.TEXTURE_2D;e.isCube&&(f=c.TEXTURE_CUBE_MAP_POSITIVE_X+a,d=c.TEXTURE_CUBE_MAP),this._bindTextureDirectly(d,e,!0),c.texSubImage2D(f,s,r,n,i,o,h,u,t),l&&this._gl.generateMipmap(f),this._bindTextureDirectly(d,null)},t.prototype._uploadArrayBufferViewToTexture=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=this._gl,o=e.isCube?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D;this._bindTextureDirectly(o,e,!0),this._uploadDataToTextureDirectly(e,t,r,n),this._bindTextureDirectly(o,null,!0)},t.prototype._prepareWebGLTextureContinuation=function(e,t,r,n,i){var o=this._gl;if(o){var a=this._getSamplingParameters(i,!r);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,a.mag),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,a.min),r||n||o.generateMipmap(o.TEXTURE_2D),this._bindTextureDirectly(o.TEXTURE_2D,null),t&&t.removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}},t.prototype._prepareWebGLTexture=function(e,t,r,n,i,o,a,s,l,c){var u=this,d=this.getCaps().maxTextureSize,p=Math.min(d,this.needPOTTextures?(0,h.R)(n.width,d):n.width),_=Math.min(d,this.needPOTTextures?(0,h.R)(n.height,d):n.height),m=this._gl;m&&(e._hardwareTexture?(this._bindTextureDirectly(m.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===i||!!i),e.baseWidth=n.width,e.baseHeight=n.height,e.width=p,e.height=_,e.isReady=!0,e.type=-1!==e.type?e.type:f.Y.TEXTURETYPE_UNSIGNED_BYTE,e.format=-1!==e.format?e.format:null!=c?c:\".jpg\"!==t||e._useSRGBBuffer?f.Y.TEXTUREFORMAT_RGBA:f.Y.TEXTUREFORMAT_RGB,s(p,_,n,t,e,(function(){u._prepareWebGLTextureContinuation(e,r,o,a,l)}))||this._prepareWebGLTextureContinuation(e,r,o,a,l)):r&&r.removePendingData(e))},t.prototype._getInternalFormatFromDepthTextureFormat=function(e,t,r){var n=this._gl;if(!t)return n.STENCIL_INDEX8;var i=r?n.DEPTH_STENCIL:n.DEPTH_COMPONENT;return this.webGLVersion>1?e===f.Y.TEXTUREFORMAT_DEPTH16?i=n.DEPTH_COMPONENT16:e===f.Y.TEXTUREFORMAT_DEPTH24?i=n.DEPTH_COMPONENT24:e===f.Y.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8||e===f.Y.TEXTUREFORMAT_DEPTH24_STENCIL8?i=r?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24:e===f.Y.TEXTUREFORMAT_DEPTH32_FLOAT?i=n.DEPTH_COMPONENT32F:e===f.Y.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8&&(i=r?n.DEPTH32F_STENCIL8:n.DEPTH_COMPONENT32F):i=n.DEPTH_COMPONENT16,i},t.prototype._setupFramebufferDepthAttachments=function(e,t,r,n,i,o){void 0===i&&(i=1);var a=this._gl;o=null!=o?o:e?f.Y.TEXTUREFORMAT_DEPTH24_STENCIL8:f.Y.TEXTUREFORMAT_DEPTH32_FLOAT;var s=this._getInternalFormatFromDepthTextureFormat(o,t,e);return e&&t?this._createRenderBuffer(r,n,i,a.DEPTH_STENCIL,s,a.DEPTH_STENCIL_ATTACHMENT):t?this._createRenderBuffer(r,n,i,s,s,a.DEPTH_ATTACHMENT):e?this._createRenderBuffer(r,n,i,s,s,a.STENCIL_ATTACHMENT):null},t.prototype._createRenderBuffer=function(e,t,r,n,i,o,a){void 0===a&&(a=!0);var s=this._gl.createRenderbuffer();return this._updateRenderBuffer(s,e,t,r,n,i,o,a)},t.prototype._updateRenderBuffer=function(e,t,r,n,i,o,a,s){void 0===s&&(s=!0);var l=this._gl;return l.bindRenderbuffer(l.RENDERBUFFER,e),n>1&&l.renderbufferStorageMultisample?l.renderbufferStorageMultisample(l.RENDERBUFFER,n,o,t,r):l.renderbufferStorage(l.RENDERBUFFER,i,t,r),l.framebufferRenderbuffer(l.FRAMEBUFFER,a,l.RENDERBUFFER,e),s&&l.bindRenderbuffer(l.RENDERBUFFER,null),e},t.prototype._releaseTexture=function(e){this._deleteTexture(e._hardwareTexture),this.unbindAllTextures();var t=this._internalTexturesCache.indexOf(e);-1!==t&&this._internalTexturesCache.splice(t,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()},t.prototype._deleteTexture=function(e){null==e||e.release()},t.prototype._setProgram=function(e){this._currentProgram!==e&&((0,i.C5)(e,this._gl),this._currentProgram=e)},t.prototype.bindSamplers=function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var r=e.getSamplers(),n=0;n<r.length;n++){var i=e.getUniform(r[n]);i&&(this._boundUniforms[n]=i)}this._currentEffect=null},t.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)},t.prototype._bindTextureDirectly=function(e,t,r,n){var i,o;void 0===r&&(r=!1),void 0===n&&(n=!1);var s=!1,l=t&&t._associatedChannel>-1;if(r&&l&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||n){if(this._activateCurrentTexture(),t&&t.isMultiview)throw a.V.Error([\"_bindTextureDirectly called with a multiview texture!\",e,t]),\"_bindTextureDirectly called with a multiview texture!\";this._gl.bindTexture(e,null!==(o=null===(i=null==t?void 0:t._hardwareTexture)||void 0===i?void 0:i.underlyingResource)&&void 0!==o?o:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else r&&(s=!0,this._activateCurrentTexture());return l&&!r&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),s},t.prototype._bindTexture=function(e,t,r){if(void 0!==e){t&&(t._associatedChannel=e),this._activeChannel=e;var n=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(n,t)}},t.prototype.unbindAllTextures=function(){for(var e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))},t.prototype.setTexture=function(e,t,r,n){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,r))},t.prototype._bindSamplerUniformToChannel=function(e,t){var r=this._boundUniforms[e];r&&r._currentState!==t&&(this._gl.uniform1i(r,t),r._currentState=t)},t.prototype._getTextureWrapMode=function(e){switch(e){case f.Y.TEXTURE_WRAP_ADDRESSMODE:return this._gl.REPEAT;case f.Y.TEXTURE_CLAMP_ADDRESSMODE:return this._gl.CLAMP_TO_EDGE;case f.Y.TEXTURE_MIRROR_ADDRESSMODE:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT},t.prototype._setTexture=function(e,t,r,n,i){if(void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=\"\"),!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video){this._activeChannel=e;var o=t.getInternalTexture();o&&(o._associatedChannel=e),t.update()}else if(t.delayLoadState===f.Y.DELAYLOADSTATE_NOTLOADED)return t.delayLoad(),!1;var a;a=n?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!r&&a&&(a._associatedChannel=e);var s=!0;this._boundTexturesCache[e]===a&&(r||this._bindSamplerUniformToChannel(a._associatedChannel,e),s=!1),this._activeChannel=e;var l=this._getTextureTarget(a);if(s&&this._bindTextureDirectly(l,a,r),a&&!a.isMultiview){if(a.isCube&&a._cachedCoordinatesMode!==t.coordinatesMode){a._cachedCoordinatesMode=t.coordinatesMode;var c=t.coordinatesMode!==f.Y.TEXTURE_CUBIC_MODE&&t.coordinatesMode!==f.Y.TEXTURE_SKYBOX_MODE?f.Y.TEXTURE_WRAP_ADDRESSMODE:f.Y.TEXTURE_CLAMP_ADDRESSMODE;t.wrapU=c,t.wrapV=c}a._cachedWrapU!==t.wrapU&&(a._cachedWrapU=t.wrapU,this._setTextureParameterInteger(l,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),a)),a._cachedWrapV!==t.wrapV&&(a._cachedWrapV=t.wrapV,this._setTextureParameterInteger(l,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),a)),a.is3D&&a._cachedWrapR!==t.wrapR&&(a._cachedWrapR=t.wrapR,this._setTextureParameterInteger(l,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),a)),this._setAnisotropicLevel(l,a,t.anisotropicFilteringLevel)}return!0},t.prototype.setTextureArray=function(e,t,r,n){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===r.length||(this._textureUnits=new Int32Array(r.length));for(var i=0;i<r.length;i++){var o=r[i].getInternalTexture();o?(this._textureUnits[i]=e+i,o._associatedChannel=e+i):this._textureUnits[i]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var a=0;a<r.length;a++)this._setTexture(this._textureUnits[a],r[a],!0)}},t.prototype._setAnisotropicLevel=function(e,t,r){var n=this._caps.textureAnisotropicFilterExtension;t.samplingMode!==f.Y.TEXTURE_LINEAR_LINEAR_MIPNEAREST&&t.samplingMode!==f.Y.TEXTURE_LINEAR_LINEAR_MIPLINEAR&&t.samplingMode!==f.Y.TEXTURE_LINEAR_LINEAR&&(r=1),n&&t._cachedAnisotropicFilteringLevel!==r&&(this._setTextureParameterFloat(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=r)},t.prototype._setTextureParameterFloat=function(e,t,r,n){this._bindTextureDirectly(e,n,!0,!0),this._gl.texParameterf(e,t,r)},t.prototype._setTextureParameterInteger=function(e,t,r,n){n&&this._bindTextureDirectly(e,n,!0,!0),this._gl.texParameteri(e,t,r)},t.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else{e=0;for(var t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}},t.prototype.releaseEffects=function(){for(var e=0,t=Object.keys(this._compiledEffects);e<t.length;e++){var r=t[e];this._compiledEffects[r].dispose()}this._compiledEffects={}},t.prototype.dispose=function(){var t;(0,s.BA)()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener(\"webglcontextlost\",this._onContextLost),this._renderingCanvas.removeEventListener(\"webglcontextrestored\",this._onContextRestored))),e.prototype.dispose.call(this),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.unbindAllAttributes(),this._boundUniforms={},this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers.length=0,this._currentProgram=null,this._creationOptions.loseContextOnDispose&&(null===(t=this._gl.getExtension(\"WEBGL_lose_context\"))||void 0===t||t.loseContext()),(0,i.Cm)(this._gl)},t.prototype.attachContextLostEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener(\"webglcontextlost\",e,!1)},t.prototype.attachContextRestoredEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener(\"webglcontextrestored\",e,!1)},t.prototype.getError=function(){return this._gl.getError()},t.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(f.Y.TEXTURETYPE_FLOAT)},t.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(f.Y.TEXTURETYPE_HALF_FLOAT)},t.prototype._canRenderToFramebuffer=function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var r=!0,n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER);if((r=(r=r&&o===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR)&&(t.clear(t.COLOR_BUFFER_BIT),r=r&&t.getError()===t.NO_ERROR),r){t.bindFramebuffer(t.FRAMEBUFFER,null);var a=t.RGBA,s=t.UNSIGNED_BYTE,l=new Uint8Array(4);t.readPixels(0,0,1,1,a,s,l),r=r&&t.getError()===t.NO_ERROR}for(t.deleteTexture(n),t.deleteFramebuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null);!r&&t.getError()!==t.NO_ERROR;);return r},t.prototype._getWebGLTextureType=function(e){if(1===this._webGLVersion){switch(e){case f.Y.TEXTURETYPE_FLOAT:return this._gl.FLOAT;case f.Y.TEXTURETYPE_HALF_FLOAT:return this._gl.HALF_FLOAT_OES;case f.Y.TEXTURETYPE_UNSIGNED_BYTE:return this._gl.UNSIGNED_BYTE;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:return this._gl.UNSIGNED_SHORT_4_4_4_4;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:return this._gl.UNSIGNED_SHORT_5_5_5_1;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case f.Y.TEXTURETYPE_BYTE:return this._gl.BYTE;case f.Y.TEXTURETYPE_UNSIGNED_BYTE:return this._gl.UNSIGNED_BYTE;case f.Y.TEXTURETYPE_SHORT:return this._gl.SHORT;case f.Y.TEXTURETYPE_UNSIGNED_SHORT:return this._gl.UNSIGNED_SHORT;case f.Y.TEXTURETYPE_INT:return this._gl.INT;case f.Y.TEXTURETYPE_UNSIGNED_INTEGER:return this._gl.UNSIGNED_INT;case f.Y.TEXTURETYPE_FLOAT:return this._gl.FLOAT;case f.Y.TEXTURETYPE_HALF_FLOAT:return this._gl.HALF_FLOAT;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:return this._gl.UNSIGNED_SHORT_4_4_4_4;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:return this._gl.UNSIGNED_SHORT_5_5_5_1;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:return this._gl.UNSIGNED_SHORT_5_6_5;case f.Y.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case f.Y.TEXTURETYPE_UNSIGNED_INT_24_8:return this._gl.UNSIGNED_INT_24_8;case f.Y.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case f.Y.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case f.Y.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE},t.prototype._getInternalFormat=function(e,t){void 0===t&&(t=!1);var r=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case f.Y.TEXTUREFORMAT_ALPHA:r=this._gl.ALPHA;break;case f.Y.TEXTUREFORMAT_LUMINANCE:r=this._gl.LUMINANCE;break;case f.Y.TEXTUREFORMAT_LUMINANCE_ALPHA:r=this._gl.LUMINANCE_ALPHA;break;case f.Y.TEXTUREFORMAT_RED:r=this._gl.RED;break;case f.Y.TEXTUREFORMAT_RG:r=this._gl.RG;break;case f.Y.TEXTUREFORMAT_RGB:r=t?this._glSRGBExtensionValues.SRGB:this._gl.RGB;break;case f.Y.TEXTUREFORMAT_RGBA:r=t?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case f.Y.TEXTUREFORMAT_RED_INTEGER:r=this._gl.RED_INTEGER;break;case f.Y.TEXTUREFORMAT_RG_INTEGER:r=this._gl.RG_INTEGER;break;case f.Y.TEXTUREFORMAT_RGB_INTEGER:r=this._gl.RGB_INTEGER;break;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:r=this._gl.RGBA_INTEGER}return r},t.prototype._getRGBABufferInternalSizedFormat=function(e,t,r){if(void 0===r&&(r=!1),1===this._webGLVersion){if(void 0!==t)switch(t){case f.Y.TEXTUREFORMAT_ALPHA:return this._gl.ALPHA;case f.Y.TEXTUREFORMAT_LUMINANCE:return this._gl.LUMINANCE;case f.Y.TEXTUREFORMAT_LUMINANCE_ALPHA:return this._gl.LUMINANCE_ALPHA;case f.Y.TEXTUREFORMAT_RGB:return r?this._glSRGBExtensionValues.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case f.Y.TEXTURETYPE_BYTE:switch(t){case f.Y.TEXTUREFORMAT_RED:return this._gl.R8_SNORM;case f.Y.TEXTUREFORMAT_RG:return this._gl.RG8_SNORM;case f.Y.TEXTUREFORMAT_RGB:return this._gl.RGB8_SNORM;case f.Y.TEXTUREFORMAT_RED_INTEGER:return this._gl.R8I;case f.Y.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG8I;case f.Y.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB8I;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case f.Y.TEXTURETYPE_UNSIGNED_BYTE:switch(t){case f.Y.TEXTUREFORMAT_RED:return this._gl.R8;case f.Y.TEXTUREFORMAT_RG:return this._gl.RG8;case f.Y.TEXTUREFORMAT_RGB:return r?this._glSRGBExtensionValues.SRGB8:this._gl.RGB8;case f.Y.TEXTUREFORMAT_RGBA:return r?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8;case f.Y.TEXTUREFORMAT_RED_INTEGER:return this._gl.R8UI;case f.Y.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG8UI;case f.Y.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB8UI;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:return this._gl.RGBA8UI;case f.Y.TEXTUREFORMAT_ALPHA:return this._gl.ALPHA;case f.Y.TEXTUREFORMAT_LUMINANCE:return this._gl.LUMINANCE;case f.Y.TEXTUREFORMAT_LUMINANCE_ALPHA:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case f.Y.TEXTURETYPE_SHORT:switch(t){case f.Y.TEXTUREFORMAT_RED_INTEGER:return this._gl.R16I;case f.Y.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG16I;case f.Y.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB16I;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA16I}case f.Y.TEXTURETYPE_UNSIGNED_SHORT:switch(t){case f.Y.TEXTUREFORMAT_RED_INTEGER:return this._gl.R16UI;case f.Y.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG16UI;case f.Y.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB16UI;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA16UI}case f.Y.TEXTURETYPE_INT:switch(t){case f.Y.TEXTUREFORMAT_RED_INTEGER:return this._gl.R32I;case f.Y.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG32I;case f.Y.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB32I;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA32I}case f.Y.TEXTURETYPE_UNSIGNED_INTEGER:switch(t){case f.Y.TEXTUREFORMAT_RED_INTEGER:return this._gl.R32UI;case f.Y.TEXTUREFORMAT_RG_INTEGER:return this._gl.RG32UI;case f.Y.TEXTUREFORMAT_RGB_INTEGER:return this._gl.RGB32UI;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:default:return this._gl.RGBA32UI}case f.Y.TEXTURETYPE_FLOAT:switch(t){case f.Y.TEXTUREFORMAT_RED:return this._gl.R32F;case f.Y.TEXTUREFORMAT_RG:return this._gl.RG32F;case f.Y.TEXTUREFORMAT_RGB:return this._gl.RGB32F;case f.Y.TEXTUREFORMAT_RGBA:default:return this._gl.RGBA32F}case f.Y.TEXTURETYPE_HALF_FLOAT:switch(t){case f.Y.TEXTUREFORMAT_RED:return this._gl.R16F;case f.Y.TEXTUREFORMAT_RG:return this._gl.RG16F;case f.Y.TEXTUREFORMAT_RGB:return this._gl.RGB16F;case f.Y.TEXTUREFORMAT_RGBA:default:return this._gl.RGBA16F}case f.Y.TEXTURETYPE_UNSIGNED_SHORT_5_6_5:return this._gl.RGB565;case f.Y.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV:return this._gl.R11F_G11F_B10F;case f.Y.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV:return this._gl.RGB9_E5;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4:return this._gl.RGBA4;case f.Y.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1:return this._gl.RGB5_A1;case f.Y.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV:switch(t){case f.Y.TEXTUREFORMAT_RGBA:return this._gl.RGB10_A2;case f.Y.TEXTUREFORMAT_RGBA_INTEGER:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return r?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8},t.prototype.readPixels=function(e,t,r,n,i,o){void 0===i&&(i=!0),void 0===o&&(o=!0);var a=i?4:3,s=i?this._gl.RGBA:this._gl.RGB,l=new Uint8Array(n*r*a);return o&&this.flushFramebuffer(),this._gl.readPixels(e,t,r,n,s,this._gl.UNSIGNED_BYTE,l),Promise.resolve(l)},Object.defineProperty(t,\"IsSupportedAsync\",{get:function(){return Promise.resolve(this.isSupported())},enumerable:!1,configurable:!0}),Object.defineProperty(t,\"IsSupported\",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0}),t.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=d.$._CreateCanvas(1,1),t=e.getContext(\"webgl\")||e.getContext(\"experimental-webgl\");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported},Object.defineProperty(t,\"HasMajorPerformanceCaveat\",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=d.$._CreateCanvas(1,1),t=e.getContext(\"webgl\",{failIfMajorPerformanceCaveat:!0})||e.getContext(\"experimental-webgl\",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0}),t._TempClearColorUint32=new Uint32Array(4),t._TempClearColorInt32=new Int32Array(4),t.ExceptionList=[{key:\"Chrome/63.0\",capture:\"63\\\\.0\\\\.3239\\\\.(\\\\d+)\",captureConstraint:108,targets:[\"uniformBuffer\"]},{key:\"Firefox/58\",capture:null,captureConstraint:null,targets:[\"uniformBuffer\"]},{key:\"Firefox/59\",capture:null,captureConstraint:null,targets:[\"uniformBuffer\"]},{key:\"Chrome/72.+?Mobile\",capture:null,captureConstraint:null,targets:[\"vao\"]},{key:\"Chrome/73.+?Mobile\",capture:null,captureConstraint:null,targets:[\"vao\"]},{key:\"Chrome/74.+?Mobile\",capture:null,captureConstraint:null,targets:[\"vao\"]},{key:\"Mac OS.+Chrome/71\",capture:null,captureConstraint:null,targets:[\"vao\"]},{key:\"Mac OS.+Chrome/72\",capture:null,captureConstraint:null,targets:[\"vao\"]},{key:\"Mac OS.+Chrome\",capture:null,captureConstraint:null,targets:[\"uniformBuffer\"]},{key:\"Chrome/12\\\\d\\\\..+?Mobile\",capture:null,captureConstraint:null,targets:[\"uniformBuffer\"]},{key:\".*AppleWebKit.*(15.4).*Safari\",capture:null,captureConstraint:null,targets:[\"antialias\",\"maxMSAASamples\"]},{key:\".*(15.4).*AppleWebKit.*Safari\",capture:null,captureConstraint:null,targets:[\"antialias\",\"maxMSAASamples\"]}],t._ConcatenateShader=g.iL,t._IsSupported=null,t._HasMajorPerformanceCaveat=null,t}(d.$)},50712:(e,t,r)=>{var n;r.d(t,{b:()=>n,s:()=>i}),function(e){e[e.PointerMove=0]=\"PointerMove\",e[e.PointerDown=1]=\"PointerDown\",e[e.PointerUp=2]=\"PointerUp\"}(n||(n={}));var i=function(){function e(){}return e.DOM_DELTA_PIXEL=0,e.DOM_DELTA_LINE=1,e.DOM_DELTA_PAGE=2,e}()},6451:(e,t,r)=>{r.d(t,{Bu:()=>a,TB:()=>i,W0:()=>o});var n=r(78322),i=function(){function e(){}return e.KEYDOWN=1,e.KEYUP=2,e}(),o=function(e,t){this.type=e,this.event=t},a=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.type=t,n.event=r,n.skipOnKeyboardObservable=!1,n}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"skipOnPointerObservable\",{get:function(){return this.skipOnKeyboardObservable},set:function(e){this.skipOnKeyboardObservable=e},enumerable:!1,configurable:!0}),t}(o)},64391:(e,t,r)=>{r.d(t,{Vn:()=>a,Zp:()=>o,mx:()=>l,tT:()=>s});var n=r(78322),i=r(8046),o=function(){function e(){}return e.POINTERDOWN=1,e.POINTERUP=2,e.POINTERMOVE=4,e.POINTERWHEEL=8,e.POINTERPICK=16,e.POINTERTAP=32,e.POINTERDOUBLETAP=64,e}(),a=function(e,t){this.type=e,this.event=t},s=function(e){function t(t,r,n,o){var a=e.call(this,t,r)||this;return a.ray=null,a.originalPickingInfo=null,a.skipOnPointerObservable=!1,a.localPosition=new i.I9(n,o),a}return(0,n.C6)(t,e),t}(a),l=function(e){function t(t,r,n,i){void 0===i&&(i=null);var o=e.call(this,t,r)||this;return o._pickInfo=n,o._inputManager=i,o}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"pickInfo\",{get:function(){return this._pickInfo||this._generatePickInfo(),this._pickInfo},enumerable:!1,configurable:!0}),t.prototype._generatePickInfo=function(){this._inputManager&&(this._pickInfo=this._inputManager._pickMove(this.event),this._inputManager._setRayOnPointerInfo(this._pickInfo,this.event),this._inputManager=null)},t}(a)},91946:(e,t,r)=>{r.d(t,{c:()=>n});var n=function(){function e(){}return e.CompareLightsPriority=function(e,t){return e.shadowEnabled!==t.shadowEnabled?(t.shadowEnabled?1:0)-(e.shadowEnabled?1:0):t.renderPriority-e.renderPriority},e.FALLOFF_DEFAULT=0,e.FALLOFF_PHYSICAL=1,e.FALLOFF_GLTF=2,e.FALLOFF_STANDARD=3,e.LIGHTMAP_DEFAULT=0,e.LIGHTMAP_SPECULAR=1,e.LIGHTMAP_SHADOWSONLY=2,e.INTENSITYMODE_AUTOMATIC=0,e.INTENSITYMODE_LUMINOUSPOWER=1,e.INTENSITYMODE_LUMINOUSINTENSITY=2,e.INTENSITYMODE_ILLUMINANCE=3,e.INTENSITYMODE_LUMINANCE=4,e.LIGHTTYPEID_POINTLIGHT=0,e.LIGHTTYPEID_DIRECTIONALLIGHT=1,e.LIGHTTYPEID_SPOTLIGHT=2,e.LIGHTTYPEID_HEMISPHERICLIGHT=3,e}()},50919:(e,t,r)=>{r.d(t,{FG:()=>s,Kq:()=>b,ZR:()=>p,tb:()=>y});var n=r(45109),i=r(25598),o=32768,a=65535;function s(e,t){for(var r=0,n=0;n<i.Ez;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[r++]=n);for(var o=r-1;r<i.Ez;)t[r++]=0;return o}function l(e,t,r,i,o){for(;r<e;)t=t<<8|(0,n.fz)(i,o),r+=8;return{l:t>>(r-=e)&(1<<e)-1,c:t,lc:r}}function c(e,t,r,i){return{c:e=e<<8|(0,n.fz)(r,i),lc:t+=8}}function u(e,t,r,n,i,o,a,s,l){if(e==t){if(n<8){var u=c(r,n,i,o);r=u.c,n=u.lc}var h=r>>(n-=8);if(h=new Uint8Array([h])[0],s.value+h>l)return null;for(var d=a[s.value-1];h-- >0;)a[s.value++]=d}else{if(!(s.value<l))return null;a[s.value++]=e}return{c:r,lc:n}}var h=new Array(59);function d(e){return 63&e}function f(e){return e>>6}function p(e,t,r,o,a,s){var p=r.value,_=(0,n.PX)(t,r),m=(0,n.PX)(t,r);r.value+=4;var g=(0,n.PX)(t,r);if(r.value+=4,_<0||_>=i.U0||m<0||m>=i.U0)throw new Error(\"Wrong HUF_ENCSIZE\");var v=new Array(i.U0),y=new Array(i.A_);if(function(e){for(var t=0;t<i.A_;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(y),function(e,t,r,n,o,a){for(var s=t,c=0,u=0;n<=o;n++){if(s.value-t.value>r)return;var d=l(6,c,u,e,s),f=d.l;if(c=d.c,u=d.lc,a[n]=f,f==i.Hh){if(s.value-t.value>r)throw new Error(\"Error in HufUnpackEncTable\");var p=(d=l(8,c,u,e,s)).l+i.gn;if(c=d.c,u=d.lc,n+p>o+1)throw new Error(\"Error in HufUnpackEncTable\");for(;p--;)a[n++]=0;n--}else if(f>=i.LU){if(n+(p=f-i.LU+2)>o+1)throw new Error(\"Error in HufUnpackEncTable\");for(;p--;)a[n++]=0;n--}}!function(e){for(var t=0;t<=58;++t)h[t]=0;for(t=0;t<i.U0;++t)h[e[t]]+=1;var r=0;for(t=58;t>0;--t){var n=r+h[t]>>1;h[t]=r,r=n}for(t=0;t<i.U0;++t){var o=e[t];o>0&&(e[t]=o|h[o]++<<6)}}(a)}(e,r,o-(r.value-p),_,m,v),g>8*(o-(r.value-p)))throw new Error(\"Wrong hufUncompress\");!function(e,t,r,n){for(;t<=r;t++){var o=f(e[t]),a=d(e[t]);if(o>>a)throw new Error(\"Invalid table entry\");if(a>i.LK){if((u=n[o>>a-i.LK]).len)throw new Error(\"Invalid table entry\");if(u.lit++,u.p){var s=u.p;u.p=new Array(u.lit);for(var l=0;l<u.lit-1;++l)u.p[l]=s[l]}else u.p=new Array(1);u.p[u.lit-1]=t}else if(a){var c=0;for(l=1<<i.LK-a;l>0;l--){var u;if((u=n[(o<<i.LK-a)+c]).len||u.p)throw new Error(\"Invalid table entry\");u.len=a,u.lit=t,c++}}}}(v,_,m,y),function(e,t,r,n,o,a,s,l,h){for(var p=0,_=0,m=s,g=Math.trunc(n.value+(o+7)/8);n.value<g;){var v=c(p,_,r,n);for(p=v.c,_=v.lc;_>=i.LK;)if((T=t[p>>_-i.LK&i.lR]).len)_-=T.len,(E=u(T.lit,a,p,_,r,n,l,h,m))&&(p=E.c,_=E.lc);else{if(!T.p)throw new Error(\"hufDecode issues\");var y=void 0;for(y=0;y<T.lit;y++){for(var b=d(e[T.p[y]]);_<b&&n.value<g;)p=(v=c(p,_,r,n)).c,_=v.lc;if(_>=b&&f(e[T.p[y]])==(p>>_-b&(1<<b)-1)){_-=b,(E=u(T.p[y],a,p,_,r,n,l,h,m))&&(p=E.c,_=E.lc);break}}if(y==T.lit)throw new Error(\"HufDecode issues\")}}var S=8-o&7;for(p>>=S,_-=S;_>0;){var T,E;if(!(T=t[p<<i.LK-_&i.lR]).len)throw new Error(\"HufDecode issues\");_-=T.len,(E=u(T.lit,a,p,_,r,n,l,h,m))&&(p=E.c,_=E.lc)}}(v,y,e,r,g,m,s,a,{value:0})}function _(e){return 65535&e}function m(e){var t=_(e);return t>32767?t-65536:t}function g(e,t){var r=m(e),n=m(t),i=r+(1&n)+(n>>1);return{a:i,b:i-n}}function v(e,t){var r=_(e),n=_(t),i=r-(n>>1)&a;return{a:n+i-o&a,b:i}}function y(e,t,r,n,i,o,a){for(var s,l,c=a<16384,u=r>i?i:r,h=1;h<=u;)h<<=1;for(s=h>>=1,h>>=1;h>=1;){for(var d=(l=0)+o*(i-s),f=o*h,p=o*s,_=n*h,m=n*s,y=void 0,b=void 0,S=void 0,T=void 0;l<=d;l+=p){for(var E=l,x=l+n*(r-s);E<=x;E+=m){var P=E+_,C=(A=E+f)+_;c?(y=(R=g(e[E+t],e[A+t])).a,S=R.b,b=(R=g(e[P+t],e[C+t])).a,T=R.b,R=g(y,b),e[E+t]=R.a,e[P+t]=R.b,R=g(S,T),e[A+t]=R.a,e[C+t]=R.b):(y=(R=v(e[E+t],e[A+t])).a,S=R.b,b=(R=v(e[P+t],e[C+t])).a,T=R.b,R=v(y,b),e[E+t]=R.a,e[P+t]=R.b,R=v(S,T),e[A+t]=R.a,e[C+t]=R.b)}if(r&h){var A=E+f,R=void 0;y=(R=c?g(e[E+t],e[A+t]):v(e[E+t],e[A+t])).a,e[A+t]=R.b,e[E+t]=y}}if(i&h)for(E=l,x=l+n*(r-s);E<=x;E+=m)P=E+_,R=void 0,y=(R=c?g(e[E+t],e[P+t]):v(e[E+t],e[P+t])).a,e[P+t]=R.b,e[E+t]=y;s=h,h>>=1}return l}function b(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}},51289:(e,t,r)=>{function n(e){for(var t=e.byteLength,r=new Array,n=0,i=new DataView(e);t>0;){var o=i.getInt8(n++);if(o<0){t-=1+(s=-o);for(var a=0;a<s;a++)r.push(i.getUint8(n++))}else{var s=o;t-=2;var l=i.getUint8(n++);for(a=0;a<s+1;a++)r.push(l)}}return r}r.d(t,{_:()=>n})},8102:(e,t,r)=>{r.d(t,{S4:()=>s,VE:()=>c,_k:()=>u,r:()=>l,tg:()=>h});var n=r(50919),i=r(51289),o=r(45109),a=r(25598);function s(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function l(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),r=new Uint8Array((0,i._)(t)),n=new Uint8Array(r.length);return(0,o.XE)(r),(0,o.KA)(r,n),new DataView(n.buffer)}function c(e){var t=e.array.slice(e.offset.value,e.offset.value+e.size),r=fflate.unzlibSync(t),n=new Uint8Array(r.length);return(0,o.XE)(r),(0,o.KA)(r,n),new DataView(n.buffer)}function u(e){for(var t=e.array.slice(e.offset.value,e.offset.value+e.size),r=fflate.unzlibSync(t),n=e.lines*e.channels*e.width,i=1==e.type?new Uint16Array(n):new Uint32Array(n),o=0,a=0,s=new Array(4),l=0;l<e.lines;l++)for(var c=0;c<e.channels;c++){var u=0;switch(e.type){case 1:s[0]=o,s[1]=s[0]+e.width,o=s[1]+e.width;for(var h=0;h<e.width;++h)u+=r[s[0]++]<<8|r[s[1]++],i[a]=u,a++;break;case 2:for(s[0]=o,s[1]=s[0]+e.width,s[2]=s[1]+e.width,o=s[2]+e.width,h=0;h<e.width;++h)u+=r[s[0]++]<<24|r[s[1]++]<<16|r[s[2]++]<<8,i[a]=u,a++}}return new DataView(i.buffer)}function h(e){for(var t=e.viewer,r={value:e.offset.value},i=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),s=new Uint8Array(a.cQ),l=0,c=new Array(e.channels),u=0;u<e.channels;u++)c[u]={},c[u].start=l,c[u].end=c[u].start,c[u].nx=e.width,c[u].ny=e.lines,c[u].size=e.type,l+=c[u].nx*c[u].ny*c[u].size;var h=(0,o.Jn)(t,r),d=(0,o.Jn)(t,r);if(d>=a.cQ)throw new Error(\"Wrong PIZ_COMPRESSION BITMAP_SIZE\");if(h<=d)for(u=0;u<d-h+1;u++)s[u+h]=(0,o._S)(t,r);var f=new Uint16Array(a.Ez),p=(0,n.FG)(s,f),_=(0,o.PX)(t,r);for((0,n.ZR)(e.array,t,r,_,i,l),u=0;u<e.channels;++u)for(var m=c[u],g=0;g<c[u].size;++g)(0,n.tb)(i,m.start+g,m.nx,m.size,m.ny,m.nx*m.size,p);(0,n.Kq)(f,i,l);for(var v=0,y=new Uint8Array(i.buffer.byteLength),b=0;b<e.lines;b++)for(var S=0;S<e.channels;S++){var T=(m=c[S]).nx*m.size,E=new Uint8Array(i.buffer,m.end*a.JH,T*a.JH);y.set(E,v),v+=T*a.JH,m.end+=T}return new DataView(y.buffer)}},54646:(e,t,r)=>{var n;r.d(t,{V:()=>n,u:()=>i}),function(e){e[e.Float=0]=\"Float\",e[e.HalfFloat=1]=\"HalfFloat\"}(n||(n={}));var i=function(){function e(){}return e.DefaultOutputType=n.HalfFloat,e.FFLATEUrl=\"https://unpkg.com/fflate@0.8.2\",e}()},45109:(e,t,r)=>{r.d(t,{Ff:()=>_,Jn:()=>d,KA:()=>b,LD:()=>m,PX:()=>u,Sn:()=>g,T$:()=>l,XE:()=>y,_S:()=>h,cL:()=>c,fz:()=>f,he:()=>n,tB:()=>p,zX:()=>v});var n,i,o=r(48810),a=r(25598);!function(e){e[e.NO_COMPRESSION=0]=\"NO_COMPRESSION\",e[e.RLE_COMPRESSION=1]=\"RLE_COMPRESSION\",e[e.ZIPS_COMPRESSION=2]=\"ZIPS_COMPRESSION\",e[e.ZIP_COMPRESSION=3]=\"ZIP_COMPRESSION\",e[e.PIZ_COMPRESSION=4]=\"PIZ_COMPRESSION\",e[e.PXR24_COMPRESSION=5]=\"PXR24_COMPRESSION\"}(n||(n={})),function(e){e[e.INCREASING_Y=0]=\"INCREASING_Y\",e[e.DECREASING_Y=1]=\"DECREASING_Y\"}(i||(i={}));var s=function(){for(var e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),n=new Uint32Array(512),i=new Uint32Array(512),o=0;o<256;++o)(u=o-127)<-27?(n[o]=0,n[256|o]=32768,i[o]=24,i[256|o]=24):u<-14?(n[o]=1024>>-u-14,n[256|o]=1024>>-u-14|32768,i[o]=-u-1,i[256|o]=-u-1):u<=15?(n[o]=u+15<<10,n[256|o]=u+15<<10|32768,i[o]=13,i[256|o]=13):u<128?(n[o]=31744,n[256|o]=64512,i[o]=24,i[256|o]=24):(n[o]=31744,n[256|o]=64512,i[o]=13,i[256|o]=13);var a=new Uint32Array(2048),s=new Uint32Array(64),l=new Uint32Array(64);for(o=1;o<1024;++o){for(var c=o<<13,u=0;!(8388608&c);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,a[o]=c|u}for(o=1024;o<2048;++o)a[o]=939524096+(o-1024<<13);for(o=1;o<31;++o)s[o]=o<<23;for(s[31]=1199570944,s[32]=2147483648,o=33;o<63;++o)s[o]=2147483648+(o-32<<23);for(s[63]=3347054592,o=1;o<64;++o)32!==o&&(l[o]=1024);return{floatView:t,uint32View:r,baseTable:n,shiftTable:i,mantissaTable:a,exponentTable:s,offsetTable:l}}();function l(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var i=(new TextDecoder).decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function c(e,t){var r=e.getInt32(t.value,!0);return t.value+=a.b7,r}function u(e,t){var r=e.getUint32(t.value,!0);return t.value+=a.b7,r}function h(e,t){var r=e.getUint8(t.value);return t.value+=a.aN,r}function d(e,t){var r=e.getUint16(t.value,!0);return t.value+=a.JH,r}function f(e,t){var r=e[t.value];return t.value+=a.aN,r}function p(e,t){var r;return r=\"getBigInt64\"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=a.Kl,r}function _(e,t){var r=e.getFloat32(t.value,!0);return t.value+=a.Y3,r}function m(e,t){return i=1023&(r=d(e,t)),(r>>15?-1:1)*((n=(31744&r)>>10)?31===n?i?NaN:1/0:Math.pow(2,n-15)*(1+i/1024):i/1024*6103515625e-14);var r,n,i}function g(e,t){return function(e){if(Math.abs(e)>65504)throw new Error(\"Value out of range.Consider using float instead of half-float.\");e=(0,o.Clamp)(e,-65504,65504),s.floatView[0]=e;var t=s.uint32View[0],r=t>>23&511;return s.baseTable[r]+((8388607&t)>>s.shiftTable[r])}(_(e,t))}function v(e,t,r,n){switch(r){case\"string\":case\"stringvector\":case\"iccProfile\":return function(e,t,r){var n=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,n}(e.buffer,t,n);case\"chlist\":return function(e,t,r){for(var n=t.value,i=[];t.value<n+r-1;){var o=l(e.buffer,t),a=c(e,t),s=h(e,t);t.value+=3;var u=c(e,t),d=c(e,t);i.push({name:o,pixelType:a,pLinear:s,xSampling:u,ySampling:d})}return t.value+=1,i}(e,t,n);case\"chromaticities\":return function(e,t){return{redX:_(e,t),redY:_(e,t),greenX:_(e,t),greenY:_(e,t),blueX:_(e,t),blueY:_(e,t),whiteX:_(e,t),whiteY:_(e,t)}}(e,t);case\"compression\":return function(e,t){return h(e,t)}(e,t);case\"box2i\":return function(e,t){return{xMin:c(e,t),yMin:c(e,t),xMax:c(e,t),yMax:c(e,t)}}(e,t);case\"lineOrder\":return function(e,t){var r=h(e,t);return i[r]}(e,t);case\"float\":return _(e,t);case\"v2f\":return function(e,t){return[_(e,t),_(e,t)]}(e,t);case\"v3f\":return function(e,t){return[_(e,t),_(e,t),_(e,t)]}(e,t);case\"int\":return c(e,t);case\"rational\":return function(e,t){return[c(e,t),u(e,t)]}(e,t);case\"timecode\":return function(e,t){return[u(e,t),u(e,t)]}(e,t);case\"preview\":return t.value+=n,\"skipped\";default:return void(t.value+=n)}}function y(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function b(e,t){for(var r=0,n=Math.floor((e.length+1)/2),i=0,o=e.length-1;!(i>o||(t[i++]=e[r++],i>o));)t[i++]=e[n++]}},99448:(e,t,r)=>{r.d(t,{d:()=>u,u:()=>h});var n=r(78322),i=r(45109),o=r(8102),a=r(25598),s=r(81152),l=r(44957),c=r(54646);function u(e,t,r,u){return(0,n.sH)(this,void 0,void 0,(function(){var h,d,f,p,_,m,g,v,y,b,S;return(0,n.YH)(this,(function(n){switch(n.label){case 0:switch(h={size:0,viewer:t,array:new Uint8Array(t.buffer),offset:r,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,channelLineOffsets:{},scanOrder:function(){return 0},bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:function(){return 0},format:s.Y.TEXTUREFORMAT_RGBA,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0},e.compression){case i.he.NO_COMPRESSION:return[3,1];case i.he.RLE_COMPRESSION:return[3,2];case i.he.ZIPS_COMPRESSION:return[3,3];case i.he.ZIP_COMPRESSION:return[3,5];case i.he.PIZ_COMPRESSION:return[3,7];case i.he.PXR24_COMPRESSION:return[3,8]}return[3,10];case 1:return h.lines=1,h.uncompress=o.S4,[3,11];case 2:return h.lines=1,h.uncompress=o.r,[3,11];case 3:return h.lines=1,h.uncompress=o.VE,[4,l.S0.LoadScriptAsync(c.u.FFLATEUrl)];case 4:case 6:case 9:return n.sent(),[3,11];case 5:return h.lines=16,h.uncompress=o.VE,[4,l.S0.LoadScriptAsync(c.u.FFLATEUrl)];case 7:return h.lines=32,h.uncompress=o.tg,[3,11];case 8:return h.lines=16,h.uncompress=o._k,[4,l.S0.LoadScriptAsync(c.u.FFLATEUrl)];case 10:throw new Error(i.he[e.compression]+\" is unsupported\");case 11:for(h.scanlineBlockSize=h.lines,d={},f=0,p=e.channels;f<p.length;f++)switch((S=p[f]).name){case\"Y\":case\"R\":case\"G\":case\"B\":case\"A\":d[S.name]=!0,h.type=S.pixelType}if(_=!1,d.R&&d.G&&d.B)_=!d.A,h.outputChannels=4,h.decodeChannels={R:0,G:1,B:2,A:3};else{if(!d.Y)throw new Error(\"EXRLoader.parse: file contains unsupported data channels.\");h.outputChannels=1,h.decodeChannels={Y:0}}if(1===h.type)switch(u){case c.V.Float:h.getter=i.LD,h.inputSize=a.JH;break;case c.V.HalfFloat:h.getter=i.Jn,h.inputSize=a.JH}else{if(2!==h.type)throw new Error(\"Unsupported pixelType \"+h.type+\" for \"+e.compression);switch(u){case c.V.Float:h.getter=i.Ff,h.inputSize=a.Y3;break;case c.V.HalfFloat:h.getter=i.Sn,h.inputSize=a.Y3}}for(h.blockCount=h.height/h.scanlineBlockSize,m=0;m<h.blockCount;m++)(0,i.tB)(t,r);switch(g=h.width*h.height*h.outputChannels,u){case c.V.Float:h.byteArray=new Float32Array(g),h.textureType=s.Y.TEXTURETYPE_FLOAT,_&&h.byteArray.fill(1,0,g);break;case c.V.HalfFloat:h.byteArray=new Uint16Array(g),h.textureType=s.Y.TEXTURETYPE_HALF_FLOAT,_&&h.byteArray.fill(15360,0,g);break;default:throw new Error(\"Unsupported type: \"+u)}for(v=0,y=0,b=e.channels;y<b.length;y++)S=b[y],void 0!==h.decodeChannels[S.name]&&(h.channelLineOffsets[S.name]=v*h.width),v+=2*S.pixelType;return h.bytesPerLine=h.width*v,h.outLineWidth=h.width*h.outputChannels,\"INCREASING_Y\"===e.lineOrder?h.scanOrder=function(e){return e}:h.scanOrder=function(e){return h.height-1-e},4==h.outputChannels?(h.format=s.Y.TEXTUREFORMAT_RGBA,h.linearSpace=!0):(h.format=s.Y.TEXTUREFORMAT_R,h.linearSpace=!1),[2,h]}}))}))}function h(e,t,r,n){for(var a={value:0},s=0;s<e.height/e.scanlineBlockSize;s++){var l=(0,i.cL)(r,n)-t.dataWindow.yMin;e.size=(0,i.PX)(r,n),e.lines=l+e.scanlineBlockSize>e.height?e.height-l:e.scanlineBlockSize;var c=e.size<e.lines*e.bytesPerLine&&e.uncompress?e.uncompress(e):(0,o.S4)(e);n.value+=e.size;for(var u=0;u<e.scanlineBlockSize;u++){var h=s*e.scanlineBlockSize,d=u+e.scanOrder(h);if(!(d>=e.height))for(var f=u*e.bytesPerLine,p=(e.height-1-d)*e.outLineWidth,_=0;_<e.channels;_++){var m=t.channels[_].name,g=e.channelLineOffsets[m],v=e.decodeChannels[m];if(void 0!==v){a.value=f+g;for(var y=0;y<e.width;y++){var b=p+y*e.outputChannels+v;e.byteArray&&(e.byteArray[b]=e.getter(c,a))}}}}}}},95487:(e,t,r)=>{r.d(t,{V:()=>s});var n=r(78322),i=r(7164),o=r(45109),a=20000630;function s(e,t){if(e.getUint32(0,!0)!=a)throw new Error(\"Incorrect OpenEXR format\");var r=e.getUint8(4),s=e.getUint8(5),l={singleTile:!!(2&s),longName:!!(4&s),deepFormat:!!(8&s),multiPart:!!(16&s)};t.value=8;for(var c={},u=!0;u;){var h=(0,o.T$)(e.buffer,t);if(h){var d=(0,o.T$)(e.buffer,t),f=(0,o.PX)(e,t),p=(0,o.zX)(e,t,d,f);void 0===p?i.V.Warn(\"Unknown header attribute type \".concat(d,\"'.\")):c[h]=p}else u=!1}if(-5&s)throw new Error(\"Unsupported file format\");return(0,n.Cl)({version:r,spec:l},c)}},25598:(e,t,r)=>{r.d(t,{A_:()=>d,Ez:()=>l,Hh:()=>_,JH:()=>a,Kl:()=>s,LK:()=>u,LU:()=>p,U0:()=>h,Y3:()=>i,aN:()=>o,b7:()=>n,cQ:()=>c,gn:()=>m,lR:()=>f});var n=4,i=4,o=1,a=2,s=8,l=65536,c=l>>3,u=14,h=65537,d=1<<u,f=d-1,p=59,_=63,m=2+_-p},23586:(e,t,r)=>{r.r(t),r.d(t,{_BasisTextureLoader:()=>o});var n=r(82941),i=r(44957),o=(r(71974),function(){function e(){this.supportCascades=!1}return e.prototype.loadCubeData=function(e,t,r,o,a){if(!Array.isArray(e)){var s=t.getEngine().getCaps(),l={supportedCompressionFormats:{etc1:!!s.etc1,s3tc:!!s.s3tc,pvrtc:!!s.pvrtc,etc2:!!s.etc2,astc:!!s.astc,bc7:!!s.bptc}};(0,n.yk)(e,l).then((function(e){var r=e.fileInfo.images[0].levels.length>1&&t.generateMipMaps;(0,n.aB)(t,e),t.getEngine()._setCubeMapTextureParams(t,r),t.isReady=!0,t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear(),o&&o()})).catch((function(e){i.S0.Warn(\"Failed to transcode Basis file, transcoding may not be supported on this device\"),t.isReady=!0,a&&a(e)}))}},e.prototype.loadData=function(e,t,r){var o=t.getEngine().getCaps(),a={supportedCompressionFormats:{etc1:!!o.etc1,s3tc:!!o.s3tc,pvrtc:!!o.pvrtc,etc2:!!o.etc2,astc:!!o.astc,bc7:!!o.bptc}};(0,n.yk)(e,a).then((function(e){var i=e.fileInfo.images[0].levels[0],o=e.fileInfo.images[0].levels.length>1&&t.generateMipMaps;r(i.width,i.height,o,-1!==e.format,(function(){(0,n.aB)(t,e)}))})).catch((function(e){i.S0.Warn(\"Failed to transcode Basis file, transcoding may not be supported on this device\"),i.S0.Warn(\"Failed to transcode Basis file: \".concat(e)),r(0,0,!1,!1,(function(){}),!0)}))},e}())},19135:(e,t,r)=>{r.r(t),r.d(t,{_DDSTextureLoader:()=>o});var n=r(51428),i=r(49611),o=(r(71974),function(){function e(){this.supportCascades=!0}return e.prototype.loadCubeData=function(e,t,r,o){var a,s=t.getEngine(),l=!1,c=1e3;if(Array.isArray(e))for(var u=0;u<e.length;u++){var h=e[u];a=i.D.GetDDSInfo(h),t.width=a.width,t.height=a.height,l=(a.isRGB||a.isLuminance||a.mipmapCount>1)&&t.generateMipMaps,s._unpackFlipY(a.isCompressed),i.D.UploadDDSLevels(s,t,h,a,l,6,-1,u),a.isFourCC||1!==a.mipmapCount?c=a.mipmapCount-1:s.generateMipMapsForCubemap(t)}else h=e,a=i.D.GetDDSInfo(h),t.width=a.width,t.height=a.height,r&&(a.sphericalPolynomial=new n.Q),l=(a.isRGB||a.isLuminance||a.mipmapCount>1)&&t.generateMipMaps,s._unpackFlipY(a.isCompressed),i.D.UploadDDSLevels(s,t,h,a,l,6),a.isFourCC||1!==a.mipmapCount?c=a.mipmapCount-1:s.generateMipMapsForCubemap(t,!1);s._setCubeMapTextureParams(t,l,c),t.isReady=!0,t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear(),o&&o({isDDS:!0,width:t.width,info:a,data:e,texture:t})},e.prototype.loadData=function(e,t,r){var n=i.D.GetDDSInfo(e),o=(n.isRGB||n.isLuminance||n.mipmapCount>1)&&t.generateMipMaps&&Math.max(n.width,n.height)>>n.mipmapCount-1==1;r(n.width,n.height,o,n.isFourCC,(function(){i.D.UploadDDSLevels(t.getEngine(),t,e,n,o,1)}))},e}())},71545:(e,t,r)=>{r.r(t),r.d(t,{_ENVTextureLoader:()=>i});var n=r(88309),i=function(){function e(){this.supportCascades=!1}return e.prototype.loadCubeData=function(e,t,r,i,o){if(!Array.isArray(e)){var a=(0,n.cU)(e);if(a){t.width=a.width,t.height=a.width;try{(0,n.ow)(t,a),(0,n.o5)(t,e,a).then((function(){t.isReady=!0,t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear(),i&&i()}),(function(e){null==o||o(\"Can not upload environment levels\",e)}))}catch(e){null==o||o(\"Can not upload environment file\",e)}}else o&&o(\"Can not parse the environment file\",null)}},e.prototype.loadData=function(){throw\".env not supported in 2d.\"},e}()},93747:(e,t,r)=>{r.r(t),r.d(t,{_ExrTextureLoader:()=>s});var n=r(78322),i=r(95487),o=r(99448),a=r(54646),s=function(){function e(){this.supportCascades=!1}return e.prototype.loadCubeData=function(e,t,r,n,i){throw\".exr not supported in Cube.\"},e.prototype.loadData=function(e,t,r){return(0,n.sH)(this,void 0,void 0,(function(){var s,l,c,u,h,d;return(0,n.YH)(this,(function(n){switch(n.label){case 0:return s=new DataView(e.buffer),l={value:0},c=(0,i.V)(s,l),[4,(0,o.d)(c,s,l,a.u.DefaultOutputType)];case 1:return u=n.sent(),(0,o.u)(u,c,s,l),h=c.dataWindow.xMax-c.dataWindow.xMin+1,d=c.dataWindow.yMax-c.dataWindow.yMin+1,r(h,d,t.generateMipMaps,!1,(function(){var e=t.getEngine();t.format=c.format,t.type=u.textureType,t.invertY=!1,t._gammaSpace=!c.linearSpace,u.byteArray&&e._uploadDataToTextureDirectly(t,u.byteArray,0,0,void 0,!0)})),[2]}}))}))},e}()},78750:(e,t,r)=>{r.r(t),r.d(t,{_HDRTextureLoader:()=>o});var n=r(51967),i=r(81152),o=function(){function e(){this.supportCascades=!1}return e.prototype.loadCubeData=function(){throw\".env not supported in Cube.\"},e.prototype.loadData=function(e,t,r){for(var o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=(0,n.NK)(o),s=(0,n.LT)(o,a),l=a.width*a.height,c=new Float32Array(4*l),u=0;u<l;u+=1)c[4*u]=s[3*u],c[4*u+1]=s[3*u+1],c[4*u+2]=s[3*u+2],c[4*u+3]=1;r(a.width,a.height,t.generateMipMaps,!1,(function(){var e=t.getEngine();t.type=i.Y.TEXTURETYPE_FLOAT,t.format=i.Y.TEXTUREFORMAT_RGBA,t._gammaSpace=!1,e._uploadDataToTextureDirectly(t,c)}))},e}()},81867:(e,t,r)=>{r.r(t),r.d(t,{_KTXTextureLoader:()=>s});var n=r(88188),i=r(47347),o=r(7164),a=r(81152);r(71974);var s=function(){function e(){this.supportCascades=!1}return e.prototype.loadCubeData=function(e,t,r,i){if(!Array.isArray(e)){t._invertVScale=!t.invertY;var o=t.getEngine(),a=new n.H(e,6),s=a.numberOfMipmapLevels>1&&t.generateMipMaps;o._unpackFlipY(!0),a.uploadLevels(t,t.generateMipMaps),t.width=a.pixelWidth,t.height=a.pixelHeight,o._setCubeMapTextureParams(t,s,a.numberOfMipmapLevels-1),t.isReady=!0,t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear(),i&&i()}},e.prototype.loadData=function(e,t,r,s){if(n.H.IsValid(e)){t._invertVScale=!t.invertY;var l=new n.H(e,1),c=function(e){switch(e){case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT:return a.Y.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:return a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:return a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2:return a.Y.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return a.Y.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return a.Y.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:return a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4;case a.Y.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM:return a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM}return null}(l.glInternalFormat);c?(t.format=c,t._useSRGBBuffer=t.getEngine()._getUseSRGBBuffer(!0,t.generateMipMaps),t._gammaSpace=!0):t.format=l.glInternalFormat,r(l.pixelWidth,l.pixelHeight,t.generateMipMaps,!0,(function(){l.uploadLevels(t,t.generateMipMaps)}),l.isInvalid)}else i.Z.IsValid(e)?new i.Z(t.getEngine())._uploadAsync(e,t,s).then((function(){r(t.width,t.height,t.generateMipMaps,!0,(function(){}),!1)}),(function(e){o.V.Warn(\"Failed to load KTX2 texture data: \".concat(e.message)),r(0,0,!1,!1,(function(){}),!0)})):(o.V.Error(\"texture missing KTX identifier\"),r(0,0,!1,!1,(function(){}),!0))},e}()},1235:(e,t,r)=>{r.d(t,{gT:()=>s,hy:()=>a,kf:()=>o});var n=r(7164),i=new Map;function o(e,t){a(e)&&n.V.Warn(\"Extension with the name '\".concat(name,\"' already exists\")),i.set(e,t)}function a(e){return i.delete(e)}function s(e,t){\"image/ktx\"!==t&&\"image/ktx2\"!==t||(e=\".ktx\"),i.has(e)||(e.endsWith(\".dds\")&&o(\".dds\",(function(){return Promise.resolve().then(r.bind(r,19135)).then((function(e){return new e._DDSTextureLoader}))})),e.endsWith(\".basis\")&&o(\".basis\",(function(){return Promise.resolve().then(r.bind(r,23586)).then((function(e){return new e._BasisTextureLoader}))})),e.endsWith(\".env\")&&o(\".env\",(function(){return Promise.resolve().then(r.bind(r,71545)).then((function(e){return new e._ENVTextureLoader}))})),e.endsWith(\".hdr\")&&o(\".hdr\",(function(){return Promise.resolve().then(r.bind(r,78750)).then((function(e){return new e._HDRTextureLoader}))})),(e.endsWith(\".ktx\")||e.endsWith(\".ktx2\"))&&(o(\".ktx\",(function(){return Promise.resolve().then(r.bind(r,81867)).then((function(e){return new e._KTXTextureLoader}))})),o(\".ktx2\",(function(){return Promise.resolve().then(r.bind(r,81867)).then((function(e){return new e._KTXTextureLoader}))}))),e.endsWith(\".tga\")&&o(\".tga\",(function(){return Promise.resolve().then(r.bind(r,5996)).then((function(e){return new e._TGATextureLoader}))})),e.endsWith(\".exr\")&&o(\".exr\",(function(){return Promise.resolve().then(r.bind(r,93747)).then((function(e){return new e._ExrTextureLoader}))})));var n=i.get(e);return n?Promise.resolve(n(t)):null}},5996:(e,t,r)=>{r.r(t),r.d(t,{_TGATextureLoader:()=>i});var n=r(65054),i=function(){function e(){this.supportCascades=!1}return e.prototype.loadCubeData=function(){throw\".env not supported in Cube.\"},e.prototype.loadData=function(e,t,r){var i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o=(0,n.O_)(i);r(o.width,o.height,t.generateMipMaps,!1,(function(){(0,n.FA)(t,i)}))},e}()},39813:(e,t,r)=>{var n=r(75768),i=r(28081);i.t.prototype.forceSphericalPolynomialsRecompute=function(){this._texture&&(this._texture._sphericalPolynomial=null,this._texture._sphericalPolynomialPromise=null,this._texture._sphericalPolynomialComputed=!1)},Object.defineProperty(i.t.prototype,\"sphericalPolynomial\",{get:function(){var e=this;if(this._texture){if(this._texture._sphericalPolynomial||this._texture._sphericalPolynomialComputed)return this._texture._sphericalPolynomial;if(this._texture.isReady)return this._texture._sphericalPolynomialPromise||(this._texture._sphericalPolynomialPromise=n.d.ConvertCubeMapTextureToSphericalPolynomial(this),null===this._texture._sphericalPolynomialPromise?this._texture._sphericalPolynomialComputed=!0:this._texture._sphericalPolynomialPromise.then((function(t){e._texture._sphericalPolynomial=t,e._texture._sphericalPolynomialComputed=!0}))),null}return null},set:function(e){this._texture&&(this._texture._sphericalPolynomial=e)},enumerable:!0,configurable:!0})},28081:(e,t,r)=>{r.d(t,{t:()=>d});var n=r(78322),i=r(6174),o=r(66377),a=r(8046),s=r(66614),l=r(81152),c=r(23885),u=(r(17347),r(63919)),h=r(12028),d=(r(82345),function(e){function t(r,n){void 0===n&&(n=null);var i=e.call(this,null)||this;return i.metadata=null,i.reservedDataStore=null,i._hasAlpha=!1,i._getAlphaFromRGB=!1,i.level=1,i._coordinatesIndex=0,i.optimizeUVAllocation=!0,i._coordinatesMode=l.Y.TEXTURE_EXPLICIT_MODE,i.wrapR=l.Y.TEXTURE_WRAP_ADDRESSMODE,i.anisotropicFilteringLevel=t.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,i._isCube=!1,i._gammaSpace=!0,i.invertZ=!1,i.lodLevelInAlpha=!1,i.isRenderTarget=!1,i._prefiltered=!1,i._forceSerialize=!1,i.animations=[],i.onDisposeObservable=new o.cP,i._onDisposeObserver=null,i._scene=null,i._uid=null,i._parentContainer=null,i._loadingError=!1,r?t._IsScene(r)?i._scene=r:i._engine=r:i._scene=s.q.LastCreatedScene,i._scene&&(i.uniqueId=i._scene.getUniqueId(),i._scene.addTexture(i),i._engine=i._scene.getEngine()),i._texture=n,i._uid=null,i}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"hasAlpha\",{get:function(){return this._hasAlpha},set:function(e){var t=this;this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"getAlphaFromRGB\",{get:function(){return this._getAlphaFromRGB},set:function(e){var t=this;this._getAlphaFromRGB!==e&&(this._getAlphaFromRGB=e,this._scene&&this._scene.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"coordinatesIndex\",{get:function(){return this._coordinatesIndex},set:function(e){var t=this;this._coordinatesIndex!==e&&(this._coordinatesIndex=e,this._scene&&this._scene.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"coordinatesMode\",{get:function(){return this._coordinatesMode},set:function(e){var t=this;this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"wrapU\",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"wrapV\",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"isCube\",{get:function(){return this._texture?this._texture.isCube:this._isCube},set:function(e){this._texture?this._texture.isCube=e:this._isCube=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"is3D\",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"is2DArray\",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"gammaSpace\",{get:function(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace},set:function(e){var t,r=this;if(this._texture){if(this._texture._gammaSpace===e)return;this._texture._gammaSpace=e}else{if(this._gammaSpace===e)return;this._gammaSpace=e}null===(t=this.getScene())||void 0===t||t.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(r)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"isRGBD\",{get:function(){return null!=this._texture&&this._texture._isRGBD},set:function(e){var t,r=this;e!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=e),null===(t=this.getScene())||void 0===t||t.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(r)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"noMipmap\",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"lodGenerationOffset\",{get:function(){return this._texture?this._texture._lodGenerationOffset:0},set:function(e){this._texture&&(this._texture._lodGenerationOffset=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"lodGenerationScale\",{get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(e){this._texture&&(this._texture._lodGenerationScale=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"linearSpecularLOD\",{get:function(){return!!this._texture&&this._texture._linearSpecularLOD},set:function(e){this._texture&&(this._texture._linearSpecularLOD=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"irradianceTexture\",{get:function(){return this._texture?this._texture._irradianceTexture:null},set:function(e){this._texture&&(this._texture._irradianceTexture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"uid\",{get:function(){return this._uid||(this._uid=(0,c.z)()),this._uid},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.name},t.prototype.getClassName=function(){return\"BaseTexture\"},Object.defineProperty(t.prototype,\"onDispose\",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"isBlocking\",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"loadingError\",{get:function(){return this._loadingError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"errorObject\",{get:function(){return this._errorObject},enumerable:!1,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype._getEngine=function(){return this._engine},t.prototype.getTextureMatrix=function(){return a.uq.IdentityReadOnly},t.prototype.getReflectionTextureMatrix=function(){return a.uq.IdentityReadOnly},t.prototype.getRefractionTextureMatrix=function(){return this.getReflectionTextureMatrix()},t.prototype.isReadyOrNotBlocking=function(){return!this.isBlocking||this.isReady()||this.loadingError},t.prototype.scale=function(e){},Object.defineProperty(t.prototype,\"canRescale\",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype._getFromCache=function(e,t,r,n,i,o){var a=this._getEngine();if(!a)return null;for(var s=a._getUseSRGBBuffer(!!i,t),l=a.getLoadedTexturesCache(),c=0;c<l.length;c++){var u=l[c];if(!(void 0!==i&&s!==u._useSRGBBuffer||void 0!==n&&n!==u.invertY||u.url!==e||u.generateMipMaps!==!t||r&&r!==u.samplingMode||void 0!==o&&o!==u.isCube))return u.incrementReferences(),u}return null},t.prototype._rebuild=function(e){void 0===e&&(e=!1)},t.prototype.clone=function(){return null},Object.defineProperty(t.prototype,\"textureType\",{get:function(){return this._texture&&void 0!==this._texture.type?this._texture.type:l.Y.TEXTURETYPE_UNSIGNED_INT},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"textureFormat\",{get:function(){return this._texture&&void 0!==this._texture.format?this._texture.format:l.Y.TEXTUREFORMAT_RGBA},enumerable:!1,configurable:!0}),t.prototype._markAllSubMeshesAsTexturesDirty=function(){var e=this.getScene();e&&e.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag)},t.prototype.readPixels=function(e,t,r,n,i,o,a,s,l){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=null),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=Number.MAX_VALUE),void 0===l&&(l=Number.MAX_VALUE),!this._texture)return null;var c=this._getEngine();if(!c)return null;var u=this.getSize(),h=u.width,d=u.height;0!==t&&(h/=Math.pow(2,t),d/=Math.pow(2,t),h=Math.round(h),d=Math.round(d)),s=Math.min(h,s),l=Math.min(d,l);try{return this._texture.isCube?c._readTexturePixels(this._texture,s,l,e,t,r,n,i,o,a):c._readTexturePixels(this._texture,s,l,-1,t,r,n,i,o,a)}catch(e){return null}},t.prototype._readPixelsSync=function(e,t,r,n,i){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=null),void 0===n&&(n=!0),void 0===i&&(i=!1),!this._texture)return null;var o=this.getSize(),a=o.width,s=o.height,l=this._getEngine();if(!l)return null;0!=t&&(a/=Math.pow(2,t),s/=Math.pow(2,t),a=Math.round(a),s=Math.round(s));try{return this._texture.isCube?l._readTexturePixelsSync(this._texture,a,s,e,t,r,n,i):l._readTexturePixelsSync(this._texture,a,s,-1,t,r,n,i)}catch(e){return null}},Object.defineProperty(t.prototype,\"_lodTextureHigh\",{get:function(){return this._texture?this._texture._lodTextureHigh:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_lodTextureMid\",{get:function(){return this._texture?this._texture._lodTextureMid:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_lodTextureLow\",{get:function(){return this._texture?this._texture._lodTextureLow:null},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);var t=this._scene.textures.indexOf(this);if(t>=0&&this._scene.textures.splice(t,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){var r=this._parentContainer.textures.indexOf(this);r>-1&&this._parentContainer.textures.splice(r,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,e.prototype.dispose.call(this)},t.prototype.serialize=function(e){if(void 0===e&&(e=!1),!this.name&&!e)return null;var t=h.p.Serialize(this);return h.p.AppendSerializedAnimations(this,t),t},t.WhenAllReady=function(e,t){var r=e.length;if(0!==r)for(var n=0;n<e.length;n++){var i=e[n];if(i.isReady())0==--r&&t();else{var o=i.onLoadObservable;o?o.addOnce((function(){0==--r&&t()})):0==--r&&t()}}else t()},t._IsScene=function(e){return\"Scene\"===e.getClassName()},t.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,n.Cg)([(0,i.lK)()],t.prototype,\"uniqueId\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"name\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"metadata\",void 0),(0,n.Cg)([(0,i.lK)(\"hasAlpha\")],t.prototype,\"_hasAlpha\",void 0),(0,n.Cg)([(0,i.lK)(\"getAlphaFromRGB\")],t.prototype,\"_getAlphaFromRGB\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"level\",void 0),(0,n.Cg)([(0,i.lK)(\"coordinatesIndex\")],t.prototype,\"_coordinatesIndex\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"optimizeUVAllocation\",void 0),(0,n.Cg)([(0,i.lK)(\"coordinatesMode\")],t.prototype,\"_coordinatesMode\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"wrapU\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"wrapV\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"wrapR\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"anisotropicFilteringLevel\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"isCube\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"is3D\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"is2DArray\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"gammaSpace\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"invertZ\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"lodLevelInAlpha\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"lodGenerationOffset\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"lodGenerationScale\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"linearSpecularLOD\",null),(0,n.Cg)([(0,i.uM)()],t.prototype,\"irradianceTexture\",null),(0,n.Cg)([(0,i.lK)()],t.prototype,\"isRenderTarget\",void 0),t}(u.D))},19133:(e,t,r)=>{r.d(t,{G:()=>n,h:()=>s});var n,i=r(78322),o=r(66377),a=r(55204);!function(e){e[e.Unknown=0]=\"Unknown\",e[e.Url=1]=\"Url\",e[e.Temp=2]=\"Temp\",e[e.Raw=3]=\"Raw\",e[e.Dynamic=4]=\"Dynamic\",e[e.RenderTarget=5]=\"RenderTarget\",e[e.MultiRenderTarget=6]=\"MultiRenderTarget\",e[e.Cube=7]=\"Cube\",e[e.CubeRaw=8]=\"CubeRaw\",e[e.CubePrefiltered=9]=\"CubePrefiltered\",e[e.Raw3D=10]=\"Raw3D\",e[e.Raw2DArray=11]=\"Raw2DArray\",e[e.DepthStencil=12]=\"DepthStencil\",e[e.CubeRawRGBD=13]=\"CubeRawRGBD\",e[e.Depth=14]=\"Depth\"}(n||(n={}));var s=function(e){function t(r,n,i){void 0===i&&(i=!1);var a=e.call(this)||this;return a.isReady=!1,a.isCube=!1,a.is3D=!1,a.is2DArray=!1,a.isMultiview=!1,a.url=\"\",a.generateMipMaps=!1,a.samples=0,a.type=-1,a.format=-1,a.onLoadedObservable=new o.cP,a.onErrorObservable=new o.cP,a.onRebuildCallback=null,a.width=0,a.height=0,a.depth=0,a.baseWidth=0,a.baseHeight=0,a.baseDepth=0,a.invertY=!1,a._invertVScale=!1,a._associatedChannel=-1,a._source=0,a._buffer=null,a._bufferView=null,a._bufferViewArray=null,a._bufferViewArrayArray=null,a._size=0,a._extension=\"\",a._files=null,a._workingCanvas=null,a._workingContext=null,a._cachedCoordinatesMode=null,a._isDisabled=!1,a._compression=null,a._sphericalPolynomial=null,a._sphericalPolynomialPromise=null,a._sphericalPolynomialComputed=!1,a._lodGenerationScale=0,a._lodGenerationOffset=0,a._useSRGBBuffer=!1,a._creationFlags=0,a._lodTextureHigh=null,a._lodTextureMid=null,a._lodTextureLow=null,a._isRGBD=!1,a._linearSpecularLOD=!1,a._irradianceTexture=null,a._hardwareTexture=null,a._maxLodLevel=null,a._references=1,a._gammaSpace=null,a._premulAlpha=!1,a._dynamicTextureSource=null,a._engine=r,a._source=n,a._uniqueId=t._Counter++,i||(a._hardwareTexture=r._createHardwareTexture()),a}return(0,i.C6)(t,e),Object.defineProperty(t.prototype,\"useMipMaps\",{get:function(){return this.generateMipMaps},set:function(e){this.generateMipMaps=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"uniqueId\",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0}),t.prototype._setUniqueId=function(e){this._uniqueId=e},t.prototype.getEngine=function(){return this._engine},Object.defineProperty(t.prototype,\"source\",{get:function(){return this._source},enumerable:!1,configurable:!0}),t.prototype.incrementReferences=function(){this._references++},t.prototype.updateSize=function(e,t,r){void 0===r&&(r=1),this._engine.updateTextureDimensions(this,e,t,r),this.width=e,this.height=t,this.depth=r,this.baseWidth=e,this.baseHeight=t,this.baseDepth=r,this._size=e*t*r},t.prototype._rebuild=function(){var e,t,r=this;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){var n=this.onRebuildCallback(this),i=function(e){e._swapAndDie(r,!1),r.isReady=n.isReady};n.isAsync?n.proxy.then(i):i(n.proxy)}else{var o;switch(this.source){case 2:case 12:case 14:break;case 1:return void(o=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(e){e._swapAndDie(r,!1),r.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case 3:(o=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer))._swapAndDie(this,!1),this.isReady=!0;break;case 10:(o=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case 11:(o=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case 4:(o=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:return void(o=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){o._swapAndDie(r,!1),r.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case 8:(o=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,null!==(t=this._originalFormat)&&void 0!==t?t:this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:return void((o=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(e){e&&e._swapAndDie(r,!1),r.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}}},t.prototype._swapAndDie=function(e,t){var r;void 0===t&&(t=!0),null===(r=this._hardwareTexture)||void 0===r||r.setUsage(e._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var n=this._engine.getLoadedTexturesCache(),i=n.indexOf(this);-1!==i&&n.splice(i,1),-1===(i=n.indexOf(e))&&n.push(e)},t.prototype.dispose=function(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)},t._Counter=0,t}(a.u)},54665:(e,t,r)=>{var n,i,o;r.d(t,{GQ:()=>o,Ok:()=>n,Xl:()=>i}),function(e){e[e.ETC1S=0]=\"ETC1S\",e[e.UASTC4x4=1]=\"UASTC4x4\"}(n||(n={})),function(e){e[e.ASTC_4X4_RGBA=0]=\"ASTC_4X4_RGBA\",e[e.BC7_RGBA=1]=\"BC7_RGBA\",e[e.BC3_RGBA=2]=\"BC3_RGBA\",e[e.BC1_RGB=3]=\"BC1_RGB\",e[e.PVRTC1_4_RGBA=4]=\"PVRTC1_4_RGBA\",e[e.PVRTC1_4_RGB=5]=\"PVRTC1_4_RGB\",e[e.ETC2_RGBA=6]=\"ETC2_RGBA\",e[e.ETC1_RGB=7]=\"ETC1_RGB\",e[e.RGBA32=8]=\"RGBA32\",e[e.R8=9]=\"R8\",e[e.RG8=10]=\"RG8\"}(i||(i={})),function(e){e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]=\"COMPRESSED_RGBA_BPTC_UNORM_EXT\",e[e.COMPRESSED_RGBA_ASTC_4X4_KHR=37808]=\"COMPRESSED_RGBA_ASTC_4X4_KHR\",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]=\"COMPRESSED_RGB_S3TC_DXT1_EXT\",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]=\"COMPRESSED_RGBA_S3TC_DXT5_EXT\",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]=\"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]=\"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]=\"COMPRESSED_RGBA8_ETC2_EAC\",e[e.COMPRESSED_RGB8_ETC2=37492]=\"COMPRESSED_RGB8_ETC2\",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]=\"COMPRESSED_RGB_ETC1_WEBGL\",e[e.RGBA8Format=32856]=\"RGBA8Format\",e[e.R8Format=33321]=\"R8Format\",e[e.RG8Format=33323]=\"RG8Format\"}(o||(o={}))},41085:(e,t,r)=>{r.d(t,{$:()=>f});var n=r(78322),i=r(66377),o=r(8046),a=r(50582),s=r(63639),l=r(7931),c=r(81152),u=(r(71073),r(8864),r(64838),r(11296)),h=r(24687),d=r(87074);r(74239).M.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)};var f=function(e){function t(t,r,n,s,u,h,d,f,p,_,m,g,v,y,b,S,T){void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===h&&(h=c.Y.TEXTURETYPE_UNSIGNED_INT),void 0===d&&(d=!1),void 0===f&&(f=a.g.TRILINEAR_SAMPLINGMODE),void 0===p&&(p=!0),void 0===_&&(_=!1),void 0===m&&(m=!1),void 0===g&&(g=c.Y.TEXTUREFORMAT_RGBA),void 0===v&&(v=!1),void 0===S&&(S=!1),void 0===T&&(T=!1);var E,x,P,C,A,R,I,M=this,O=void 0,D=!0;if(\"object\"==typeof s){var N=s;s=!!N.generateMipMaps,u=null===(E=N.doNotChangeAspectRatio)||void 0===E||E,h=null!==(x=N.type)&&void 0!==x?x:c.Y.TEXTURETYPE_UNSIGNED_BYTE,d=!!N.isCube,f=null!==(P=N.samplingMode)&&void 0!==P?P:a.g.TRILINEAR_SAMPLINGMODE,p=null===(C=N.generateDepthBuffer)||void 0===C||C,_=!!N.generateStencilBuffer,m=!!N.isMulti,g=null!==(A=N.format)&&void 0!==A?A:c.Y.TEXTUREFORMAT_RGBA,v=!!N.delayAllocation,y=N.samples,b=N.creationFlags,S=!!N.noColorAttachment,T=!!N.useSRGBBuffer,O=N.colorAttachment,D=null!==(R=N.gammaSpace)&&void 0!==R?R:D}if((M=e.call(this,null,n,!s,void 0,f,void 0,void 0,void 0,void 0,g)||this)._unObserveRenderList=null,M._renderListHasChanged=function(e,t){var r,n=M._renderList?M._renderList.length:0;(0===t&&n>0||0===n)&&(null===(r=M.getScene())||void 0===r||r.meshes.forEach((function(e){e._markSubMeshesAsLightDirty()})))},M.renderParticles=!0,M.renderSprites=!1,M.forceLayerMaskCheck=!1,M.ignoreCameraViewport=!1,M.onBeforeBindObservable=new i.cP,M.onAfterUnbindObservable=new i.cP,M.onBeforeRenderObservable=new i.cP,M.onAfterRenderObservable=new i.cP,M.onClearObservable=new i.cP,M.onResizeObservable=new i.cP,M._cleared=!1,M.skipInitialClear=!1,M._currentRefreshId=-1,M._refreshRate=1,M._samples=1,M._canRescale=!0,M._renderTarget=null,M.boundingBoxPosition=o.Pq.Zero(),!(n=M.getScene()))return M;var L=M.getScene().getEngine();return M._gammaSpace=D,M._coordinatesMode=a.g.PROJECTION_MODE,M.renderList=[],M.name=t,M.isRenderTarget=!0,M._initialSizeParameter=r,M._renderPassIds=[],M._isCubeData=d,M._processSizeParameter(r),M.renderPassId=M._renderPassIds[0],M._resizeObserver=L.onResizeObservable.add((function(){})),M._generateMipMaps=!!s,M._doNotChangeAspectRatio=u,M._renderingManager=new l.m(n),M._renderingManager._useSceneAutoClearSetup=!0,m||(M._renderTargetOptions={generateMipMaps:s,type:h,format:null!==(I=M._format)&&void 0!==I?I:void 0,samplingMode:M.samplingMode,generateDepthBuffer:p,generateStencilBuffer:_,samples:y,creationFlags:b,noColorAttachment:S,useSRGBBuffer:T,colorAttachment:O,label:M.name},M.samplingMode===a.g.NEAREST_SAMPLINGMODE&&(M.wrapU=a.g.CLAMP_ADDRESSMODE,M.wrapV=a.g.CLAMP_ADDRESSMODE),v||(d?(M._renderTarget=n.getEngine().createRenderTargetCubeTexture(M.getRenderSize(),M._renderTargetOptions),M.coordinatesMode=a.g.INVCUBIC_MODE,M._textureMatrix=o.uq.Identity()):M._renderTarget=n.getEngine().createRenderTargetTexture(M._size,M._renderTargetOptions),M._texture=M._renderTarget.texture,void 0!==y&&(M.samples=y))),M}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"renderList\",{get:function(){return this._renderList},set:function(e){this._unObserveRenderList&&(this._unObserveRenderList(),this._unObserveRenderList=null),e&&(this._unObserveRenderList=(0,u.lL)(e,this._renderListHasChanged)),this._renderList=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"postProcesses\",{get:function(){return this._postProcesses},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"_prePassEnabled\",{get:function(){return!!this._prePassRenderTarget&&this._prePassRenderTarget.enabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"onAfterUnbind\",{set:function(e){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"onBeforeRender\",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"onAfterRender\",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"onClear\",{set:function(e){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"renderPassIds\",{get:function(){return this._renderPassIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"currentRefreshId\",{get:function(){return this._currentRefreshId},enumerable:!1,configurable:!0}),t.prototype.setMaterialForRendering=function(e,t){var r;r=Array.isArray(e)?e:[e];for(var n=0;n<r.length;++n)for(var i=0;i<this._renderPassIds.length;++i)r[n].setMaterialForRenderPass(this._renderPassIds[i],void 0!==t?Array.isArray(t)?t[i]:t:void 0)},Object.defineProperty(t.prototype,\"isMulti\",{get:function(){var e,t;return null!==(t=null===(e=this._renderTarget)||void 0===e?void 0:e.isMulti)&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"renderTargetOptions\",{get:function(){return this._renderTargetOptions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"renderTarget\",{get:function(){return this._renderTarget},enumerable:!1,configurable:!0}),t.prototype._onRatioRescale=function(){this._sizeRatio&&this.resize(this._initialSizeParameter)},Object.defineProperty(t.prototype,\"boundingBoxSize\",{get:function(){return this._boundingBoxSize},set:function(e){if(!this._boundingBoxSize||!this._boundingBoxSize.equals(e)){this._boundingBoxSize=e;var t=this.getScene();t&&t.markAllMaterialsAsDirty(c.Y.MATERIAL_TextureDirtyFlag)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"depthStencilTexture\",{get:function(){var e,t;return null!==(t=null===(e=this._renderTarget)||void 0===e?void 0:e._depthStencilTexture)&&void 0!==t?t:null},enumerable:!1,configurable:!0}),t.prototype.createDepthStencilTexture=function(e,t,r,n,i,o){var a;void 0===e&&(e=0),void 0===t&&(t=!0),void 0===r&&(r=!1),void 0===n&&(n=1),void 0===i&&(i=c.Y.TEXTUREFORMAT_DEPTH32_FLOAT),null===(a=this._renderTarget)||void 0===a||a.createDepthStencilTexture(e,t,r,n,i,o)},t.prototype._releaseRenderPassId=function(){if(this._scene)for(var e=this._scene.getEngine(),t=0;t<this._renderPassIds.length;++t)e.releaseRenderPassId(this._renderPassIds[t]);this._renderPassIds=[]},t.prototype._createRenderPassId=function(){this._releaseRenderPassId();for(var e=this._scene.getEngine(),t=this._isCubeData?6:this.getRenderLayers()||1,r=0;r<t;++r)this._renderPassIds[r]=e.createRenderPassId(\"RenderTargetTexture - \".concat(this.name,\"#\").concat(r))},t.prototype._processSizeParameter=function(e,t){if(void 0===t&&(t=!0),e.ratio){this._sizeRatio=e.ratio;var r=this._getEngine();this._size={width:this._bestReflectionRenderTargetDimension(r.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(r.getRenderHeight(),this._sizeRatio)}}else this._size=e;t&&this._createRenderPassId()},Object.defineProperty(t.prototype,\"samples\",{get:function(){var e,t;return null!==(t=null===(e=this._renderTarget)||void 0===e?void 0:e.samples)&&void 0!==t?t:this._samples},set:function(e){this._renderTarget&&(this._samples=this._renderTarget.setSamples(e))},enumerable:!1,configurable:!0}),t.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},Object.defineProperty(t.prototype,\"refreshRate\",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!1,configurable:!0}),t.prototype.addPostProcess=function(e){if(!this._postProcessManager){var t=this.getScene();if(!t)return;this._postProcessManager=new s.X(t),this._postProcesses=new Array}this._postProcesses.push(e),this._postProcesses[0].autoClear=!1},t.prototype.clearPostProcesses=function(e){if(void 0===e&&(e=!1),this._postProcesses){if(e)for(var t=0,r=this._postProcesses;t<r.length;t++)r[t].dispose();this._postProcesses=[]}},t.prototype.removePostProcess=function(e){if(this._postProcesses){var t=this._postProcesses.indexOf(e);-1!==t&&(this._postProcesses.splice(t,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}},t.prototype._shouldRender=function(){return-1===this._currentRefreshId||this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)},t.prototype.getRenderSize=function(){return this.getRenderWidth()},t.prototype.getRenderWidth=function(){return this._size.width?this._size.width:this._size},t.prototype.getRenderHeight=function(){return this._size.width?this._size.height:this._size},t.prototype.getRenderLayers=function(){var e=this._size.layers;return e||(this._size.depth||0)},t.prototype.disableRescaling=function(){this._canRescale=!1},Object.defineProperty(t.prototype,\"canRescale\",{get:function(){return this._canRescale},enumerable:!1,configurable:!0}),t.prototype.scale=function(e){var t=Math.max(1,this.getRenderSize()*e);this.resize(t)},t.prototype.getReflectionTextureMatrix=function(){return this.isCube?this._textureMatrix:e.prototype.getReflectionTextureMatrix.call(this)},t.prototype.resize=function(e){var t,r=this.isCube;null===(t=this._renderTarget)||void 0===t||t.dispose(),this._renderTarget=null;var n=this.getScene();n&&(this._processSizeParameter(e,!1),this._renderTarget=r?n.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):n.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,void 0!==this._renderTargetOptions.samples&&(this.samples=this._renderTargetOptions.samples),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))},t.prototype.render=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this._render(e,t)},t.prototype.isReadyForRendering=function(){return this._render(!1,!1,!0)},t.prototype._render=function(e,t,r){var n;void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===r&&(r=!1);var i=this.getScene();if(!i)return r;var o=i.getEngine();if(void 0!==this.useCameraPostProcesses&&(e=this.useCameraPostProcesses),this._waitingRenderList){if(!this.renderListPredicate){this.renderList=[];for(var a=0;a<this._waitingRenderList.length;a++){var s=this._waitingRenderList[a];(u=i.getMeshById(s))&&this.renderList.push(u)}}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];var l=this.getScene();if(!l)return r;var c=l.meshes;for(a=0;a<c.length;a++){var u=c[a];this.renderListPredicate(u)&&this.renderList.push(u)}}var h=o.currentRenderPassId;this.onBeforeBindObservable.notifyObservers(this);var d=null!==(n=this.activeCamera)&&void 0!==n?n:i.activeCamera,f=i.activeCamera;d&&(d!==i.activeCamera&&(i.setTransformMatrix(d.getViewMatrix(),d.getProjectionMatrix(!0)),i.activeCamera=d),o.setViewport(d.rigParent?d.rigParent.viewport:d.viewport,this.getRenderWidth(),this.getRenderHeight())),this._defaultRenderListPrepared=!1;var p=r;if(r){i.getViewMatrix()||i.updateTransformMatrix();var _=this.is2DArray||this.is3D?this.getRenderLayers():this.isCube?6:1;for(S=0;S<_&&p;S++){var m=null,g=this.renderList?this.renderList:i.getActiveMeshes().data,v=this.renderList?this.renderList.length:i.getActiveMeshes().length;o.currentRenderPassId=this._renderPassIds[S],this.onBeforeRenderObservable.notifyObservers(S),this.getCustomRenderList&&(m=this.getCustomRenderList(S,g,v)),m||(m=g),this._doNotChangeAspectRatio||i.updateTransformMatrix(!0);for(var y=0;y<m.length&&p;++y)if((u=m[y]).isEnabled()&&!u.isBlocked&&u.isVisible&&u.subMeshes)if(this.customIsReadyFunction){if(!this.customIsReadyFunction(u,this.refreshRate,r)){p=!1;continue}}else if(!u.isReady(!0)){p=!1;continue}this.onAfterRenderObservable.notifyObservers(S),(this.is2DArray||this.is3D||this.isCube)&&(i.incrementRenderId(),i.resetCachedMaterial())}}else if(!this.is2DArray&&!this.is3D||this.isMulti)if(this.isCube&&!this.isMulti)for(var b=0;b<6;b++)this._renderToTarget(b,e,t,void 0,d),i.incrementRenderId(),i.resetCachedMaterial();else this._renderToTarget(0,e,t,void 0,d);else for(var S=0;S<this.getRenderLayers();S++)this._renderToTarget(0,e,t,S,d),i.incrementRenderId(),i.resetCachedMaterial();return this.onAfterUnbindObservable.notifyObservers(this),o.currentRenderPassId=h,f&&(i.activeCamera=f,this.activeCamera&&this.activeCamera!==i.activeCamera&&i.setTransformMatrix(i.activeCamera.getViewMatrix(),i.activeCamera.getProjectionMatrix(!0)),o.setViewport(i.activeCamera.viewport)),i.resetCachedMaterial(),p},t.prototype._bestReflectionRenderTargetDimension=function(e,t){var r=e*t,n=(0,d.OG)(r+16384/(128+r));return Math.min((0,d.C4)(e),n)},t.prototype._prepareRenderingManager=function(e,t,r,n){var i=this.getScene();if(i){this._renderingManager.reset();for(var o=i.getRenderId(),a=0;a<t;a++){var s=e[a];if(s&&!s.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(s,this.refreshRate,!1)){this.resetRefreshCounter();continue}}else if(!s.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}if(!s._internalAbstractMeshDataInfo._currentLODIsUpToDate&&i.activeCamera&&(s._internalAbstractMeshDataInfo._currentLOD=i.customLODSelector?i.customLODSelector(s,this.activeCamera||i.activeCamera):s.getLOD(this.activeCamera||i.activeCamera),s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0),!s._internalAbstractMeshDataInfo._currentLOD)continue;var l=s._internalAbstractMeshDataInfo._currentLOD;l._preActivateForIntermediateRendering(o);var c;if(c=!(!n||!r||s.layerMask&r.layerMask),s.isEnabled()&&s.isVisible&&s.subMeshes&&!c){if(l!==s&&l._activate(o,!0),s._activate(o,!0)&&s.subMeshes.length){s.isAnInstance?s._internalAbstractMeshDataInfo._actAsRegularMesh&&(l=s):l._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,l._internalAbstractMeshDataInfo._isActiveIntermediate=!0;for(var u=0;u<l.subMeshes.length;u++){var h=l.subMeshes[u];this._renderingManager.dispatch(h,l)}}s._postActivate()}}}for(var d=0;d<i.particleSystems.length;d++){var f=i.particleSystems[d],p=f.emitter;f.isStarted()&&p&&(!p.position||p.isEnabled())&&this._renderingManager.dispatchParticles(f)}}},t.prototype._bindFrameBuffer=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var r=this.getScene();if(r){var n=r.getEngine();this._renderTarget&&n.bindFramebuffer(this._renderTarget,this.isCube?e:void 0,void 0,void 0,this.ignoreCameraViewport,0,t)}},t.prototype._unbindFrameBuffer=function(e,t){var r=this;this._renderTarget&&e.unBindFramebuffer(this._renderTarget,this.isCube,(function(){r.onAfterRenderObservable.notifyObservers(t)}))},t.prototype._prepareFrame=function(e,t,r,n){this._postProcessManager?this._prePassEnabled||this._postProcessManager._prepareFrame(this._texture,this._postProcesses):n&&e.postProcessManager._prepareFrame(this._texture)||this._bindFrameBuffer(t,r)},t.prototype._renderToTarget=function(e,t,r,n,i){var o,a,s,l,u,d;void 0===n&&(n=0),void 0===i&&(i=null);var f=this.getScene();if(f){var p=f.getEngine();if(null===(o=p._debugPushGroup)||void 0===o||o.call(p,\"render to face #\".concat(e,\" layer #\").concat(n),1),this._prepareFrame(f,e,n,t),this.is2DArray||this.is3D?(p.currentRenderPassId=this._renderPassIds[n],this.onBeforeRenderObservable.notifyObservers(n)):(p.currentRenderPassId=this._renderPassIds[e],this.onBeforeRenderObservable.notifyObservers(e)),p.snapshotRendering&&p.snapshotRenderingMode===c.Y.SNAPSHOTRENDERING_FAST)this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(p):this.skipInitialClear||p.clear(this.clearColor||f.clearColor,!0,!0,!0);else{var _=null,m=this.renderList?this.renderList:f.getActiveMeshes().data,g=this.renderList?this.renderList.length:f.getActiveMeshes().length;this.getCustomRenderList&&(_=this.getCustomRenderList(this.is2DArray||this.is3D?n:e,m,g)),_?this._prepareRenderingManager(_,_.length,i,this.forceLayerMaskCheck):(this._defaultRenderListPrepared||(this._prepareRenderingManager(m,g,i,!this.renderList||this.forceLayerMaskCheck),this._defaultRenderListPrepared=!0),_=m);for(var v=0,y=f._beforeRenderTargetClearStage;v<y.length;v++)y[v].action(this,e,n);this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(p):this.skipInitialClear||p.clear(this.clearColor||f.clearColor,!0,!0,!0),this._doNotChangeAspectRatio||f.updateTransformMatrix(!0);for(var b=0,S=f._beforeRenderTargetDrawStage;b<S.length;b++)S[b].action(this,e,n);this._renderingManager.render(this.customRenderFunction,_,this.renderParticles,this.renderSprites);for(var T=0,E=f._afterRenderTargetDrawStage;T<E.length;T++)E[T].action(this,e,n);var x=null!==(s=null===(a=this._texture)||void 0===a?void 0:a.generateMipMaps)&&void 0!==s&&s;this._texture&&(this._texture.generateMipMaps=!1),this._postProcessManager?this._postProcessManager._finalizeFrame(!1,null!==(l=this._renderTarget)&&void 0!==l?l:void 0,e,this._postProcesses,this.ignoreCameraViewport):t&&f.postProcessManager._finalizeFrame(!1,null!==(u=this._renderTarget)&&void 0!==u?u:void 0,e);for(var P=0,C=f._afterRenderTargetPostProcessStage;P<C.length;P++)C[P].action(this,e,n);this._texture&&(this._texture.generateMipMaps=x),this._doNotChangeAspectRatio||f.updateTransformMatrix(!0),r&&(0,h.yp)(this.getRenderWidth(),this.getRenderHeight(),p)}this._unbindFrameBuffer(p,e),this._texture&&this.isCube&&5===e&&p.generateMipMapsForCubemap(this._texture,!0),null===(d=p._debugPopGroup)||void 0===d||d.call(p,1)}},t.prototype.setRenderingOrder=function(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null),this._renderingManager.setRenderingOrder(e,t,r,n)},t.prototype.setRenderingAutoClearDepthStencil=function(e,t){this._renderingManager.setRenderingAutoClearDepthStencil(e,t),this._renderingManager._useSceneAutoClearSetup=!1},t.prototype.clone=function(){var e=this.getSize(),r=new t(this.name,e,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer,void 0,this._renderTargetOptions.format,void 0,this._renderTargetOptions.samples);return r.hasAlpha=this.hasAlpha,r.level=this.level,r.coordinatesMode=this.coordinatesMode,this.renderList&&(r.renderList=this.renderList.slice(0)),r},t.prototype.serialize=function(){if(!this.name)return null;var t=e.prototype.serialize.call(this);if(t.renderTargetSize=this.getRenderSize(),t.renderList=[],this.renderList)for(var r=0;r<this.renderList.length;r++)t.renderList.push(this.renderList[r].id);return t},t.prototype.disposeFramebufferObjects=function(){var e;null===(e=this._renderTarget)||void 0===e||e.dispose(!0)},t.prototype.releaseInternalTexture=function(){var e;null===(e=this._renderTarget)||void 0===e||e.releaseTextures(),this._texture=null},t.prototype.dispose=function(){var t;this.onResizeObservable.clear(),this.onClearObservable.clear(),this.onAfterRenderObservable.clear(),this.onAfterUnbindObservable.clear(),this.onBeforeBindObservable.clear(),this.onBeforeRenderObservable.clear(),this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this._prePassRenderTarget&&this._prePassRenderTarget.dispose(),this._releaseRenderPassId(),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;var r=this.getScene();if(r){var n=r.customRenderTargets.indexOf(this);n>=0&&r.customRenderTargets.splice(n,1);for(var i=0,o=r.cameras;i<o.length;i++){var a=o[i];(n=a.customRenderTargets.indexOf(this))>=0&&a.customRenderTargets.splice(n,1)}null===(t=this._renderTarget)||void 0===t||t.dispose(),this._renderTarget=null,this._texture=null,e.prototype.dispose.call(this)}},t.prototype._rebuild=function(){this.refreshRate===t.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=t.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()},t.prototype.freeRenderingGroups=function(){this._renderingManager&&this._renderingManager.freeRenderingGroups()},t.prototype.getViewCount=function(){return 1},t.REFRESHRATE_RENDER_ONCE=0,t.REFRESHRATE_RENDER_ONEVERYFRAME=1,t.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2,t}(a.g);a.g._CreateRenderTargetTexture=function(e,t,r,n,i){return new f(e,t,r,n)}},50582:(e,t,r)=>{r.d(t,{g:()=>v});var n=r(78322),i=r(6174),o=r(66377),a=r(8046),s=r(28081),l=r(81152),c=r(34623),u=r(41190),h=r(53695),d=r(252),f=r(43939),p=r(37530),_=r(75838),m=r(51956),g=r(12028),v=function(e){function t(r,n,i,a,s,c,u,d,f,p,_,g,v,y){void 0===s&&(s=t.TRILINEAR_SAMPLINGMODE),void 0===c&&(c=null),void 0===u&&(u=null),void 0===d&&(d=null),void 0===f&&(f=!1);var b,S,T,E,x,P,C,A,R,I,M,O=this;(O=e.call(this,n)||this).url=null,O.uOffset=0,O.vOffset=0,O.uScale=1,O.vScale=1,O.uAng=0,O.vAng=0,O.wAng=0,O.uRotationCenter=.5,O.vRotationCenter=.5,O.wRotationCenter=.5,O.homogeneousRotationInUVTransform=!1,O.inspectableCustomProperties=null,O._noMipmap=!1,O._invertY=!1,O._rowGenerationMatrix=null,O._cachedTextureMatrix=null,O._projectionModeMatrix=null,O._t0=null,O._t1=null,O._t2=null,O._cachedUOffset=-1,O._cachedVOffset=-1,O._cachedUScale=0,O._cachedVScale=0,O._cachedUAng=-1,O._cachedVAng=-1,O._cachedWAng=-1,O._cachedReflectionProjectionMatrixId=-1,O._cachedURotationCenter=-1,O._cachedVRotationCenter=-1,O._cachedWRotationCenter=-1,O._cachedHomogeneousRotationInUVTransform=!1,O._cachedIdentity3x2=!0,O._cachedReflectionTextureMatrix=null,O._cachedReflectionUOffset=-1,O._cachedReflectionVOffset=-1,O._cachedReflectionUScale=0,O._cachedReflectionVScale=0,O._cachedReflectionCoordinatesMode=-1,O._buffer=null,O._deleteBuffer=!1,O._format=null,O._delayedOnLoad=null,O._delayedOnError=null,O.onLoadObservable=new o.cP,O._isBlocking=!0,O.name=r||\"\",O.url=r;var D=!1,N=null,L=!0;\"object\"==typeof i&&null!==i?(M=null!==(b=i.noMipmap)&&void 0!==b&&b,a=null!==(S=i.invertY)&&void 0!==S?S:!m.rX,s=null!==(T=i.samplingMode)&&void 0!==T?T:t.TRILINEAR_SAMPLINGMODE,c=null!==(E=i.onLoad)&&void 0!==E?E:null,u=null!==(x=i.onError)&&void 0!==x?x:null,d=null!==(P=i.buffer)&&void 0!==P?P:null,f=null!==(C=i.deleteBuffer)&&void 0!==C&&C,p=i.format,_=i.mimeType,g=i.loaderOptions,v=i.creationFlags,D=null!==(A=i.useSRGBBuffer)&&void 0!==A&&A,N=null!==(R=i.internalTexture)&&void 0!==R?R:null,L=null!==(I=i.gammaSpace)&&void 0!==I?I:L):M=!!i,O._gammaSpace=L,O._noMipmap=M,O._invertY=void 0===a?!m.rX:a,O._initialSamplingMode=s,O._buffer=d,O._deleteBuffer=f,O._mimeType=_,O._loaderOptions=g,O._creationFlags=v,O._useSRGBBuffer=D,O._forcedExtension=y,p&&(O._format=p);var F=O.getScene(),w=O._getEngine();if(!w)return O;w.onBeforeTextureInitObservable.notifyObservers(O);var B=function(){O._texture&&(O._texture._invertVScale&&(O.vScale*=-1,O.vOffset+=1),null!==O._texture._cachedWrapU&&(O.wrapU=O._texture._cachedWrapU,O._texture._cachedWrapU=null),null!==O._texture._cachedWrapV&&(O.wrapV=O._texture._cachedWrapV,O._texture._cachedWrapV=null),null!==O._texture._cachedWrapR&&(O.wrapR=O._texture._cachedWrapR,O._texture._cachedWrapR=null)),O.onLoadObservable.hasObservers()&&O.onLoadObservable.notifyObservers(O),c&&c(),!O.isBlocking&&F&&F.resetCachedMaterial()},V=function(e,r){O._loadingError=!0,O._errorObject={message:e,exception:r},u&&u(e,r),t.OnTextureLoadErrorObservable.notifyObservers(O)};if(!O.url&&!N)return O._delayedOnLoad=B,O._delayedOnError=V,O;if(O._texture=null!=N?N:O._getFromCache(O.url,M,s,O._invertY,D,O.isCube),O._texture)if(O._texture.isReady)h._.SetImmediate((function(){return B()}));else{var U=O._texture.onLoadedObservable.add(B);O._texture.onErrorObservable.add((function(e){var t;V(e.message,e.exception),null===(t=O._texture)||void 0===t||t.onLoadedObservable.remove(U)}))}else if(F&&F.useDelayedTextureLoading)O.delayLoadState=l.Y.DELAYLOADSTATE_NOTLOADED,O._delayedOnLoad=B,O._delayedOnError=V;else{try{O._texture=w.createTexture(O.url,M,O._invertY,F,s,B,V,O._buffer,void 0,O._format,O._forcedExtension,_,g,v,D)}catch(e){throw V(\"error loading\",e),e}f&&(O._buffer=null)}return O}return(0,n.C6)(t,e),t._CreateVideoTexture=function(e,r,n,i,o,a,s,c,h){throw void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=t.TRILINEAR_SAMPLINGMODE),void 0===s&&(s={}),void 0===h&&(h=l.Y.TEXTUREFORMAT_RGBA),(0,u.n)(\"VideoTexture\")},Object.defineProperty(t.prototype,\"noMipmap\",{get:function(){return this._noMipmap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"mimeType\",{get:function(){return this._mimeType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"isBlocking\",{get:function(){return this._isBlocking},set:function(e){this._isBlocking=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"invertY\",{get:function(){return this._invertY},enumerable:!1,configurable:!0}),t.prototype.updateURL=function(e,t,r,n){var i=this;void 0===t&&(t=null),this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(i)}))),this.name&&!this.name.startsWith(\"data:\")||(this.name=e),this.url=e,this._buffer=t,this._forcedExtension=n,this.delayLoadState=l.Y.DELAYLOADSTATE_NOTLOADED,r&&(this._delayedOnLoad=r),this.delayLoad()},t.prototype.delayLoad=function(){if(this.delayLoadState===l.Y.DELAYLOADSTATE_NOTLOADED){var e=this.getScene();e&&(this.delayLoadState=l.Y.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?h._.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}},t.prototype._prepareRowForTextureGeneration=function(e,t,r,n){e*=this._cachedUScale,t*=this._cachedVScale,e-=this.uRotationCenter*this._cachedUScale,t-=this.vRotationCenter*this._cachedVScale,r-=this.wRotationCenter,a.Pq.TransformCoordinatesFromFloatsToRef(e,t,r,this._rowGenerationMatrix,n),n.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,n.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,n.z+=this.wRotationCenter},t.prototype.getTextureMatrix=function(e){var t=this;if(void 0===e&&(e=1),this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*e===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*e,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=a.uq.Zero(),this._rowGenerationMatrix=new a.uq,this._t0=a.Pq.Zero(),this._t1=a.Pq.Zero(),this._t2=a.Pq.Zero()),a.uq.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(a.uq.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,a.AA.Matrix[0]),a.uq.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,a.AA.Matrix[1]),a.uq.ScalingToRef(this._cachedUScale,this._cachedVScale,0,a.AA.Matrix[2]),a.uq.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,a.AA.Matrix[3]),a.AA.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(a.AA.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(a.AA.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(a.AA.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),a.uq.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));var r=this.getScene();if(!r)return this._cachedTextureMatrix;var n=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&n!==this._cachedIdentity3x2&&r.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(e){return e.hasTexture(t)})),this._cachedTextureMatrix},t.prototype.getReflectionTextureMatrix=function(){var e=this,r=this.getScene();if(!r)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==t.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===r.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=a.uq.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=a.uq.Zero());var n=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case t.PLANAR_MODE:a.uq.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case t.PROJECTION_MODE:a.uq.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var i=r.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=i.updateFlag,i.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break;default:a.uq.IdentityToRef(this._cachedReflectionTextureMatrix)}return n&&r.markAllMaterialsAsDirty(l.Y.MATERIAL_TextureDirtyFlag,(function(t){return t.hasTexture(e)})),this._cachedReflectionTextureMatrix},t.prototype.clone=function(){var e=this,r={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return g.p.Clone((function(){return new t(e._texture?e._texture.url:null,e.getScene(),r)}),this)},t.prototype.serialize=function(){var r,n,i=this.name;t.SerializeBuffers||this.name.startsWith(\"data:\")&&(this.name=\"\"),this.name.startsWith(\"data:\")&&this.url===this.name&&(this.url=\"\");var o=e.prototype.serialize.call(this,t._SerializeInternalTextureUniqueId);return o?((t.SerializeBuffers||t.ForceSerializeBuffers)&&(\"string\"==typeof this._buffer&&\"data:\"===this._buffer.substring(0,5)?(o.base64String=this._buffer,o.name=o.name.replace(\"data:\",\"\")):this.url&&this.url.startsWith(\"data:\")&&this._buffer instanceof Uint8Array?o.base64String=\"data:image/png;base64,\"+(0,p.EL)(this._buffer):(t.ForceSerializeBuffers||this.url&&this.url.startsWith(\"blob:\")||this._forceSerialize)&&(o.base64String=!this._engine||this._engine._features.supportSyncTextureRead?(0,_.lP)(this):(0,_.nh)(this))),o.invertY=this._invertY,o.samplingMode=this.samplingMode,o._creationFlags=this._creationFlags,o._useSRGBBuffer=this._useSRGBBuffer,t._SerializeInternalTextureUniqueId&&(o.internalTextureUniqueId=null!==(n=null===(r=this._texture)||void 0===r?void 0:r.uniqueId)&&void 0!==n?n:void 0),o.noMipmap=this._noMipmap,this.name=i,o):null},t.prototype.getClassName=function(){return\"Texture\"},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null},t.Parse=function(e,r,n){if(e.customType){var i=d.n.Instantiate(e.customType).Parse(e,r,n);return e.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==e.samplingMode&&i.updateSamplingMode(e.samplingMode),i}if(e.isCube&&!e.isRenderTarget)return t._CubeTextureParser(e,r,n);var o,a=void 0!==e.internalTextureUniqueId;if(!e.name&&!e.isRenderTarget&&!a)return null;if(a)for(var s=0,l=r.getEngine().getLoadedTexturesCache();s<l.length;s++){var u=l[s];if(u.uniqueId===e.internalTextureUniqueId){o=u;break}}var h=function(t){var r;if(t&&t._texture&&(t._texture._cachedWrapU=null,t._texture._cachedWrapV=null,t._texture._cachedWrapR=null),e.samplingMode){var n=e.samplingMode;t&&t.samplingMode!==n&&t.updateSamplingMode(n)}if(t&&e.animations)for(var i=0;i<e.animations.length;i++){var s=e.animations[i],l=(0,c.n9)(\"BABYLON.Animation\");l&&t.animations.push(l.Parse(s))}a&&!o&&(null===(r=null==t?void 0:t._texture)||void 0===r||r._setUniqueId(e.internalTextureUniqueId))},p=g.p.Parse((function(){var i,a,s,l,c=!0;if(e.noMipmap&&(c=!1),e.mirrorPlane){var u=t._CreateMirror(e.name,e.renderTargetSize,r,c);return u._waitingRenderList=e.renderList,u.mirrorPlane=f.Z.FromArray(e.mirrorPlane),h(u),u}if(e.isRenderTarget){var d=null;if(e.isCube){if(r.reflectionProbes)for(var p=0;p<r.reflectionProbes.length;p++){var _=r.reflectionProbes[p];if(_.name===e.name)return _.cubeTexture}}else(d=t._CreateRenderTargetTexture(e.name,e.renderTargetSize,r,c,null!==(i=e._creationFlags)&&void 0!==i?i:0))._waitingRenderList=e.renderList;return h(d),d}if(e.isVideo){var m=t._CreateVideoTexture(n+(e.url||e.name),n+(e.src||e.url),r,c,e.invertY,e.samplingMode,e.settings||{});return h(m),m}if(e.base64String&&!o)(l=t.CreateFromBase64String(e.base64String,e.base64String,r,!c,e.invertY,e.samplingMode,(function(){h(l)}),null!==(a=e._creationFlags)&&void 0!==a?a:0,null!==(s=e._useSRGBBuffer)&&void 0!==s&&s)).name=e.name;else{var g=void 0;g=e.name&&(e.name.indexOf(\"://\")>0||e.name.startsWith(\"data:\"))?e.name:n+e.name,e.url&&(e.url.startsWith(\"data:\")||t.UseSerializedUrlIfAny)&&(g=e.url);var v={noMipmap:!c,invertY:e.invertY,samplingMode:e.samplingMode,onLoad:function(){h(l)},internalTexture:o};l=new t(g,r,v)}return l}),e,r);return p},t.CreateFromBase64String=function(e,r,n,i,o,a,s,c,u,h,d){return void 0===a&&(a=t.TRILINEAR_SAMPLINGMODE),void 0===s&&(s=null),void 0===c&&(c=null),void 0===u&&(u=l.Y.TEXTUREFORMAT_RGBA),new t(\"data:\"+r,n,i,o,a,s,c,e,!1,u,void 0,void 0,h,d)},t.LoadFromDataString=function(e,r,n,i,o,a,s,c,u,h,d,f){return void 0===i&&(i=!1),void 0===a&&(a=!0),void 0===s&&(s=t.TRILINEAR_SAMPLINGMODE),void 0===c&&(c=null),void 0===u&&(u=null),void 0===h&&(h=l.Y.TEXTUREFORMAT_RGBA),\"data:\"!==e.substring(0,5)&&(e=\"data:\"+e),new t(e,n,o,a,s,c,u,r,i,h,void 0,void 0,d,f)},t.SerializeBuffers=!0,t.ForceSerializeBuffers=!1,t.OnTextureLoadErrorObservable=new o.cP,t._SerializeInternalTextureUniqueId=!1,t._CubeTextureParser=function(e,t,r){throw(0,u.n)(\"CubeTexture\")},t._CreateMirror=function(e,t,r,n){throw(0,u.n)(\"MirrorTexture\")},t._CreateRenderTargetTexture=function(e,t,r,n,i){throw(0,u.n)(\"RenderTargetTexture\")},t.NEAREST_SAMPLINGMODE=l.Y.TEXTURE_NEAREST_SAMPLINGMODE,t.NEAREST_NEAREST_MIPLINEAR=l.Y.TEXTURE_NEAREST_NEAREST_MIPLINEAR,t.BILINEAR_SAMPLINGMODE=l.Y.TEXTURE_BILINEAR_SAMPLINGMODE,t.LINEAR_LINEAR_MIPNEAREST=l.Y.TEXTURE_LINEAR_LINEAR_MIPNEAREST,t.TRILINEAR_SAMPLINGMODE=l.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,t.LINEAR_LINEAR_MIPLINEAR=l.Y.TEXTURE_LINEAR_LINEAR_MIPLINEAR,t.NEAREST_NEAREST_MIPNEAREST=l.Y.TEXTURE_NEAREST_NEAREST_MIPNEAREST,t.NEAREST_LINEAR_MIPNEAREST=l.Y.TEXTURE_NEAREST_LINEAR_MIPNEAREST,t.NEAREST_LINEAR_MIPLINEAR=l.Y.TEXTURE_NEAREST_LINEAR_MIPLINEAR,t.NEAREST_LINEAR=l.Y.TEXTURE_NEAREST_LINEAR,t.NEAREST_NEAREST=l.Y.TEXTURE_NEAREST_NEAREST,t.LINEAR_NEAREST_MIPNEAREST=l.Y.TEXTURE_LINEAR_NEAREST_MIPNEAREST,t.LINEAR_NEAREST_MIPLINEAR=l.Y.TEXTURE_LINEAR_NEAREST_MIPLINEAR,t.LINEAR_LINEAR=l.Y.TEXTURE_LINEAR_LINEAR,t.LINEAR_NEAREST=l.Y.TEXTURE_LINEAR_NEAREST,t.EXPLICIT_MODE=l.Y.TEXTURE_EXPLICIT_MODE,t.SPHERICAL_MODE=l.Y.TEXTURE_SPHERICAL_MODE,t.PLANAR_MODE=l.Y.TEXTURE_PLANAR_MODE,t.CUBIC_MODE=l.Y.TEXTURE_CUBIC_MODE,t.PROJECTION_MODE=l.Y.TEXTURE_PROJECTION_MODE,t.SKYBOX_MODE=l.Y.TEXTURE_SKYBOX_MODE,t.INVCUBIC_MODE=l.Y.TEXTURE_INVCUBIC_MODE,t.EQUIRECTANGULAR_MODE=l.Y.TEXTURE_EQUIRECTANGULAR_MODE,t.FIXED_EQUIRECTANGULAR_MODE=l.Y.TEXTURE_FIXED_EQUIRECTANGULAR_MODE,t.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=l.Y.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE,t.CLAMP_ADDRESSMODE=l.Y.TEXTURE_CLAMP_ADDRESSMODE,t.WRAP_ADDRESSMODE=l.Y.TEXTURE_WRAP_ADDRESSMODE,t.MIRROR_ADDRESSMODE=l.Y.TEXTURE_MIRROR_ADDRESSMODE,t.UseSerializedUrlIfAny=!1,(0,n.Cg)([(0,i.lK)()],t.prototype,\"url\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"uOffset\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"vOffset\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"uScale\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"vScale\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"uAng\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"vAng\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"wAng\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"uRotationCenter\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"vRotationCenter\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"wRotationCenter\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"homogeneousRotationInUVTransform\",void 0),(0,n.Cg)([(0,i.lK)()],t.prototype,\"isBlocking\",null),t}(s.t);(0,c.Y5)(\"BABYLON.Texture\",v),g.p._TextureParser=v.Parse},55204:(e,t,r)=>{r.d(t,{u:()=>i});var n=r(81152),i=function(){function e(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}return Object.defineProperty(e.prototype,\"wrapU\",{get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"wrapV\",{get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"wrapR\",{get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"anisotropicFilteringLevel\",{get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"comparisonFunction\",{get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"useMipMaps\",{get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e},enumerable:!1,configurable:!0}),e.prototype.setParameters=function(e,t,r,i,o,a){return void 0===e&&(e=n.Y.TEXTURE_WRAP_ADDRESSMODE),void 0===t&&(t=n.Y.TEXTURE_WRAP_ADDRESSMODE),void 0===r&&(r=n.Y.TEXTURE_WRAP_ADDRESSMODE),void 0===i&&(i=1),void 0===o&&(o=n.Y.TEXTURE_BILINEAR_SAMPLINGMODE),void 0===a&&(a=0),this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=r,this._cachedAnisotropicFilteringLevel=i,this.samplingMode=o,this._comparisonFunction=a,this},e.prototype.compareSampler=function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps},e}()},63919:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(81152),i=r(73152),o=function(){function e(t){this._wrapU=n.Y.TEXTURE_WRAP_ADDRESSMODE,this._wrapV=n.Y.TEXTURE_WRAP_ADDRESSMODE,this.wrapR=n.Y.TEXTURE_WRAP_ADDRESSMODE,this.anisotropicFilteringLevel=4,this.delayLoadState=n.Y.DELAYLOADSTATE_NONE,this._texture=null,this._engine=null,this._cachedSize=i.o.Zero(),this._cachedBaseSize=i.o.Zero(),this._initialSamplingMode=n.Y.TEXTURE_BILINEAR_SAMPLINGMODE,this._texture=e._IsRenderTargetWrapper(t)?t.texture:t,this._texture&&(this._engine=this._texture.getEngine())}return Object.defineProperty(e.prototype,\"wrapU\",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"wrapV\",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"coordinatesMode\",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isCube\",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"is3D\",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"is2DArray\",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return\"ThinTexture\"},e._IsRenderTargetWrapper=function(e){return void 0!==(null==e?void 0:e.shareDepth)},e.prototype.isReady=function(){return this.delayLoadState===n.Y.DELAYLOADSTATE_NOTLOADED?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},e.prototype.delayLoad=function(){},e.prototype.getInternalTexture=function(){return this._texture},e.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},e.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)},Object.defineProperty(e.prototype,\"samplingMode\",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0}),e.prototype.updateSamplingMode=function(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)},e.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},e.prototype.dispose=function(){this._texture&&(this.releaseInternalTexture(),this._engine=null)},e}()},34561:(e,t,r)=>{function n(e){-1===e.indexOf(\"vClipPlane\")&&e.push(\"vClipPlane\"),-1===e.indexOf(\"vClipPlane2\")&&e.push(\"vClipPlane2\"),-1===e.indexOf(\"vClipPlane3\")&&e.push(\"vClipPlane3\"),-1===e.indexOf(\"vClipPlane4\")&&e.push(\"vClipPlane4\"),-1===e.indexOf(\"vClipPlane5\")&&e.push(\"vClipPlane5\"),-1===e.indexOf(\"vClipPlane6\")&&e.push(\"vClipPlane6\")}function i(e,t,r){var n,i,o,a,s,l,c=!!(null!==(n=e.clipPlane)&&void 0!==n?n:t.clipPlane),u=!!(null!==(i=e.clipPlane2)&&void 0!==i?i:t.clipPlane2),h=!!(null!==(o=e.clipPlane3)&&void 0!==o?o:t.clipPlane3),d=!!(null!==(a=e.clipPlane4)&&void 0!==a?a:t.clipPlane4),f=!!(null!==(s=e.clipPlane5)&&void 0!==s?s:t.clipPlane5),p=!!(null!==(l=e.clipPlane6)&&void 0!==l?l:t.clipPlane6);c&&r.push(\"#define CLIPPLANE\"),u&&r.push(\"#define CLIPPLANE2\"),h&&r.push(\"#define CLIPPLANE3\"),d&&r.push(\"#define CLIPPLANE4\"),f&&r.push(\"#define CLIPPLANE5\"),p&&r.push(\"#define CLIPPLANE6\")}function o(e,t,r){var n,i,o,a,s,l,c=!1,u=!!(null!==(n=e.clipPlane)&&void 0!==n?n:t.clipPlane),h=!!(null!==(i=e.clipPlane2)&&void 0!==i?i:t.clipPlane2),d=!!(null!==(o=e.clipPlane3)&&void 0!==o?o:t.clipPlane3),f=!!(null!==(a=e.clipPlane4)&&void 0!==a?a:t.clipPlane4),p=!!(null!==(s=e.clipPlane5)&&void 0!==s?s:t.clipPlane5),_=!!(null!==(l=e.clipPlane6)&&void 0!==l?l:t.clipPlane6);return r.CLIPPLANE!==u&&(r.CLIPPLANE=u,c=!0),r.CLIPPLANE2!==h&&(r.CLIPPLANE2=h,c=!0),r.CLIPPLANE3!==d&&(r.CLIPPLANE3=d,c=!0),r.CLIPPLANE4!==f&&(r.CLIPPLANE4=f,c=!0),r.CLIPPLANE5!==p&&(r.CLIPPLANE5=p,c=!0),r.CLIPPLANE6!==_&&(r.CLIPPLANE6=_,c=!0),c}function a(e,t,r){var n,i,o,a,l,c,u=null!==(n=t.clipPlane)&&void 0!==n?n:r.clipPlane;s(e,\"vClipPlane\",u),s(e,\"vClipPlane2\",u=null!==(i=t.clipPlane2)&&void 0!==i?i:r.clipPlane2),s(e,\"vClipPlane3\",u=null!==(o=t.clipPlane3)&&void 0!==o?o:r.clipPlane3),s(e,\"vClipPlane4\",u=null!==(a=t.clipPlane4)&&void 0!==a?a:r.clipPlane4),s(e,\"vClipPlane5\",u=null!==(l=t.clipPlane5)&&void 0!==l?l:r.clipPlane5),s(e,\"vClipPlane6\",u=null!==(c=t.clipPlane6)&&void 0!==c?c:r.clipPlane6)}function s(e,t,r){r&&e.setFloat4(t,r.normal.x,r.normal.y,r.normal.z,r.d)}r.d(t,{Eq:()=>o,TV:()=>n,gS:()=>a,tv:()=>i})},10740:(e,t,r)=>{function n(e){e.push(\"vCameraColorCurveNeutral\",\"vCameraColorCurvePositive\",\"vCameraColorCurveNegative\")}r.d(t,{B:()=>n})},76331:(e,t,r)=>{r.d(t,{Q:()=>l});var n=r(78322),i=r(6174),o=r(64726),a=r(12028),s=r(10740),l=function(){function e(){this._dirty=!0,this._tempColor=new o.ov(0,0,0,0),this._globalCurve=new o.ov(0,0,0,0),this._highlightsCurve=new o.ov(0,0,0,0),this._midtonesCurve=new o.ov(0,0,0,0),this._shadowsCurve=new o.ov(0,0,0,0),this._positiveCurve=new o.ov(0,0,0,0),this._negativeCurve=new o.ov(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}return Object.defineProperty(e.prototype,\"globalHue\",{get:function(){return this._globalHue},set:function(e){this._globalHue=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"globalDensity\",{get:function(){return this._globalDensity},set:function(e){this._globalDensity=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"globalSaturation\",{get:function(){return this._globalSaturation},set:function(e){this._globalSaturation=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"globalExposure\",{get:function(){return this._globalExposure},set:function(e){this._globalExposure=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"highlightsHue\",{get:function(){return this._highlightsHue},set:function(e){this._highlightsHue=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"highlightsDensity\",{get:function(){return this._highlightsDensity},set:function(e){this._highlightsDensity=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"highlightsSaturation\",{get:function(){return this._highlightsSaturation},set:function(e){this._highlightsSaturation=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"highlightsExposure\",{get:function(){return this._highlightsExposure},set:function(e){this._highlightsExposure=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"midtonesHue\",{get:function(){return this._midtonesHue},set:function(e){this._midtonesHue=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"midtonesDensity\",{get:function(){return this._midtonesDensity},set:function(e){this._midtonesDensity=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"midtonesSaturation\",{get:function(){return this._midtonesSaturation},set:function(e){this._midtonesSaturation=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"midtonesExposure\",{get:function(){return this._midtonesExposure},set:function(e){this._midtonesExposure=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shadowsHue\",{get:function(){return this._shadowsHue},set:function(e){this._shadowsHue=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shadowsDensity\",{get:function(){return this._shadowsDensity},set:function(e){this._shadowsDensity=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shadowsSaturation\",{get:function(){return this._shadowsSaturation},set:function(e){this._shadowsSaturation=e,this._dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shadowsExposure\",{get:function(){return this._shadowsExposure},set:function(e){this._shadowsExposure=e,this._dirty=!0},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return\"ColorCurves\"},e.Bind=function(e,t,r,n,i){void 0===r&&(r=\"vCameraColorCurvePositive\"),void 0===n&&(n=\"vCameraColorCurveNeutral\"),void 0===i&&(i=\"vCameraColorCurveNegative\"),e._dirty&&(e._dirty=!1,e._getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e._getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e._getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e._getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t&&(t.setFloat4(r,e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4(n,e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4(i,e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a))},e.prototype._getColorGradingDataToRef=function(t,r,n,i,o){null!=t&&(t=e._Clamp(t,0,360),r=e._Clamp(r,-100,100),n=e._Clamp(n,-100,100),i=e._Clamp(i,-100,100),r=e._ApplyColorGradingSliderNonlinear(r),r*=.5,i=e._ApplyColorGradingSliderNonlinear(i),r<0&&(r*=-1,t=(t+180)%360),e._FromHSBToRef(t,r,50+.25*i,o),o.scaleToRef(2,o),o.a=1+.01*n)},e._ApplyColorGradingSliderNonlinear=function(e){e/=100;var t=Math.abs(e);return t=Math.pow(t,2),e<0&&(t*=-1),100*t},e._FromHSBToRef=function(t,r,n,i){var o=e._Clamp(t,0,360),a=e._Clamp(r/100,0,1),s=e._Clamp(n/100,0,1);if(0===a)i.r=s,i.g=s,i.b=s;else{o/=60;var l=Math.floor(o),c=o-l,u=s*(1-a),h=s*(1-a*c),d=s*(1-a*(1-c));switch(l){case 0:i.r=s,i.g=d,i.b=u;break;case 1:i.r=h,i.g=s,i.b=u;break;case 2:i.r=u,i.g=s,i.b=d;break;case 3:i.r=u,i.g=h,i.b=s;break;case 4:i.r=d,i.g=u,i.b=s;break;default:i.r=s,i.g=u,i.b=h}}i.a=1},e._Clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},e.prototype.clone=function(){return a.p.Clone((function(){return new e}),this)},e.prototype.serialize=function(){return a.p.Serialize(this)},e.Parse=function(t){return a.p.Parse((function(){return new e}),t,null,null)},e.PrepareUniforms=s.B,(0,n.Cg)([(0,i.lK)()],e.prototype,\"_globalHue\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_globalDensity\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_globalSaturation\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_globalExposure\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_highlightsHue\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_highlightsDensity\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_highlightsSaturation\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_highlightsExposure\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_midtonesHue\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_midtonesDensity\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_midtonesSaturation\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_midtonesExposure\",void 0),e}();a.p._ColorCurvesParser=l.Parse},92118:(e,t,r)=>{function n(e){return void 0===e.getPipelineContext}r.d(t,{E:()=>n})},14777:(e,t,r)=>{r.d(t,{E:()=>n});var n=function(){function e(e,t){void 0===t&&(t=!0),this._wasPreviouslyReady=!1,this._forceRebindOnNextCall=!0,this._wasPreviouslyUsingInstances=null,this.effect=null,this.defines=null,this.drawContext=e.createDrawContext(),t&&(this.materialContext=e.createMaterialContext())}return e.GetEffect=function(e){return void 0===e.getPipelineContext?e.effect:e},e.prototype.setEffect=function(e,t,r){var n;void 0===r&&(r=!0),this.effect=e,void 0!==t&&(this.defines=t),r&&(null===(n=this.drawContext)||void 0===n||n.reset())},e.prototype.dispose=function(){var e;null===(e=this.drawContext)||void 0===e||e.dispose()},e}()},76320:(e,t,r)=>{r.d(t,{b4:()=>c,bu:()=>h,mO:()=>u,uR:()=>f});var n=r(5153),i=r(53399),o=r(98519),a=r(7164),s=r(35930),l=r(24894);function c(e,t){return(0,i.N5)(t).cachedPipelines[e]}function u(e){var t=e._name,r=e.context;if(t&&r){var n=(0,i.N5)(r),o=n.cachedPipelines[t];null==o||o.dispose(),delete n.cachedPipelines[t]}}function h(e,t,r,i,o,a,l){var c,u,h=(0,n.BA)()?null==a?void 0:a.getHostDocument():null;c=\"string\"==typeof t?t:t.vertexSource?\"source:\"+t.vertexSource:t.vertexElement?(null==h?void 0:h.getElementById(t.vertexElement))||t.vertexElement:t.vertex||t,u=\"string\"==typeof t?t:t.fragmentSource?\"source:\"+t.fragmentSource:t.fragmentElement?(null==h?void 0:h.getElementById(t.fragmentElement))||t.fragmentElement:t.fragment||t;var f=[void 0,void 0],p=function(){if(f[0]&&f[1]){e.isFragment=!0;var n=f[0],c=f[1];(0,s.M0)(c,e,(function(a,c){l&&(l._fragmentSourceCodeBeforeMigration=c),r&&(a=r(\"fragment\",a));var u=(0,s.nO)(n,a,e);e=null;var h=function(e,t,r,n){return r?{vertexSourceCode:(1===n?\"//\":\"\")+\"#define SHADER_NAME vertex:\"+(r.vertexElement||r.vertex||r.spectorName||r)+\"\\n\"+e,fragmentSourceCode:(1===n?\"//\":\"\")+\"#define SHADER_NAME fragment:\"+(r.fragmentElement||r.fragment||r.spectorName||r)+\"\\n\"+t}:{vertexSourceCode:e,fragmentSourceCode:t}}(u.vertexCode,u.fragmentCode,t,o);null==i||i(h.vertexSourceCode,h.fragmentSourceCode)}),a)}};d(c,\"Vertex\",\"\",(function(t){(0,s.pB)(e),(0,s.M0)(t,e,(function(e,n){l&&(l._rawVertexSourceCode=t,l._vertexSourceCodeBeforeMigration=n),r&&(e=r(\"vertex\",e)),f[0]=e,p()}),a)}),o),d(u,\"Fragment\",\"Pixel\",(function(e){l&&(l._rawFragmentSourceCode=e),f[1]=e,p()}),o)}function d(e,t,r,i,a,s){if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)i((0,n.Zl)(e));else if(\"source:\"!==e.substring(0,7))if(\"base64:\"!==e.substring(0,7)){var c=o.l.GetShadersStore(a);if(c[e+t+\"Shader\"])i(c[e+t+\"Shader\"]);else if(r&&c[e+r+\"Shader\"])i(c[e+r+\"Shader\"]);else{var u;if(u=\".\"===e[0]||\"/\"===e[0]||e.indexOf(\"http\")>-1?e:o.l.GetShadersRepository(a)+e,!(s=s||l.W0))throw new Error(\"loadFileInjection is not defined\");s(u+\".\"+t.toLowerCase()+\".fx\",i)}}else i(window.atob(e.substring(7)));else i(e.substring(7))}var f=function(e,t,r,n){try{var o=e.existingPipelineContext||t(e.shaderProcessingContext);return o._name=e.name,e.name&&e.context&&((0,i.N5)(e.context).cachedPipelines[e.name]=o),r(o,e.vertex,e.fragment,!!e.createAsRaw,\"\",\"\",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,\"\",(function(){n(o,(function(){var t;null===(t=e.onRenderingStateCompiled)||void 0===t||t.call(e,o)}))})),o}catch(e){throw a.V.Error(\"Error compiling effect\"),e}}},74239:(e,t,r)=>{r.d(t,{M:()=>c});var n=r(78322),i=r(66377),o=r(81152),a=r(7164),s=r(98519),l=r(76320),c=function(){function e(t,r,n,o,a,s,c,u,h,d,f,p,_){var m,g,v,y;void 0===o&&(o=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===u&&(u=null),void 0===h&&(h=null),void 0===f&&(f=\"\"),void 0===p&&(p=0),this.defines=\"\",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new i.cP,this.onErrorObservable=new i.cP,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError=\"\",this._allFallbacksProcessed=!1,this._uniforms={},this._key=\"\",this._fallbacks=null,this._vertexSourceCodeOverride=\"\",this._fragmentSourceCodeOverride=\"\",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode=\"\",this._fragmentSourceCode=\"\",this._vertexSourceCodeBeforeMigration=\"\",this._fragmentSourceCodeBeforeMigration=\"\",this._rawVertexSourceCode=\"\",this._rawFragmentSourceCode=\"\",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=t,this._key=f;var b=this._key.replace(/\\r/g,\"\").replace(/\\n/g,\"|\"),S=void 0;if(r.attributes){var T=r;if(this._engine=n,this._attributesNames=T.attributes,this._uniformsNames=T.uniformsNames.concat(T.samplers),this._samplerList=T.samplers.slice(),this.defines=T.defines,this.onError=T.onError,this.onCompiled=T.onCompiled,this._fallbacks=T.fallbacks,this._indexParameters=T.indexParameters,this._transformFeedbackVaryings=T.transformFeedbackVaryings||null,this._multiTarget=!!T.multiTarget,this._shaderLanguage=null!==(m=T.shaderLanguage)&&void 0!==m?m:0,T.uniformBuffersNames){this._uniformBuffersNamesList=T.uniformBuffersNames.slice();for(var E=0;E<T.uniformBuffersNames.length;E++)this._uniformBuffersNames[T.uniformBuffersNames[E]]=E}this._processFinalCode=null!==(g=T.processFinalCode)&&void 0!==g?g:null,this._processCodeAfterIncludes=null!==(v=T.processCodeAfterIncludes)&&void 0!==v?v:void 0,S=T.existingPipelineContext}else this._engine=a,this.defines=null==s?\"\":s,this._uniformsNames=n.concat(o),this._samplerList=o?o.slice():[],this._attributesNames=r,this._uniformBuffersNamesList=[],this._shaderLanguage=p,this.onError=h,this.onCompiled=u,this._indexParameters=d,this._fallbacks=c;\"WEBGL2\"===this._engine.shaderPlatformName&&(S=null!==(y=(0,l.b4)(b,this._engine._gl))&&void 0!==y?y:S),this._attributeLocationByName={},this.uniqueId=e._UniqueIdSeed++,S?(this._pipelineContext=S,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,_)}return Object.defineProperty(e,\"ShadersRepository\",{get:function(){return s.l.ShadersRepository},set:function(e){s.l.ShadersRepository=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onBindObservable\",{get:function(){return this._onBindObservable||(this._onBindObservable=new i.cP),this._onBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shaderLanguage\",{get:function(){return this._shaderLanguage},enumerable:!1,configurable:!0}),e.prototype._processShaderCodeAsync=function(e,t,r,i){return void 0===e&&(e=null),void 0===t&&(t=!1),void 0===r&&(r=null),(0,n.sH)(this,void 0,void 0,(function(){var o,a=this;return(0,n.YH)(this,(function(n){switch(n.label){case 0:return i?[4,i()]:[3,2];case 1:n.sent(),n.label=2;case 2:return this._processingContext=r||this._engine._getShaderProcessingContext(this._shaderLanguage,!1),o={defines:this.defines.split(\"\\n\"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:null!=e?e:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:s.l.GetShadersRepository(this._shaderLanguage),includesShadersStore:s.l.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes},(0,l.bu)(o,this.name,this._processFinalCode,(function(e,r){a._vertexSourceCode=e,a._fragmentSourceCode=r,a._prepareEffect(t)}),this._shaderLanguage,this._engine,this),[2]}}))}))},Object.defineProperty(e.prototype,\"key\",{get:function(){return this._key},enumerable:!1,configurable:!0}),e.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}},e.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},e.prototype.getEngine=function(){return this._engine},e.prototype.getPipelineContext=function(){return this._pipelineContext},e.prototype.getAttributesNames=function(){return this._attributesNames},e.prototype.getAttributeLocation=function(e){return this._attributes[e]},e.prototype.getAttributeLocationByName=function(e){return this._attributeLocationByName[e]},e.prototype.getAttributesCount=function(){return this._attributes.length},e.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},e.prototype.getUniform=function(e){return this._uniforms[e]},e.prototype.getSamplers=function(){return this._samplerList},e.prototype.getUniformNames=function(){return this._uniformsNames},e.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList},e.prototype.getIndexParameters=function(){return this._indexParameters},e.prototype.getCompilationError=function(){return this._compilationError},e.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed},e.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add((function(t){e(t)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((function(){t._checkIsReady(null)}),16))},e.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}this._isDisposed||setTimeout((function(){t._checkIsReady(e)}),16)},Object.defineProperty(e.prototype,\"vertexSourceCode\",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())&&void 0!==t?t:this._vertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"fragmentSourceCode\",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())&&void 0!==t?t:this._fragmentSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"vertexSourceCodeBeforeMigration\",{get:function(){return this._vertexSourceCodeBeforeMigration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"fragmentSourceCodeBeforeMigration\",{get:function(){return this._fragmentSourceCodeBeforeMigration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"rawVertexSourceCode\",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"rawFragmentSourceCode\",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0}),e.prototype.getPipelineGenerationOptions=function(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split(\"\\n\"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}},e.prototype._rebuildProgram=function(e,t,r,n){var i=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){n&&n(t)},this.onCompiled=function(){var e,t,n=i.getEngine().scenes;if(n)for(var a=0;a<n.length;a++)n[a].markAllMaterialsAsDirty(o.Y.MATERIAL_AllDirtyFlag);null===(t=(e=i._pipelineContext)._handlesSpectorRebuildCallback)||void 0===t||t.call(e,r)},this._fallbacks=null,this._prepareEffect()},e.prototype._onRenderingStateCompiled=function(e){if(this._pipelineContext=e,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(var t=0;t<this._attributesNames.length;t++){var r=this._attributesNames[t];this._attributeLocationByName[r]=this._attributes[t]}this._engine.bindSamplers(this),this._compilationError=\"\",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh()},e.prototype._prepareEffect=function(e){var t=this;void 0===e&&(e=!1);var r=this._pipelineContext;this._isReady=!1;try{var n=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),i=n?null:this.defines,o=n?this._vertexSourceCodeOverride:this._vertexSourceCode,a=n?this._fragmentSourceCodeOverride:this._fragmentSourceCode,s=this._engine;this._pipelineContext=(0,l.uR)({existingPipelineContext:e?r:null,vertex:o,fragment:a,context:\"WEBGL2\"===s.shaderPlatformName?s._gl:void 0,rebuildRebind:function(e,r,n,i){return t._rebuildProgram(e,r,n,i)},defines:i,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\\r/g,\"\").replace(/\\n/g,\"|\"),createAsRaw:n,parallelShaderCompile:s._caps.parallelShaderCompile,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:function(n){r&&!e&&t._engine._deletePipelineContext(r),n&&t._onRenderingStateCompiled(n)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContext.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(e){this._processCompilationErrors(e,r)}},e.prototype._getShaderCodeAndErrorLine=function(e,t,r){var n=r?/FRAGMENT SHADER ERROR: 0:(\\d+?):/:/VERTEX SHADER ERROR: 0:(\\d+?):/,i=null;if(t&&e){var o=t.match(n);if(o&&2===o.length){var a=parseInt(o[1]),s=e.split(\"\\n\",-1);s.length>=a&&(i=\"Offending line [\".concat(a,\"] in \").concat(r?\"fragment\":\"vertex\",\" code: \").concat(s[a-1]))}}return[e,i]},e.prototype._processCompilationErrors=function(t,r){var n,i,o,s,l,c=this;void 0===r&&(r=null),this._compilationError=t.message;var u=this._attributesNames,h=this._fallbacks;if(a.V.Error(\"Unable to compile effect:\"),a.V.Error(\"Uniforms: \"+this._uniformsNames.map((function(e){return\" \"+e}))),a.V.Error(\"Attributes: \"+u.map((function(e){return\" \"+e}))),a.V.Error(\"Defines:\\n\"+this.defines),e.LogShaderCodeOnCompilationError){var d=null,f=null,p=null;(null===(o=this._pipelineContext)||void 0===o?void 0:o._getVertexShaderCode())&&(p=(n=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],d=n[1],p&&(a.V.Error(\"Vertex code:\"),a.V.Error(p))),(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode())&&(p=(i=this._getShaderCodeAndErrorLine(null===(l=this._pipelineContext)||void 0===l?void 0:l._getFragmentShaderCode(),this._compilationError,!0))[0],f=i[1],p&&(a.V.Error(\"Fragment code:\"),a.V.Error(p))),d&&a.V.Error(d),f&&a.V.Error(f)}a.V.Error(\"Error: \"+this._compilationError);var _=function(){c.onError&&c.onError(c,c._compilationError),c.onErrorObservable.notifyObservers(c)};r&&(this._pipelineContext=r,this._isReady=!0,_()),h?(this._pipelineContext=null,h.hasMoreFallbacks?(this._allFallbacksProcessed=!1,a.V.Error(\"Trying next fallback.\"),this.defines=h.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,_(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,r||_())},Object.defineProperty(e.prototype,\"isSupported\",{get:function(){return\"\"===this._compilationError},enumerable:!1,configurable:!0}),e.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers[e],t,e)},e.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setTextureArray=function(e,t){var r=e+\"Ex\";if(-1===this._samplerList.indexOf(r+\"0\")){for(var n=this._samplerList.indexOf(e),i=1;i<t.length;i++){var o=r+(i-1).toString();this._samplerList.splice(n+i,0,o)}for(var a=0,s=0,l=this._samplerList;s<l.length;s++){var c=l[s];this._samplers[c]=a,a+=1}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)},e.prototype.bindUniformBuffer=function(t,r){var n=this._uniformBuffersNames[r];void 0===n||e._BaseCache[n]===t&&this._engine._features.useUBOBindingCache||(e._BaseCache[n]=t,this._engine.bindUniformBufferBase(t,n,r))},e.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)},e.prototype.setInt=function(e,t){return this._pipelineContext.setInt(e,t),this},e.prototype.setInt2=function(e,t,r){return this._pipelineContext.setInt2(e,t,r),this},e.prototype.setInt3=function(e,t,r,n){return this._pipelineContext.setInt3(e,t,r,n),this},e.prototype.setInt4=function(e,t,r,n,i){return this._pipelineContext.setInt4(e,t,r,n,i),this},e.prototype.setIntArray=function(e,t){return this._pipelineContext.setIntArray(e,t),this},e.prototype.setIntArray2=function(e,t){return this._pipelineContext.setIntArray2(e,t),this},e.prototype.setIntArray3=function(e,t){return this._pipelineContext.setIntArray3(e,t),this},e.prototype.setIntArray4=function(e,t){return this._pipelineContext.setIntArray4(e,t),this},e.prototype.setUInt=function(e,t){return this._pipelineContext.setUInt(e,t),this},e.prototype.setUInt2=function(e,t,r){return this._pipelineContext.setUInt2(e,t,r),this},e.prototype.setUInt3=function(e,t,r,n){return this._pipelineContext.setUInt3(e,t,r,n),this},e.prototype.setUInt4=function(e,t,r,n,i){return this._pipelineContext.setUInt4(e,t,r,n,i),this},e.prototype.setUIntArray=function(e,t){return this._pipelineContext.setUIntArray(e,t),this},e.prototype.setUIntArray2=function(e,t){return this._pipelineContext.setUIntArray2(e,t),this},e.prototype.setUIntArray3=function(e,t){return this._pipelineContext.setUIntArray3(e,t),this},e.prototype.setUIntArray4=function(e,t){return this._pipelineContext.setUIntArray4(e,t),this},e.prototype.setFloatArray=function(e,t){return this._pipelineContext.setArray(e,t),this},e.prototype.setFloatArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},e.prototype.setFloatArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},e.prototype.setFloatArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},e.prototype.setArray=function(e,t){return this._pipelineContext.setArray(e,t),this},e.prototype.setArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},e.prototype.setArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},e.prototype.setArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},e.prototype.setMatrices=function(e,t){return this._pipelineContext.setMatrices(e,t),this},e.prototype.setMatrix=function(e,t){return this._pipelineContext.setMatrix(e,t),this},e.prototype.setMatrix3x3=function(e,t){return this._pipelineContext.setMatrix3x3(e,t),this},e.prototype.setMatrix2x2=function(e,t){return this._pipelineContext.setMatrix2x2(e,t),this},e.prototype.setFloat=function(e,t){return this._pipelineContext.setFloat(e,t),this},e.prototype.setBool=function(e,t){return this._pipelineContext.setInt(e,t?1:0),this},e.prototype.setVector2=function(e,t){return this._pipelineContext.setVector2(e,t),this},e.prototype.setFloat2=function(e,t,r){return this._pipelineContext.setFloat2(e,t,r),this},e.prototype.setVector3=function(e,t){return this._pipelineContext.setVector3(e,t),this},e.prototype.setFloat3=function(e,t,r,n){return this._pipelineContext.setFloat3(e,t,r,n),this},e.prototype.setVector4=function(e,t){return this._pipelineContext.setVector4(e,t),this},e.prototype.setQuaternion=function(e,t){return this._pipelineContext.setQuaternion(e,t),this},e.prototype.setFloat4=function(e,t,r,n,i){return this._pipelineContext.setFloat4(e,t,r,n,i),this},e.prototype.setColor3=function(e,t){return this._pipelineContext.setColor3(e,t),this},e.prototype.setColor4=function(e,t,r){return this._pipelineContext.setColor4(e,t,r),this},e.prototype.setDirectColor4=function(e,t){return this._pipelineContext.setDirectColor4(e,t),this},e.prototype.dispose=function(){this._refCount--,this._refCount>0||(this._pipelineContext&&(0,l.mO)(this._pipelineContext),this._engine._releaseEffect(this),this._isDisposed=!0)},e.RegisterShader=function(e,t,r,n){void 0===n&&(n=0),t&&(s.l.GetShadersStore(n)[\"\".concat(e,\"PixelShader\")]=t),r&&(s.l.GetShadersStore(n)[\"\".concat(e,\"VertexShader\")]=r)},e.ResetCache=function(){e._BaseCache={}},e.LogShaderCodeOnCompilationError=!0,e._UniqueIdSeed=0,e._BaseCache={},e.ShadersStore=s.l.ShadersStore,e.IncludesShadersStore=s.l.IncludesShadersStore,e}()},93540:(e,t,r)=>{r.d(t,{$:()=>h,J:()=>u});var n=r(62623),i=r(25187),o=r(81152),a=r(66377),s=r(74239),l=r(14777),c=(r(96795),{positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]}),u=function(){function e(e,t){var r;void 0===t&&(t=c);var o,a,s=this;this._fullscreenViewport=new i.L(0,0,1,1);var l=null!==(o=t.positions)&&void 0!==o?o:c.positions,u=null!==(a=t.indices)&&void 0!==a?a:c.indices;this.engine=e,this._vertexBuffers=((r={})[n.R.PositionKind]=new n.R(e,l,n.R.PositionKind,!1,!1,2),r),this._indexBuffer=e.createIndexBuffer(u),this._onContextRestoredObserver=e.onContextRestoredObservable.add((function(){for(var t in s._indexBuffer=e.createIndexBuffer(u),s._vertexBuffers)s._vertexBuffers[t]._rebuild()}))}return e.prototype.setViewport=function(e){void 0===e&&(e=this._fullscreenViewport),this.engine.setViewport(e)},e.prototype.bindBuffers=function(e){this.engine.bindBuffers(this._vertexBuffers,this._indexBuffer,e)},e.prototype.applyEffectWrapper=function(e){this.engine.setState(!0),this.engine.depthCullingState.depthTest=!1,this.engine.stencilState.stencilTest=!1,this.engine.enableEffect(e._drawWrapper),this.bindBuffers(e.effect),e.onApplyObservable.notifyObservers({})},e.prototype.saveStates=function(){this._savedStateDepthTest=this.engine.depthCullingState.depthTest,this._savedStateStencilTest=this.engine.stencilState.stencilTest},e.prototype.restoreStates=function(){this.engine.depthCullingState.depthTest=this._savedStateDepthTest,this.engine.stencilState.stencilTest=this._savedStateStencilTest},e.prototype.draw=function(){this.engine.drawElementsType(o.Y.MATERIAL_TriangleFillMode,0,6)},e.prototype._isRenderTargetTexture=function(e){return void 0!==e.renderTarget},e.prototype.render=function(e,t){if(void 0===t&&(t=null),e.effect.isReady()){this.saveStates(),this.setViewport();var r=null===t?null:this._isRenderTargetTexture(t)?t.renderTarget:t;r&&this.engine.bindFramebuffer(r),this.applyEffectWrapper(e),this.draw(),r&&this.engine.unBindFramebuffer(r),this.restoreStates()}},e.prototype.dispose=function(){var e=this._vertexBuffers[n.R.PositionKind];e&&(e.dispose(),delete this._vertexBuffers[n.R.PositionKind]),this._indexBuffer&&this.engine._releaseBuffer(this._indexBuffer),this._onContextRestoredObserver&&(this.engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)},e}(),h=function(){function e(e){var t,r=this;this.onApplyObservable=new a.cP;var n=e.uniformNames||[];e.vertexShader?t={fragmentSource:e.fragmentShader,vertexSource:e.vertexShader,spectorName:e.name||\"effectWrapper\"}:(n.push(\"scale\"),t={fragmentSource:e.fragmentShader,vertex:\"postprocess\",spectorName:e.name||\"effectWrapper\"},this.onApplyObservable.add((function(){r.effect.setFloat2(\"scale\",1,1)})));var i=e.defines?e.defines.join(\"\\n\"):\"\";this._drawWrapper=new l.E(e.engine),e.useShaderStore?(t.fragment=t.fragmentSource,t.vertex||(t.vertex=t.vertexSource),delete t.fragmentSource,delete t.vertexSource,this.effect=e.engine.createEffect(t,e.attributeNames||[\"position\"],n,e.samplerNames,i,void 0,e.onCompiled,void 0,void 0,e.shaderLanguage,e.extraInitializationsAsync)):(this.effect=new s.M(t,e.attributeNames||[\"position\"],n,e.samplerNames,e.engine,i,void 0,e.onCompiled,void 0,void 0,void 0,e.shaderLanguage,e.extraInitializationsAsync),this._onContextRestoredObserver=e.engine.onContextRestoredObservable.add((function(){r.effect._pipelineContext=null,r.effect._prepareEffect()})))}return Object.defineProperty(e.prototype,\"effect\",{get:function(){return this._drawWrapper.effect},set:function(e){this._drawWrapper.effect=e},enumerable:!1,configurable:!0}),e.prototype.dispose=function(e){void 0===e&&(e=!1),this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null),this.effect.dispose()},e}()},27181:(e,t,r)=>{r.d(t,{C:()=>o,_:()=>i});var n=r(10740);function i(e,t){t.EXPOSURE&&e.push(\"exposureLinear\"),t.CONTRAST&&e.push(\"contrast\"),t.COLORGRADING&&e.push(\"colorTransformSettings\"),(t.VIGNETTE||t.DITHER)&&e.push(\"vInverseScreenSize\"),t.VIGNETTE&&(e.push(\"vignetteSettings1\"),e.push(\"vignetteSettings2\")),t.COLORCURVES&&(0,n.B)(e),t.DITHER&&e.push(\"ditherIntensity\")}function o(e,t){t.COLORGRADING&&e.push(\"txColorTransform\")}},81914:(e,t,r)=>{r.d(t,{p:()=>d});var n=r(78322),i=r(6174),o=r(66377),a=r(64726),s=r(76331),l=r(87074),c=r(12028),u=r(27181),h=r(34623),d=function(){function e(){this.colorCurves=new s.Q,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=e.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCenterX=0,this.vignetteCenterY=0,this.vignetteWeight=1.5,this.vignetteColor=new a.ov(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=e.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._ditheringEnabled=!1,this._ditheringIntensity=1/255,this._skipFinalColorClamp=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new o.cP}return Object.defineProperty(e.prototype,\"colorCurvesEnabled\",{get:function(){return this._colorCurvesEnabled},set:function(e){this._colorCurvesEnabled!==e&&(this._colorCurvesEnabled=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"colorGradingTexture\",{get:function(){return this._colorGradingTexture},set:function(e){this._colorGradingTexture!==e&&(this._colorGradingTexture=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"colorGradingEnabled\",{get:function(){return this._colorGradingEnabled},set:function(e){this._colorGradingEnabled!==e&&(this._colorGradingEnabled=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"colorGradingWithGreenDepth\",{get:function(){return this._colorGradingWithGreenDepth},set:function(e){this._colorGradingWithGreenDepth!==e&&(this._colorGradingWithGreenDepth=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"colorGradingBGR\",{get:function(){return this._colorGradingBGR},set:function(e){this._colorGradingBGR!==e&&(this._colorGradingBGR=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"exposure\",{get:function(){return this._exposure},set:function(e){this._exposure!==e&&(this._exposure=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"toneMappingEnabled\",{get:function(){return this._toneMappingEnabled},set:function(e){this._toneMappingEnabled!==e&&(this._toneMappingEnabled=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"toneMappingType\",{get:function(){return this._toneMappingType},set:function(e){this._toneMappingType!==e&&(this._toneMappingType=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"contrast\",{get:function(){return this._contrast},set:function(e){this._contrast!==e&&(this._contrast=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"vignetteCentreY\",{get:function(){return this.vignetteCenterY},set:function(e){this.vignetteCenterY=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"vignetteCentreX\",{get:function(){return this.vignetteCenterX},set:function(e){this.vignetteCenterX=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"vignetteBlendMode\",{get:function(){return this._vignetteBlendMode},set:function(e){this._vignetteBlendMode!==e&&(this._vignetteBlendMode=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"vignetteEnabled\",{get:function(){return this._vignetteEnabled},set:function(e){this._vignetteEnabled!==e&&(this._vignetteEnabled=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"ditheringEnabled\",{get:function(){return this._ditheringEnabled},set:function(e){this._ditheringEnabled!==e&&(this._ditheringEnabled=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"ditheringIntensity\",{get:function(){return this._ditheringIntensity},set:function(e){this._ditheringIntensity!==e&&(this._ditheringIntensity=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"skipFinalColorClamp\",{get:function(){return this._skipFinalColorClamp},set:function(e){this._skipFinalColorClamp!==e&&(this._skipFinalColorClamp=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"applyByPostProcess\",{get:function(){return this._applyByPostProcess},set:function(e){this._applyByPostProcess!==e&&(this._applyByPostProcess=e,this._updateParameters())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isEnabled\",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._updateParameters())},enumerable:!1,configurable:!0}),e.prototype._updateParameters=function(){this.onUpdateParameters.notifyObservers(this)},e.prototype.getClassName=function(){return\"ImageProcessingConfiguration\"},e.prototype.prepareDefines=function(t,r){if(void 0===r&&(r=!1),r!==this.applyByPostProcess||!this._isEnabled)return t.VIGNETTE=!1,t.TONEMAPPING=0,t.CONTRAST=!1,t.EXPOSURE=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.DITHER=!1,t.IMAGEPROCESSING=!1,t.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,void(t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled);if(t.VIGNETTE=this.vignetteEnabled,t.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===e._VIGNETTEMODE_MULTIPLY,t.VIGNETTEBLENDMODEOPAQUE=!t.VIGNETTEBLENDMODEMULTIPLY,this._toneMappingEnabled)switch(this._toneMappingType){case e.TONEMAPPING_KHR_PBR_NEUTRAL:t.TONEMAPPING=3;break;case e.TONEMAPPING_ACES:t.TONEMAPPING=2;break;default:t.TONEMAPPING=1}else t.TONEMAPPING=0;t.CONTRAST=1!==this.contrast,t.EXPOSURE=1!==this.exposure,t.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,t.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,t.COLORGRADING?t.COLORGRADING3D=this.colorGradingTexture.is3D:t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,t.SAMPLER3DBGRMAP=this.colorGradingBGR,t.DITHER=this._ditheringEnabled,t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,t.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,t.IMAGEPROCESSING=t.VIGNETTE||!!t.TONEMAPPING||t.CONTRAST||t.EXPOSURE||t.COLORCURVES||t.COLORGRADING||t.DITHER},e.prototype.isReady=function(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()},e.prototype.bind=function(e,t){if(this._colorCurvesEnabled&&this.colorCurves&&s.Q.Bind(this.colorCurves,e),this._vignetteEnabled||this._ditheringEnabled){var r=1/e.getEngine().getRenderWidth(),n=1/e.getEngine().getRenderHeight();if(e.setFloat2(\"vInverseScreenSize\",r,n),this._ditheringEnabled&&e.setFloat(\"ditherIntensity\",.5*this._ditheringIntensity),this._vignetteEnabled){var i=null!=t?t:n/r,o=Math.tan(.5*this.vignetteCameraFov),a=o*i,c=Math.sqrt(a*o);a=(0,l.zF)(a,c,this.vignetteStretch),o=(0,l.zF)(o,c,this.vignetteStretch),e.setFloat4(\"vignetteSettings1\",a,o,-a*this.vignetteCenterX,-o*this.vignetteCenterY);var u=-2*this.vignetteWeight;e.setFloat4(\"vignetteSettings2\",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,u)}}if(e.setFloat(\"exposureLinear\",this.exposure),e.setFloat(\"contrast\",this.contrast),this.colorGradingTexture){e.setTexture(\"txColorTransform\",this.colorGradingTexture);var h=this.colorGradingTexture.getSize().height;e.setFloat4(\"colorTransformSettings\",(h-1)/h,.5/h,h,this.colorGradingTexture.level)}},e.prototype.clone=function(){return c.p.Clone((function(){return new e}),this)},e.prototype.serialize=function(){return c.p.Serialize(this)},e.Parse=function(t){var r=c.p.Parse((function(){return new e}),t,null,null);return void 0!==t.vignetteCentreX&&(r.vignetteCenterX=t.vignetteCentreX),void 0!==t.vignetteCentreY&&(r.vignetteCenterY=t.vignetteCentreY),r},Object.defineProperty(e,\"VIGNETTEMODE_MULTIPLY\",{get:function(){return this._VIGNETTEMODE_MULTIPLY},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"VIGNETTEMODE_OPAQUE\",{get:function(){return this._VIGNETTEMODE_OPAQUE},enumerable:!1,configurable:!0}),e.TONEMAPPING_STANDARD=0,e.TONEMAPPING_ACES=1,e.TONEMAPPING_KHR_PBR_NEUTRAL=2,e.PrepareUniforms=u._,e.PrepareSamplers=u.C,e._VIGNETTEMODE_MULTIPLY=0,e._VIGNETTEMODE_OPAQUE=1,(0,n.Cg)([(0,i.wL)()],e.prototype,\"colorCurves\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_colorCurvesEnabled\",void 0),(0,n.Cg)([(0,i.uM)(\"colorGradingTexture\")],e.prototype,\"_colorGradingTexture\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_colorGradingEnabled\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_colorGradingWithGreenDepth\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_colorGradingBGR\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_exposure\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_toneMappingEnabled\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_toneMappingType\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_contrast\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"vignetteStretch\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"vignetteCenterX\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"vignetteCenterY\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"vignetteWeight\",void 0),(0,n.Cg)([(0,i.qK)()],e.prototype,\"vignetteColor\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"vignetteCameraFov\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_vignetteBlendMode\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_vignetteEnabled\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_ditheringEnabled\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_ditheringIntensity\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_skipFinalColorClamp\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_applyByPostProcess\",void 0),(0,n.Cg)([(0,i.lK)()],e.prototype,\"_isEnabled\",void 0),e}();c.p._ImageProcessingConfigurationParser=d.Parse,(0,h.Y5)(\"BABYLON.ImageProcessingConfiguration\",d)},85096:(e,t,r)=>{r.d(t,{Bb:()=>z,DL:()=>h,ER:()=>C,GD:()=>k,IC:()=>N,IF:()=>p,J2:()=>b,Jz:()=>L,Kd:()=>E,L0:()=>T,MF:()=>f,N4:()=>U,Nc:()=>V,OR:()=>D,RL:()=>x,VO:()=>B,Y7:()=>G,YT:()=>v,Yy:()=>d,_8:()=>g,az:()=>M,c4:()=>A,f$:()=>S,fm:()=>I,lo:()=>O,mA:()=>y,nR:()=>m,ni:()=>P,qB:()=>w,qL:()=>R,te:()=>_,wu:()=>F});var n=r(7164),i=r(81152),o=r(64726),a=r(66614),s=r(91946),l=r(34561),c=o.v9.Black(),u={NUM_MORPH_INFLUENCERS:0};function h(e,t,r){if(!e||e.LOGARITHMICDEPTH||e.indexOf&&e.indexOf(\"LOGARITHMICDEPTH\")>=0){var o=r.activeCamera;o.mode===i.Y.ORTHOGRAPHIC_CAMERA&&n.V.Error(\"Logarithmic depth is not compatible with orthographic cameras!\",20),t.setFloat(\"logarithmicDepthConstant\",2/(Math.log(o.maxZ+1)/Math.LN2))}}function d(e,t,r,n){void 0===n&&(n=!1),r&&e.fogEnabled&&(!t||t.applyFog)&&e.fogMode!==i.Y.FOGMODE_NONE&&(r.setFloat4(\"vFogInfos\",e.fogMode,e.fogStart,e.fogEnd,e.fogDensity),n?(e.fogColor.toLinearSpaceToRef(c,e.getEngine().useExactSrgbConversions),r.setColor3(\"vFogColor\",c)):r.setColor3(\"vFogColor\",e.fogColor))}function f(e,t,r){u.NUM_MORPH_INFLUENCERS=r,p(e,t,u)}function p(e,t,r){var o=r.NUM_MORPH_INFLUENCERS;if(o>0&&a.q.LastCreatedEngine){var s=a.q.LastCreatedEngine.getCaps().maxVertexAttribs,l=t.morphTargetManager;if(null==l?void 0:l.isUsingTextureForTargets)return;for(var c=l&&l.supportsNormals&&r.NORMAL,u=l&&l.supportsTangents&&r.TANGENT,h=l&&l.supportsUVs&&r.UV1,d=0;d<o;d++)e.push(i.Y.PositionKind+d),c&&e.push(i.Y.NormalKind+d),u&&e.push(i.Y.TangentKind+d),h&&e.push(i.Y.UVKind+\"_\"+d),e.length>s&&n.V.Error(\"Cannot add more vertex attributes for mesh \"+t.name)}}function _(e,t){void 0===t&&(t=!1),e.push(\"world0\"),e.push(\"world1\"),e.push(\"world2\"),e.push(\"world3\"),t&&(e.push(\"previousWorld0\"),e.push(\"previousWorld1\"),e.push(\"previousWorld2\"),e.push(\"previousWorld3\"))}function m(e,t){var r=e.morphTargetManager;e&&r&&t.setFloatArray(\"morphTargetInfluences\",r.influences)}function g(e,t){t.bindToEffect(e,\"Scene\")}function v(e,t,r){t._needUVs=!0,t[r]=!0,e.optimizeUVAllocation&&e.getTextureMatrix().isIdentityAs3x2()?(t[r+\"DIRECTUV\"]=e.coordinatesIndex+1,t[\"MAINUV\"+(e.coordinatesIndex+1)]=!0):t[r+\"DIRECTUV\"]=0}function y(e,t,r){var n=e.getTextureMatrix();t.updateMatrix(r+\"Matrix\",n)}function b(e,t,r){r.BAKED_VERTEX_ANIMATION_TEXTURE&&r.INSTANCES&&e.push(\"bakedVertexAnimationSettingsInstanced\")}function S(e,t,r){var n;if(t&&e&&(e.computeBonesUsingShaders&&t._bonesComputationForcedToCPU&&(e.computeBonesUsingShaders=!1),e.useBones&&e.computeBonesUsingShaders&&e.skeleton)){var o=e.skeleton;if(o.isUsingTextureForMatrices&&t.getUniformIndex(\"boneTextureWidth\")>-1){var a=o.getTransformMatrixTexture(e);t.setTexture(\"boneSampler\",a),t.setFloat(\"boneTextureWidth\",4*(o.bones.length+1))}else{var s=o.getTransformMatrices(e);s&&(t.setMatrices(\"mBones\",s),r&&e.getScene().prePassRenderer&&e.getScene().prePassRenderer.getIndex(i.Y.PREPASS_VELOCITY_TEXTURE_TYPE)&&(r.previousBones[e.uniqueId]||(r.previousBones[e.uniqueId]=s.slice()),t.setMatrices(\"mPreviousBones\",r.previousBones[e.uniqueId]),n=s,r.previousBones[e.uniqueId].set(n)))}}}function T(e,t,r){e.transferToEffect(t,r+\"\")}function E(e,t,r,n,i,o){void 0===o&&(o=!0),e._bindLight(t,r,n,i,o)}function x(e,t,r,n,i){void 0===i&&(i=4);for(var o=Math.min(t.lightSources.length,i),a=0;a<o;a++)E(t.lightSources[a],a,e,r,\"boolean\"==typeof n?n:n.SPECULARTERM,t.receiveShadows)}function P(e,t,r,n){r.NUM_BONE_INFLUENCERS>0&&(n.addCPUSkinningFallback(0,t),e.push(i.Y.MatricesIndicesKind),e.push(i.Y.MatricesWeightsKind),r.NUM_BONE_INFLUENCERS>4&&(e.push(i.Y.MatricesIndicesExtraKind),e.push(i.Y.MatricesWeightsExtraKind)))}function C(e,t){(t.INSTANCES||t.THIN_INSTANCES)&&_(e,!!t.PREPASS_VELOCITY),t.INSTANCESCOLOR&&e.push(i.Y.ColorInstanceKind)}function A(e,t,r,n){void 0===r&&(r=4),void 0===n&&(n=0);for(var i=0,o=0;o<r&&e[\"LIGHT\"+o];o++)o>0&&(i=n+o,t.addFallback(i,\"LIGHT\"+o)),e.SHADOWS||(e[\"SHADOW\"+o]&&t.addFallback(n,\"SHADOW\"+o),e[\"SHADOWPCF\"+o]&&t.addFallback(n,\"SHADOWPCF\"+o),e[\"SHADOWPCSS\"+o]&&t.addFallback(n,\"SHADOWPCSS\"+o),e[\"SHADOWPOISSON\"+o]&&t.addFallback(n,\"SHADOWPOISSON\"+o),e[\"SHADOWESM\"+o]&&t.addFallback(n,\"SHADOWESM\"+o),e[\"SHADOWCLOSEESM\"+o]&&t.addFallback(n,\"SHADOWCLOSEESM\"+o));return i++}function R(e,t){return t.fogEnabled&&e.applyFog&&t.fogMode!==i.Y.FOGMODE_NONE}function I(e,t,r,n,i,o,a,s){void 0===s&&(s=!1),a._areMiscDirty&&(a.LOGARITHMICDEPTH=r,a.POINTSIZE=n,a.FOG=i&&R(e,t),a.NONUNIFORMSCALING=e.nonUniformScaling,a.ALPHATEST=o,a.DECAL_AFTER_DETAIL=s)}function M(e,t,r,n,i,o){if(void 0===i&&(i=4),void 0===o&&(o=!1),!r._areLightsDirty)return r._needNormals;var a=0,s={needNormals:r._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(e.lightsEnabled&&!o)for(var l=0,c=t.lightSources;l<c.length&&(O(e,t,c[l],a,r,n,s),++a!==i);l++);r.SPECULARTERM=s.specularEnabled,r.SHADOWS=s.shadowEnabled;for(var u=a;u<i;u++)void 0!==r[\"LIGHT\"+u]&&(r[\"LIGHT\"+u]=!1,r[\"HEMILIGHT\"+u]=!1,r[\"POINTLIGHT\"+u]=!1,r[\"DIRLIGHT\"+u]=!1,r[\"SPOTLIGHT\"+u]=!1,r[\"SHADOW\"+u]=!1,r[\"SHADOWCSM\"+u]=!1,r[\"SHADOWCSMDEBUG\"+u]=!1,r[\"SHADOWCSMNUM_CASCADES\"+u]=!1,r[\"SHADOWCSMUSESHADOWMAXZ\"+u]=!1,r[\"SHADOWCSMNOBLEND\"+u]=!1,r[\"SHADOWCSM_RIGHTHANDED\"+u]=!1,r[\"SHADOWPCF\"+u]=!1,r[\"SHADOWPCSS\"+u]=!1,r[\"SHADOWPOISSON\"+u]=!1,r[\"SHADOWESM\"+u]=!1,r[\"SHADOWCLOSEESM\"+u]=!1,r[\"SHADOWCUBE\"+u]=!1,r[\"SHADOWLOWQUALITY\"+u]=!1,r[\"SHADOWMEDIUMQUALITY\"+u]=!1);var h=e.getEngine().getCaps();return void 0===r.SHADOWFLOAT&&(s.needRebuild=!0),r.SHADOWFLOAT=s.shadowEnabled&&(h.textureFloatRender&&h.textureFloatLinearFiltering||h.textureHalfFloatRender&&h.textureHalfFloatLinearFiltering),r.LIGHTMAPEXCLUDED=s.lightmapMode,s.needRebuild&&r.rebuild(),s.needNormals}function O(e,t,r,n,i,o,a){var l;switch(a.needNormals=!0,void 0===i[\"LIGHT\"+n]&&(a.needRebuild=!0),i[\"LIGHT\"+n]=!0,i[\"SPOTLIGHT\"+n]=!1,i[\"HEMILIGHT\"+n]=!1,i[\"POINTLIGHT\"+n]=!1,i[\"DIRLIGHT\"+n]=!1,r.prepareLightSpecificDefines(i,n),i[\"LIGHT_FALLOFF_PHYSICAL\"+n]=!1,i[\"LIGHT_FALLOFF_GLTF\"+n]=!1,i[\"LIGHT_FALLOFF_STANDARD\"+n]=!1,r.falloffType){case s.c.FALLOFF_GLTF:i[\"LIGHT_FALLOFF_GLTF\"+n]=!0;break;case s.c.FALLOFF_PHYSICAL:i[\"LIGHT_FALLOFF_PHYSICAL\"+n]=!0;break;case s.c.FALLOFF_STANDARD:i[\"LIGHT_FALLOFF_STANDARD\"+n]=!0}if(o&&!r.specular.equalsFloats(0,0,0)&&(a.specularEnabled=!0),i[\"SHADOW\"+n]=!1,i[\"SHADOWCSM\"+n]=!1,i[\"SHADOWCSMDEBUG\"+n]=!1,i[\"SHADOWCSMNUM_CASCADES\"+n]=!1,i[\"SHADOWCSMUSESHADOWMAXZ\"+n]=!1,i[\"SHADOWCSMNOBLEND\"+n]=!1,i[\"SHADOWCSM_RIGHTHANDED\"+n]=!1,i[\"SHADOWPCF\"+n]=!1,i[\"SHADOWPCSS\"+n]=!1,i[\"SHADOWPOISSON\"+n]=!1,i[\"SHADOWESM\"+n]=!1,i[\"SHADOWCLOSEESM\"+n]=!1,i[\"SHADOWCUBE\"+n]=!1,i[\"SHADOWLOWQUALITY\"+n]=!1,i[\"SHADOWMEDIUMQUALITY\"+n]=!1,t&&t.receiveShadows&&e.shadowsEnabled&&r.shadowEnabled){var c=null!==(l=r.getShadowGenerator(e.activeCamera))&&void 0!==l?l:r.getShadowGenerator();if(c){var u=c.getShadowMap();u&&u.renderList&&u.renderList.length>0&&(a.shadowEnabled=!0,c.prepareDefines(i,n))}}r.lightmapMode!=s.c.LIGHTMAP_DEFAULT?(a.lightmapMode=!0,i[\"LIGHTMAPEXCLUDED\"+n]=!0,i[\"LIGHTMAPNOSPECULAR\"+n]=r.lightmapMode==s.c.LIGHTMAP_SHADOWSONLY):(i[\"LIGHTMAPEXCLUDED\"+n]=!1,i[\"LIGHTMAPNOSPECULAR\"+n]=!1)}function D(e,t,r,n,i,o,a){void 0===o&&(o=null),void 0===a&&(a=!1);var s=G(e,n);!1!==o&&(s=(0,l.Eq)(r,e,n)),n.DEPTHPREPASS!==!t.getColorWrite()&&(n.DEPTHPREPASS=!n.DEPTHPREPASS,s=!0),n.INSTANCES!==i&&(n.INSTANCES=i,s=!0),n.THIN_INSTANCES!==a&&(n.THIN_INSTANCES=a,s=!0),s&&n.markAsUnprocessed()}function N(e,t){if(e.useBones&&e.computeBonesUsingShaders&&e.skeleton){t.NUM_BONE_INFLUENCERS=e.numBoneInfluencers;var r=void 0!==t.BONETEXTURE;if(e.skeleton.isUsingTextureForMatrices&&r)t.BONETEXTURE=!0;else{t.BonesPerMesh=e.skeleton.bones.length+1,t.BONETEXTURE=!r&&void 0;var n=e.getScene().prePassRenderer;if(n&&n.enabled){var i=-1===n.excludedSkinnedMesh.indexOf(e);t.BONES_VELOCITY_ENABLED=i}}}else t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,void 0!==t.BONETEXTURE&&(t.BONETEXTURE=!1)}function L(e,t){var r=e.morphTargetManager;r?(t.MORPHTARGETS_UV=r.supportsUVs&&t.UV1,t.MORPHTARGETS_TANGENT=r.supportsTangents&&t.TANGENT,t.MORPHTARGETS_NORMAL=r.supportsNormals&&t.NORMAL,t.NUM_MORPH_INFLUENCERS=r.numMaxInfluencers||r.numInfluencers,t.MORPHTARGETS=t.NUM_MORPH_INFLUENCERS>0,t.MORPHTARGETS_TEXTURE=r.isUsingTextureForTargets):(t.MORPHTARGETS_UV=!1,t.MORPHTARGETS_TANGENT=!1,t.MORPHTARGETS_NORMAL=!1,t.MORPHTARGETS=!1,t.NUM_MORPH_INFLUENCERS=0)}function F(e,t){var r=e.bakedVertexAnimationManager;t.BAKED_VERTEX_ANIMATION_TEXTURE=!(!r||!r.isEnabled)}function w(e,t,r,n,o,a,s){if(void 0===o&&(o=!1),void 0===a&&(a=!0),void 0===s&&(s=!0),!t._areAttributesDirty&&t._needNormals===t._normals&&t._needUVs===t._uvs)return!1;t._normals=t._needNormals,t._uvs=t._needUVs,t.NORMAL=t._needNormals&&e.isVerticesDataPresent(i.Y.NormalKind),t._needNormals&&e.isVerticesDataPresent(i.Y.TangentKind)&&(t.TANGENT=!0);for(var l=1;l<=i.Y.MAX_SUPPORTED_UV_SETS;++l)t[\"UV\"+l]=!!t._needUVs&&e.isVerticesDataPresent(\"uv\".concat(1===l?\"\":l));if(r){var c=e.useVertexColors&&e.isVerticesDataPresent(i.Y.ColorKind);t.VERTEXCOLOR=c,t.VERTEXALPHA=e.hasVertexAlpha&&c&&a}return e.isVerticesDataPresent(i.Y.ColorInstanceKind)&&(e.hasInstances||e.hasThinInstances)&&(t.INSTANCESCOLOR=!0),n&&N(e,t),o&&L(e,t),s&&F(e,t),!0}function B(e,t){if(e.activeCamera){var r=t.MULTIVIEW;t.MULTIVIEW=null!==e.activeCamera.outputRenderTarget&&e.activeCamera.outputRenderTarget.getViewCount()>1,t.MULTIVIEW!=r&&t.markAsUnprocessed()}}function V(e,t,r){var n=t.ORDER_INDEPENDENT_TRANSPARENCY,i=t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;t.ORDER_INDEPENDENT_TRANSPARENCY=e.useOrderIndependentTransparency&&r,t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!e.getEngine().getCaps().textureFloatLinearFiltering,n===t.ORDER_INDEPENDENT_TRANSPARENCY&&i===t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||t.markAsUnprocessed()}function U(e,t,r){var n=t.PREPASS;if(t._arePrePassDirty){var o=[{type:i.Y.PREPASS_POSITION_TEXTURE_TYPE,define:\"PREPASS_POSITION\",index:\"PREPASS_POSITION_INDEX\"},{type:i.Y.PREPASS_LOCAL_POSITION_TEXTURE_TYPE,define:\"PREPASS_LOCAL_POSITION\",index:\"PREPASS_LOCAL_POSITION_INDEX\"},{type:i.Y.PREPASS_VELOCITY_TEXTURE_TYPE,define:\"PREPASS_VELOCITY\",index:\"PREPASS_VELOCITY_INDEX\"},{type:i.Y.PREPASS_VELOCITY_LINEAR_TEXTURE_TYPE,define:\"PREPASS_VELOCITY_LINEAR\",index:\"PREPASS_VELOCITY_LINEAR_INDEX\"},{type:i.Y.PREPASS_REFLECTIVITY_TEXTURE_TYPE,define:\"PREPASS_REFLECTIVITY\",index:\"PREPASS_REFLECTIVITY_INDEX\"},{type:i.Y.PREPASS_IRRADIANCE_TEXTURE_TYPE,define:\"PREPASS_IRRADIANCE\",index:\"PREPASS_IRRADIANCE_INDEX\"},{type:i.Y.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE,define:\"PREPASS_ALBEDO_SQRT\",index:\"PREPASS_ALBEDO_SQRT_INDEX\"},{type:i.Y.PREPASS_DEPTH_TEXTURE_TYPE,define:\"PREPASS_DEPTH\",index:\"PREPASS_DEPTH_INDEX\"},{type:i.Y.PREPASS_SCREENSPACE_DEPTH_TEXTURE_TYPE,define:\"PREPASS_SCREENSPACE_DEPTH\",index:\"PREPASS_SCREENSPACE_DEPTH_INDEX\"},{type:i.Y.PREPASS_NORMAL_TEXTURE_TYPE,define:\"PREPASS_NORMAL\",index:\"PREPASS_NORMAL_INDEX\"},{type:i.Y.PREPASS_WORLD_NORMAL_TEXTURE_TYPE,define:\"PREPASS_WORLD_NORMAL\",index:\"PREPASS_WORLD_NORMAL_INDEX\"}];if(e.prePassRenderer&&e.prePassRenderer.enabled&&r){t.PREPASS=!0,t.SCENE_MRT_COUNT=e.prePassRenderer.mrtCount,t.PREPASS_NORMAL_WORLDSPACE=e.prePassRenderer.generateNormalsInWorldSpace;for(var a=0;a<o.length;a++){var s=e.prePassRenderer.getIndex(o[a].type);-1!==s?(t[o[a].define]=!0,t[o[a].index]=s):t[o[a].define]=!1}}else for(t.PREPASS=!1,a=0;a<o.length;a++)t[o[a].define]=!1;t.PREPASS!=n&&(t.markAsUnprocessed(),t.markAsImageProcessingDirty())}}function G(e,t){var r=!1;if(e.activeCamera){var n=t.CAMERA_ORTHOGRAPHIC?1:0,o=t.CAMERA_PERSPECTIVE?1:0,a=e.activeCamera.mode===i.Y.ORTHOGRAPHIC_CAMERA?1:0,s=e.activeCamera.mode===i.Y.PERSPECTIVE_CAMERA?1:0;(n^a||o^s)&&(t.CAMERA_ORTHOGRAPHIC=1===a,t.CAMERA_PERSPECTIVE=1===s,r=!0)}return r}function k(e,t,r,n,i,o){void 0===i&&(i=null),void 0===o&&(o=!1),i&&i.push(\"Light\"+e),o||(t.push(\"vLightData\"+e,\"vLightDiffuse\"+e,\"vLightSpecular\"+e,\"vLightDirection\"+e,\"vLightFalloff\"+e,\"vLightGround\"+e,\"lightMatrix\"+e,\"shadowsInfo\"+e,\"depthValues\"+e),r.push(\"shadowTexture\"+e),r.push(\"depthTexture\"+e),t.push(\"viewFrustumZ\"+e,\"cascadeBlendFactor\"+e,\"lightSizeUVCorrection\"+e,\"depthCorrection\"+e,\"penumbraDarkness\"+e,\"frustumLengths\"+e),n&&(r.push(\"projectionLightTexture\"+e),t.push(\"textureProjectionMatrix\"+e)))}function z(e,t,r,n){var i;void 0===n&&(n=4);var o=null;if(e.uniformsNames){var a=e;i=a.uniformsNames,o=a.uniformBuffersNames,t=a.samplers,r=a.defines,n=a.maxSimultaneousLights||0}else i=e,t||(t=[]);for(var s=0;s<n&&r[\"LIGHT\"+s];s++)k(s,i,t,r[\"PROJECTEDLIGHTTEXTURE\"+s],o);r.NUM_MORPH_INFLUENCERS&&(i.push(\"morphTargetInfluences\"),i.push(\"morphTargetCount\")),r.BAKED_VERTEX_ANIMATION_TEXTURE&&(i.push(\"bakedVertexAnimationSettings\"),i.push(\"bakedVertexAnimationTextureSizeInverted\"),i.push(\"bakedVertexAnimationTime\"),t.push(\"bakedVertexAnimationTexture\"))}},75482:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(7164),i=r(44957),o=(r(59012),function(){function e(e,t,r,n,i){void 0===i&&(i=!1),this._valueCache={},this._engine=e,this._noUBO=!e.supportsUniformBuffers||i,this._dynamic=r,this._name=null!=n?n:\"no-name\",this._data=t||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateUIntArray=this._updateUIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect,this.updateUInt=this._updateUIntForEffect,this.updateUInt2=this._updateUInt2ForEffect,this.updateUInt3=this._updateUInt3ForEffect,this.updateUInt4=this._updateUInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateUIntArray=this._updateUIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform,this.updateUInt=this._updateUIntForUniform,this.updateUInt2=this._updateUInt2ForUniform,this.updateUInt3=this._updateUInt3ForUniform,this.updateUInt4=this._updateUInt4ForUniform)}return Object.defineProperty(e.prototype,\"useUbo\",{get:function(){return!this._noUBO},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"isSync\",{get:function(){return!this._needSync},enumerable:!1,configurable:!0}),e.prototype.isDynamic=function(){return void 0!==this._dynamic},e.prototype.getData=function(){return this._bufferData},e.prototype.getBuffer=function(){return this._buffer},e.prototype._fillAlignment=function(e){var t;if(t=e<=2?e:4,this._uniformLocationPointer%t!=0){var r=this._uniformLocationPointer;this._uniformLocationPointer+=t-this._uniformLocationPointer%t;for(var n=this._uniformLocationPointer-r,i=0;i<n;i++)this._data.push(0)}},e.prototype.addUniform=function(e,t,r){if(void 0===r&&(r=0),!this._noUBO&&void 0===this._uniformLocations[e]){var n;if(r>0){if(t instanceof Array)throw\"addUniform should not be use with Array in UBO: \"+e;this._fillAlignment(4),this._uniformArraySizes[e]={strideSize:t,arraySize:r},16==t?t*=r:t=t*r+(4-t)*r,n=[];for(var i=0;i<t;i++)n.push(0)}else{if(t instanceof Array)t=(n=t).length;else for(n=[],i=0;i<t;i++)n.push(0);this._fillAlignment(t)}for(this._uniformSizes[e]=t,this._uniformLocations[e]=this._uniformLocationPointer,this._uniformLocationPointer+=t,i=0;i<t;i++)this._data.push(n[i]);this._needSync=!0}},e.prototype.addMatrix=function(e,t){this.addUniform(e,Array.prototype.slice.call(t.asArray()))},e.prototype.addFloat2=function(e,t,r){var n=[t,r];this.addUniform(e,n)},e.prototype.addFloat3=function(e,t,r,n){var i=[t,r,n];this.addUniform(e,i)},e.prototype.addColor3=function(e,t){var r=[t.r,t.g,t.b];this.addUniform(e,r)},e.prototype.addColor4=function(e,t,r){var n=[t.r,t.g,t.b,r];this.addUniform(e,n)},e.prototype.addVector3=function(e,t){var r=[t.x,t.y,t.z];this.addUniform(e,r)},e.prototype.addMatrix3x3=function(e){this.addUniform(e,12)},e.prototype.addMatrix2x2=function(e){this.addUniform(e,8)},e.prototype.create=function(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)},e.prototype._getNames=function(){var e=[],t=0;for(var r in this._uniformLocations)if(e.push(r),10==++t)break;return e.join(\",\")},e.prototype._rebuild=function(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData,this._name+\"_UniformList:\"+this._getNames()):this._buffer=this._engine.createUniformBuffer(this._bufferData,this._name+\"_UniformList:\"+this._getNames()),this._engine._features.trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))},e.prototype._rebuildAfterContextLost=function(){this._engine._features.trackUbosInFrame&&(this._buffers=[],this._currentFrameId=0),this._rebuild()},Object.defineProperty(e.prototype,\"_numBuffers\",{get:function(){return this._buffers.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"_indexBuffer\",{get:function(){return this._bufferIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"name\",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"currentEffect\",{get:function(){return this._currentEffect},enumerable:!1,configurable:!0}),e.prototype._buffersEqual=function(e,t){for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0},e.prototype._copyBuffer=function(e,t){for(var r=0;r<e.length;++r)t[r]=e[r]},e.prototype.update=function(){if(!this._noUBO)if(this.bindUniformBuffer(),this._buffer)if(this._dynamic||this._needSync){if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1]){if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1]))return this._needSync=!1,void(this._createBufferOnWrite=this._engine._features.trackUbosInFrame);this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1])}this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(e._UpdatedUbosInFrame[this._name]||(e._UpdatedUbosInFrame[this._name]=0),e._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame}else this._createBufferOnWrite=this._engine._features.trackUbosInFrame;else this.create()},e.prototype._createNewBuffer=function(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()},e.prototype._checkNewFrame=function(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=0!==this._bufferIndex,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)},e.prototype.updateUniform=function(e,t,r){this._checkNewFrame();var i=this._uniformLocations[e];if(void 0===i){if(this._buffer)return void n.V.Error(\"Cannot add an uniform after UBO has been created. uniformName=\"+e);this.addUniform(e,r),i=this._uniformLocations[e]}if(this._buffer||this.create(),this._dynamic)for(a=0;a<r;a++)this._bufferData[i+a]=t[a];else{for(var o=!1,a=0;a<r;a++)(16===r&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[i+a]!==Math.fround(t[a]))&&(o=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[i+a]=t[a]);this._needSync=this._needSync||o}},e.prototype.updateUniformArray=function(e,t,r){this._checkNewFrame();var o=this._uniformLocations[e];if(void 0!==o){this._buffer||this.create();var a=this._uniformArraySizes[e];if(this._dynamic)for(u=0;u<r;u++)this._bufferData[o+u]=t[u];else{for(var s=!1,l=0,c=0,u=0;u<r;u++)if(this._bufferData[o+4*c+l]!==i.S0.FloatRound(t[u])&&(s=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[o+4*c+l]=t[u]),++l===a.strideSize){for(;l<4;l++)this._bufferData[o+4*c+l]=0;l=0,c++}this._needSync=this._needSync||s}}else n.V.Error(\"Cannot add an uniform Array dynamically. Please, add it using addUniform and make sure that uniform buffers are supported by the current engine.\")},e.prototype._cacheMatrix=function(e,t){this._checkNewFrame();var r=this._valueCache[e],n=t.updateFlag;return(void 0===r||r!==n)&&(this._valueCache[e]=n,!0)},e.prototype._updateMatrix3x3ForUniform=function(t,r){for(var n=0;n<3;n++)e._TempBuffer[4*n]=r[3*n],e._TempBuffer[4*n+1]=r[3*n+1],e._TempBuffer[4*n+2]=r[3*n+2],e._TempBuffer[4*n+3]=0;this.updateUniform(t,e._TempBuffer,12)},e.prototype._updateMatrix3x3ForEffect=function(e,t){this._currentEffect.setMatrix3x3(e,t)},e.prototype._updateMatrix2x2ForEffect=function(e,t){this._currentEffect.setMatrix2x2(e,t)},e.prototype._updateMatrix2x2ForUniform=function(t,r){for(var n=0;n<2;n++)e._TempBuffer[4*n]=r[2*n],e._TempBuffer[4*n+1]=r[2*n+1],e._TempBuffer[4*n+2]=0,e._TempBuffer[4*n+3]=0;this.updateUniform(t,e._TempBuffer,8)},e.prototype._updateFloatForEffect=function(e,t){this._currentEffect.setFloat(e,t)},e.prototype._updateFloatForUniform=function(t,r){e._TempBuffer[0]=r,this.updateUniform(t,e._TempBuffer,1)},e.prototype._updateFloat2ForEffect=function(e,t,r,n){void 0===n&&(n=\"\"),this._currentEffect.setFloat2(e+n,t,r)},e.prototype._updateFloat2ForUniform=function(t,r,n){e._TempBuffer[0]=r,e._TempBuffer[1]=n,this.updateUniform(t,e._TempBuffer,2)},e.prototype._updateFloat3ForEffect=function(e,t,r,n,i){void 0===i&&(i=\"\"),this._currentEffect.setFloat3(e+i,t,r,n)},e.prototype._updateFloat3ForUniform=function(t,r,n,i){e._TempBuffer[0]=r,e._TempBuffer[1]=n,e._TempBuffer[2]=i,this.updateUniform(t,e._TempBuffer,3)},e.prototype._updateFloat4ForEffect=function(e,t,r,n,i,o){void 0===o&&(o=\"\"),this._currentEffect.setFloat4(e+o,t,r,n,i)},e.prototype._updateFloat4ForUniform=function(t,r,n,i,o){e._TempBuffer[0]=r,e._TempBuffer[1]=n,e._TempBuffer[2]=i,e._TempBuffer[3]=o,this.updateUniform(t,e._TempBuffer,4)},e.prototype._updateFloatArrayForEffect=function(e,t){this._currentEffect.setFloatArray(e,t)},e.prototype._updateFloatArrayForUniform=function(e,t){this.updateUniformArray(e,t,t.length)},e.prototype._updateArrayForEffect=function(e,t){this._currentEffect.setArray(e,t)},e.prototype._updateArrayForUniform=function(e,t){this.updateUniformArray(e,t,t.length)},e.prototype._updateIntArrayForEffect=function(e,t){this._currentEffect.setIntArray(e,t)},e.prototype._updateIntArrayForUniform=function(t,r){e._TempBufferInt32View.set(r),this.updateUniformArray(t,e._TempBuffer,r.length)},e.prototype._updateUIntArrayForEffect=function(e,t){this._currentEffect.setUIntArray(e,t)},e.prototype._updateUIntArrayForUniform=function(t,r){e._TempBufferUInt32View.set(r),this.updateUniformArray(t,e._TempBuffer,r.length)},e.prototype._updateMatrixForEffect=function(e,t){this._currentEffect.setMatrix(e,t)},e.prototype._updateMatrixForUniform=function(e,t){this._cacheMatrix(e,t)&&this.updateUniform(e,t.asArray(),16)},e.prototype._updateMatricesForEffect=function(e,t){this._currentEffect.setMatrices(e,t)},e.prototype._updateMatricesForUniform=function(e,t){this.updateUniform(e,t,t.length)},e.prototype._updateVector3ForEffect=function(e,t){this._currentEffect.setVector3(e,t)},e.prototype._updateVector3ForUniform=function(t,r){e._TempBuffer[0]=r.x,e._TempBuffer[1]=r.y,e._TempBuffer[2]=r.z,this.updateUniform(t,e._TempBuffer,3)},e.prototype._updateVector4ForEffect=function(e,t){this._currentEffect.setVector4(e,t)},e.prototype._updateVector4ForUniform=function(t,r){e._TempBuffer[0]=r.x,e._TempBuffer[1]=r.y,e._TempBuffer[2]=r.z,e._TempBuffer[3]=r.w,this.updateUniform(t,e._TempBuffer,4)},e.prototype._updateColor3ForEffect=function(e,t,r){void 0===r&&(r=\"\"),this._currentEffect.setColor3(e+r,t)},e.prototype._updateColor3ForUniform=function(t,r){e._TempBuffer[0]=r.r,e._TempBuffer[1]=r.g,e._TempBuffer[2]=r.b,this.updateUniform(t,e._TempBuffer,3)},e.prototype._updateColor4ForEffect=function(e,t,r,n){void 0===n&&(n=\"\"),this._currentEffect.setColor4(e+n,t,r)},e.prototype._updateDirectColor4ForEffect=function(e,t,r){void 0===r&&(r=\"\"),this._currentEffect.setDirectColor4(e+r,t)},e.prototype._updateColor4ForUniform=function(t,r,n){e._TempBuffer[0]=r.r,e._TempBuffer[1]=r.g,e._TempBuffer[2]=r.b,e._TempBuffer[3]=n,this.updateUniform(t,e._TempBuffer,4)},e.prototype._updateDirectColor4ForUniform=function(t,r){e._TempBuffer[0]=r.r,e._TempBuffer[1]=r.g,e._TempBuffer[2]=r.b,e._TempBuffer[3]=r.a,this.updateUniform(t,e._TempBuffer,4)},e.prototype._updateIntForEffect=function(e,t,r){void 0===r&&(r=\"\"),this._currentEffect.setInt(e+r,t)},e.prototype._updateIntForUniform=function(t,r){e._TempBufferInt32View[0]=r,this.updateUniform(t,e._TempBuffer,1)},e.prototype._updateInt2ForEffect=function(e,t,r,n){void 0===n&&(n=\"\"),this._currentEffect.setInt2(e+n,t,r)},e.prototype._updateInt2ForUniform=function(t,r,n){e._TempBufferInt32View[0]=r,e._TempBufferInt32View[1]=n,this.updateUniform(t,e._TempBuffer,2)},e.prototype._updateInt3ForEffect=function(e,t,r,n,i){void 0===i&&(i=\"\"),this._currentEffect.setInt3(e+i,t,r,n)},e.prototype._updateInt3ForUniform=function(t,r,n,i){e._TempBufferInt32View[0]=r,e._TempBufferInt32View[1]=n,e._TempBufferInt32View[2]=i,this.updateUniform(t,e._TempBuffer,3)},e.prototype._updateInt4ForEffect=function(e,t,r,n,i,o){void 0===o&&(o=\"\"),this._currentEffect.setInt4(e+o,t,r,n,i)},e.prototype._updateInt4ForUniform=function(t,r,n,i,o){e._TempBufferInt32View[0]=r,e._TempBufferInt32View[1]=n,e._TempBufferInt32View[2]=i,e._TempBufferInt32View[3]=o,this.updateUniform(t,e._TempBuffer,4)},e.prototype._updateUIntForEffect=function(e,t,r){void 0===r&&(r=\"\"),this._currentEffect.setUInt(e+r,t)},e.prototype._updateUIntForUniform=function(t,r){e._TempBufferUInt32View[0]=r,this.updateUniform(t,e._TempBuffer,1)},e.prototype._updateUInt2ForEffect=function(e,t,r,n){void 0===n&&(n=\"\"),this._currentEffect.setUInt2(e+n,t,r)},e.prototype._updateUInt2ForUniform=function(t,r,n){e._TempBufferUInt32View[0]=r,e._TempBufferUInt32View[1]=n,this.updateUniform(t,e._TempBuffer,2)},e.prototype._updateUInt3ForEffect=function(e,t,r,n,i){void 0===i&&(i=\"\"),this._currentEffect.setUInt3(e+i,t,r,n)},e.prototype._updateUInt3ForUniform=function(t,r,n,i){e._TempBufferUInt32View[0]=r,e._TempBufferUInt32View[1]=n,e._TempBufferUInt32View[2]=i,this.updateUniform(t,e._TempBuffer,3)},e.prototype._updateUInt4ForEffect=function(e,t,r,n,i,o){void 0===o&&(o=\"\"),this._currentEffect.setUInt4(e+o,t,r,n,i)},e.prototype._updateUInt4ForUniform=function(t,r,n,i,o){e._TempBufferUInt32View[0]=r,e._TempBufferUInt32View[1]=n,e._TempBufferUInt32View[2]=i,e._TempBufferUInt32View[3]=o,this.updateUniform(t,e._TempBuffer,4)},e.prototype.setTexture=function(e,t){this._currentEffect.setTexture(e,t)},e.prototype.setTextureArray=function(e,t){this._currentEffect.setTextureArray(e,t)},e.prototype.bindTexture=function(e,t){this._currentEffect._bindTexture(e,t)},e.prototype.updateUniformDirectly=function(e,t){this.updateUniform(e,t,t.length),this.update()},e.prototype.bindToEffect=function(e,t){this._currentEffect=e,this._currentEffectName=t},e.prototype.bindUniformBuffer=function(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)},e.prototype.unbindEffect=function(){this._currentEffect=void 0,this._currentEffectName=void 0},e.prototype.setDataBuffer=function(e){if(!this._buffers)return this._buffer===e;for(var t=0;t<this._buffers.length;++t)if(this._buffers[t][0]===e)return this._bufferIndex=t,this._buffer=e,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0;return!1},e.prototype.dispose=function(){if(!this._noUBO){var e=this._engine._uniformBuffers,t=e.indexOf(this);if(-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(var r=0;r<this._buffers.length;++r){var n=this._buffers[r][0];this._engine._releaseBuffer(n)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}},e._UpdatedUbosInFrame={},e._MAX_UNIFORM_SIZE=256,e._TempBuffer=new Float32Array(e._MAX_UNIFORM_SIZE),e._TempBufferInt32View=new Int32Array(e._TempBuffer.buffer),e._TempBufferUInt32View=new Uint32Array(e._TempBuffer.buffer),e}())},13424:(e,t,r)=>{r.d(t,{$x:()=>n,_0:()=>a,xp:()=>o});var n,i=r(8046);!function(e){e[e.LOCAL=0]=\"LOCAL\",e[e.WORLD=1]=\"WORLD\",e[e.BONE=2]=\"BONE\"}(n||(n={}));var o,a=function(){function e(){}return e.X=new i.Pq(1,0,0),e.Y=new i.Pq(0,1,0),e.Z=new i.Pq(0,0,1),e}();!function(e){e[e.X=0]=\"X\",e[e.Y=1]=\"Y\",e[e.Z=2]=\"Z\"}(o||(o={}))},64726:(e,t,r)=>{r.d(t,{IG:()=>f,ov:()=>d,v9:()=>h});var n=r(11296),i=r(34623),o=r(56740),a=r(48810);function s(e){return Math.pow(e,o.tk)}function l(e){return e<=.04045?.0773993808*e:Math.pow(.947867299*(e+.055),2.4)}function c(e){return Math.pow(e,o.rv)}function u(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var h=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.r=e,this.g=t,this.b=r}return e.prototype.toString=function(){return\"{R: \"+this.r+\" G:\"+this.g+\" B:\"+this.b+\"}\"},e.prototype.getClassName=function(){return\"Color3\"},e.prototype.getHashCode=function(){var e=255*this.r|0;return 397*(e=397*e^255*this.g)^255*this.b},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,this},e.prototype.fromArray=function(t,r){return void 0===r&&(r=0),e.FromArrayToRef(t,r,this),this},e.prototype.toColor4=function(e){return void 0===e&&(e=1),new d(this.r,this.g,this.b,e)},e.prototype.asArray=function(){return[this.r,this.g,this.b]},e.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},e.prototype.multiply=function(t){return new e(this.r*t.r,this.g*t.g,this.b*t.b)},e.prototype.multiplyToRef=function(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t},e.prototype.multiplyInPlace=function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},e.prototype.multiplyByFloats=function(t,r,n){return new e(this.r*t,this.g*r,this.b*n)},e.prototype.divide=function(e){throw new ReferenceError(\"Can not divide a color\")},e.prototype.divideToRef=function(e,t){throw new ReferenceError(\"Can not divide a color\")},e.prototype.divideInPlace=function(e){throw new ReferenceError(\"Can not divide a color\")},e.prototype.minimizeInPlace=function(e){return this.minimizeInPlaceFromFloats(e.r,e.g,e.b)},e.prototype.maximizeInPlace=function(e){return this.maximizeInPlaceFromFloats(e.r,e.g,e.b)},e.prototype.minimizeInPlaceFromFloats=function(e,t,r){return this.r=Math.min(e,this.r),this.g=Math.min(t,this.g),this.b=Math.min(r,this.b),this},e.prototype.maximizeInPlaceFromFloats=function(e,t,r){return this.r=Math.max(e,this.r),this.g=Math.max(t,this.g),this.b=Math.max(r,this.b),this},e.prototype.floorToRef=function(e){throw new ReferenceError(\"Can not floor a color\")},e.prototype.floor=function(){throw new ReferenceError(\"Can not floor a color\")},e.prototype.fractToRef=function(e){throw new ReferenceError(\"Can not fract a color\")},e.prototype.fract=function(){throw new ReferenceError(\"Can not fract a color\")},e.prototype.equals=function(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b},e.prototype.equalsFloats=function(e,t,r){return this.equalsToFloats(e,t,r)},e.prototype.equalsToFloats=function(e,t,r){return this.r===e&&this.g===t&&this.b===r},e.prototype.equalsWithEpsilon=function(e,t){return void 0===t&&(t=o.bH),(0,a.WithinEpsilon)(this.r,e.r,t)&&(0,a.WithinEpsilon)(this.g,e.g,t)&&(0,a.WithinEpsilon)(this.b,e.b,t)},e.prototype.negate=function(){throw new ReferenceError(\"Can not negate a color\")},e.prototype.negateInPlace=function(){throw new ReferenceError(\"Can not negate a color\")},e.prototype.negateToRef=function(e){throw new ReferenceError(\"Can not negate a color\")},e.prototype.scale=function(t){return new e(this.r*t,this.g*t,this.b*t)},e.prototype.scaleInPlace=function(e){return this.r*=e,this.g*=e,this.b*=e,this},e.prototype.scaleToRef=function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t},e.prototype.scaleAndAddToRef=function(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t},e.prototype.clampToRef=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),r.r=(0,a.Clamp)(this.r,e,t),r.g=(0,a.Clamp)(this.g,e,t),r.b=(0,a.Clamp)(this.b,e,t),r},e.prototype.add=function(t){return new e(this.r+t.r,this.g+t.g,this.b+t.b)},e.prototype.addInPlace=function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},e.prototype.addInPlaceFromFloats=function(e,t,r){return this.r+=e,this.g+=t,this.b+=r,this},e.prototype.addToRef=function(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,t},e.prototype.subtract=function(t){return new e(this.r-t.r,this.g-t.g,this.b-t.b)},e.prototype.subtractToRef=function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t},e.prototype.subtractInPlace=function(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this},e.prototype.subtractFromFloats=function(t,r,n){return new e(this.r-t,this.g-r,this.b-n)},e.prototype.subtractFromFloatsToRef=function(e,t,r,n){return n.r=this.r-e,n.g=this.g-t,n.b=this.b-r,n},e.prototype.clone=function(){return new e(this.r,this.g,this.b)},e.prototype.copyFrom=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},e.prototype.copyFromFloats=function(e,t,r){return this.r=e,this.g=t,this.b=r,this},e.prototype.set=function(e,t,r){return this.copyFromFloats(e,t,r)},e.prototype.setAll=function(e){return this.r=this.g=this.b=e,this},e.prototype.toHexString=function(){var e=Math.round(255*this.r),t=Math.round(255*this.g),r=Math.round(255*this.b);return\"#\"+(0,a.ToHex)(e)+(0,a.ToHex)(t)+(0,a.ToHex)(r)},e.prototype.toHSV=function(){return this.toHSVToRef(new e)},e.prototype.toHSVToRef=function(e){var t=this.r,r=this.g,n=this.b,i=Math.max(t,r,n),o=Math.min(t,r,n),a=0,s=0,l=i,c=i-o;return 0!==i&&(s=c/i),i!=o&&(i==t?(a=(r-n)/c,r<n&&(a+=6)):i==r?a=(n-t)/c+2:i==n&&(a=(t-r)/c+4),a*=60),e.r=a,e.g=s,e.b=l,e},e.prototype.toLinearSpace=function(t){void 0===t&&(t=!1);var r=new e;return this.toLinearSpaceToRef(r,t),r},e.prototype.toLinearSpaceToRef=function(e,t){return void 0===t&&(t=!1),t?(e.r=l(this.r),e.g=l(this.g),e.b=l(this.b)):(e.r=s(this.r),e.g=s(this.g),e.b=s(this.b)),this},e.prototype.toGammaSpace=function(t){void 0===t&&(t=!1);var r=new e;return this.toGammaSpaceToRef(r,t),r},e.prototype.toGammaSpaceToRef=function(e,t){return void 0===t&&(t=!1),t?(e.r=u(this.r),e.g=u(this.g),e.b=u(this.b)):(e.r=c(this.r),e.g=c(this.g),e.b=c(this.b)),this},e.HSVtoRGBToRef=function(e,t,r,n){var i=r*t,o=e/60,a=i*(1-Math.abs(o%2-1)),s=0,l=0,c=0;o>=0&&o<=1?(s=i,l=a):o>=1&&o<=2?(s=a,l=i):o>=2&&o<=3?(l=i,c=a):o>=3&&o<=4?(l=a,c=i):o>=4&&o<=5?(s=a,c=i):o>=5&&o<=6&&(s=i,c=a);var u=r-i;return n.r=s+u,n.g=l+u,n.b=c+u,n},e.FromHSV=function(t,r,n){var i=new e(0,0,0);return e.HSVtoRGBToRef(t,r,n,i),i},e.FromHexString=function(t){if(\"#\"!==t.substring(0,1)||7!==t.length)return new e(0,0,0);var r=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16);return e.FromInts(r,n,i)},e.FromArray=function(t,r){return void 0===r&&(r=0),new e(t[r],t[r+1],t[r+2])},e.FromArrayToRef=function(e,t,r){void 0===t&&(t=0),r.r=e[t],r.g=e[t+1],r.b=e[t+2]},e.FromInts=function(t,r,n){return new e(t/255,r/255,n/255)},e.Lerp=function(t,r,n){var i=new e(0,0,0);return e.LerpToRef(t,r,n,i),i},e.LerpToRef=function(e,t,r,n){n.r=e.r+(t.r-e.r)*r,n.g=e.g+(t.g-e.g)*r,n.b=e.b+(t.b-e.b)*r},e.Hermite=function(t,r,n,i,o){var a=o*o,s=o*a,l=2*s-3*a+1,c=-2*s+3*a,u=s-2*a+o,h=s-a;return new e(t.r*l+n.r*c+r.r*u+i.r*h,t.g*l+n.g*c+r.g*u+i.g*h,t.b*l+n.b*c+r.b*u+i.b*h)},e.Hermite1stDerivative=function(t,r,n,i,o){var a=e.Black();return this.Hermite1stDerivativeToRef(t,r,n,i,o,a),a},e.Hermite1stDerivativeToRef=function(e,t,r,n,i,o){var a=i*i;o.r=6*(a-i)*e.r+(3*a-4*i+1)*t.r+6*(-a+i)*r.r+(3*a-2*i)*n.r,o.g=6*(a-i)*e.g+(3*a-4*i+1)*t.g+6*(-a+i)*r.g+(3*a-2*i)*n.g,o.b=6*(a-i)*e.b+(3*a-4*i+1)*t.b+6*(-a+i)*r.b+(3*a-2*i)*n.b},e.Red=function(){return new e(1,0,0)},e.Green=function(){return new e(0,1,0)},e.Blue=function(){return new e(0,0,1)},e.Black=function(){return new e(0,0,0)},Object.defineProperty(e,\"BlackReadOnly\",{get:function(){return e._BlackReadOnly},enumerable:!1,configurable:!0}),e.White=function(){return new e(1,1,1)},e.Purple=function(){return new e(.5,0,.5)},e.Magenta=function(){return new e(1,0,1)},e.Yellow=function(){return new e(1,1,0)},e.Gray=function(){return new e(.5,.5,.5)},e.Teal=function(){return new e(0,1,1)},e.Random=function(){return new e(Math.random(),Math.random(),Math.random())},e._BlackReadOnly=e.Black(),e}();Object.defineProperties(h.prototype,{dimension:{value:[3]},rank:{value:1}});var d=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n}return e.prototype.asArray=function(){return[this.r,this.g,this.b,this.a]},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e[t+3]=this.a,this},e.prototype.fromArray=function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this.a=e[t+3],this},e.prototype.equals=function(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a},e.prototype.add=function(t){return new e(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)},e.prototype.addToRef=function(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,t.a=this.a+e.a,t},e.prototype.addInPlace=function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this},e.prototype.addInPlaceFromFloats=function(e,t,r,n){return this.r+=e,this.g+=t,this.b+=r,this.a+=n,this},e.prototype.subtract=function(t){return new e(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)},e.prototype.subtractToRef=function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,t},e.prototype.subtractInPlace=function(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this},e.prototype.subtractFromFloats=function(t,r,n,i){return new e(this.r-t,this.g-r,this.b-n,this.a-i)},e.prototype.subtractFromFloatsToRef=function(e,t,r,n,i){return i.r=this.r-e,i.g=this.g-t,i.b=this.b-r,i.a=this.a-n,i},e.prototype.scale=function(t){return new e(this.r*t,this.g*t,this.b*t,this.a*t)},e.prototype.scaleInPlace=function(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this},e.prototype.scaleToRef=function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,t},e.prototype.scaleAndAddToRef=function(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t.a+=this.a*e,t},e.prototype.clampToRef=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),r.r=(0,a.Clamp)(this.r,e,t),r.g=(0,a.Clamp)(this.g,e,t),r.b=(0,a.Clamp)(this.b,e,t),r.a=(0,a.Clamp)(this.a,e,t),r},e.prototype.multiply=function(t){return new e(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)},e.prototype.multiplyToRef=function(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t.a=this.a*e.a,t},e.prototype.multiplyInPlace=function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this.a*=e.a,this},e.prototype.multiplyByFloats=function(t,r,n,i){return new e(this.r*t,this.g*r,this.b*n,this.a*i)},e.prototype.divide=function(e){throw new ReferenceError(\"Can not divide a color\")},e.prototype.divideToRef=function(e,t){throw new ReferenceError(\"Can not divide a color\")},e.prototype.divideInPlace=function(e){throw new ReferenceError(\"Can not divide a color\")},e.prototype.minimizeInPlace=function(e){return this.r=Math.min(this.r,e.r),this.g=Math.min(this.g,e.g),this.b=Math.min(this.b,e.b),this.a=Math.min(this.a,e.a),this},e.prototype.maximizeInPlace=function(e){return this.r=Math.max(this.r,e.r),this.g=Math.max(this.g,e.g),this.b=Math.max(this.b,e.b),this.a=Math.max(this.a,e.a),this},e.prototype.minimizeInPlaceFromFloats=function(e,t,r,n){return this.r=Math.min(e,this.r),this.g=Math.min(t,this.g),this.b=Math.min(r,this.b),this.a=Math.min(n,this.a),this},e.prototype.maximizeInPlaceFromFloats=function(e,t,r,n){return this.r=Math.max(e,this.r),this.g=Math.max(t,this.g),this.b=Math.max(r,this.b),this.a=Math.max(n,this.a),this},e.prototype.floorToRef=function(e){throw new ReferenceError(\"Can not floor a color\")},e.prototype.floor=function(){throw new ReferenceError(\"Can not floor a color\")},e.prototype.fractToRef=function(e){throw new ReferenceError(\"Can not fract a color\")},e.prototype.fract=function(){throw new ReferenceError(\"Can not fract a color\")},e.prototype.negate=function(){throw new ReferenceError(\"Can not negate a color\")},e.prototype.negateInPlace=function(){throw new ReferenceError(\"Can not negate a color\")},e.prototype.negateToRef=function(e){throw new ReferenceError(\"Can not negate a color\")},e.prototype.equalsWithEpsilon=function(e,t){return void 0===t&&(t=o.bH),(0,a.WithinEpsilon)(this.r,e.r,t)&&(0,a.WithinEpsilon)(this.g,e.g,t)&&(0,a.WithinEpsilon)(this.b,e.b,t)&&(0,a.WithinEpsilon)(this.a,e.a,t)},e.prototype.equalsToFloats=function(e,t,r,n){return this.r===e&&this.g===t&&this.b===r&&this.a===n},e.prototype.toString=function(){return\"{R: \"+this.r+\" G:\"+this.g+\" B:\"+this.b+\" A:\"+this.a+\"}\"},e.prototype.getClassName=function(){return\"Color4\"},e.prototype.getHashCode=function(){var e=255*this.r|0;return 397*(e=397*(e=397*e^255*this.g)^255*this.b)^255*this.a},e.prototype.clone=function(){return(new e).copyFrom(this)},e.prototype.copyFrom=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this},e.prototype.copyFromFloats=function(e,t,r,n){return this.r=e,this.g=t,this.b=r,this.a=n,this},e.prototype.set=function(e,t,r,n){return this.copyFromFloats(e,t,r,n)},e.prototype.setAll=function(e){return this.r=this.g=this.b=this.a=e,this},e.prototype.toHexString=function(e){void 0===e&&(e=!1);var t=Math.round(255*this.r),r=Math.round(255*this.g),n=Math.round(255*this.b);if(e)return\"#\"+(0,a.ToHex)(t)+(0,a.ToHex)(r)+(0,a.ToHex)(n);var i=Math.round(255*this.a);return\"#\"+(0,a.ToHex)(t)+(0,a.ToHex)(r)+(0,a.ToHex)(n)+(0,a.ToHex)(i)},e.prototype.toLinearSpace=function(t){void 0===t&&(t=!1);var r=new e;return this.toLinearSpaceToRef(r,t),r},e.prototype.toLinearSpaceToRef=function(e,t){return void 0===t&&(t=!1),t?(e.r=l(this.r),e.g=l(this.g),e.b=l(this.b)):(e.r=s(this.r),e.g=s(this.g),e.b=s(this.b)),e.a=this.a,this},e.prototype.toGammaSpace=function(t){void 0===t&&(t=!1);var r=new e;return this.toGammaSpaceToRef(r,t),r},e.prototype.toGammaSpaceToRef=function(e,t){return void 0===t&&(t=!1),t?(e.r=u(this.r),e.g=u(this.g),e.b=u(this.b)):(e.r=c(this.r),e.g=c(this.g),e.b=c(this.b)),e.a=this.a,this},e.FromHexString=function(t){if(\"#\"!==t.substring(0,1)||9!==t.length&&7!==t.length)return new e(0,0,0,0);var r=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16),o=9===t.length?parseInt(t.substring(7,9),16):255;return e.FromInts(r,n,i,o)},e.Lerp=function(t,r,n){return e.LerpToRef(t,r,n,new e)},e.LerpToRef=function(e,t,r,n){return n.r=e.r+(t.r-e.r)*r,n.g=e.g+(t.g-e.g)*r,n.b=e.b+(t.b-e.b)*r,n.a=e.a+(t.a-e.a)*r,n},e.Hermite=function(t,r,n,i,o){var a=o*o,s=o*a,l=2*s-3*a+1,c=-2*s+3*a,u=s-2*a+o,h=s-a;return new e(t.r*l+n.r*c+r.r*u+i.r*h,t.g*l+n.g*c+r.g*u+i.g*h,t.b*l+n.b*c+r.b*u+i.b*h,t.a*l+n.a*c+r.a*u+i.a*h)},e.Hermite1stDerivative=function(t,r,n,i,o){var a=new e;return this.Hermite1stDerivativeToRef(t,r,n,i,o,a),a},e.Hermite1stDerivativeToRef=function(e,t,r,n,i,o){var a=i*i;o.r=6*(a-i)*e.r+(3*a-4*i+1)*t.r+6*(-a+i)*r.r+(3*a-2*i)*n.r,o.g=6*(a-i)*e.g+(3*a-4*i+1)*t.g+6*(-a+i)*r.g+(3*a-2*i)*n.g,o.b=6*(a-i)*e.b+(3*a-4*i+1)*t.b+6*(-a+i)*r.b+(3*a-2*i)*n.b,o.a=6*(a-i)*e.a+(3*a-4*i+1)*t.a+6*(-a+i)*r.a+(3*a-2*i)*n.a},e.FromColor3=function(t,r){return void 0===r&&(r=1),new e(t.r,t.g,t.b,r)},e.FromArray=function(t,r){return void 0===r&&(r=0),new e(t[r],t[r+1],t[r+2],t[r+3])},e.FromArrayToRef=function(e,t,r){void 0===t&&(t=0),r.r=e[t],r.g=e[t+1],r.b=e[t+2],r.a=e[t+3]},e.FromInts=function(t,r,n,i){return new e(t/255,r/255,n/255,i/255)},e.CheckColors4=function(e,t){if(e.length===3*t){for(var r=[],n=0;n<e.length;n+=3){var i=n/3*4;r[i]=e[n],r[i+1]=e[n+1],r[i+2]=e[n+2],r[i+3]=1}return r}return e},e}();Object.defineProperties(d.prototype,{dimension:{value:[4]},rank:{value:1}});var f=function(){function e(){}return e.Color3=(0,n.mI)(3,h.Black),e.Color4=(0,n.mI)(3,(function(){return new d(0,0,0,0)})),e}();(0,i.Y5)(\"BABYLON.Color3\",h),(0,i.Y5)(\"BABYLON.Color4\",d)},56740:(e,t,r)=>{r.d(t,{a6:()=>o,bH:()=>a,rv:()=>n,tk:()=>i});var n=1/2.2,i=2.2,o=(1+Math.sqrt(5))/2,a=.001},36359:(e,t,r)=>{r.d(t,{P:()=>i});var n=r(43939),i=function(){function e(){}return e.GetPlanes=function(t){for(var r=[],i=0;i<6;i++)r.push(new n.Z(0,0,0,0));return e.GetPlanesToRef(t,r),r},e.GetNearPlaneToRef=function(e,t){var r=e.m;t.normal.x=r[3]+r[2],t.normal.y=r[7]+r[6],t.normal.z=r[11]+r[10],t.d=r[15]+r[14],t.normalize()},e.GetFarPlaneToRef=function(e,t){var r=e.m;t.normal.x=r[3]-r[2],t.normal.y=r[7]-r[6],t.normal.z=r[11]-r[10],t.d=r[15]-r[14],t.normalize()},e.GetLeftPlaneToRef=function(e,t){var r=e.m;t.normal.x=r[3]+r[0],t.normal.y=r[7]+r[4],t.normal.z=r[11]+r[8],t.d=r[15]+r[12],t.normalize()},e.GetRightPlaneToRef=function(e,t){var r=e.m;t.normal.x=r[3]-r[0],t.normal.y=r[7]-r[4],t.normal.z=r[11]-r[8],t.d=r[15]-r[12],t.normalize()},e.GetTopPlaneToRef=function(e,t){var r=e.m;t.normal.x=r[3]-r[1],t.normal.y=r[7]-r[5],t.normal.z=r[11]-r[9],t.d=r[15]-r[13],t.normalize()},e.GetBottomPlaneToRef=function(e,t){var r=e.m;t.normal.x=r[3]+r[1],t.normal.y=r[7]+r[5],t.normal.z=r[11]+r[9],t.d=r[15]+r[13],t.normalize()},e.GetPlanesToRef=function(t,r){e.GetNearPlaneToRef(t,r[0]),e.GetFarPlaneToRef(t,r[1]),e.GetLeftPlaneToRef(t,r[2]),e.GetRightPlaneToRef(t,r[3]),e.GetTopPlaneToRef(t,r[4]),e.GetBottomPlaneToRef(t,r[5])},e.IsPointInFrustum=function(e,t){for(var r=0;r<6;r++)if(t[r].dotCoordinate(e)<0)return!1;return!0},e}()},47424:(e,t,r)=>{r.d(t,{b:()=>l,c:()=>s});var n=r(78322),i=r(8046),o=r(6174),a=function(){function e(){}return e.extractMinAndMaxIndexed=function(e,t,r,n,i,o){for(var a=r;a<r+n;a++){var s=3*t[a],l=e[s],c=e[s+1],u=e[s+2];i.minimizeInPlaceFromFloats(l,c,u),o.maximizeInPlaceFromFloats(l,c,u)}},e.extractMinAndMax=function(e,t,r,n,i,o){for(var a=t,s=t*n;a<t+r;a++,s+=n){var l=e[s],c=e[s+1],u=e[s+2];i.minimizeInPlaceFromFloats(l,c,u),o.maximizeInPlaceFromFloats(l,c,u)}},(0,n.Cg)([o.Cx.filter((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],n=e[1];return!Array.isArray(r)&&!Array.isArray(n)}))],e,\"extractMinAndMaxIndexed\",null),(0,n.Cg)([o.Cx.filter((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0];return!Array.isArray(r)}))],e,\"extractMinAndMax\",null),e}();function s(e,t,r,n,o){void 0===o&&(o=null);var s=new i.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new i.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return a.extractMinAndMaxIndexed(e,t,r,n,s,l),o&&(s.x-=s.x*o.x+o.y,s.y-=s.y*o.x+o.y,s.z-=s.z*o.x+o.y,l.x+=l.x*o.x+o.y,l.y+=l.y*o.x+o.y,l.z+=l.z*o.x+o.y),{minimum:s,maximum:l}}function l(e,t,r,n,o){void 0===n&&(n=null);var s=new i.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new i.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return o||(o=3),a.extractMinAndMax(e,t,r,o,s,l),n&&(s.x-=s.x*n.x+n.y,s.y-=s.y*n.x+n.y,s.z-=s.z*n.x+n.y,l.x+=l.x*n.x+n.y,l.y+=l.y*n.x+n.y,l.z+=l.z*n.x+n.y),{minimum:s,maximum:l}}},95318:(e,t,r)=>{r.d(t,{Cu:()=>u,Xy:()=>c,jj:()=>d,t4:()=>n,tO:()=>h,uM:()=>l,vr:()=>s});var n,i=r(48810),o=r(8046),a=r(56740);!function(e){e[e.CW=0]=\"CW\",e[e.CCW=1]=\"CCW\"}(n||(n={}));var s=function(){function e(){}return e.Interpolate=function(e,t,r,n,i){for(var o=1-3*n+3*t,a=3*n-6*t,s=3*t,l=e,c=0;c<5;c++){var u=l*l;l-=1/(3*o*u+2*a*l+s)*(o*(u*l)+a*u+s*l-e),l=Math.min(1,Math.max(0,l))}return 3*Math.pow(1-l,2)*l*r+3*(1-l)*Math.pow(l,2)*i+Math.pow(l,3)},e}(),l=function(){function e(e){this._radians=e,this._radians<0&&(this._radians+=2*Math.PI)}return e.prototype.degrees=function(){return 180*this._radians/Math.PI},e.prototype.radians=function(){return this._radians},e.BetweenTwoPoints=function(t,r){var n=r.subtract(t);return new e(Math.atan2(n.y,n.x))},e.BetweenTwoVectors=function(t,r){var n=t.lengthSquared()*r.lengthSquared();if(0===n)return new e(Math.PI/2);n=Math.sqrt(n);var o=t.dot(r)/n;return o=(0,i.Clamp)(o,-1,1),new e(Math.acos(o))},e.FromRadians=function(t){return new e(t)},e.FromDegrees=function(t){return new e(t*Math.PI/180)},e}(),c=function(e,t,r){this.startPoint=e,this.midPoint=t,this.endPoint=r;var n=Math.pow(t.x,2)+Math.pow(t.y,2),i=(Math.pow(e.x,2)+Math.pow(e.y,2)-n)/2,a=(n-Math.pow(r.x,2)-Math.pow(r.y,2))/2,s=(e.x-t.x)*(t.y-r.y)-(t.x-r.x)*(e.y-t.y);this.centerPoint=new o.I9((i*(t.y-r.y)-a*(e.y-t.y))/s,((e.x-t.x)*a-(t.x-r.x)*i)/s),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=l.BetweenTwoPoints(this.centerPoint,this.startPoint);var c=this.startAngle.degrees(),u=l.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),h=l.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();u-c>180&&(u-=360),u-c<-180&&(u+=360),h-u>180&&(h-=360),h-u<-180&&(h+=360),this.orientation=u-c<0?0:1,this.angle=l.FromDegrees(0===this.orientation?c-h:h-c)},u=function(){function e(e,t){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new o.I9(e,t))}return e.prototype.addLineTo=function(e,t){if(this.closed)return this;var r=new o.I9(e,t),n=this._points[this._points.length-1];return this._points.push(r),this._length+=r.subtract(n).length(),this},e.prototype.addArcTo=function(e,t,r,n,i){if(void 0===i&&(i=36),this.closed)return this;var a=this._points[this._points.length-1],s=new o.I9(e,t),l=new o.I9(r,n),u=new c(a,s,l),h=u.angle.radians()/i;0===u.orientation&&(h*=-1);for(var d=u.startAngle.radians()+h,f=0;f<i;f++){var p=Math.cos(d)*u.radius+u.centerPoint.x,_=Math.sin(d)*u.radius+u.centerPoint.y;this.addLineTo(p,_),d+=h}return this},e.prototype.addQuadraticCurveTo=function(e,t,r,n,i){if(void 0===i&&(i=36),this.closed)return this;for(var o=function(e,t,r,n){return(1-e)*(1-e)*t+2*e*(1-e)*r+e*e*n},a=this._points[this._points.length-1],s=0;s<=i;s++){var l=s/i,c=o(l,a.x,e,r),u=o(l,a.y,t,n);this.addLineTo(c,u)}return this},e.prototype.addBezierCurveTo=function(e,t,r,n,i,o,a){if(void 0===a&&(a=36),this.closed)return this;for(var s=function(e,t,r,n,i){return(1-e)*(1-e)*(1-e)*t+3*e*(1-e)*(1-e)*r+3*e*e*(1-e)*n+e*e*e*i},l=this._points[this._points.length-1],c=0;c<=a;c++){var u=c/a,h=s(u,l.x,e,r,i),d=s(u,l.y,t,n,o);this.addLineTo(h,d)}return this},e.prototype.isPointInside=function(e){for(var t=!1,r=this._points.length,n=r-1,i=0;i<r;n=i++){var o=this._points[n],a=this._points[i],s=a.x-o.x,l=a.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=this._points[i],s=-s,a=this._points[n],l=-l),e.y<o.y||e.y>a.y)continue;if(e.y===o.y&&e.x===o.x)return!0;var c=l*(e.x-o.x)-s*(e.y-o.y);if(0===c)return!0;if(c<0)continue;t=!t}else{if(e.y!==o.y)continue;if(a.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=a.x)return!0}}return t},e.prototype.close=function(){return this.closed=!0,this},e.prototype.length=function(){var e=this._length;if(this.closed){var t=this._points[this._points.length-1];e+=this._points[0].subtract(t).length()}return e},e.prototype.area=function(){for(var e=this._points.length,t=0,r=e-1,n=0;n<e;r=n++)t+=this._points[r].x*this._points[n].y-this._points[n].x*this._points[r].y;return.5*t},e.prototype.getPoints=function(){return this._points},e.prototype.getPointAtLengthPosition=function(e){if(e<0||e>1)return o.I9.Zero();for(var t=e*this.length(),r=0,n=0;n<this._points.length;n++){var i=(n+1)%this._points.length,a=this._points[n],s=this._points[i].subtract(a),l=s.length()+r;if(t>=r&&t<=l){var c=s.normalize(),u=t-r;return new o.I9(a.x+c.x*u,a.y+c.y*u)}r=l}return o.I9.Zero()},e.StartingAt=function(t,r){return new e(t,r)},e}(),h=function(){function e(e,t,r,n){void 0===t&&(t=null),void 0===n&&(n=!1),this.path=e,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array,this._pointAtData={id:0,point:o.Pq.Zero(),previousPointArrayIndex:0,position:0,subPosition:0,interpolateReady:!1,interpolationMatrix:o.uq.Identity()};for(var i=0;i<e.length;i++)this._curve[i]=e[i].clone();this._raw=r||!1,this._alignTangentsWithPath=n,this._compute(t,n)}return e.prototype.getCurve=function(){return this._curve},e.prototype.getPoints=function(){return this._curve},e.prototype.length=function(){return this._distances[this._distances.length-1]},e.prototype.getTangents=function(){return this._tangents},e.prototype.getNormals=function(){return this._normals},e.prototype.getBinormals=function(){return this._binormals},e.prototype.getDistances=function(){return this._distances},e.prototype.getPointAt=function(e){return this._updatePointAtData(e).point},e.prototype.getTangentAt=function(e,t){return void 0===t&&(t=!1),this._updatePointAtData(e,t),t?o.Pq.TransformCoordinates(o.Pq.Forward(),this._pointAtData.interpolationMatrix):this._tangents[this._pointAtData.previousPointArrayIndex]},e.prototype.getNormalAt=function(e,t){return void 0===t&&(t=!1),this._updatePointAtData(e,t),t?o.Pq.TransformCoordinates(o.Pq.Right(),this._pointAtData.interpolationMatrix):this._normals[this._pointAtData.previousPointArrayIndex]},e.prototype.getBinormalAt=function(e,t){return void 0===t&&(t=!1),this._updatePointAtData(e,t),t?o.Pq.TransformCoordinates(o.Pq.UpReadOnly,this._pointAtData.interpolationMatrix):this._binormals[this._pointAtData.previousPointArrayIndex]},e.prototype.getDistanceAt=function(e){return this.length()*e},e.prototype.getPreviousPointIndexAt=function(e){return this._updatePointAtData(e),this._pointAtData.previousPointArrayIndex},e.prototype.getSubPositionAt=function(e){return this._updatePointAtData(e),this._pointAtData.subPosition},e.prototype.getClosestPositionTo=function(e){for(var t=Number.MAX_VALUE,r=0,n=0;n<this._curve.length-1;n++){var i=this._curve[n+0],a=this._curve[n+1].subtract(i).normalize(),s=this._distances[n+1]-this._distances[n+0],l=Math.min(Math.max(o.Pq.Dot(a,e.subtract(i).normalize()),0)*o.Pq.Distance(i,e)/s,1),c=o.Pq.Distance(i.add(a.scale(l*s)),e);c<t&&(t=c,r=(this._distances[n+0]+s*l)/this.length())}return r},e.prototype.slice=function(t,r){if(void 0===t&&(t=0),void 0===r&&(r=1),t<0&&(t=1- -1*t%1),r<0&&(r=1- -1*r%1),t>r){var n=t;t=r,r=n}var i=this.getCurve(),o=this.getPointAt(t),a=this.getPreviousPointIndexAt(t),s=this.getPointAt(r),l=this.getPreviousPointIndexAt(r)+1,c=[];return 0!==t&&(a++,c.push(o)),c.push.apply(c,i.slice(a,l)),1===r&&1!==t||c.push(s),new e(c,this.getNormalAt(t),this._raw,this._alignTangentsWithPath)},e.prototype.update=function(e,t,r){void 0===t&&(t=null),void 0===r&&(r=!1);for(var n=0;n<e.length;n++)this._curve[n].x=e[n].x,this._curve[n].y=e[n].y,this._curve[n].z=e[n].z;return this._compute(t,r),this},e.prototype._compute=function(e,t){void 0===t&&(t=!1);var r=this._curve.length;if(!(r<2)){this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[r-1]=this._curve[r-1].subtract(this._curve[r-2]),this._raw||this._tangents[r-1].normalize();var n,i,a,s,l,c=this._tangents[0],u=this._normalVector(c,e);this._normals[0]=u,this._raw||this._normals[0].normalize(),this._binormals[0]=o.Pq.Cross(c,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var h=1;h<r;h++)n=this._getLastNonNullVector(h),h<r-1&&(i=this._getFirstNonNullVector(h),this._tangents[h]=t?i:n.add(i),this._tangents[h].normalize()),this._distances[h]=this._distances[h-1]+this._curve[h].subtract(this._curve[h-1]).length(),a=this._tangents[h],l=this._binormals[h-1],this._normals[h]=o.Pq.Cross(l,a),this._raw||(0===this._normals[h].length()?(s=this._normals[h-1],this._normals[h]=s.clone()):this._normals[h].normalize()),this._binormals[h]=o.Pq.Cross(a,this._normals[h]),this._raw||this._binormals[h].normalize();this._pointAtData.id=NaN}},e.prototype._getFirstNonNullVector=function(e){for(var t=1,r=this._curve[e+t].subtract(this._curve[e]);0===r.length()&&e+t+1<this._curve.length;)t++,r=this._curve[e+t].subtract(this._curve[e]);return r},e.prototype._getLastNonNullVector=function(e){for(var t=1,r=this._curve[e].subtract(this._curve[e-t]);0===r.length()&&e>t+1;)t++,r=this._curve[e].subtract(this._curve[e-t]);return r},e.prototype._normalVector=function(e,t){var r,n=e.length();if(0===n&&(n=1),null==t){var s;s=(0,i.WithinEpsilon)(Math.abs(e.y)/n,1,a.bH)?(0,i.WithinEpsilon)(Math.abs(e.x)/n,1,a.bH)?(0,i.WithinEpsilon)(Math.abs(e.z)/n,1,a.bH)?o.Pq.Zero():new o.Pq(0,0,1):new o.Pq(1,0,0):new o.Pq(0,-1,0),r=o.Pq.Cross(e,s)}else r=o.Pq.Cross(e,t),o.Pq.CrossToRef(r,e,r);return r.normalize(),r},e.prototype._updatePointAtData=function(e,t){if(void 0===t&&(t=!1),this._pointAtData.id===e)return this._pointAtData.interpolateReady||this._updateInterpolationMatrix(),this._pointAtData;this._pointAtData.id=e;var r=this.getPoints();if(e<=0)return this._setPointAtData(0,0,r[0],0,t);if(e>=1)return this._setPointAtData(1,1,r[r.length-1],r.length-1,t);for(var n,i=r[0],a=0,s=e*this.length(),l=1;l<r.length;l++){n=r[l];var c=o.Pq.Distance(i,n);if((a+=c)===s)return this._setPointAtData(e,1,n,l,t);if(a>s){var u=(a-s)/c,h=i.subtract(n),d=n.add(h.scaleInPlace(u));return this._setPointAtData(e,1-u,d,l-1,t)}i=n}return this._pointAtData},e.prototype._setPointAtData=function(e,t,r,n,i){return this._pointAtData.point=r,this._pointAtData.position=e,this._pointAtData.subPosition=t,this._pointAtData.previousPointArrayIndex=n,this._pointAtData.interpolateReady=i,i&&this._updateInterpolationMatrix(),this._pointAtData},e.prototype._updateInterpolationMatrix=function(){this._pointAtData.interpolationMatrix=o.uq.Identity();var e=this._pointAtData.previousPointArrayIndex;if(e!==this._tangents.length-1){var t=e+1,r=this._tangents[e].clone(),n=this._normals[e].clone(),i=this._binormals[e].clone(),a=this._tangents[t].clone(),s=this._normals[t].clone(),l=this._binormals[t].clone(),c=o.PT.RotationQuaternionFromAxis(n,i,r),u=o.PT.RotationQuaternionFromAxis(s,l,a);o.PT.Slerp(c,u,this._pointAtData.subPosition).toRotationMatrix(this._pointAtData.interpolationMatrix)}},e}(),d=function(){function e(e){this._length=0,this._points=e,this._length=this._computeLength(e)}return e.CreateQuadraticBezier=function(t,r,n,i){i=i>2?i:3;for(var a=[],s=function(e,t,r,n){return(1-e)*(1-e)*t+2*e*(1-e)*r+e*e*n},l=0;l<=i;l++)a.push(new o.Pq(s(l/i,t.x,r.x,n.x),s(l/i,t.y,r.y,n.y),s(l/i,t.z,r.z,n.z)));return new e(a)},e.CreateCubicBezier=function(t,r,n,i,a){a=a>3?a:4;for(var s=[],l=function(e,t,r,n,i){return(1-e)*(1-e)*(1-e)*t+3*e*(1-e)*(1-e)*r+3*e*e*(1-e)*n+e*e*e*i},c=0;c<=a;c++)s.push(new o.Pq(l(c/a,t.x,r.x,n.x,i.x),l(c/a,t.y,r.y,n.y,i.y),l(c/a,t.z,r.z,n.z,i.z)));return new e(s)},e.CreateHermiteSpline=function(t,r,n,i,a){for(var s=[],l=1/a,c=0;c<=a;c++)s.push(o.Pq.Hermite(t,r,n,i,c*l));return new e(s)},e.CreateCatmullRomSpline=function(t,r,n){var i=[],a=1/r,s=0;if(n){for(var l=t.length,c=0;c<l;c++){s=0;for(var u=0;u<r;u++)i.push(o.Pq.CatmullRom(t[c%l],t[(c+1)%l],t[(c+2)%l],t[(c+3)%l],s)),s+=a}i.push(i[0])}else{var h=[];for(h.push(t[0].clone()),Array.prototype.push.apply(h,t),h.push(t[t.length-1].clone()),c=0;c<h.length-3;c++)for(s=0,u=0;u<r;u++)i.push(o.Pq.CatmullRom(h[c],h[c+1],h[c+2],h[c+3],s)),s+=a;c--,i.push(o.Pq.CatmullRom(h[c],h[c+1],h[c+2],h[c+3],s))}return new e(i)},e.ArcThru3Points=function(t,r,n,i,a,s){void 0===i&&(i=32),void 0===a&&(a=!1),void 0===s&&(s=!1);var l=[],c=r.subtract(t),u=n.subtract(r),h=t.subtract(n),d=o.Pq.Cross(c,u),f=d.length();if(f<Math.pow(10,-8))return new e(l);var p=c.lengthSquared(),_=u.lengthSquared(),m=h.lengthSquared(),g=d.lengthSquared(),v=.5*c.length()*u.length()*h.length()/f,y=-.5*_*o.Pq.Dot(c,h)/g,b=-.5*m*o.Pq.Dot(c,u)/g,S=-.5*p*o.Pq.Dot(u,h)/g,T=t.scale(y).add(r.scale(b)).add(n.scale(S)),E=t.subtract(T).normalize(),x=o.Pq.Cross(d,E).normalize();if(s){for(var P=2*Math.PI/i,C=0;C<=2*Math.PI;C+=P)l.push(T.add(E.scale(v*Math.cos(C)).add(x.scale(v*Math.sin(C)))));l.push(t)}else{P=1/i,C=0;var A=o.Pq.Zero();do{A=T.add(E.scale(v*Math.cos(C)).add(x.scale(v*Math.sin(C)))),l.push(A),C+=P}while(!A.equalsWithEpsilon(n,v*P*1.1));l.push(n),a&&l.push(t)}return new e(l)},e.prototype.getPoints=function(){return this._points},e.prototype.length=function(){return this._length},e.prototype.continue=function(t){for(var r=this._points[this._points.length-1],n=this._points.slice(),i=t.getPoints(),o=1;o<i.length;o++)n.push(i[o].subtract(i[0]).add(r));return new e(n)},e.prototype._computeLength=function(e){for(var t=0,r=1;r<e.length;r++)t+=e[r].subtract(e[r-1]).length();return t},e}()},43939:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(8046),i=function(){function e(e,t,r,i){this.normal=new n.Pq(e,t,r),this.d=i}return e.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},e.prototype.clone=function(){return new e(this.normal.x,this.normal.y,this.normal.z,this.d)},e.prototype.getClassName=function(){return\"Plane\"},e.prototype.getHashCode=function(){var e=this.normal.getHashCode();return 397*e^this.d},e.prototype.normalize=function(){var e=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),t=0;return 0!==e&&(t=1/e),this.normal.x*=t,this.normal.y*=t,this.normal.z*=t,this.d*=t,this},e.prototype.transform=function(t){var r=e._TmpMatrix;t.invertToRef(r);var n=r.m,i=this.normal.x,o=this.normal.y,a=this.normal.z,s=this.d;return new e(i*n[0]+o*n[1]+a*n[2]+s*n[3],i*n[4]+o*n[5]+a*n[6]+s*n[7],i*n[8]+o*n[9]+a*n[10]+s*n[11],i*n[12]+o*n[13]+a*n[14]+s*n[15])},e.prototype.dotCoordinate=function(e){return this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z+this.d},e.prototype.copyFromPoints=function(e,t,r){var n,i=t.x-e.x,o=t.y-e.y,a=t.z-e.z,s=r.x-e.x,l=r.y-e.y,c=r.z-e.z,u=o*c-a*l,h=a*s-i*c,d=i*l-o*s,f=Math.sqrt(u*u+h*h+d*d);return n=0!==f?1/f:0,this.normal.x=u*n,this.normal.y=h*n,this.normal.z=d*n,this.d=-(this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z),this},e.prototype.isFrontFacingTo=function(e,t){return n.Pq.Dot(this.normal,e)<=t},e.prototype.signedDistanceTo=function(e){return n.Pq.Dot(e,this.normal)+this.d},e.FromArray=function(t){return new e(t[0],t[1],t[2],t[3])},e.FromPoints=function(t,r,n){var i=new e(0,0,0,0);return i.copyFromPoints(t,r,n),i},e.FromPositionAndNormal=function(t,r){var n=new e(0,0,0,0);return this.FromPositionAndNormalToRef(t,r,n)},e.FromPositionAndNormalToRef=function(e,t,r){return r.normal.copyFrom(t),r.normal.normalize(),r.d=-e.dot(r.normal),r},e.SignedDistanceToPlaneFromPositionAndNormal=function(e,t,r){var i=-(t.x*e.x+t.y*e.y+t.z*e.z);return n.Pq.Dot(r,t)+i},e._TmpMatrix=n.uq.Identity(),e}()},48810:(e,t,r)=>{function n(e){return parseInt(e.toString().replace(/\\W/g,\"\"))}function i(e,t,r){return void 0===r&&(r=1401298e-51),Math.abs(e-t)<=r}function o(e,t){return e===t?e:Math.random()*(t-e)+e}function a(e,t,r){return e+(t-e)*r}function s(e,t,r){var n=_(t-e,360);return n>180&&(n-=360),e+n*h(r)}function l(e,t,r){return e!=t?h((r-e)/(t-e)):0}function c(e,t,r,n,i){var o=i*i,a=i*o;return e*(2*a-3*o+1)+r*(-2*a+3*o)+t*(a-2*o+i)+n*(a-o)}function u(e,t,r,n,i){var o=i*i;return 6*(o-i)*e+(3*o-4*i+1)*t+6*(-o+i)*r+(3*o-2*i)*n}function h(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),Math.min(r,Math.max(t,e))}function d(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}function f(e){var t=e.toString(16);return e<=15?(\"0\"+t).toUpperCase():t.toUpperCase()}function p(e){if(Math.log2)return Math.floor(Math.log2(e));if(e<0)return NaN;if(0===e)return-1/0;var t=0;if(e<1){for(;e<1;)t++,e*=2;t=-t}else if(e>1)for(;e>1;)t++,e=Math.floor(e/2);return t}function _(e,t){return e-Math.floor(e/t)*t}function m(e,t,r){return(e-t)/(r-t)}function g(e,t,r){return e*(r-t)+t}function v(e,t){var r=_(t-e,360);return r>180&&(r-=360),r}function y(e,t){var r=_(e,2*t);return t-Math.abs(r-t)}function b(e,t,r){var n=h(r);return t*(n=-2*n*n*n+3*n*n)+e*(1-n)}function S(e,t,r){return Math.abs(t-e)<=r?t:e+Math.sign(t-e)*r}function T(e,t,r){var n=v(e,t);return-r<n&&n<r?t:S(e,t=e+n,r)}function E(e,t,r){return(e-t)/(r-t)}function x(e,t,r){return(r-t)*e+t}function P(e,t){var r=e%t;return 0===r?t:P(t,r)}r.r(t),r.d(t,{Clamp:()=>h,DeltaAngle:()=>v,Denormalize:()=>g,ExtractAsInt:()=>n,Hermite:()=>c,Hermite1stDerivative:()=>u,HighestCommonFactor:()=>P,ILog2:()=>p,InverseLerp:()=>l,Lerp:()=>a,LerpAngle:()=>s,MoveTowards:()=>S,MoveTowardsAngle:()=>T,Normalize:()=>m,NormalizeRadians:()=>d,PercentToRange:()=>x,PingPong:()=>y,RandomRange:()=>o,RangeToPercent:()=>E,Repeat:()=>_,SmoothStep:()=>b,ToHex:()=>f,WithinEpsilon:()=>i})},73152:(e,t,r)=>{r.d(t,{o:()=>n});var n=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.toString=function(){return\"{W: \".concat(this.width,\", H: \").concat(this.height,\"}\")},e.prototype.getClassName=function(){return\"Size\"},e.prototype.getHashCode=function(){var e=0|this.width;return 397*e^this.height},e.prototype.copyFrom=function(e){this.width=e.width,this.height=e.height},e.prototype.copyFromFloats=function(e,t){return this.width=e,this.height=t,this},e.prototype.set=function(e,t){return this.copyFromFloats(e,t)},e.prototype.multiplyByFloats=function(t,r){return new e(this.width*t,this.height*r)},e.prototype.clone=function(){return new e(this.width,this.height)},e.prototype.equals=function(e){return!!e&&this.width===e.width&&this.height===e.height},Object.defineProperty(e.prototype,\"surface\",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),e.Zero=function(){return new e(0,0)},e.prototype.add=function(t){return new e(this.width+t.width,this.height+t.height)},e.prototype.subtract=function(t){return new e(this.width-t.width,this.height-t.height)},e.prototype.scale=function(t){return new e(this.width*t,this.height*t)},e.Lerp=function(t,r,n){return new e(t.width+(r.width-t.width)*n,t.height+(r.height-t.height)*n)},e}()},51322:(e,t,r)=>{r.d(t,{uM:()=>s.uM,Xy:()=>s.Xy,_0:()=>n._0,vr:()=>s.vr,v9:()=>i.v9,ov:()=>i.ov,xp:()=>n.xp,jj:()=>s.jj,bH:()=>o.bH,PP:()=>a.P,uq:()=>u.uq,t4:()=>s.t4,a6:()=>o.a6,Cu:()=>s.Cu,tO:()=>s.tO,Zc:()=>l.Z,k0:()=>d,B5:()=>h,PT:()=>u.PT,or:()=>c.o,$x:()=>n.$x,IG:()=>i.IG,AA:()=>u.AA,rv:()=>o.rv,tk:()=>o.tk,I9:()=>u.I9,Pq:()=>u.Pq,IU:()=>u.IU,LM:()=>f.L});var n=r(13424),i=r(64726),o=r(56740),a=r(36359),s=r(95318),l=r(43939),c=r(73152),u=r(8046),h=function(){function e(e,t){void 0===e&&(e=u.Pq.Zero()),void 0===t&&(t=u.Pq.Up()),this.position=e,this.normal=t}return e.prototype.clone=function(){return new e(this.position.clone(),this.normal.clone())},e}(),d=function(){function e(e,t,r){void 0===e&&(e=u.Pq.Zero()),void 0===t&&(t=u.Pq.Up()),void 0===r&&(r=u.I9.Zero()),this.position=e,this.normal=t,this.uv=r}return e.prototype.clone=function(){return new e(this.position.clone(),this.normal.clone(),this.uv.clone())},e}(),f=r(25187)},8046:(e,t,r)=>{r.d(t,{AA:()=>g,I9:()=>h,IU:()=>f,PT:()=>p,Pq:()=>d,uq:()=>_});var n=r(78322),i=r(56740),o=r(11296),a=r(34623),s=r(16106),l=r(66614),c=r(48810),u=function(e){return parseInt(e.toString().replace(/\\W/g,\"\"))},h=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.toString=function(){return\"{X: \".concat(this.x,\" Y: \").concat(this.y,\"}\")},e.prototype.getClassName=function(){return\"Vector2\"},e.prototype.getHashCode=function(){var e=u(this.x);return 397*e^u(this.y)},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,this},e.prototype.fromArray=function(t,r){return void 0===r&&(r=0),e.FromArrayToRef(t,r,this),this},e.prototype.asArray=function(){return[this.x,this.y]},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this},e.prototype.copyFromFloats=function(e,t){return this.x=e,this.y=t,this},e.prototype.set=function(e,t){return this.copyFromFloats(e,t)},e.prototype.setAll=function(e){return this.copyFromFloats(e,e)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.addToRef=function(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t},e.prototype.addInPlace=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.addInPlaceFromFloats=function(e,t){return this.x+=e,this.y+=t,this},e.prototype.addVector3=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.subtractToRef=function(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t},e.prototype.subtractInPlace=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.multiplyInPlace=function(e){return this.x*=e.x,this.y*=e.y,this},e.prototype.multiply=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.multiplyToRef=function(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t},e.prototype.multiplyByFloats=function(t,r){return new e(this.x*t,this.y*r)},e.prototype.divide=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.divideToRef=function(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t},e.prototype.divideInPlace=function(e){return this.x=this.x/e.x,this.y=this.y/e.y,this},e.prototype.minimizeInPlace=function(e){return this.minimizeInPlaceFromFloats(e.x,e.y)},e.prototype.maximizeInPlace=function(e){return this.maximizeInPlaceFromFloats(e.x,e.y)},e.prototype.minimizeInPlaceFromFloats=function(e,t){return this.x=Math.min(e,this.x),this.y=Math.min(t,this.y),this},e.prototype.maximizeInPlaceFromFloats=function(e,t){return this.x=Math.max(e,this.x),this.y=Math.max(t,this.y),this},e.prototype.subtractFromFloats=function(t,r){return new e(this.x-t,this.y-r)},e.prototype.subtractFromFloatsToRef=function(e,t,r){return r.x=this.x-e,r.y=this.y-t,r},e.prototype.negate=function(){return new e(-this.x,-this.y)},e.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this},e.prototype.negateToRef=function(e){return e.x=-this.x,e.y=-this.y,e},e.prototype.scaleInPlace=function(e){return this.x*=e,this.y*=e,this},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.scaleToRef=function(e,t){return t.x=this.x*e,t.y=this.y*e,t},e.prototype.scaleAndAddToRef=function(e,t){return t.x+=this.x*e,t.y+=this.y*e,t},e.prototype.equals=function(e){return e&&this.x===e.x&&this.y===e.y},e.prototype.equalsWithEpsilon=function(e,t){return void 0===t&&(t=i.bH),e&&(0,c.WithinEpsilon)(this.x,e.x,t)&&(0,c.WithinEpsilon)(this.y,e.y,t)},e.prototype.equalsToFloats=function(e,t){return this.x===e&&this.y===t},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e.prototype.floorToRef=function(e){return e.x=Math.floor(this.x),e.y=Math.floor(this.y),e},e.prototype.fract=function(){return new e(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},e.prototype.fractToRef=function(e){return e.x=this.x-Math.floor(this.x),e.y=this.y-Math.floor(this.y),e},e.prototype.rotateToRef=function(e,t){var r=Math.cos(e),n=Math.sin(e),i=r*this.x-n*this.y,o=n*this.x+r*this.y;return t.x=i,t.y=o,t},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){return this.normalizeFromLength(this.length())},e.prototype.normalizeFromLength=function(e){return 0===e||1===e?this:this.scaleInPlace(1/e)},e.prototype.normalizeToNew=function(){var t=new e;return this.normalizeToRef(t),t},e.prototype.normalizeToRef=function(e){var t=this.length();return 0===t&&(e.x=this.x,e.y=this.y),this.scaleToRef(1/t,e)},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y},e.Zero=function(){return new e(0,0)},e.One=function(){return new e(1,1)},e.Random=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),new e((0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r))},e.RandomToRef=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),r.copyFromFloats((0,c.RandomRange)(e,t),(0,c.RandomRange)(e,t))},Object.defineProperty(e,\"ZeroReadOnly\",{get:function(){return e._ZeroReadOnly},enumerable:!1,configurable:!0}),e.FromArray=function(t,r){return void 0===r&&(r=0),new e(t[r],t[r+1])},e.FromArrayToRef=function(e,t,r){return r.x=e[t],r.y=e[t+1],r},e.FromFloatsToRef=function(e,t,r){return r.copyFromFloats(e,t),r},e.CatmullRom=function(t,r,n,i,o){var a=o*o,s=o*a;return new e(.5*(2*r.x+(-t.x+n.x)*o+(2*t.x-5*r.x+4*n.x-i.x)*a+(-t.x+3*r.x-3*n.x+i.x)*s),.5*(2*r.y+(-t.y+n.y)*o+(2*t.y-5*r.y+4*n.y-i.y)*a+(-t.y+3*r.y-3*n.y+i.y)*s))},e.ClampToRef=function(e,t,r,n){return n.x=(0,c.Clamp)(e.x,t.x,r.x),n.y=(0,c.Clamp)(e.y,t.y,r.y),n},e.Clamp=function(t,r,n){return new e((0,c.Clamp)(t.x,r.x,n.x),(0,c.Clamp)(t.y,r.y,n.y))},e.Hermite=function(t,r,n,i,o){var a=o*o,s=o*a,l=2*s-3*a+1,c=-2*s+3*a,u=s-2*a+o,h=s-a;return new e(t.x*l+n.x*c+r.x*u+i.x*h,t.y*l+n.y*c+r.y*u+i.y*h)},e.Hermite1stDerivative=function(t,r,n,i,o){return this.Hermite1stDerivativeToRef(t,r,n,i,o,new e)},e.Hermite1stDerivativeToRef=function(e,t,r,n,i,o){var a=i*i;return o.x=6*(a-i)*e.x+(3*a-4*i+1)*t.x+6*(-a+i)*r.x+(3*a-2*i)*n.x,o.y=6*(a-i)*e.y+(3*a-4*i+1)*t.y+6*(-a+i)*r.y+(3*a-2*i)*n.y,o},e.Lerp=function(t,r,n){return e.LerpToRef(t,r,n,new e)},e.LerpToRef=function(e,t,r,n){return n.x=e.x+(t.x-e.x)*r,n.y=e.y+(t.y-e.y)*r,n},e.Dot=function(e,t){return e.x*t.x+e.y*t.y},e.Normalize=function(t){return e.NormalizeToRef(t,new e)},e.NormalizeToRef=function(e,t){return e.normalizeToRef(t),t},e.Minimize=function(t,r){return new e(t.x<r.x?t.x:r.x,t.y<r.y?t.y:r.y)},e.Maximize=function(t,r){return new e(t.x>r.x?t.x:r.x,t.y>r.y?t.y:r.y)},e.Transform=function(t,r){return e.TransformToRef(t,r,new e)},e.TransformToRef=function(e,t,r){var n=t.m,i=e.x*n[0]+e.y*n[4]+n[12],o=e.x*n[1]+e.y*n[5]+n[13];return r.x=i,r.y=o,r},e.PointInTriangle=function(e,t,r,n){var i=.5*(-r.y*n.x+t.y*(-r.x+n.x)+t.x*(r.y-n.y)+r.x*n.y),o=i<0?-1:1,a=(t.y*n.x-t.x*n.y+(n.y-t.y)*e.x+(t.x-n.x)*e.y)*o,s=(t.x*r.y-t.y*r.x+(t.y-r.y)*e.x+(r.x-t.x)*e.y)*o;return a>0&&s>0&&a+s<2*i*o},e.Distance=function(t,r){return Math.sqrt(e.DistanceSquared(t,r))},e.DistanceSquared=function(e,t){var r=e.x-t.x,n=e.y-t.y;return r*r+n*n},e.Center=function(t,r){return e.CenterToRef(t,r,new e)},e.CenterToRef=function(e,t,r){return r.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)},e.DistanceOfPointFromSegment=function(t,r,n){var i=e.DistanceSquared(r,n);if(0===i)return e.Distance(t,r);var o=n.subtract(r),a=Math.max(0,Math.min(1,e.Dot(t.subtract(r),o)/i)),s=r.add(o.multiplyByFloats(a,a));return e.Distance(t,s)},e._ZeroReadOnly=e.Zero(),e}();Object.defineProperties(h.prototype,{dimension:{value:[2]},rank:{value:1}});var d=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this._isDirty=!0,this._x=e,this._y=t,this._z=r}return Object.defineProperty(e.prototype,\"x\",{get:function(){return this._x},set:function(e){this._x=e,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"y\",{get:function(){return this._y},set:function(e){this._y=e,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"z\",{get:function(){return this._z},set:function(e){this._z=e,this._isDirty=!0},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return\"{X: \".concat(this._x,\" Y: \").concat(this._y,\" Z: \").concat(this._z,\"}\")},e.prototype.getClassName=function(){return\"Vector3\"},e.prototype.getHashCode=function(){var e=u(this._x);return 397*(e=397*e^u(this._y))^u(this._z)},e.prototype.asArray=function(){return[this._x,this._y,this._z]},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,this},e.prototype.fromArray=function(t,r){return void 0===r&&(r=0),e.FromArrayToRef(t,r,this),this},e.prototype.toQuaternion=function(){return p.RotationYawPitchRoll(this._y,this._x,this._z)},e.prototype.addInPlace=function(e){return this._x+=e._x,this._y+=e._y,this._z+=e._z,this._isDirty=!0,this},e.prototype.addInPlaceFromFloats=function(e,t,r){return this._x+=e,this._y+=t,this._z+=r,this._isDirty=!0,this},e.prototype.add=function(t){return new e(this._x+t._x,this._y+t._y,this._z+t._z)},e.prototype.addToRef=function(e,t){return t._x=this._x+e._x,t._y=this._y+e._y,t._z=this._z+e._z,t._isDirty=!0,t},e.prototype.subtractInPlace=function(e){return this._x-=e._x,this._y-=e._y,this._z-=e._z,this._isDirty=!0,this},e.prototype.subtract=function(t){return new e(this._x-t._x,this._y-t._y,this._z-t._z)},e.prototype.subtractToRef=function(e,t){return this.subtractFromFloatsToRef(e._x,e._y,e._z,t)},e.prototype.subtractFromFloats=function(t,r,n){return new e(this._x-t,this._y-r,this._z-n)},e.prototype.subtractFromFloatsToRef=function(e,t,r,n){return n._x=this._x-e,n._y=this._y-t,n._z=this._z-r,n._isDirty=!0,n},e.prototype.negate=function(){return new e(-this._x,-this._y,-this._z)},e.prototype.negateInPlace=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this},e.prototype.negateToRef=function(e){return e._x=-1*this._x,e._y=-1*this._y,e._z=-1*this._z,e._isDirty=!0,e},e.prototype.scaleInPlace=function(e){return this._x*=e,this._y*=e,this._z*=e,this._isDirty=!0,this},e.prototype.scale=function(t){return new e(this._x*t,this._y*t,this._z*t)},e.prototype.scaleToRef=function(e,t){return t._x=this._x*e,t._y=this._y*e,t._z=this._z*e,t._isDirty=!0,t},e.prototype.getNormalToRef=function(e){var t=this.length(),r=Math.acos(this.y/t),n=Math.atan2(this.z,this.x);r>Math.PI/2?r-=Math.PI/2:r+=Math.PI/2;var i=t*Math.sin(r)*Math.cos(n),o=t*Math.cos(r),a=t*Math.sin(r)*Math.sin(n);return e.set(i,o,a),e},e.prototype.applyRotationQuaternionToRef=function(e,t){var r=this._x,n=this._y,i=this._z,o=e._x,a=e._y,s=e._z,l=e._w,c=2*(a*i-s*n),u=2*(s*r-o*i),h=2*(o*n-a*r);return t._x=r+l*c+a*h-s*u,t._y=n+l*u+s*c-o*h,t._z=i+l*h+o*u-a*c,t._isDirty=!0,t},e.prototype.applyRotationQuaternionInPlace=function(e){return this.applyRotationQuaternionToRef(e,this)},e.prototype.applyRotationQuaternion=function(t){return this.applyRotationQuaternionToRef(t,new e)},e.prototype.scaleAndAddToRef=function(e,t){return t._x+=this._x*e,t._y+=this._y*e,t._z+=this._z*e,t._isDirty=!0,t},e.prototype.projectOnPlane=function(t,r){return this.projectOnPlaneToRef(t,r,new e)},e.prototype.projectOnPlaneToRef=function(t,r,n){var i=t.normal,o=t.d,a=m.Vector3[0];this.subtractToRef(r,a),a.normalize();var s=e.Dot(a,i);if(Math.abs(s)<1e-10)n.setAll(1/0);else{var l=-(e.Dot(r,i)+o)/s,c=a.scaleInPlace(l);r.addToRef(c,n)}return n},e.prototype.equals=function(e){return e&&this._x===e._x&&this._y===e._y&&this._z===e._z},e.prototype.equalsWithEpsilon=function(e,t){return void 0===t&&(t=i.bH),e&&(0,c.WithinEpsilon)(this._x,e._x,t)&&(0,c.WithinEpsilon)(this._y,e._y,t)&&(0,c.WithinEpsilon)(this._z,e._z,t)},e.prototype.equalsToFloats=function(e,t,r){return this._x===e&&this._y===t&&this._z===r},e.prototype.multiplyInPlace=function(e){return this._x*=e._x,this._y*=e._y,this._z*=e._z,this._isDirty=!0,this},e.prototype.multiply=function(e){return this.multiplyByFloats(e._x,e._y,e._z)},e.prototype.multiplyToRef=function(e,t){return t._x=this._x*e._x,t._y=this._y*e._y,t._z=this._z*e._z,t._isDirty=!0,t},e.prototype.multiplyByFloats=function(t,r,n){return new e(this._x*t,this._y*r,this._z*n)},e.prototype.divide=function(t){return new e(this._x/t._x,this._y/t._y,this._z/t._z)},e.prototype.divideToRef=function(e,t){return t._x=this._x/e._x,t._y=this._y/e._y,t._z=this._z/e._z,t._isDirty=!0,t},e.prototype.divideInPlace=function(e){return this._x=this._x/e._x,this._y=this._y/e._y,this._z=this._z/e._z,this._isDirty=!0,this},e.prototype.minimizeInPlace=function(e){return this.minimizeInPlaceFromFloats(e._x,e._y,e._z)},e.prototype.maximizeInPlace=function(e){return this.maximizeInPlaceFromFloats(e._x,e._y,e._z)},e.prototype.minimizeInPlaceFromFloats=function(e,t,r){return e<this._x&&(this.x=e),t<this._y&&(this.y=t),r<this._z&&(this.z=r),this},e.prototype.maximizeInPlaceFromFloats=function(e,t,r){return e>this._x&&(this.x=e),t>this._y&&(this.y=t),r>this._z&&(this.z=r),this},e.prototype.isNonUniformWithinEpsilon=function(e){var t=Math.abs(this._x),r=Math.abs(this._y);if(!(0,c.WithinEpsilon)(t,r,e))return!0;var n=Math.abs(this._z);return!(0,c.WithinEpsilon)(t,n,e)||!(0,c.WithinEpsilon)(r,n,e)},Object.defineProperty(e.prototype,\"isNonUniform\",{get:function(){var e=Math.abs(this._x);return e!==Math.abs(this._y)||e!==Math.abs(this._z)},enumerable:!1,configurable:!0}),e.prototype.floorToRef=function(e){return e._x=Math.floor(this._x),e._y=Math.floor(this._y),e._z=Math.floor(this._z),e._isDirty=!0,e},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},e.prototype.fractToRef=function(e){return e._x=this.x-Math.floor(this._x),e._y=this.y-Math.floor(this._y),e._z=this.z-Math.floor(this._z),e._isDirty=!0,e},e.prototype.fract=function(){return new e(this.x-Math.floor(this._x),this.y-Math.floor(this._y),this.z-Math.floor(this._z))},e.prototype.length=function(){return Math.sqrt(this.lengthSquared())},e.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z},Object.defineProperty(e.prototype,\"hasAZeroComponent\",{get:function(){return this._x*this._y*this._z==0},enumerable:!1,configurable:!0}),e.prototype.normalize=function(){return this.normalizeFromLength(this.length())},e.prototype.reorderInPlace=function(e){if(\"xyz\"===(e=e.toLowerCase()))return this;var t=m.Vector3[0].copyFrom(this);return this.x=t[e[0]],this.y=t[e[1]],this.z=t[e[2]],this},e.prototype.rotateByQuaternionToRef=function(t,r){return t.toRotationMatrix(m.Matrix[0]),e.TransformCoordinatesToRef(this,m.Matrix[0],r),r},e.prototype.rotateByQuaternionAroundPointToRef=function(e,t,r){return this.subtractToRef(t,m.Vector3[0]),m.Vector3[0].rotateByQuaternionToRef(e,m.Vector3[0]),t.addToRef(m.Vector3[0],r),r},e.prototype.cross=function(t){return e.CrossToRef(this,t,new e)},e.prototype.normalizeFromLength=function(e){return 0===e||1===e?this:this.scaleInPlace(1/e)},e.prototype.normalizeToNew=function(){return this.normalizeToRef(new e)},e.prototype.normalizeToRef=function(e){var t=this.length();return 0===t||1===t?(e._x=this._x,e._y=this._y,e._z=this._z,e._isDirty=!0,e):this.scaleToRef(1/t,e)},e.prototype.clone=function(){return new e(this._x,this._y,this._z)},e.prototype.copyFrom=function(e){return this.copyFromFloats(e._x,e._y,e._z)},e.prototype.copyFromFloats=function(e,t,r){return this._x=e,this._y=t,this._z=r,this._isDirty=!0,this},e.prototype.set=function(e,t,r){return this.copyFromFloats(e,t,r)},e.prototype.setAll=function(e){return this._x=this._y=this._z=e,this._isDirty=!0,this},e.GetClipFactor=function(t,r,n,i){var o=e.Dot(t,n);return(o-i)/(o-e.Dot(r,n))},e.GetAngleBetweenVectors=function(t,r,n){var i=t.normalizeToRef(m.Vector3[1]),o=r.normalizeToRef(m.Vector3[2]),a=e.Dot(i,o);a=(0,c.Clamp)(a,-1,1);var s=Math.acos(a),l=m.Vector3[3];return e.CrossToRef(i,o,l),e.Dot(l,n)>0?isNaN(s)?0:s:isNaN(s)?-Math.PI:-Math.acos(a)},e.GetAngleBetweenVectorsOnPlane=function(t,r,n){m.Vector3[0].copyFrom(t);var i=m.Vector3[0];m.Vector3[1].copyFrom(r);var o=m.Vector3[1];m.Vector3[2].copyFrom(n);var a=m.Vector3[2],s=m.Vector3[3],l=m.Vector3[4];i.normalize(),o.normalize(),a.normalize(),e.CrossToRef(a,i,s),e.CrossToRef(s,a,l);var u=Math.atan2(e.Dot(o,s),e.Dot(o,l));return(0,c.NormalizeRadians)(u)},e.PitchYawRollToMoveBetweenPointsToRef=function(e,t,r){var n=g.Vector3[0];return t.subtractToRef(e,n),r._y=Math.atan2(n.x,n.z)||0,r._x=Math.atan2(Math.sqrt(Math.pow(n.x,2)+Math.pow(n.z,2)),n.y)||0,r._z=0,r._isDirty=!0,r},e.PitchYawRollToMoveBetweenPoints=function(t,r){var n=e.Zero();return e.PitchYawRollToMoveBetweenPointsToRef(t,r,n)},e.SlerpToRef=function(t,r,n,o){n=(0,c.Clamp)(n,0,1);var a=m.Vector3[0],s=m.Vector3[1];a.copyFrom(t);var l=a.length();a.normalizeFromLength(l),s.copyFrom(r);var u=s.length();s.normalizeFromLength(u);var h,d,f=e.Dot(a,s);if(f<1-i.bH){var p=Math.acos(f),_=1/Math.sin(p);h=Math.sin((1-n)*p)*_,d=Math.sin(n*p)*_}else h=1-n,d=n;return a.scaleInPlace(h),s.scaleInPlace(d),o.copyFrom(a).addInPlace(s),o.scaleInPlace((0,c.Lerp)(l,u,n)),o},e.SmoothToRef=function(t,r,n,i,o){return e.SlerpToRef(t,r,0===i?1:n/i,o),o},e.FromArray=function(t,r){return void 0===r&&(r=0),new e(t[r],t[r+1],t[r+2])},e.FromFloatArray=function(t,r){return e.FromArray(t,r)},e.FromArrayToRef=function(e,t,r){return r._x=e[t],r._y=e[t+1],r._z=e[t+2],r._isDirty=!0,r},e.FromFloatArrayToRef=function(t,r,n){return e.FromArrayToRef(t,r,n)},e.FromFloatsToRef=function(e,t,r,n){return n.copyFromFloats(e,t,r),n},e.Zero=function(){return new e(0,0,0)},e.One=function(){return new e(1,1,1)},e.Up=function(){return new e(0,1,0)},Object.defineProperty(e,\"UpReadOnly\",{get:function(){return e._UpReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"DownReadOnly\",{get:function(){return e._DownReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"RightReadOnly\",{get:function(){return e._RightReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"LeftReadOnly\",{get:function(){return e._LeftReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"LeftHandedForwardReadOnly\",{get:function(){return e._LeftHandedForwardReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"RightHandedForwardReadOnly\",{get:function(){return e._RightHandedForwardReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"LeftHandedBackwardReadOnly\",{get:function(){return e._LeftHandedBackwardReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"RightHandedBackwardReadOnly\",{get:function(){return e._RightHandedBackwardReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"ZeroReadOnly\",{get:function(){return e._ZeroReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"OneReadOnly\",{get:function(){return e._OneReadOnly},enumerable:!1,configurable:!0}),e.Down=function(){return new e(0,-1,0)},e.Forward=function(t){return void 0===t&&(t=!1),new e(0,0,t?-1:1)},e.Backward=function(t){return void 0===t&&(t=!1),new e(0,0,t?1:-1)},e.Right=function(){return new e(1,0,0)},e.Left=function(){return new e(-1,0,0)},e.Random=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),new e((0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r))},e.RandomToRef=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),r.copyFromFloats((0,c.RandomRange)(e,t),(0,c.RandomRange)(e,t),(0,c.RandomRange)(e,t))},e.TransformCoordinates=function(t,r){var n=e.Zero();return e.TransformCoordinatesToRef(t,r,n),n},e.TransformCoordinatesToRef=function(t,r,n){return e.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,r,n),n},e.TransformCoordinatesFromFloatsToRef=function(e,t,r,n,i){var o=n.m,a=e*o[0]+t*o[4]+r*o[8]+o[12],s=e*o[1]+t*o[5]+r*o[9]+o[13],l=e*o[2]+t*o[6]+r*o[10]+o[14],c=1/(e*o[3]+t*o[7]+r*o[11]+o[15]);return i._x=a*c,i._y=s*c,i._z=l*c,i._isDirty=!0,i},e.TransformNormal=function(t,r){var n=e.Zero();return e.TransformNormalToRef(t,r,n),n},e.TransformNormalToRef=function(e,t,r){return this.TransformNormalFromFloatsToRef(e._x,e._y,e._z,t,r),r},e.TransformNormalFromFloatsToRef=function(e,t,r,n,i){var o=n.m;return i._x=e*o[0]+t*o[4]+r*o[8],i._y=e*o[1]+t*o[5]+r*o[9],i._z=e*o[2]+t*o[6]+r*o[10],i._isDirty=!0,i},e.CatmullRom=function(t,r,n,i,o){var a=o*o,s=o*a;return new e(.5*(2*r._x+(-t._x+n._x)*o+(2*t._x-5*r._x+4*n._x-i._x)*a+(-t._x+3*r._x-3*n._x+i._x)*s),.5*(2*r._y+(-t._y+n._y)*o+(2*t._y-5*r._y+4*n._y-i._y)*a+(-t._y+3*r._y-3*n._y+i._y)*s),.5*(2*r._z+(-t._z+n._z)*o+(2*t._z-5*r._z+4*n._z-i._z)*a+(-t._z+3*r._z-3*n._z+i._z)*s))},e.Clamp=function(t,r,n){var i=new e;return e.ClampToRef(t,r,n,i),i},e.ClampToRef=function(e,t,r,n){var i=e._x;i=(i=i>r._x?r._x:i)<t._x?t._x:i;var o=e._y;o=(o=o>r._y?r._y:o)<t._y?t._y:o;var a=e._z;return a=(a=a>r._z?r._z:a)<t._z?t._z:a,n.copyFromFloats(i,o,a),n},e.CheckExtends=function(e,t,r){t.minimizeInPlace(e),r.maximizeInPlace(e)},e.Hermite=function(t,r,n,i,o){var a=o*o,s=o*a,l=2*s-3*a+1,c=-2*s+3*a,u=s-2*a+o,h=s-a;return new e(t._x*l+n._x*c+r._x*u+i._x*h,t._y*l+n._y*c+r._y*u+i._y*h,t._z*l+n._z*c+r._z*u+i._z*h)},e.Hermite1stDerivative=function(t,r,n,i,o){var a=new e;return this.Hermite1stDerivativeToRef(t,r,n,i,o,a),a},e.Hermite1stDerivativeToRef=function(e,t,r,n,i,o){var a=i*i;return o._x=6*(a-i)*e._x+(3*a-4*i+1)*t._x+6*(-a+i)*r._x+(3*a-2*i)*n._x,o._y=6*(a-i)*e._y+(3*a-4*i+1)*t._y+6*(-a+i)*r._y+(3*a-2*i)*n._y,o._z=6*(a-i)*e._z+(3*a-4*i+1)*t._z+6*(-a+i)*r._z+(3*a-2*i)*n._z,o._isDirty=!0,o},e.Lerp=function(t,r,n){var i=new e(0,0,0);return e.LerpToRef(t,r,n,i),i},e.LerpToRef=function(e,t,r,n){return n._x=e._x+(t._x-e._x)*r,n._y=e._y+(t._y-e._y)*r,n._z=e._z+(t._z-e._z)*r,n._isDirty=!0,n},e.Dot=function(e,t){return e._x*t._x+e._y*t._y+e._z*t._z},e.prototype.dot=function(e){return this._x*e._x+this._y*e._y+this._z*e._z},e.Cross=function(t,r){var n=new e;return e.CrossToRef(t,r,n),n},e.CrossToRef=function(e,t,r){var n=e._y*t._z-e._z*t._y,i=e._z*t._x-e._x*t._z,o=e._x*t._y-e._y*t._x;return r.copyFromFloats(n,i,o),r},e.Normalize=function(t){var r=e.Zero();return e.NormalizeToRef(t,r),r},e.NormalizeToRef=function(e,t){return e.normalizeToRef(t),t},e.Project=function(t,r,n,i){var o=new e;return e.ProjectToRef(t,r,n,i,o),o},e.ProjectToRef=function(t,r,n,i,o){var a,s=i.width,c=i.height,u=i.x,h=i.y,d=m.Matrix[1],f=null===(a=l.q.LastCreatedEngine)||void 0===a?void 0:a.isNDCHalfZRange,p=f?1:.5,g=f?0:.5;_.FromValuesToRef(s/2,0,0,0,0,-c/2,0,0,0,0,p,0,u+s/2,c/2+h,g,1,d);var v=m.Matrix[0];return r.multiplyToRef(n,v),v.multiplyToRef(d,v),e.TransformCoordinatesToRef(t,v,o),o},e.Reflect=function(t,r){return this.ReflectToRef(t,r,new e)},e.ReflectToRef=function(t,r,n){var i=g.Vector3[0];return i.copyFrom(r).scaleInPlace(2*e.Dot(t,r)),n.copyFrom(t).subtractInPlace(i)},e._UnprojectFromInvertedMatrixToRef=function(t,r,n){e.TransformCoordinatesToRef(t,r,n);var i=r.m,o=t._x*i[3]+t._y*i[7]+t._z*i[11]+i[15];return(0,c.WithinEpsilon)(o,1)&&n.scaleInPlace(1/o),n},e.UnprojectFromTransform=function(e,t,r,n,i){return this.Unproject(e,t,r,n,i,_.IdentityReadOnly)},e.Unproject=function(t,r,n,i,o,a){var s=new e;return e.UnprojectToRef(t,r,n,i,o,a,s),s},e.UnprojectToRef=function(t,r,n,i,o,a,s){return e.UnprojectFloatsToRef(t._x,t._y,t._z,r,n,i,o,a,s),s},e.UnprojectFloatsToRef=function(t,r,n,i,o,a,s,c,u){var h,d=m.Matrix[0];a.multiplyToRef(s,d),d.multiplyToRef(c,d),d.invert();var f=m.Vector3[0];return f.x=t/i*2-1,f.y=-(r/o*2-1),(null===(h=l.q.LastCreatedEngine)||void 0===h?void 0:h.isNDCHalfZRange)?f.z=n:f.z=2*n-1,e._UnprojectFromInvertedMatrixToRef(f,d,u),u},e.Minimize=function(t,r){var n=new e;return n.copyFrom(t),n.minimizeInPlace(r),n},e.Maximize=function(t,r){var n=new e;return n.copyFrom(t),n.maximizeInPlace(r),n},e.Distance=function(t,r){return Math.sqrt(e.DistanceSquared(t,r))},e.DistanceSquared=function(e,t){var r=e._x-t._x,n=e._y-t._y,i=e._z-t._z;return r*r+n*n+i*i},e.ProjectOnTriangleToRef=function(t,r,n,o,a){var s=m.Vector3[0],l=m.Vector3[1],u=m.Vector3[2],h=m.Vector3[3],d=m.Vector3[4];n.subtractToRef(r,s),o.subtractToRef(r,l),o.subtractToRef(n,u);var f=s.length(),p=l.length(),_=u.length();if(f<i.bH||p<i.bH||_<i.bH)return a.copyFrom(r),e.Distance(t,r);t.subtractToRef(r,d),e.CrossToRef(s,l,h);var g=h.length();if(g<i.bH)return a.copyFrom(r),e.Distance(t,r);h.normalizeFromLength(g);var v=d.length();if(v<i.bH)return a.copyFrom(r),0;d.normalizeFromLength(v);var y=e.Dot(h,d),b=m.Vector3[5],S=m.Vector3[6];b.copyFrom(h).scaleInPlace(-v*y),S.copyFrom(t).addInPlace(b);var T=m.Vector3[4],E=m.Vector3[5],x=m.Vector3[7],P=m.Vector3[8];T.copyFrom(s).scaleInPlace(1/f),P.copyFrom(l).scaleInPlace(1/p),T.addInPlace(P).scaleInPlace(-1),E.copyFrom(s).scaleInPlace(-1/f),P.copyFrom(u).scaleInPlace(1/_),E.addInPlace(P).scaleInPlace(-1),x.copyFrom(u).scaleInPlace(-1/_),P.copyFrom(l).scaleInPlace(-1/p),x.addInPlace(P).scaleInPlace(-1);var C=m.Vector3[9];C.copyFrom(S).subtractInPlace(r),e.CrossToRef(T,C,P);var A=e.Dot(P,h);C.copyFrom(S).subtractInPlace(n),e.CrossToRef(E,C,P);var R=e.Dot(P,h);C.copyFrom(S).subtractInPlace(o),e.CrossToRef(x,C,P);var I,M,O=e.Dot(P,h),D=m.Vector3[10];A>0&&R<0?(D.copyFrom(s),I=r,M=n):R>0&&O<0?(D.copyFrom(u),I=n,M=o):(D.copyFrom(l).scaleInPlace(-1),I=o,M=r);var N=m.Vector3[9],L=m.Vector3[4];if(I.subtractToRef(S,P),M.subtractToRef(S,N),e.CrossToRef(P,N,L),!(e.Dot(L,h)<0))return a.copyFrom(S),Math.abs(v*y);var F=m.Vector3[5];e.CrossToRef(D,L,F),F.normalize();var w=m.Vector3[9];w.copyFrom(I).subtractInPlace(S);var B=w.length();if(B<i.bH)return a.copyFrom(I),e.Distance(t,I);w.normalizeFromLength(B);var V=e.Dot(F,w),U=m.Vector3[7];U.copyFrom(S).addInPlace(F.scaleInPlace(B*V)),P.copyFrom(U).subtractInPlace(I),v=D.length(),D.normalizeFromLength(v);var G=e.Dot(P,D)/Math.max(v,i.bH);return G=(0,c.Clamp)(G,0,1),U.copyFrom(I).addInPlace(D.scaleInPlace(G*v)),a.copyFrom(U),e.Distance(t,U)},e.Center=function(t,r){return e.CenterToRef(t,r,e.Zero())},e.CenterToRef=function(e,t,r){return r.copyFromFloats((e._x+t._x)/2,(e._y+t._y)/2,(e._z+t._z)/2)},e.RotationFromAxis=function(t,r,n){var i=new e;return e.RotationFromAxisToRef(t,r,n,i),i},e.RotationFromAxisToRef=function(e,t,r,n){var i=m.Quaternion[0];return p.RotationQuaternionFromAxisToRef(e,t,r,i),i.toEulerAnglesToRef(n),n},e._UpReadOnly=e.Up(),e._DownReadOnly=e.Down(),e._LeftHandedForwardReadOnly=e.Forward(!1),e._RightHandedForwardReadOnly=e.Forward(!0),e._LeftHandedBackwardReadOnly=e.Backward(!1),e._RightHandedBackwardReadOnly=e.Backward(!0),e._RightReadOnly=e.Right(),e._LeftReadOnly=e.Left(),e._ZeroReadOnly=e.Zero(),e._OneReadOnly=e.One(),e}();Object.defineProperties(d.prototype,{dimension:{value:[3]},rank:{value:1}});var f=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=e,this.y=t,this.z=r,this.w=n}return e.prototype.toString=function(){return\"{X: \".concat(this.x,\" Y: \").concat(this.y,\" Z: \").concat(this.z,\" W: \").concat(this.w,\"}\")},e.prototype.getClassName=function(){return\"Vector4\"},e.prototype.getHashCode=function(){var e=u(this.x);return 397*(e=397*(e=397*e^u(this.y))^u(this.z))^u(this.w)},e.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,this},e.prototype.fromArray=function(t,r){return void 0===r&&(r=0),e.FromArrayToRef(t,r,this),this},e.prototype.addInPlace=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},e.prototype.addInPlaceFromFloats=function(e,t,r,n){return this.x+=e,this.y+=t,this.z+=r,this.w+=n,this},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},e.prototype.addToRef=function(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,t.z=this.z+e.z,t.w=this.w+e.w,t},e.prototype.subtractInPlace=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},e.prototype.subtractToRef=function(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z,t.w=this.w-e.w,t},e.prototype.subtractFromFloats=function(t,r,n,i){return new e(this.x-t,this.y-r,this.z-n,this.w-i)},e.prototype.subtractFromFloatsToRef=function(e,t,r,n,i){return i.x=this.x-e,i.y=this.y-t,i.z=this.z-r,i.w=this.w-n,i},e.prototype.negate=function(){return new e(-this.x,-this.y,-this.z,-this.w)},e.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this},e.prototype.negateToRef=function(e){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=-this.w,e},e.prototype.scaleInPlace=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},e.prototype.scale=function(t){return new e(this.x*t,this.y*t,this.z*t,this.w*t)},e.prototype.scaleToRef=function(e,t){return t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e,t},e.prototype.scaleAndAddToRef=function(e,t){return t.x+=this.x*e,t.y+=this.y*e,t.z+=this.z*e,t.w+=this.w*e,t},e.prototype.equals=function(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},e.prototype.equalsWithEpsilon=function(e,t){return void 0===t&&(t=i.bH),e&&(0,c.WithinEpsilon)(this.x,e.x,t)&&(0,c.WithinEpsilon)(this.y,e.y,t)&&(0,c.WithinEpsilon)(this.z,e.z,t)&&(0,c.WithinEpsilon)(this.w,e.w,t)},e.prototype.equalsToFloats=function(e,t,r,n){return this.x===e&&this.y===t&&this.z===r&&this.w===n},e.prototype.multiplyInPlace=function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},e.prototype.multiply=function(t){return new e(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},e.prototype.multiplyToRef=function(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,t.z=this.z*e.z,t.w=this.w*e.w,t},e.prototype.multiplyByFloats=function(t,r,n,i){return new e(this.x*t,this.y*r,this.z*n,this.w*i)},e.prototype.divide=function(t){return new e(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)},e.prototype.divideToRef=function(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,t.z=this.z/e.z,t.w=this.w/e.w,t},e.prototype.divideInPlace=function(e){return this.divideToRef(e,this)},e.prototype.minimizeInPlace=function(e){return e.x<this.x&&(this.x=e.x),e.y<this.y&&(this.y=e.y),e.z<this.z&&(this.z=e.z),e.w<this.w&&(this.w=e.w),this},e.prototype.maximizeInPlace=function(e){return e.x>this.x&&(this.x=e.x),e.y>this.y&&(this.y=e.y),e.z>this.z&&(this.z=e.z),e.w>this.w&&(this.w=e.w),this},e.prototype.minimizeInPlaceFromFloats=function(e,t,r,n){return this.x=Math.min(e,this.x),this.y=Math.min(t,this.y),this.z=Math.min(r,this.z),this.w=Math.min(n,this.w),this},e.prototype.maximizeInPlaceFromFloats=function(e,t,r,n){return this.x=Math.max(e,this.x),this.y=Math.max(t,this.y),this.z=Math.max(r,this.z),this.w=Math.max(n,this.w),this},e.prototype.floorToRef=function(e){return e.x=Math.floor(this.x),e.y=Math.floor(this.y),e.z=Math.floor(this.z),e.w=Math.floor(this.w),e},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},e.prototype.fractToRef=function(e){return e.x=this.x-Math.floor(this.x),e.y=this.y-Math.floor(this.y),e.z=this.z-Math.floor(this.z),e.w=this.w-Math.floor(this.w),e},e.prototype.fract=function(){return new e(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},e.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},e.prototype.normalize=function(){return this.normalizeFromLength(this.length())},e.prototype.normalizeFromLength=function(e){return 0===e||1===e?this:this.scaleInPlace(1/e)},e.prototype.normalizeToNew=function(){return this.normalizeToRef(new e)},e.prototype.normalizeToRef=function(e){var t=this.length();return 0===t||1===t?(e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e):this.scaleToRef(1/t,e)},e.prototype.toVector3=function(){return new d(this.x,this.y,this.z)},e.prototype.clone=function(){return new e(this.x,this.y,this.z,this.w)},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},e.prototype.copyFromFloats=function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},e.prototype.set=function(e,t,r,n){return this.copyFromFloats(e,t,r,n)},e.prototype.setAll=function(e){return this.x=this.y=this.z=this.w=e,this},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},e.FromArray=function(t,r){return r||(r=0),new e(t[r],t[r+1],t[r+2],t[r+3])},e.FromArrayToRef=function(e,t,r){return r.x=e[t],r.y=e[t+1],r.z=e[t+2],r.w=e[t+3],r},e.FromFloatArrayToRef=function(t,r,n){return e.FromArrayToRef(t,r,n),n},e.FromFloatsToRef=function(e,t,r,n,i){return i.x=e,i.y=t,i.z=r,i.w=n,i},e.Zero=function(){return new e(0,0,0,0)},e.One=function(){return new e(1,1,1,1)},e.Random=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),new e((0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r))},e.RandomToRef=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),r.x=(0,c.RandomRange)(e,t),r.y=(0,c.RandomRange)(e,t),r.z=(0,c.RandomRange)(e,t),r.w=(0,c.RandomRange)(e,t),r},e.Clamp=function(t,r,n){return e.ClampToRef(t,r,n,new e)},e.ClampToRef=function(e,t,r,n){return n.x=(0,c.Clamp)(e.x,t.x,r.x),n.y=(0,c.Clamp)(e.y,t.y,r.y),n.z=(0,c.Clamp)(e.z,t.z,r.z),n.w=(0,c.Clamp)(e.w,t.w,r.w),n},e.CheckExtends=function(e,t,r){t.minimizeInPlace(e),r.maximizeInPlace(e)},Object.defineProperty(e,\"ZeroReadOnly\",{get:function(){return e._ZeroReadOnly},enumerable:!1,configurable:!0}),e.Normalize=function(t){return e.NormalizeToRef(t,new e)},e.NormalizeToRef=function(e,t){return e.normalizeToRef(t),t},e.Minimize=function(t,r){var n=new e;return n.copyFrom(t),n.minimizeInPlace(r),n},e.Maximize=function(t,r){var n=new e;return n.copyFrom(t),n.maximizeInPlace(r),n},e.Distance=function(t,r){return Math.sqrt(e.DistanceSquared(t,r))},e.DistanceSquared=function(e,t){var r=e.x-t.x,n=e.y-t.y,i=e.z-t.z,o=e.w-t.w;return r*r+n*n+i*i+o*o},e.Center=function(t,r){return e.CenterToRef(t,r,new e)},e.CenterToRef=function(e,t,r){return r.x=(e.x+t.x)/2,r.y=(e.y+t.y)/2,r.z=(e.z+t.z)/2,r.w=(e.w+t.w)/2,r},e.TransformCoordinates=function(t,r){return e.TransformCoordinatesToRef(t,r,new e)},e.TransformCoordinatesToRef=function(t,r,n){return e.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,r,n),n},e.TransformCoordinatesFromFloatsToRef=function(e,t,r,n,i){var o=n.m,a=e*o[0]+t*o[4]+r*o[8]+o[12],s=e*o[1]+t*o[5]+r*o[9]+o[13],l=e*o[2]+t*o[6]+r*o[10]+o[14],c=e*o[3]+t*o[7]+r*o[11]+o[15];return i.x=a,i.y=s,i.z=l,i.w=c,i},e.TransformNormal=function(t,r){return e.TransformNormalToRef(t,r,new e)},e.TransformNormalToRef=function(e,t,r){var n=t.m,i=e.x*n[0]+e.y*n[4]+e.z*n[8],o=e.x*n[1]+e.y*n[5]+e.z*n[9],a=e.x*n[2]+e.y*n[6]+e.z*n[10];return r.x=i,r.y=o,r.z=a,r.w=e.w,r},e.TransformNormalFromFloatsToRef=function(e,t,r,n,i,o){var a=i.m;return o.x=e*a[0]+t*a[4]+r*a[8],o.y=e*a[1]+t*a[5]+r*a[9],o.z=e*a[2]+t*a[6]+r*a[10],o.w=n,o},e.FromVector3=function(t,r){return void 0===r&&(r=0),new e(t._x,t._y,t._z,r)},e.Dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},e._ZeroReadOnly=e.Zero(),e}();Object.defineProperties(f.prototype,{dimension:{value:[4]},rank:{value:1}});var p=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=1),this._isDirty=!0,this._x=e,this._y=t,this._z=r,this._w=n}return Object.defineProperty(e.prototype,\"x\",{get:function(){return this._x},set:function(e){this._x=e,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"y\",{get:function(){return this._y},set:function(e){this._y=e,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"z\",{get:function(){return this._z},set:function(e){this._z=e,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"w\",{get:function(){return this._w},set:function(e){this._w=e,this._isDirty=!0},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return\"{X: \".concat(this._x,\" Y: \").concat(this._y,\" Z: \").concat(this._z,\" W: \").concat(this._w,\"}\")},e.prototype.getClassName=function(){return\"Quaternion\"},e.prototype.getHashCode=function(){var e=u(this._x);return 397*(e=397*(e=397*e^u(this._y))^u(this._z))^u(this._w)},e.prototype.asArray=function(){return[this._x,this._y,this._z,this._w]},e.prototype.toArray=function(e,t){return void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,this},e.prototype.fromArray=function(t,r){return void 0===r&&(r=0),e.FromArrayToRef(t,r,this)},e.prototype.equals=function(e){return e&&this._x===e._x&&this._y===e._y&&this._z===e._z&&this._w===e._w},e.prototype.equalsWithEpsilon=function(e,t){return void 0===t&&(t=i.bH),e&&(0,c.WithinEpsilon)(this._x,e._x,t)&&(0,c.WithinEpsilon)(this._y,e._y,t)&&(0,c.WithinEpsilon)(this._z,e._z,t)&&(0,c.WithinEpsilon)(this._w,e._w,t)},e.prototype.clone=function(){return new e(this._x,this._y,this._z,this._w)},e.prototype.copyFrom=function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._w=e._w,this._isDirty=!0,this},e.prototype.copyFromFloats=function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._isDirty=!0,this},e.prototype.set=function(e,t,r,n){return this.copyFromFloats(e,t,r,n)},e.prototype.setAll=function(e){return this.copyFromFloats(e,e,e,e)},e.prototype.add=function(t){return new e(this._x+t._x,this._y+t._y,this._z+t._z,this._w+t._w)},e.prototype.addInPlace=function(e){return this._x+=e._x,this._y+=e._y,this._z+=e._z,this._w+=e._w,this._isDirty=!0,this},e.prototype.addToRef=function(e,t){return t._x=this._x+e._x,t._y=this._y+e._y,t._z=this._z+e._z,t._w=this._w+e._w,t._isDirty=!0,t},e.prototype.addInPlaceFromFloats=function(e,t,r,n){return this._x+=e,this._y+=t,this._z+=r,this._w+=n,this._isDirty=!0,this},e.prototype.subtractToRef=function(e,t){return t._x=this._x-e._x,t._y=this._y-e._y,t._z=this._z-e._z,t._w=this._w-e._w,t._isDirty=!0,t},e.prototype.subtractFromFloats=function(t,r,n,i){return this.subtractFromFloatsToRef(t,r,n,i,new e)},e.prototype.subtractFromFloatsToRef=function(e,t,r,n,i){return i._x=this._x-e,i._y=this._y-t,i._z=this._z-r,i._w=this._w-n,i._isDirty=!0,i},e.prototype.subtract=function(t){return new e(this._x-t._x,this._y-t._y,this._z-t._z,this._w-t._w)},e.prototype.subtractInPlace=function(e){return this._x-=e._x,this._y-=e._y,this._z-=e._z,this._w-=e._w,this._isDirty=!0,this},e.prototype.scale=function(t){return new e(this._x*t,this._y*t,this._z*t,this._w*t)},e.prototype.scaleToRef=function(e,t){return t._x=this._x*e,t._y=this._y*e,t._z=this._z*e,t._w=this._w*e,t._isDirty=!0,t},e.prototype.scaleInPlace=function(e){return this._x*=e,this._y*=e,this._z*=e,this._w*=e,this._isDirty=!0,this},e.prototype.scaleAndAddToRef=function(e,t){return t._x+=this._x*e,t._y+=this._y*e,t._z+=this._z*e,t._w+=this._w*e,t._isDirty=!0,t},e.prototype.multiply=function(t){var r=new e(0,0,0,1);return this.multiplyToRef(t,r),r},e.prototype.multiplyToRef=function(e,t){var r=this._x*e._w+this._y*e._z-this._z*e._y+this._w*e._x,n=-this._x*e._z+this._y*e._w+this._z*e._x+this._w*e._y,i=this._x*e._y-this._y*e._x+this._z*e._w+this._w*e._z,o=-this._x*e._x-this._y*e._y-this._z*e._z+this._w*e._w;return t.copyFromFloats(r,n,i,o),t},e.prototype.multiplyInPlace=function(e){return this.multiplyToRef(e,this)},e.prototype.multiplyByFloats=function(e,t,r,n){return this._x*=e,this._y*=t,this._z*=r,this._w*=n,this._isDirty=!0,this},e.prototype.divide=function(e){throw new ReferenceError(\"Can not divide a quaternion\")},e.prototype.divideToRef=function(e,t){throw new ReferenceError(\"Can not divide a quaternion\")},e.prototype.divideInPlace=function(e){throw new ReferenceError(\"Can not divide a quaternion\")},e.prototype.minimizeInPlace=function(){throw new ReferenceError(\"Can not minimize a quaternion\")},e.prototype.minimizeInPlaceFromFloats=function(){throw new ReferenceError(\"Can not minimize a quaternion\")},e.prototype.maximizeInPlace=function(){throw new ReferenceError(\"Can not maximize a quaternion\")},e.prototype.maximizeInPlaceFromFloats=function(){throw new ReferenceError(\"Can not maximize a quaternion\")},e.prototype.negate=function(){return this.negateToRef(new e)},e.prototype.negateInPlace=function(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this._isDirty=!0,this},e.prototype.negateToRef=function(e){return e._x=-this._x,e._y=-this._y,e._z=-this._z,e._w=-this._w,e._isDirty=!0,e},e.prototype.equalsToFloats=function(e,t,r,n){return this._x===e&&this._y===t&&this._z===r&&this._w===n},e.prototype.floorToRef=function(e){throw new ReferenceError(\"Can not floor a quaternion\")},e.prototype.floor=function(){throw new ReferenceError(\"Can not floor a quaternion\")},e.prototype.fractToRef=function(e){throw new ReferenceError(\"Can not fract a quaternion\")},e.prototype.fract=function(){throw new ReferenceError(\"Can not fract a quaternion\")},e.prototype.conjugateToRef=function(e){return e.copyFromFloats(-this._x,-this._y,-this._z,this._w),e},e.prototype.conjugateInPlace=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this},e.prototype.conjugate=function(){return new e(-this._x,-this._y,-this._z,this._w)},e.prototype.invert=function(){var e=this.conjugate(),t=this.lengthSquared();return 0==t||1==t||e.scaleInPlace(1/t),e},e.prototype.invertInPlace=function(){this.conjugateInPlace();var e=this.lengthSquared();return 0==e||1==e||this.scaleInPlace(1/e),this},e.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},e.prototype.length=function(){return Math.sqrt(this.lengthSquared())},e.prototype.normalize=function(){return this.normalizeFromLength(this.length())},e.prototype.normalizeFromLength=function(e){return 0===e||1===e?this:this.scaleInPlace(1/e)},e.prototype.normalizeToNew=function(){var t=new e(0,0,0,1);return this.normalizeToRef(t),t},e.prototype.normalizeToRef=function(e){var t=this.length();return 0===t||1===t?e.copyFromFloats(this._x,this._y,this._z,this._w):this.scaleToRef(1/t,e)},e.prototype.toEulerAngles=function(){var e=d.Zero();return this.toEulerAnglesToRef(e),e},e.prototype.toEulerAnglesToRef=function(e){var t=this._z,r=this._x,n=this._y,i=this._w,o=n*t-r*i,a=.4999999;if(o<-a)e._y=2*Math.atan2(n,i),e._x=Math.PI/2,e._z=0,e._isDirty=!0;else if(o>a)e._y=2*Math.atan2(n,i),e._x=-Math.PI/2,e._z=0,e._isDirty=!0;else{var s=i*i,l=t*t,c=r*r,u=n*n;e._z=Math.atan2(2*(r*n+t*i),-l-c+u+s),e._x=Math.asin(-2*o),e._y=Math.atan2(2*(t*r+n*i),l-c-u+s),e._isDirty=!0}return e},e.prototype.toAlphaBetaGammaToRef=function(e){var t=this._z,r=this._x,n=this._y,i=this._w,o=Math.sqrt(r*r+n*n),a=Math.sqrt(t*t+i*i),s=2*Math.atan2(o,a),l=2*Math.atan2(t,i),c=2*Math.atan2(n,r),u=(l+c)/2,h=(l-c)/2;return e.set(h,s,u),e},e.prototype.toRotationMatrix=function(e){return _.FromQuaternionToRef(this,e),e},e.prototype.fromRotationMatrix=function(t){return e.FromRotationMatrixToRef(t,this),this},e.prototype.dot=function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},e.FromRotationMatrix=function(t){var r=new e;return e.FromRotationMatrixToRef(t,r),r},e.FromRotationMatrixToRef=function(e,t){var r,n=e.m,i=n[0],o=n[4],a=n[8],s=n[1],l=n[5],c=n[9],u=n[2],h=n[6],d=n[10],f=i+l+d;return f>0?(r=.5/Math.sqrt(f+1),t._w=.25/r,t._x=(h-c)*r,t._y=(a-u)*r,t._z=(s-o)*r,t._isDirty=!0):i>l&&i>d?(r=2*Math.sqrt(1+i-l-d),t._w=(h-c)/r,t._x=.25*r,t._y=(o+s)/r,t._z=(a+u)/r,t._isDirty=!0):l>d?(r=2*Math.sqrt(1+l-i-d),t._w=(a-u)/r,t._x=(o+s)/r,t._y=.25*r,t._z=(c+h)/r,t._isDirty=!0):(r=2*Math.sqrt(1+d-i-l),t._w=(s-o)/r,t._x=(a+u)/r,t._y=(c+h)/r,t._z=.25*r,t._isDirty=!0),t},e.Dot=function(e,t){return e._x*t._x+e._y*t._y+e._z*t._z+e._w*t._w},e.AreClose=function(t,r,n){void 0===n&&(n=.1);var i=e.Dot(t,r);return 1-i*i<=n},e.SmoothToRef=function(t,r,n,i,o){var a=0===i?1:n/i;return a=(0,c.Clamp)(a,0,1),e.SlerpToRef(t,r,a,o),o},e.Zero=function(){return new e(0,0,0,0)},e.Inverse=function(t){return new e(-t._x,-t._y,-t._z,t._w)},e.InverseToRef=function(e,t){return t.set(-e._x,-e._y,-e._z,e._w),t},e.Identity=function(){return new e(0,0,0,1)},e.IsIdentity=function(e){return e&&0===e._x&&0===e._y&&0===e._z&&1===e._w},e.RotationAxis=function(t,r){return e.RotationAxisToRef(t,r,new e)},e.RotationAxisToRef=function(e,t,r){r._w=Math.cos(t/2);var n=Math.sin(t/2)/e.length();return r._x=e._x*n,r._y=e._y*n,r._z=e._z*n,r._isDirty=!0,r},e.FromArray=function(t,r){return r||(r=0),new e(t[r],t[r+1],t[r+2],t[r+3])},e.FromArrayToRef=function(e,t,r){return r._x=e[t],r._y=e[t+1],r._z=e[t+2],r._w=e[t+3],r._isDirty=!0,r},e.FromFloatsToRef=function(e,t,r,n,i){return i.copyFromFloats(e,t,r,n),i},e.FromEulerAngles=function(t,r,n){var i=new e;return e.RotationYawPitchRollToRef(r,t,n,i),i},e.FromEulerAnglesToRef=function(t,r,n,i){return e.RotationYawPitchRollToRef(r,t,n,i),i},e.FromEulerVector=function(t){var r=new e;return e.RotationYawPitchRollToRef(t._y,t._x,t._z,r),r},e.FromEulerVectorToRef=function(t,r){return e.RotationYawPitchRollToRef(t._y,t._x,t._z,r),r},e.FromUnitVectorsToRef=function(e,t,r,n){void 0===n&&(n=i.bH);var o=d.Dot(e,t)+1;return o<n?Math.abs(e.x)>Math.abs(e.z)?r.set(-e.y,e.x,0,0):r.set(0,-e.z,e.y,0):(d.CrossToRef(e,t,g.Vector3[0]),r.set(g.Vector3[0].x,g.Vector3[0].y,g.Vector3[0].z,o)),r.normalize()},e.RotationYawPitchRoll=function(t,r,n){var i=new e;return e.RotationYawPitchRollToRef(t,r,n,i),i},e.RotationYawPitchRollToRef=function(e,t,r,n){var i=.5*r,o=.5*t,a=.5*e,s=Math.sin(i),l=Math.cos(i),c=Math.sin(o),u=Math.cos(o),h=Math.sin(a),d=Math.cos(a);return n._x=d*c*l+h*u*s,n._y=h*u*l-d*c*s,n._z=d*u*s-h*c*l,n._w=d*u*l+h*c*s,n._isDirty=!0,n},e.RotationAlphaBetaGamma=function(t,r,n){var i=new e;return e.RotationAlphaBetaGammaToRef(t,r,n,i),i},e.RotationAlphaBetaGammaToRef=function(e,t,r,n){var i=.5*(r+e),o=.5*(r-e),a=.5*t;return n._x=Math.cos(o)*Math.sin(a),n._y=Math.sin(o)*Math.sin(a),n._z=Math.sin(i)*Math.cos(a),n._w=Math.cos(i)*Math.cos(a),n._isDirty=!0,n},e.RotationQuaternionFromAxis=function(t,r,n){var i=new e(0,0,0,0);return e.RotationQuaternionFromAxisToRef(t,r,n,i),i},e.RotationQuaternionFromAxisToRef=function(t,r,n,i){var o=m.Matrix[0];return t=t.normalizeToRef(m.Vector3[0]),r=r.normalizeToRef(m.Vector3[1]),n=n.normalizeToRef(m.Vector3[2]),_.FromXYZAxesToRef(t,r,n,o),e.FromRotationMatrixToRef(o,i),i},e.FromLookDirectionLH=function(t,r){var n=new e;return e.FromLookDirectionLHToRef(t,r,n),n},e.FromLookDirectionLHToRef=function(t,r,n){var i=m.Matrix[0];return _.LookDirectionLHToRef(t,r,i),e.FromRotationMatrixToRef(i,n),n},e.FromLookDirectionRH=function(t,r){var n=new e;return e.FromLookDirectionRHToRef(t,r,n),n},e.FromLookDirectionRHToRef=function(t,r,n){var i=m.Matrix[0];return _.LookDirectionRHToRef(t,r,i),e.FromRotationMatrixToRef(i,n)},e.Slerp=function(t,r,n){var i=e.Identity();return e.SlerpToRef(t,r,n,i),i},e.SlerpToRef=function(e,t,r,n){var i,o,a=e._x*t._x+e._y*t._y+e._z*t._z+e._w*t._w,s=!1;if(a<0&&(s=!0,a=-a),a>.999999)o=1-r,i=s?-r:r;else{var l=Math.acos(a),c=1/Math.sin(l);o=Math.sin((1-r)*l)*c,i=s?-Math.sin(r*l)*c:Math.sin(r*l)*c}return n._x=o*e._x+i*t._x,n._y=o*e._y+i*t._y,n._z=o*e._z+i*t._z,n._w=o*e._w+i*t._w,n._isDirty=!0,n},e.Hermite=function(t,r,n,i,o){var a=o*o,s=o*a,l=2*s-3*a+1,c=-2*s+3*a,u=s-2*a+o,h=s-a;return new e(t._x*l+n._x*c+r._x*u+i._x*h,t._y*l+n._y*c+r._y*u+i._y*h,t._z*l+n._z*c+r._z*u+i._z*h,t._w*l+n._w*c+r._w*u+i._w*h)},e.Hermite1stDerivative=function(t,r,n,i,o){var a=new e;return this.Hermite1stDerivativeToRef(t,r,n,i,o,a),a},e.Hermite1stDerivativeToRef=function(e,t,r,n,i,o){var a=i*i;return o._x=6*(a-i)*e._x+(3*a-4*i+1)*t._x+6*(-a+i)*r._x+(3*a-2*i)*n._x,o._y=6*(a-i)*e._y+(3*a-4*i+1)*t._y+6*(-a+i)*r._y+(3*a-2*i)*n._y,o._z=6*(a-i)*e._z+(3*a-4*i+1)*t._z+6*(-a+i)*r._z+(3*a-2*i)*n._z,o._w=6*(a-i)*e._w+(3*a-4*i+1)*t._w+6*(-a+i)*r._w+(3*a-2*i)*n._w,o._isDirty=!0,o},e.Normalize=function(t){var r=e.Zero();return e.NormalizeToRef(t,r),r},e.NormalizeToRef=function(e,t){return e.normalizeToRef(t),t},e.Clamp=function(t,r,n){var i=new e;return e.ClampToRef(t,r,n,i),i},e.ClampToRef=function(e,t,r,n){return n.copyFromFloats((0,c.Clamp)(e.x,t.x,r.x),(0,c.Clamp)(e.y,t.y,r.y),(0,c.Clamp)(e.z,t.z,r.z),(0,c.Clamp)(e.w,t.w,r.w))},e.Random=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),new e((0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r),(0,c.RandomRange)(t,r))},e.RandomToRef=function(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=1),r.copyFromFloats((0,c.RandomRange)(e,t),(0,c.RandomRange)(e,t),(0,c.RandomRange)(e,t),(0,c.RandomRange)(e,t))},e.Minimize=function(){throw new ReferenceError(\"Quaternion.Minimize does not make sense\")},e.Maximize=function(){throw new ReferenceError(\"Quaternion.Maximize does not make sense\")},e.Distance=function(t,r){return Math.sqrt(e.DistanceSquared(t,r))},e.DistanceSquared=function(e,t){var r=e.x-t.x,n=e.y-t.y,i=e.z-t.z,o=e.w-t.w;return r*r+n*n+i*i+o*o},e.Center=function(t,r){return e.CenterToRef(t,r,e.Zero())},e.CenterToRef=function(e,t,r){return r.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2,(e.z+t.z)/2,(e.w+t.w)/2)},e}();Object.defineProperties(p.prototype,{dimension:{value:[4]},rank:{value:1}});var _=function(){function e(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,s.I.MatrixTrackPrecisionChange&&s.I.MatrixTrackedMatrices.push(this),this._m=new s.I.MatrixCurrentType(16),this.markAsUpdated()}return Object.defineProperty(e,\"Use64Bits\",{get:function(){return s.I.MatrixUse64Bits},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"m\",{get:function(){return this._m},enumerable:!1,configurable:!0}),e.prototype.markAsUpdated=function(){this.updateFlag=e._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},e.prototype._updateIdentityStatus=function(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!0),this._isIdentity=e,this._isIdentity3x2=e||r,this._isIdentityDirty=!this._isIdentity&&t,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n},e.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var e=this._m;this._isIdentity=1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]}return this._isIdentity},e.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},e.prototype.determinant=function(){if(!0===this._isIdentity)return 1;var e=this._m,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],_=e[14],m=e[15],g=h*m-_*d,v=u*m-p*d,y=u*_-p*h,b=c*m-f*d,S=c*_-h*f,T=c*p-f*u;return t*+(a*g-s*v+l*y)+r*-(o*g-s*b+l*S)+n*+(o*v-a*b+l*T)+i*-(o*y-a*S+s*T)},e.prototype.toString=function(){return\"{\".concat(this.m[0],\", \").concat(this.m[1],\", \").concat(this.m[2],\", \").concat(this.m[3],\"\\n\").concat(this.m[4],\", \").concat(this.m[5],\", \").concat(this.m[6],\", \").concat(this.m[7],\"\\n\").concat(this.m[8],\", \").concat(this.m[9],\", \").concat(this.m[10],\", \").concat(this.m[11],\"\\n\").concat(this.m[12],\", \").concat(this.m[13],\", \").concat(this.m[14],\", \").concat(this.m[15],\"}\")},e.prototype.toArray=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=0),!e)return this._m;for(var r=this._m,n=0;n<16;n++)e[t+n]=r[n];return this},e.prototype.asArray=function(){return this._m},e.prototype.fromArray=function(t,r){return void 0===r&&(r=0),e.FromArrayToRef(t,r,this)},e.prototype.copyFromFloats=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.FromArrayToRef(t,0,this)},e.prototype.set=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._m,n=0;n<16;n++)r[n]=e[n];return this.markAsUpdated(),this},e.prototype.setAll=function(e){for(var t=this._m,r=0;r<16;r++)t[r]=e;return this.markAsUpdated(),this},e.prototype.invert=function(){return this.invertToRef(this),this},e.prototype.reset=function(){return e.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},e.prototype.add=function(t){var r=new e;return this.addToRef(t,r),r},e.prototype.addToRef=function(e,t){for(var r=this._m,n=t._m,i=e.m,o=0;o<16;o++)n[o]=r[o]+i[o];return t.markAsUpdated(),t},e.prototype.addToSelf=function(e){var t=this._m,r=e.m;return t[0]+=r[0],t[1]+=r[1],t[2]+=r[2],t[3]+=r[3],t[4]+=r[4],t[5]+=r[5],t[6]+=r[6],t[7]+=r[7],t[8]+=r[8],t[9]+=r[9],t[10]+=r[10],t[11]+=r[11],t[12]+=r[12],t[13]+=r[13],t[14]+=r[14],t[15]+=r[15],this.markAsUpdated(),this},e.prototype.addInPlace=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]+=r[n];return this.markAsUpdated(),this},e.prototype.addInPlaceFromFloats=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._m,n=0;n<16;n++)r[n]+=e[n];return this.markAsUpdated(),this},e.prototype.subtract=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]-=r[n];return this.markAsUpdated(),this},e.prototype.subtractToRef=function(e,t){for(var r=this._m,n=e.m,i=t._m,o=0;o<16;o++)i[o]=r[o]-n[o];return t.markAsUpdated(),t},e.prototype.subtractInPlace=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]-=r[n];return this.markAsUpdated(),this},e.prototype.subtractFromFloats=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.subtractFromFloatsToRef.apply(this,(0,n.fX)((0,n.fX)([],t,!1),[new e],!1))},e.prototype.subtractFromFloatsToRef=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.pop(),n=this._m,i=r._m,o=e,a=0;a<16;a++)i[a]=n[a]-o[a];return r.markAsUpdated(),r},e.prototype.invertToRef=function(t){if(!0===this._isIdentity)return e.IdentityToRef(t),t;var r=this._m,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],f=r[10],p=r[11],_=r[12],m=r[13],g=r[14],v=r[15],y=f*v-g*p,b=d*v-m*p,S=d*g-m*f,T=h*v-_*p,E=h*g-f*_,x=h*m-_*d,P=+(l*y-c*b+u*S),C=-(s*y-c*T+u*E),A=+(s*b-l*T+u*x),R=-(s*S-l*E+c*x),I=n*P+i*C+o*A+a*R;if(0===I)return t.copyFrom(this),t;var M=1/I,O=c*v-g*u,D=l*v-m*u,N=l*g-m*c,L=s*v-_*u,F=s*g-_*c,w=s*m-_*l,B=c*p-f*u,V=l*p-d*u,U=l*f-d*c,G=s*p-h*u,k=s*f-h*c,z=s*d-h*l,W=-(i*y-o*b+a*S),Y=+(n*y-o*T+a*E),H=-(n*b-i*T+a*x),X=+(n*S-i*E+o*x),j=+(i*O-o*D+a*N),q=-(n*O-o*L+a*F),K=+(n*D-i*L+a*w),Q=-(n*N-i*F+o*w),Z=-(i*B-o*V+a*U),J=+(n*B-o*G+a*k),$=-(n*V-i*G+a*z),ee=+(n*U-i*k+o*z);return e.FromValuesToRef(P*M,W*M,j*M,Z*M,C*M,Y*M,q*M,J*M,A*M,H*M,K*M,$*M,R*M,X*M,Q*M,ee*M,t),t},e.prototype.addAtIndex=function(e,t){return this._m[e]+=t,this.markAsUpdated(),this},e.prototype.multiplyAtIndex=function(e,t){return this._m[e]*=t,this.markAsUpdated(),this},e.prototype.setTranslationFromFloats=function(e,t,r){return this._m[12]=e,this._m[13]=t,this._m[14]=r,this.markAsUpdated(),this},e.prototype.addTranslationFromFloats=function(e,t,r){return this._m[12]+=e,this._m[13]+=t,this._m[14]+=r,this.markAsUpdated(),this},e.prototype.setTranslation=function(e){return this.setTranslationFromFloats(e._x,e._y,e._z)},e.prototype.getTranslation=function(){return new d(this._m[12],this._m[13],this._m[14])},e.prototype.getTranslationToRef=function(e){return e.x=this._m[12],e.y=this._m[13],e.z=this._m[14],e},e.prototype.removeRotationAndScaling=function(){var t=this.m;return e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),this},e.prototype.copyFrom=function(e){e.copyToArray(this._m);var t=e;return this.updateFlag=t.updateFlag,this._updateIdentityStatus(t._isIdentity,t._isIdentityDirty,t._isIdentity3x2,t._isIdentity3x2Dirty),this},e.prototype.copyToArray=function(e,t){void 0===t&&(t=0);var r=this._m;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],this},e.prototype.multiply=function(t){var r=new e;return this.multiplyToRef(t,r),r},e.prototype.multiplyInPlace=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]*=r[n];return this.markAsUpdated(),this},e.prototype.multiplyByFloats=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._m,n=0;n<16;n++)r[n]*=e[n];return this.markAsUpdated(),this},e.prototype.multiplyByFloatsToRef=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.pop(),n=this._m,i=r._m,o=e,a=0;a<16;a++)i[a]=n[a]*o[a];return r.markAsUpdated(),r},e.prototype.multiplyToRef=function(e,t){return this._isIdentity?(t.copyFrom(e),t):e._isIdentity?(t.copyFrom(this),t):(this.multiplyToArray(e,t._m,0),t.markAsUpdated(),t)},e.prototype.multiplyToArray=function(e,t,r){var n=this._m,i=e.m,o=n[0],a=n[1],s=n[2],l=n[3],c=n[4],u=n[5],h=n[6],d=n[7],f=n[8],p=n[9],_=n[10],m=n[11],g=n[12],v=n[13],y=n[14],b=n[15],S=i[0],T=i[1],E=i[2],x=i[3],P=i[4],C=i[5],A=i[6],R=i[7],I=i[8],M=i[9],O=i[10],D=i[11],N=i[12],L=i[13],F=i[14],w=i[15];return t[r]=o*S+a*P+s*I+l*N,t[r+1]=o*T+a*C+s*M+l*L,t[r+2]=o*E+a*A+s*O+l*F,t[r+3]=o*x+a*R+s*D+l*w,t[r+4]=c*S+u*P+h*I+d*N,t[r+5]=c*T+u*C+h*M+d*L,t[r+6]=c*E+u*A+h*O+d*F,t[r+7]=c*x+u*R+h*D+d*w,t[r+8]=f*S+p*P+_*I+m*N,t[r+9]=f*T+p*C+_*M+m*L,t[r+10]=f*E+p*A+_*O+m*F,t[r+11]=f*x+p*R+_*D+m*w,t[r+12]=g*S+v*P+y*I+b*N,t[r+13]=g*T+v*C+y*M+b*L,t[r+14]=g*E+v*A+y*O+b*F,t[r+15]=g*x+v*R+y*D+b*w,this},e.prototype.divide=function(t){return this.divideToRef(t,new e)},e.prototype.divideToRef=function(e,t){for(var r=this._m,n=e.m,i=t._m,o=0;o<16;o++)i[o]=r[o]/n[o];return t.markAsUpdated(),t},e.prototype.divideInPlace=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]/=r[n];return this.markAsUpdated(),this},e.prototype.minimizeInPlace=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]=Math.min(t[n],r[n]);return this.markAsUpdated(),this},e.prototype.minimizeInPlaceFromFloats=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._m,n=0;n<16;n++)r[n]=Math.min(r[n],e[n]);return this.markAsUpdated(),this},e.prototype.maximizeInPlace=function(e){for(var t=this._m,r=e.m,n=0;n<16;n++)t[n]=Math.min(t[n],r[n]);return this.markAsUpdated(),this},e.prototype.maximizeInPlaceFromFloats=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._m,n=0;n<16;n++)r[n]=Math.min(r[n],e[n]);return this.markAsUpdated(),this},e.prototype.negate=function(){return this.negateToRef(new e)},e.prototype.negateInPlace=function(){for(var e=this._m,t=0;t<16;t++)e[t]=-e[t];return this.markAsUpdated(),this},e.prototype.negateToRef=function(e){for(var t=this._m,r=e._m,n=0;n<16;n++)r[n]=-t[n];return e.markAsUpdated(),e},e.prototype.equals=function(e){var t=e;if(!t)return!1;if((this._isIdentity||t._isIdentity)&&!this._isIdentityDirty&&!t._isIdentityDirty)return this._isIdentity&&t._isIdentity;var r=this.m,n=t.m;return r[0]===n[0]&&r[1]===n[1]&&r[2]===n[2]&&r[3]===n[3]&&r[4]===n[4]&&r[5]===n[5]&&r[6]===n[6]&&r[7]===n[7]&&r[8]===n[8]&&r[9]===n[9]&&r[10]===n[10]&&r[11]===n[11]&&r[12]===n[12]&&r[13]===n[13]&&r[14]===n[14]&&r[15]===n[15]},e.prototype.equalsWithEpsilon=function(e,t){void 0===t&&(t=0);for(var r=this._m,n=e.m,i=0;i<16;i++)if(!(0,c.WithinEpsilon)(r[i],n[i],t))return!1;return!0},e.prototype.equalsToFloats=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this._m,n=0;n<16;n++)if(r[n]!=e[n])return!1;return!0},e.prototype.floor=function(){return this.floorToRef(new e)},e.prototype.floorToRef=function(e){for(var t=this._m,r=e._m,n=0;n<16;n++)r[n]=Math.floor(t[n]);return e.markAsUpdated(),e},e.prototype.fract=function(){return this.fractToRef(new e)},e.prototype.fractToRef=function(e){for(var t=this._m,r=e._m,n=0;n<16;n++)r[n]=t[n]-Math.floor(t[n]);return e.markAsUpdated(),e},e.prototype.clone=function(){var t=new e;return t.copyFrom(this),t},e.prototype.getClassName=function(){return\"Matrix\"},e.prototype.getHashCode=function(){for(var e=u(this._m[0]),t=1;t<16;t++)e=397*e^u(this._m[t]);return e},e.prototype.decomposeToTransformNode=function(e){return e.rotationQuaternion=e.rotationQuaternion||new p,this.decompose(e.scaling,e.rotationQuaternion,e.position)},e.prototype.decompose=function(t,r,n,i,o){if(void 0===o&&(o=!0),this._isIdentity)return n&&n.setAll(0),t&&t.setAll(1),r&&r.copyFromFloats(0,0,0,1),!0;var a=this._m;if(n&&n.copyFromFloats(a[12],a[13],a[14]),(t=t||m.Vector3[0]).x=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),t.y=Math.sqrt(a[4]*a[4]+a[5]*a[5]+a[6]*a[6]),t.z=Math.sqrt(a[8]*a[8]+a[9]*a[9]+a[10]*a[10]),i){var s=(o?i.absoluteScaling.x:i.scaling.x)<0?-1:1,l=(o?i.absoluteScaling.y:i.scaling.y)<0?-1:1,c=(o?i.absoluteScaling.z:i.scaling.z)<0?-1:1;t.x*=s,t.y*=l,t.z*=c}else this.determinant()<=0&&(t.y*=-1);if(0===t._x||0===t._y||0===t._z)return r&&r.copyFromFloats(0,0,0,1),!1;if(r){var u=1/t._x,h=1/t._y,d=1/t._z;e.FromValuesToRef(a[0]*u,a[1]*u,a[2]*u,0,a[4]*h,a[5]*h,a[6]*h,0,a[8]*d,a[9]*d,a[10]*d,0,0,0,0,1,m.Matrix[0]),p.FromRotationMatrixToRef(m.Matrix[0],r)}return!0},e.prototype.getRow=function(e){if(e<0||e>3)return null;var t=4*e;return new f(this._m[t+0],this._m[t+1],this._m[t+2],this._m[t+3])},e.prototype.getRowToRef=function(e,t){if(e>=0&&e<=3){var r=4*e;t.x=this._m[r+0],t.y=this._m[r+1],t.z=this._m[r+2],t.w=this._m[r+3]}return t},e.prototype.setRow=function(e,t){return this.setRowFromFloats(e,t.x,t.y,t.z,t.w)},e.prototype.transpose=function(){var t=new e;return e.TransposeToRef(this,t),t},e.prototype.transposeToRef=function(t){return e.TransposeToRef(this,t),t},e.prototype.setRowFromFloats=function(e,t,r,n,i){if(e<0||e>3)return this;var o=4*e;return this._m[o+0]=t,this._m[o+1]=r,this._m[o+2]=n,this._m[o+3]=i,this.markAsUpdated(),this},e.prototype.scale=function(t){var r=new e;return this.scaleToRef(t,r),r},e.prototype.scaleToRef=function(e,t){for(var r=0;r<16;r++)t._m[r]=this._m[r]*e;return t.markAsUpdated(),t},e.prototype.scaleAndAddToRef=function(e,t){for(var r=0;r<16;r++)t._m[r]+=this._m[r]*e;return t.markAsUpdated(),t},e.prototype.scaleInPlace=function(e){for(var t=this._m,r=0;r<16;r++)t[r]*=e;return this.markAsUpdated(),this},e.prototype.toNormalMatrix=function(t){var r=m.Matrix[0];this.invertToRef(r),r.transposeToRef(t);var n=t._m;return e.FromValuesToRef(n[0],n[1],n[2],0,n[4],n[5],n[6],0,n[8],n[9],n[10],0,0,0,0,1,t),t},e.prototype.getRotationMatrix=function(){var t=new e;return this.getRotationMatrixToRef(t),t},e.prototype.getRotationMatrixToRef=function(t){var r=m.Vector3[0];if(!this.decompose(r))return e.IdentityToRef(t),t;var n=this._m,i=1/r._x,o=1/r._y,a=1/r._z;return e.FromValuesToRef(n[0]*i,n[1]*i,n[2]*i,0,n[4]*o,n[5]*o,n[6]*o,0,n[8]*a,n[9]*a,n[10]*a,0,0,0,0,1,t),t},e.prototype.toggleModelMatrixHandInPlace=function(){var e=this._m;return e[2]*=-1,e[6]*=-1,e[8]*=-1,e[9]*=-1,e[14]*=-1,this.markAsUpdated(),this},e.prototype.toggleProjectionMatrixHandInPlace=function(){var e=this._m;return e[8]*=-1,e[9]*=-1,e[10]*=-1,e[11]*=-1,this.markAsUpdated(),this},e.FromArray=function(t,r){void 0===r&&(r=0);var n=new e;return e.FromArrayToRef(t,r,n),n},e.FromArrayToRef=function(e,t,r){for(var n=0;n<16;n++)r._m[n]=e[n+t];return r.markAsUpdated(),r},e.FromFloat32ArrayToRefScaled=function(e,t,r,n){return n._m[0]=e[0+t]*r,n._m[1]=e[1+t]*r,n._m[2]=e[2+t]*r,n._m[3]=e[3+t]*r,n._m[4]=e[4+t]*r,n._m[5]=e[5+t]*r,n._m[6]=e[6+t]*r,n._m[7]=e[7+t]*r,n._m[8]=e[8+t]*r,n._m[9]=e[9+t]*r,n._m[10]=e[10+t]*r,n._m[11]=e[11+t]*r,n._m[12]=e[12+t]*r,n._m[13]=e[13+t]*r,n._m[14]=e[14+t]*r,n._m[15]=e[15+t]*r,n.markAsUpdated(),n},Object.defineProperty(e,\"IdentityReadOnly\",{get:function(){return e._IdentityReadOnly},enumerable:!1,configurable:!0}),e.FromValuesToRef=function(e,t,r,n,i,o,a,s,l,c,u,h,d,f,p,_,m){var g=m._m;g[0]=e,g[1]=t,g[2]=r,g[3]=n,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=l,g[9]=c,g[10]=u,g[11]=h,g[12]=d,g[13]=f,g[14]=p,g[15]=_,m.markAsUpdated()},e.FromValues=function(t,r,n,i,o,a,s,l,c,u,h,d,f,p,_,m){var g=new e,v=g._m;return v[0]=t,v[1]=r,v[2]=n,v[3]=i,v[4]=o,v[5]=a,v[6]=s,v[7]=l,v[8]=c,v[9]=u,v[10]=h,v[11]=d,v[12]=f,v[13]=p,v[14]=_,v[15]=m,g.markAsUpdated(),g},e.Compose=function(t,r,n){var i=new e;return e.ComposeToRef(t,r,n,i),i},e.ComposeToRef=function(e,t,r,n){var i=n._m,o=t._x,a=t._y,s=t._z,l=t._w,c=o+o,u=a+a,h=s+s,d=o*c,f=o*u,p=o*h,_=a*u,m=a*h,g=s*h,v=l*c,y=l*u,b=l*h,S=e._x,T=e._y,E=e._z;return i[0]=(1-(_+g))*S,i[1]=(f+b)*S,i[2]=(p-y)*S,i[3]=0,i[4]=(f-b)*T,i[5]=(1-(d+g))*T,i[6]=(m+v)*T,i[7]=0,i[8]=(p+y)*E,i[9]=(m-v)*E,i[10]=(1-(d+_))*E,i[11]=0,i[12]=r._x,i[13]=r._y,i[14]=r._z,i[15]=1,n.markAsUpdated(),n},e.Identity=function(){var t=e.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t},e.IdentityToRef=function(t){return e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0),t},e.Zero=function(){var t=e.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t},e.RotationX=function(t){var r=new e;return e.RotationXToRef(t,r),r},e.Invert=function(t){var r=new e;return t.invertToRef(r),r},e.RotationXToRef=function(t,r){var n=Math.sin(t),i=Math.cos(t);return e.FromValuesToRef(1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1,r),r._updateIdentityStatus(1===i&&0===n),r},e.RotationY=function(t){var r=new e;return e.RotationYToRef(t,r),r},e.RotationYToRef=function(t,r){var n=Math.sin(t),i=Math.cos(t);return e.FromValuesToRef(i,0,-n,0,0,1,0,0,n,0,i,0,0,0,0,1,r),r._updateIdentityStatus(1===i&&0===n),r},e.RotationZ=function(t){var r=new e;return e.RotationZToRef(t,r),r},e.RotationZToRef=function(t,r){var n=Math.sin(t),i=Math.cos(t);return e.FromValuesToRef(i,n,0,0,-n,i,0,0,0,0,1,0,0,0,0,1,r),r._updateIdentityStatus(1===i&&0===n),r},e.RotationAxis=function(t,r){var n=new e;return e.RotationAxisToRef(t,r,n),n},e.RotationAxisToRef=function(e,t,r){var n=Math.sin(-t),i=Math.cos(-t),o=1-i;e=e.normalizeToRef(m.Vector3[0]);var a=r._m;return a[0]=e._x*e._x*o+i,a[1]=e._x*e._y*o-e._z*n,a[2]=e._x*e._z*o+e._y*n,a[3]=0,a[4]=e._y*e._x*o+e._z*n,a[5]=e._y*e._y*o+i,a[6]=e._y*e._z*o-e._x*n,a[7]=0,a[8]=e._z*e._x*o-e._y*n,a[9]=e._z*e._y*o+e._x*n,a[10]=e._z*e._z*o+i,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,r.markAsUpdated(),r},e.RotationAlignToRef=function(e,t,r,n){void 0===n&&(n=!1);var o=d.Dot(t,e),a=r._m;if(o<-1+i.bH)a[0]=-1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n?1:-1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n?-1:1,a[11]=0;else{var s=d.Cross(t,e),l=1/(1+o);a[0]=s._x*s._x*l+o,a[1]=s._y*s._x*l-s._z,a[2]=s._z*s._x*l+s._y,a[3]=0,a[4]=s._x*s._y*l+s._z,a[5]=s._y*s._y*l+o,a[6]=s._z*s._y*l-s._x,a[7]=0,a[8]=s._x*s._z*l-s._y,a[9]=s._y*s._z*l+s._x,a[10]=s._z*s._z*l+o,a[11]=0}return a[12]=0,a[13]=0,a[14]=0,a[15]=1,r.markAsUpdated(),r},e.RotationYawPitchRoll=function(t,r,n){var i=new e;return e.RotationYawPitchRollToRef(t,r,n,i),i},e.RotationYawPitchRollToRef=function(e,t,r,n){return p.RotationYawPitchRollToRef(e,t,r,m.Quaternion[0]),m.Quaternion[0].toRotationMatrix(n),n},e.Scaling=function(t,r,n){var i=new e;return e.ScalingToRef(t,r,n,i),i},e.ScalingToRef=function(t,r,n,i){return e.FromValuesToRef(t,0,0,0,0,r,0,0,0,0,n,0,0,0,0,1,i),i._updateIdentityStatus(1===t&&1===r&&1===n),i},e.Translation=function(t,r,n){var i=new e;return e.TranslationToRef(t,r,n,i),i},e.TranslationToRef=function(t,r,n,i){return e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,r,n,1,i),i._updateIdentityStatus(0===t&&0===r&&0===n),i},e.Lerp=function(t,r,n){var i=new e;return e.LerpToRef(t,r,n,i),i},e.LerpToRef=function(e,t,r,n){for(var i=n._m,o=e.m,a=t.m,s=0;s<16;s++)i[s]=o[s]*(1-r)+a[s]*r;return n.markAsUpdated(),n},e.DecomposeLerp=function(t,r,n){var i=new e;return e.DecomposeLerpToRef(t,r,n,i),i},e.DecomposeLerpToRef=function(t,r,n,i){var o=m.Vector3[0],a=m.Quaternion[0],s=m.Vector3[1];t.decompose(o,a,s);var l=m.Vector3[2],c=m.Quaternion[1],u=m.Vector3[3];r.decompose(l,c,u);var h=m.Vector3[4];d.LerpToRef(o,l,n,h);var f=m.Quaternion[2];p.SlerpToRef(a,c,n,f);var _=m.Vector3[5];return d.LerpToRef(s,u,n,_),e.ComposeToRef(h,f,_,i),i},e.LookAtLH=function(t,r,n){var i=new e;return e.LookAtLHToRef(t,r,n,i),i},e.LookAtLHToRef=function(t,r,n,i){var o=m.Vector3[0],a=m.Vector3[1],s=m.Vector3[2];r.subtractToRef(t,s),s.normalize(),d.CrossToRef(n,s,o);var l=o.lengthSquared();0===l?o.x=1:o.normalizeFromLength(Math.sqrt(l)),d.CrossToRef(s,o,a),a.normalize();var c=-d.Dot(o,t),u=-d.Dot(a,t),h=-d.Dot(s,t);return e.FromValuesToRef(o._x,a._x,s._x,0,o._y,a._y,s._y,0,o._z,a._z,s._z,0,c,u,h,1,i),i},e.LookAtRH=function(t,r,n){var i=new e;return e.LookAtRHToRef(t,r,n,i),i},e.LookAtRHToRef=function(t,r,n,i){var o=m.Vector3[0],a=m.Vector3[1],s=m.Vector3[2];t.subtractToRef(r,s),s.normalize(),d.CrossToRef(n,s,o);var l=o.lengthSquared();0===l?o.x=1:o.normalizeFromLength(Math.sqrt(l)),d.CrossToRef(s,o,a),a.normalize();var c=-d.Dot(o,t),u=-d.Dot(a,t),h=-d.Dot(s,t);return e.FromValuesToRef(o._x,a._x,s._x,0,o._y,a._y,s._y,0,o._z,a._z,s._z,0,c,u,h,1,i),i},e.LookDirectionLH=function(t,r){var n=new e;return e.LookDirectionLHToRef(t,r,n),n},e.LookDirectionLHToRef=function(t,r,n){var i=m.Vector3[0];i.copyFrom(t),i.scaleInPlace(-1);var o=m.Vector3[1];return d.CrossToRef(r,i,o),e.FromValuesToRef(o._x,o._y,o._z,0,r._x,r._y,r._z,0,i._x,i._y,i._z,0,0,0,0,1,n),n},e.LookDirectionRH=function(t,r){var n=new e;return e.LookDirectionRHToRef(t,r,n),n},e.LookDirectionRHToRef=function(t,r,n){var i=m.Vector3[2];return d.CrossToRef(r,t,i),e.FromValuesToRef(i._x,i._y,i._z,0,r._x,r._y,r._z,0,t._x,t._y,t._z,0,0,0,0,1,n),n},e.OrthoLH=function(t,r,n,i,o){var a=new e;return e.OrthoLHToRef(t,r,n,i,a,o),a},e.OrthoLHToRef=function(t,r,n,i,o,a){var s=2/t,l=2/r,c=2/(i-n),u=-(i+n)/(i-n);return e.FromValuesToRef(s,0,0,0,0,l,0,0,0,0,c,0,0,0,u,1,o),a&&o.multiplyToRef(v,o),o._updateIdentityStatus(1===s&&1===l&&1===c&&0===u),o},e.OrthoOffCenterLH=function(t,r,n,i,o,a,s){var l=new e;return e.OrthoOffCenterLHToRef(t,r,n,i,o,a,l,s),l},e.OrthoOffCenterLHToRef=function(t,r,n,i,o,a,s,l){var c=2/(r-t),u=2/(i-n),h=2/(a-o),d=-(a+o)/(a-o),f=(t+r)/(t-r),p=(i+n)/(n-i);return e.FromValuesToRef(c,0,0,0,0,u,0,0,0,0,h,0,f,p,d,1,s),l&&s.multiplyToRef(v,s),s.markAsUpdated(),s},e.ObliqueOffCenterLHToRef=function(t,r,n,i,o,a,s,l,c,u,h){var d=-s*Math.cos(l),f=-s*Math.sin(l);return e.TranslationToRef(0,0,-c,m.Matrix[1]),e.FromValuesToRef(1,0,0,0,0,1,0,0,d,f,1,0,0,0,0,1,m.Matrix[0]),m.Matrix[1].multiplyToRef(m.Matrix[0],m.Matrix[0]),e.TranslationToRef(0,0,c,m.Matrix[1]),m.Matrix[0].multiplyToRef(m.Matrix[1],m.Matrix[0]),e.OrthoOffCenterLHToRef(t,r,n,i,o,a,u,h),m.Matrix[0].multiplyToRef(u,u),u},e.OrthoOffCenterRH=function(t,r,n,i,o,a,s){var l=new e;return e.OrthoOffCenterRHToRef(t,r,n,i,o,a,l,s),l},e.OrthoOffCenterRHToRef=function(t,r,n,i,o,a,s,l){return e.OrthoOffCenterLHToRef(t,r,n,i,o,a,s,l),s._m[10]*=-1,s},e.ObliqueOffCenterRHToRef=function(t,r,n,i,o,a,s,l,c,u,h){var d=s*Math.cos(l),f=s*Math.sin(l);return e.TranslationToRef(0,0,c,m.Matrix[1]),e.FromValuesToRef(1,0,0,0,0,1,0,0,d,f,1,0,0,0,0,1,m.Matrix[0]),m.Matrix[1].multiplyToRef(m.Matrix[0],m.Matrix[0]),e.TranslationToRef(0,0,-c,m.Matrix[1]),m.Matrix[0].multiplyToRef(m.Matrix[1],m.Matrix[0]),e.OrthoOffCenterRHToRef(t,r,n,i,o,a,u,h),m.Matrix[0].multiplyToRef(u,u),u},e.PerspectiveLH=function(t,r,n,i,o,a){void 0===a&&(a=0);var s=new e,l=2*n/t,c=2*n/r,u=(i+n)/(i-n),h=-2*i*n/(i-n),d=Math.tan(a);return e.FromValuesToRef(l,0,0,0,0,c,0,d,0,0,u,1,0,0,h,0,s),o&&s.multiplyToRef(v,s),s._updateIdentityStatus(!1),s},e.PerspectiveFovLH=function(t,r,n,i,o,a,s){void 0===a&&(a=0),void 0===s&&(s=!1);var l=new e;return e.PerspectiveFovLHToRef(t,r,n,i,l,!0,o,a,s),l},e.PerspectiveFovLHToRef=function(t,r,n,i,o,a,s,l,c){void 0===a&&(a=!0),void 0===l&&(l=0),void 0===c&&(c=!1);var u=n,h=i,d=1/Math.tan(.5*t),f=a?d/r:d,p=a?d:d*r,_=c&&0===u?-1:0!==h?(h+u)/(h-u):1,m=c&&0===u?2*h:0!==h?-2*h*u/(h-u):-2*u,g=Math.tan(l);return e.FromValuesToRef(f,0,0,0,0,p,0,g,0,0,_,1,0,0,m,0,o),s&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o},e.PerspectiveFovReverseLHToRef=function(t,r,n,i,o,a,s,l){void 0===a&&(a=!0),void 0===l&&(l=0);var c=1/Math.tan(.5*t),u=a?c/r:c,h=a?c:c*r,d=Math.tan(l);return e.FromValuesToRef(u,0,0,0,0,h,0,d,0,0,-n,1,0,0,1,0,o),s&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o},e.PerspectiveFovRH=function(t,r,n,i,o,a,s){void 0===a&&(a=0),void 0===s&&(s=!1);var l=new e;return e.PerspectiveFovRHToRef(t,r,n,i,l,!0,o,a,s),l},e.PerspectiveFovRHToRef=function(t,r,n,i,o,a,s,l,c){void 0===a&&(a=!0),void 0===l&&(l=0),void 0===c&&(c=!1);var u=n,h=i,d=1/Math.tan(.5*t),f=a?d/r:d,p=a?d:d*r,_=c&&0===u?1:0!==h?-(h+u)/(h-u):-1,m=c&&0===u?2*h:0!==h?-2*h*u/(h-u):-2*u,g=Math.tan(l);return e.FromValuesToRef(f,0,0,0,0,p,0,g,0,0,_,-1,0,0,m,0,o),s&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o},e.PerspectiveFovReverseRHToRef=function(t,r,n,i,o,a,s,l){void 0===a&&(a=!0),void 0===l&&(l=0);var c=1/Math.tan(.5*t),u=a?c/r:c,h=a?c:c*r,d=Math.tan(l);return e.FromValuesToRef(u,0,0,0,0,h,0,d,0,0,-n,-1,0,0,-1,0,o),s&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o},e.GetFinalMatrix=function(t,r,n,i,o,a){var s=t.width,l=t.height,c=t.x,u=t.y,h=e.FromValues(s/2,0,0,0,0,-l/2,0,0,0,0,a-o,0,c+s/2,l/2+u,o,1),d=new e;return r.multiplyToRef(n,d),d.multiplyToRef(i,d),d.multiplyToRef(h,d)},e.GetAsMatrix2x2=function(e){var t=e.m,r=[t[0],t[1],t[4],t[5]];return s.I.MatrixUse64Bits?r:new Float32Array(r)},e.GetAsMatrix3x3=function(e){var t=e.m,r=[t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]];return s.I.MatrixUse64Bits?r:new Float32Array(r)},e.Transpose=function(t){var r=new e;return e.TransposeToRef(t,r),r},e.TransposeToRef=function(e,t){var r=e.m,n=r[0],i=r[4],o=r[8],a=r[12],s=r[1],l=r[5],c=r[9],u=r[13],h=r[2],d=r[6],f=r[10],p=r[14],_=r[3],m=r[7],g=r[11],v=r[15],y=t._m;return y[0]=n,y[1]=i,y[2]=o,y[3]=a,y[4]=s,y[5]=l,y[6]=c,y[7]=u,y[8]=h,y[9]=d,y[10]=f,y[11]=p,y[12]=_,y[13]=m,y[14]=g,y[15]=v,t.markAsUpdated(),t._updateIdentityStatus(e._isIdentity,e._isIdentityDirty),t},e.Reflection=function(t){var r=new e;return e.ReflectionToRef(t,r),r},e.ReflectionToRef=function(t,r){t.normalize();var n=t.normal.x,i=t.normal.y,o=t.normal.z,a=-2*n,s=-2*i,l=-2*o;return e.FromValuesToRef(a*n+1,s*n,l*n,0,a*i,s*i+1,l*i,0,a*o,s*o,l*o+1,0,a*t.d,s*t.d,l*t.d,1,r),r},e.FromXYZAxesToRef=function(t,r,n,i){return e.FromValuesToRef(t._x,t._y,t._z,0,r._x,r._y,r._z,0,n._x,n._y,n._z,0,0,0,0,1,i),i},e.FromQuaternionToRef=function(e,t){var r=e._x*e._x,n=e._y*e._y,i=e._z*e._z,o=e._x*e._y,a=e._z*e._w,s=e._z*e._x,l=e._y*e._w,c=e._y*e._z,u=e._x*e._w;return t._m[0]=1-2*(n+i),t._m[1]=2*(o+a),t._m[2]=2*(s-l),t._m[3]=0,t._m[4]=2*(o-a),t._m[5]=1-2*(i+r),t._m[6]=2*(c+u),t._m[7]=0,t._m[8]=2*(s+l),t._m[9]=2*(c-u),t._m[10]=1-2*(n+r),t._m[11]=0,t._m[12]=0,t._m[13]=0,t._m[14]=0,t._m[15]=1,t.markAsUpdated(),t},e._UpdateFlagSeed=0,e._IdentityReadOnly=e.Identity(),e}();Object.defineProperties(_.prototype,{dimension:{value:[4,4]},rank:{value:2}});var m=function(){function e(){}return e.Vector3=(0,o.ln)(11,d.Zero),e.Matrix=(0,o.ln)(2,_.Identity),e.Quaternion=(0,o.ln)(3,p.Zero),e}(),g=function(){function e(){}return e.Vector2=(0,o.ln)(3,h.Zero),e.Vector3=(0,o.ln)(13,d.Zero),e.Vector4=(0,o.ln)(3,f.Zero),e.Quaternion=(0,o.ln)(3,p.Zero),e.Matrix=(0,o.ln)(8,_.Identity),e}();(0,a.Y5)(\"BABYLON.Vector2\",h),(0,a.Y5)(\"BABYLON.Vector3\",d),(0,a.Y5)(\"BABYLON.Vector4\",f),(0,a.Y5)(\"BABYLON.Matrix\",_);var v=_.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1)},25187:(e,t,r)=>{r.d(t,{L:()=>n});var n=function(){function e(e,t,r,n){this.x=e,this.y=t,this.width=r,this.height=n}return e.prototype.toGlobal=function(t,r){return new e(this.x*t,this.y*r,this.width*t,this.height*r)},e.prototype.toGlobalToRef=function(e,t,r){return r.x=this.x*e,r.y=this.y*t,r.width=this.width*e,r.height=this.height*t,this},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}()},51428:(e,t,r)=>{r.d(t,{O:()=>c,Q:()=>u});var n=r(8046),i=r(51322),o=[Math.sqrt(1/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(3/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(15/(4*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(5/(16*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(15/(16*Math.PI))],a=[function(){return 1},function(e){return e.y},function(e){return e.z},function(e){return e.x},function(e){return e.x*e.y},function(e){return e.y*e.z},function(e){return 3*e.z*e.z-1},function(e){return e.x*e.z},function(e){return e.x*e.x-e.y*e.y}],s=function(e,t){return o[e]*a[e](t)},l=[Math.PI,2*Math.PI/3,2*Math.PI/3,2*Math.PI/3,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4],c=function(){function e(){this.preScaled=!1,this.l00=n.Pq.Zero(),this.l1_1=n.Pq.Zero(),this.l10=n.Pq.Zero(),this.l11=n.Pq.Zero(),this.l2_2=n.Pq.Zero(),this.l2_1=n.Pq.Zero(),this.l20=n.Pq.Zero(),this.l21=n.Pq.Zero(),this.l22=n.Pq.Zero()}return e.prototype.addLight=function(e,t,r){i.AA.Vector3[0].set(t.r,t.g,t.b);var n=i.AA.Vector3[0],o=i.AA.Vector3[1];n.scaleToRef(r,o),o.scaleToRef(s(0,e),i.AA.Vector3[2]),this.l00.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(1,e),i.AA.Vector3[2]),this.l1_1.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(2,e),i.AA.Vector3[2]),this.l10.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(3,e),i.AA.Vector3[2]),this.l11.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(4,e),i.AA.Vector3[2]),this.l2_2.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(5,e),i.AA.Vector3[2]),this.l2_1.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(6,e),i.AA.Vector3[2]),this.l20.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(7,e),i.AA.Vector3[2]),this.l21.addInPlace(i.AA.Vector3[2]),o.scaleToRef(s(8,e),i.AA.Vector3[2]),this.l22.addInPlace(i.AA.Vector3[2])},e.prototype.scaleInPlace=function(e){this.l00.scaleInPlace(e),this.l1_1.scaleInPlace(e),this.l10.scaleInPlace(e),this.l11.scaleInPlace(e),this.l2_2.scaleInPlace(e),this.l2_1.scaleInPlace(e),this.l20.scaleInPlace(e),this.l21.scaleInPlace(e),this.l22.scaleInPlace(e)},e.prototype.convertIncidentRadianceToIrradiance=function(){this.l00.scaleInPlace(l[0]),this.l1_1.scaleInPlace(l[1]),this.l10.scaleInPlace(l[2]),this.l11.scaleInPlace(l[3]),this.l2_2.scaleInPlace(l[4]),this.l2_1.scaleInPlace(l[5]),this.l20.scaleInPlace(l[6]),this.l21.scaleInPlace(l[7]),this.l22.scaleInPlace(l[8])},e.prototype.convertIrradianceToLambertianRadiance=function(){this.scaleInPlace(1/Math.PI)},e.prototype.preScaleForRendering=function(){this.preScaled=!0,this.l00.scaleInPlace(o[0]),this.l1_1.scaleInPlace(o[1]),this.l10.scaleInPlace(o[2]),this.l11.scaleInPlace(o[3]),this.l2_2.scaleInPlace(o[4]),this.l2_1.scaleInPlace(o[5]),this.l20.scaleInPlace(o[6]),this.l21.scaleInPlace(o[7]),this.l22.scaleInPlace(o[8])},e.prototype.updateFromArray=function(e){return n.Pq.FromArrayToRef(e[0],0,this.l00),n.Pq.FromArrayToRef(e[1],0,this.l1_1),n.Pq.FromArrayToRef(e[2],0,this.l10),n.Pq.FromArrayToRef(e[3],0,this.l11),n.Pq.FromArrayToRef(e[4],0,this.l2_2),n.Pq.FromArrayToRef(e[5],0,this.l2_1),n.Pq.FromArrayToRef(e[6],0,this.l20),n.Pq.FromArrayToRef(e[7],0,this.l21),n.Pq.FromArrayToRef(e[8],0,this.l22),this},e.prototype.updateFromFloatsArray=function(e){return n.Pq.FromFloatsToRef(e[0],e[1],e[2],this.l00),n.Pq.FromFloatsToRef(e[3],e[4],e[5],this.l1_1),n.Pq.FromFloatsToRef(e[6],e[7],e[8],this.l10),n.Pq.FromFloatsToRef(e[9],e[10],e[11],this.l11),n.Pq.FromFloatsToRef(e[12],e[13],e[14],this.l2_2),n.Pq.FromFloatsToRef(e[15],e[16],e[17],this.l2_1),n.Pq.FromFloatsToRef(e[18],e[19],e[20],this.l20),n.Pq.FromFloatsToRef(e[21],e[22],e[23],this.l21),n.Pq.FromFloatsToRef(e[24],e[25],e[26],this.l22),this},e.FromArray=function(t){return(new e).updateFromArray(t)},e.FromPolynomial=function(t){var r=new e;return r.l00=t.xx.scale(.376127).add(t.yy.scale(.376127)).add(t.zz.scale(.376126)),r.l1_1=t.y.scale(.977204),r.l10=t.z.scale(.977204),r.l11=t.x.scale(.977204),r.l2_2=t.xy.scale(1.16538),r.l2_1=t.yz.scale(1.16538),r.l20=t.zz.scale(1.34567).subtract(t.xx.scale(.672834)).subtract(t.yy.scale(.672834)),r.l21=t.zx.scale(1.16538),r.l22=t.xx.scale(1.16538).subtract(t.yy.scale(1.16538)),r.l1_1.scaleInPlace(-1),r.l11.scaleInPlace(-1),r.l2_1.scaleInPlace(-1),r.l21.scaleInPlace(-1),r.scaleInPlace(Math.PI),r},e}(),u=function(){function e(){this.x=n.Pq.Zero(),this.y=n.Pq.Zero(),this.z=n.Pq.Zero(),this.xx=n.Pq.Zero(),this.yy=n.Pq.Zero(),this.zz=n.Pq.Zero(),this.xy=n.Pq.Zero(),this.yz=n.Pq.Zero(),this.zx=n.Pq.Zero()}return Object.defineProperty(e.prototype,\"preScaledHarmonics\",{get:function(){return this._harmonics||(this._harmonics=c.FromPolynomial(this)),this._harmonics.preScaled||this._harmonics.preScaleForRendering(),this._harmonics},enumerable:!1,configurable:!0}),e.prototype.addAmbient=function(e){i.AA.Vector3[0].copyFromFloats(e.r,e.g,e.b);var t=i.AA.Vector3[0];this.xx.addInPlace(t),this.yy.addInPlace(t),this.zz.addInPlace(t)},e.prototype.scaleInPlace=function(e){this.x.scaleInPlace(e),this.y.scaleInPlace(e),this.z.scaleInPlace(e),this.xx.scaleInPlace(e),this.yy.scaleInPlace(e),this.zz.scaleInPlace(e),this.yz.scaleInPlace(e),this.zx.scaleInPlace(e),this.xy.scaleInPlace(e)},e.prototype.updateFromHarmonics=function(e){return this._harmonics=e,this.x.copyFrom(e.l11),this.x.scaleInPlace(1.02333).scaleInPlace(-1),this.y.copyFrom(e.l1_1),this.y.scaleInPlace(1.02333).scaleInPlace(-1),this.z.copyFrom(e.l10),this.z.scaleInPlace(1.02333),this.xx.copyFrom(e.l00),i.AA.Vector3[0].copyFrom(e.l20).scaleInPlace(.247708),i.AA.Vector3[1].copyFrom(e.l22).scaleInPlace(.429043),this.xx.scaleInPlace(.886277).subtractInPlace(i.AA.Vector3[0]).addInPlace(i.AA.Vector3[1]),this.yy.copyFrom(e.l00),this.yy.scaleInPlace(.886277).subtractInPlace(i.AA.Vector3[0]).subtractInPlace(i.AA.Vector3[1]),this.zz.copyFrom(e.l00),i.AA.Vector3[0].copyFrom(e.l20).scaleInPlace(.495417),this.zz.scaleInPlace(.886277).addInPlace(i.AA.Vector3[0]),this.yz.copyFrom(e.l2_1),this.yz.scaleInPlace(.858086).scaleInPlace(-1),this.zx.copyFrom(e.l21),this.zx.scaleInPlace(.858086).scaleInPlace(-1),this.xy.copyFrom(e.l2_2),this.xy.scaleInPlace(.858086),this.scaleInPlace(1/Math.PI),this},e.FromHarmonics=function(t){return(new e).updateFromHarmonics(t)},e.FromArray=function(t){var r=new e;return n.Pq.FromArrayToRef(t[0],0,r.x),n.Pq.FromArrayToRef(t[1],0,r.y),n.Pq.FromArrayToRef(t[2],0,r.z),n.Pq.FromArrayToRef(t[3],0,r.xx),n.Pq.FromArrayToRef(t[4],0,r.yy),n.Pq.FromArrayToRef(t[5],0,r.zz),n.Pq.FromArrayToRef(t[6],0,r.yz),n.Pq.FromArrayToRef(t[7],0,r.zx),n.Pq.FromArrayToRef(t[8],0,r.xy),r},e}()},26218:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(78322),i=function(e){function t(t){var r=e.call(this)||this;return r._buffer=t,r}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"underlyingResource\",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),t}(r(37943).n)},75768:(e,t,r)=>{r.d(t,{d:()=>u});var n=r(8046),i=r(48810),o=r(51428),a=r(81152),s=r(56740),l=r(64726),c=function(e,t,r,n){this.name=e,this.worldAxisForNormal=t,this.worldAxisForFileX=r,this.worldAxisForFileY=n},u=function(){function e(){}return e.ConvertCubeMapTextureToSphericalPolynomial=function(e){var t,r=this;if(!e.isCube)return null;null===(t=e.getScene())||void 0===t||t.getEngine().flushFramebuffer();var n,i,o=e.getSize().width,s=e.readPixels(0,void 0,void 0,!1),l=e.readPixels(1,void 0,void 0,!1);e.isRenderTarget?(n=e.readPixels(3,void 0,void 0,!1),i=e.readPixels(2,void 0,void 0,!1)):(n=e.readPixels(2,void 0,void 0,!1),i=e.readPixels(3,void 0,void 0,!1));var c=e.readPixels(4,void 0,void 0,!1),u=e.readPixels(5,void 0,void 0,!1),h=e.gammaSpace,d=a.Y.TEXTUREFORMAT_RGBA,f=a.Y.TEXTURETYPE_UNSIGNED_INT;return e.textureType!=a.Y.TEXTURETYPE_FLOAT&&e.textureType!=a.Y.TEXTURETYPE_HALF_FLOAT||(f=a.Y.TEXTURETYPE_FLOAT),new Promise((function(e){Promise.all([l,s,n,i,c,u]).then((function(t){var n=t[0],i=t[1],a=t[2],s=t[3],l=t[4],c=t[5],u={size:o,right:i,left:n,up:a,down:s,front:l,back:c,format:d,type:f,gammaSpace:h};e(r.ConvertCubeMapToSphericalPolynomial(u))}))}))},e._AreaElement=function(e,t){return Math.atan2(e*t,Math.sqrt(e*e+t*t+1))},e.ConvertCubeMapToSphericalPolynomial=function(e){for(var t=new o.O,r=0,n=2/e.size,c=n,u=.5*n,h=u-1,d=0;d<6;d++)for(var f=this._FileFaces[d],p=e[f.name],_=h,m=e.format===a.Y.TEXTUREFORMAT_RGBA?4:3,g=0;g<e.size;g++){for(var v=h,y=0;y<e.size;y++){var b=f.worldAxisForFileX.scale(v).add(f.worldAxisForFileY.scale(_)).add(f.worldAxisForNormal);b.normalize();var S=this._AreaElement(v-u,_-u)-this._AreaElement(v-u,_+u)-this._AreaElement(v+u,_-u)+this._AreaElement(v+u,_+u),T=p[g*e.size*m+y*m+0],E=p[g*e.size*m+y*m+1],x=p[g*e.size*m+y*m+2];isNaN(T)&&(T=0),isNaN(E)&&(E=0),isNaN(x)&&(x=0),e.type===a.Y.TEXTURETYPE_UNSIGNED_INT&&(T/=255,E/=255,x/=255),e.gammaSpace&&(T=Math.pow((0,i.Clamp)(T),s.tk),E=Math.pow((0,i.Clamp)(E),s.tk),x=Math.pow((0,i.Clamp)(x),s.tk));var P=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){var C=Math.max(T,E,x);if(C>P){var A=P/C;T*=A,E*=A,x*=A}}else T=(0,i.Clamp)(T,0,P),E=(0,i.Clamp)(E,0,P),x=(0,i.Clamp)(x,0,P);var R=new l.v9(T,E,x);t.addLight(b,R,S),r+=S,v+=n}_+=c}var I=4*Math.PI*6/6/r;return t.scaleInPlace(I),t.convertIncidentRadianceToIrradiance(),t.convertIrradianceToLambertianRadiance(),o.Q.FromHarmonics(t)},e._FileFaces=[new c(\"right\",new n.Pq(1,0,0),new n.Pq(0,0,-1),new n.Pq(0,-1,0)),new c(\"left\",new n.Pq(-1,0,0),new n.Pq(0,0,1),new n.Pq(0,-1,0)),new c(\"up\",new n.Pq(0,1,0),new n.Pq(1,0,0),new n.Pq(0,0,1)),new c(\"down\",new n.Pq(0,-1,0),new n.Pq(1,0,0),new n.Pq(0,0,-1)),new c(\"front\",new n.Pq(0,0,1),new n.Pq(1,0,0),new n.Pq(0,-1,0)),new c(\"back\",new n.Pq(0,0,-1),new n.Pq(-1,0,0),new n.Pq(0,-1,0))],e.MAX_HDRI_VALUE=4096,e.PRESERVE_CLAMPED_COLORS=!1,e}()},51967:(e,t,r)=>{r.d(t,{I9:()=>u,LT:()=>l,NK:()=>a,VH:()=>s});var n=r(16814);function i(e,t,r,n,i,o){i>0?(i=function(e,t){return t>1023?1*Math.pow(2,1023)*Math.pow(2,t-1023):t<-1074?1*Math.pow(2,-1074)*Math.pow(2,t+1074):1*Math.pow(2,t)}(0,i-136),e[o+0]=t*i,e[o+1]=r*i,e[o+2]=n*i):(e[o+0]=0,e[o+1]=0,e[o+2]=0)}function o(e,t){for(var r=\"\",n=\"\",i=t;i<e.length-t&&\"\\n\"!=(n=String.fromCharCode(e[i]));i++)r+=n;return r}function a(e){var t,r,n=o(e,0);if(\"#\"!=n[0]||\"?\"!=n[1])throw\"Bad HDR Format.\";var i=!1,a=!1,s=0;do{\"FORMAT=32-bit_rle_rgbe\"==(n=o(e,s+=n.length+1))?a=!0:0==n.length&&(i=!0)}while(!i);if(!a)throw\"HDR Bad header format, unsupported FORMAT\";n=o(e,s+=n.length+1);var l=/^-Y (.*) \\+X (.*)$/g.exec(n);if(!l||l.length<3)throw\"HDR Bad header format, no size\";if(r=parseInt(l[2]),t=parseInt(l[1]),r<8||r>32767)throw\"HDR Bad header format, unsupported size\";return{height:t,width:r,dataPosition:s+=n.length+1}}function s(e,t,r){void 0===r&&(r=!1);var i=new Uint8Array(e),o=a(i),s=l(i,o);return n.D.ConvertPanoramaToCubemap(s,o.width,o.height,t,r)}function l(e,t){return function(e,t){for(var r,n,o,a,s,l=t.height,u=t.width,h=t.dataPosition,d=0,f=0,p=0,_=new ArrayBuffer(4*u),m=new Uint8Array(_),g=new ArrayBuffer(t.width*t.height*4*3),v=new Float32Array(g);l>0;){if(r=e[h++],n=e[h++],o=e[h++],a=e[h++],2!=r||2!=n||128&o||t.width<8||t.width>32767)return c(e,t);if((o<<8|a)!=u)throw\"HDR Bad header format, wrong scan line width\";for(d=0,p=0;p<4;p++)for(f=(p+1)*u;d<f;)if(r=e[h++],n=e[h++],r>128){if(0==(s=r-128)||s>f-d)throw\"HDR Bad Format, bad scanline data (run)\";for(;s-- >0;)m[d++]=n}else{if(0==(s=r)||s>f-d)throw\"HDR Bad Format, bad scanline data (non-run)\";if(m[d++]=n,--s>0)for(var y=0;y<s;y++)m[d++]=e[h++]}for(p=0;p<u;p++)i(v,r=m[p],n=m[p+u],o=m[p+2*u],a=m[p+3*u],(t.height-l)*u*3+3*p);l--}return v}(e,t)}function c(e,t){for(var r,n=t.height,o=t.width,a=t.dataPosition,s=new ArrayBuffer(t.width*t.height*4*3),l=new Float32Array(s);n>0;){for(r=0;r<t.width;r++)i(l,e[a++],e[a++],e[a++],e[a++],(t.height-n)*o*3+3*r);n--}return l}var u={RGBE_ReadHeader:a,GetCubeMapTextureData:s,RGBE_ReadPixels:l}},16814:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(8046),i=r(81152),o=function(){function e(){}return e.ConvertPanoramaToCubemap=function(e,t,r,n,o){if(void 0===o&&(o=!1),!e)throw\"ConvertPanoramaToCubemap: input cannot be null\";if(e.length!=t*r*3)throw\"ConvertPanoramaToCubemap: input size is wrong\";return{front:this.CreateCubemapTexture(n,this.FACE_FRONT,e,t,r,o),back:this.CreateCubemapTexture(n,this.FACE_BACK,e,t,r,o),left:this.CreateCubemapTexture(n,this.FACE_LEFT,e,t,r,o),right:this.CreateCubemapTexture(n,this.FACE_RIGHT,e,t,r,o),up:this.CreateCubemapTexture(n,this.FACE_UP,e,t,r,o),down:this.CreateCubemapTexture(n,this.FACE_DOWN,e,t,r,o),size:n,type:i.Y.TEXTURETYPE_FLOAT,format:i.Y.TEXTUREFORMAT_RGB,gammaSpace:!1}},e.CreateCubemapTexture=function(e,t,r,n,i,o){void 0===o&&(o=!1);for(var a=new ArrayBuffer(e*e*4*3),s=new Float32Array(a),l=o?Math.max(1,Math.round(n/4/e)):1,c=1/l,u=c*c,h=t[1].subtract(t[0]).scale(c/e),d=t[3].subtract(t[2]).scale(c/e),f=1/e,p=0,_=0;_<e;_++)for(var m=0;m<l;m++){for(var g=t[0],v=t[2],y=0;y<e;y++)for(var b=0;b<l;b++){var S=v.subtract(g).scale(p).add(g);S.normalize();var T=this.CalcProjectionSpherical(S,r,n,i);s[_*e*3+3*y+0]+=T.r*u,s[_*e*3+3*y+1]+=T.g*u,s[_*e*3+3*y+2]+=T.b*u,g=g.add(h),v=v.add(d)}p+=f*c}return s},e.CalcProjectionSpherical=function(e,t,r,n){for(var i=Math.atan2(e.z,e.x),o=Math.acos(e.y);i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;var a=i/Math.PI,s=o/Math.PI;a=.5*a+.5;var l=Math.round(a*r);l<0?l=0:l>=r&&(l=r-1);var c=Math.round(s*n);c<0?c=0:c>=n&&(c=n-1);var u=n-c-1;return{r:t[u*r*3+3*l+0],g:t[u*r*3+3*l+1],b:t[u*r*3+3*l+2]}},e.FACE_LEFT=[new n.Pq(-1,-1,-1),new n.Pq(1,-1,-1),new n.Pq(-1,1,-1),new n.Pq(1,1,-1)],e.FACE_RIGHT=[new n.Pq(1,-1,1),new n.Pq(-1,-1,1),new n.Pq(1,1,1),new n.Pq(-1,1,1)],e.FACE_FRONT=[new n.Pq(1,-1,-1),new n.Pq(1,-1,1),new n.Pq(1,1,-1),new n.Pq(1,1,1)],e.FACE_BACK=[new n.Pq(-1,-1,1),new n.Pq(-1,-1,-1),new n.Pq(-1,1,1),new n.Pq(-1,1,-1)],e.FACE_DOWN=[new n.Pq(1,1,-1),new n.Pq(1,1,1),new n.Pq(-1,1,-1),new n.Pq(-1,1,1)],e.FACE_UP=[new n.Pq(-1,-1,-1),new n.Pq(-1,-1,1),new n.Pq(1,-1,-1),new n.Pq(1,-1,1)],e}()},92548:(e,t,r)=>{r.d(t,{Z:()=>n});var n=function(){function e(){}return e.Eval=function(t,r){return\"true\"===(t=t.match(/\\([^()]*\\)/g)?t.replace(/\\([^()]*\\)/g,(function(t){return t=t.slice(1,t.length-1),e._HandleParenthesisContent(t,r)})):e._HandleParenthesisContent(t,r))||\"false\"!==t&&e.Eval(t,r)},e._HandleParenthesisContent=function(t,r){var n;r=r||function(e){return\"true\"===e};var i=t.split(\"||\");for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)){var a=e._SimplifyNegation(i[o].trim()),s=a.split(\"&&\");if(s.length>1)for(var l=0;l<s.length;++l){var c=e._SimplifyNegation(s[l].trim());if(!(n=\"true\"!==c&&\"false\"!==c?\"!\"===c[0]?!r(c.substring(1)):r(c):\"true\"===c)){a=\"false\";break}}if(n||\"true\"===a){n=!0;break}n=\"true\"!==a&&\"false\"!==a?\"!\"===a[0]?!r(a.substring(1)):r(a):\"true\"===a}return n?\"true\":\"false\"},e._SimplifyNegation=function(e){return\"!true\"===(e=(e=e.replace(/^[\\s!]+/,(function(e){return(e=e.replace(/[\\s]/g,(function(){return\"\"}))).length%2?\"!\":\"\"}))).trim())?e=\"false\":\"!false\"===e&&(e=\"true\"),e},e}()},11296:(e,t,r)=>{function n(e,t){for(var r=[],n=0;n<e;++n)r.push(t());return r}function i(e,t){return n(e,t)}r.d(t,{lL:()=>a,ln:()=>i,mI:()=>n});var o=[\"push\",\"splice\",\"pop\",\"shift\",\"unshift\"];function a(e,t){var r=o.map((function(r){return function(e,t,r){var n=e[t];if(\"function\"!=typeof n)return null;var i=function(){var n=e.length,o=i.previous.apply(e,arguments);return r(t,n),o};return n.next=i,i.previous=n,e[t]=i,function(){var r=i.previous;if(r){var n=i.next;n?(r.next=n,n.previous=r):(r.next=void 0,e[t]=r),i.next=void 0,i.previous=void 0}}}(e,r,t)}));return function(){r.forEach((function(e){null==e||e()}))}}},82941:(e,t,r)=>{r.d(t,{$e:()=>c,ED:()=>b,Sl:()=>h,SV:()=>u,yT:()=>d,aB:()=>y,af:()=>m,yk:()=>g});var n=r(44957),i=r(50582),o=r(19133),a=r(81152);function s(){var e=null;function t(e,t,r,n,i){var o=e.getImageTranscodedSizeInBytes(t,r,n),a=new Uint8Array(o);return e.transcodeImage(a,t,r,n,1,0)?(i&&(a=function(e,t,r,n){for(var i=new Uint16Array(4),o=new Uint16Array(r*n),a=r/4,s=n/4,l=0;l<s;l++)for(var c=0;c<a;c++){var u=0+8*(l*a+c);i[0]=e[u]|e[u+1]<<8,i[1]=e[u+2]|e[u+3]<<8,i[2]=(2*(31&i[0])+1*(31&i[1]))/3|(2*(2016&i[0])+1*(2016&i[1]))/3&2016|(2*(63488&i[0])+1*(63488&i[1]))/3&63488,i[3]=(2*(31&i[1])+1*(31&i[0]))/3|(2*(2016&i[1])+1*(2016&i[0]))/3&2016|(2*(63488&i[1])+1*(63488&i[0]))/3&63488;for(var h=0;h<4;h++){var d=e[u+4+h],f=(4*l+h)*r+4*c;o[f++]=i[3&d],o[f++]=i[d>>2&3],o[f++]=i[d>>4&3],o[f++]=i[d>>6&3]}}return o}(a,0,e.getImageWidth(t,r)+3&-4,e.getImageHeight(t,r)+3&-4)),a):null}onmessage=function(r){if(\"init\"===r.data.action){if(r.data.url)try{importScripts(r.data.url)}catch(e){postMessage({action:\"error\",error:e})}e||(e=BASIS({wasmBinary:r.data.wasmBinary})),null!==e&&e.then((function(e){BASIS=e,e.initializeBasis(),postMessage({action:\"init\"})}))}else if(\"transcode\"===r.data.action){var n=r.data.config,i=r.data.imageData,o=new BASIS.BasisFile(i),a=function(e){for(var t=e.getHasAlpha(),r=e.getNumImages(),n=[],i=0;i<r;i++){for(var o={levels:[]},a=e.getNumLevels(i),s=0;s<a;s++){var l={width:e.getImageWidth(i,s),height:e.getImageHeight(i,s)};o.levels.push(l)}n.push(o)}return{hasAlpha:t,images:n}}(o),s=r.data.ignoreSupportedFormats?null:function(e,t){var r=null;return e.supportedCompressionFormats&&(r=e.supportedCompressionFormats.astc?10:e.supportedCompressionFormats.bc7?6:e.supportedCompressionFormats.s3tc?t.hasAlpha?3:2:e.supportedCompressionFormats.pvrtc?t.hasAlpha?9:8:e.supportedCompressionFormats.etc2?1:e.supportedCompressionFormats.etc1?0:14),r}(r.data.config,a),l=!1;null===s&&(l=!0,s=a.hasAlpha?3:2);var c=!0;o.startTranscoding()||(c=!1);for(var u=[],h=0;h<a.images.length&&c;h++){var d=a.images[h];if(void 0===n.loadSingleImage||n.loadSingleImage===h){var f=d.levels.length;!1===n.loadMipmapLevels&&(f=1);for(var p=0;p<f;p++){var _=d.levels[p],m=t(o,h,p,s,l);if(!m){c=!1;break}_.transcodedPixels=m,u.push(_.transcodedPixels.buffer)}}}o.close(),o.delete(),l&&(s=-1),c?postMessage({action:\"transcode\",success:c,id:r.data.id,fileInfo:a,format:s},u):postMessage({action:\"transcode\",success:c,id:r.data.id})}}}var l,c=function(){},u=function(){};!function(e){e[e.cTFETC1=0]=\"cTFETC1\",e[e.cTFETC2=1]=\"cTFETC2\",e[e.cTFBC1=2]=\"cTFBC1\",e[e.cTFBC3=3]=\"cTFBC3\",e[e.cTFBC4=4]=\"cTFBC4\",e[e.cTFBC5=5]=\"cTFBC5\",e[e.cTFBC7=6]=\"cTFBC7\",e[e.cTFPVRTC1_4_RGB=8]=\"cTFPVRTC1_4_RGB\",e[e.cTFPVRTC1_4_RGBA=9]=\"cTFPVRTC1_4_RGBA\",e[e.cTFASTC_4x4=10]=\"cTFASTC_4x4\",e[e.cTFATC_RGB=11]=\"cTFATC_RGB\",e[e.cTFATC_RGBA_INTERPOLATED_ALPHA=12]=\"cTFATC_RGBA_INTERPOLATED_ALPHA\",e[e.cTFRGBA32=13]=\"cTFRGBA32\",e[e.cTFRGB565=14]=\"cTFRGB565\",e[e.cTFBGR565=15]=\"cTFBGR565\",e[e.cTFRGBA4444=16]=\"cTFRGBA4444\",e[e.cTFFXT1_RGB=17]=\"cTFFXT1_RGB\",e[e.cTFPVRTC2_4_RGB=18]=\"cTFPVRTC2_4_RGB\",e[e.cTFPVRTC2_4_RGBA=19]=\"cTFPVRTC2_4_RGBA\",e[e.cTFETC2_EAC_R11=20]=\"cTFETC2_EAC_R11\",e[e.cTFETC2_EAC_RG11=21]=\"cTFETC2_EAC_RG11\"}(l||(l={}));var h={JSModuleURL:\"\".concat(n.S0._DefaultCdnUrl,\"/basisTranscoder/1/basis_transcoder.js\"),WasmModuleURL:\"\".concat(n.S0._DefaultCdnUrl,\"/basisTranscoder/1/basis_transcoder.wasm\")},d=function(e,t){var r;switch(e){case l.cTFETC1:r=a.Y.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL;break;case l.cTFBC1:r=a.Y.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1;break;case l.cTFBC4:r=a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5;break;case l.cTFASTC_4x4:r=a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4;break;case l.cTFETC2:r=a.Y.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC;break;case l.cTFBC7:r=a.Y.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM}if(void 0===r)throw\"The chosen Basis transcoder format is not currently supported\";return r},f=null,p=null,_=0,m=function(e){p=e},g=function(e,t){var r=e instanceof ArrayBuffer?new Uint8Array(e):e;return new Promise((function(e,i){(f||(f=new Promise((function(e,t){p?e(p):n.S0.LoadFileAsync(n.S0.GetBabylonScriptURL(h.WasmModuleURL)).then((function(r){if(\"function\"!=typeof URL)return t(\"Basis transcoder requires an environment with a URL constructor\");var i=URL.createObjectURL(new Blob([\"(\".concat(s,\")()\")],{type:\"application/javascript\"}));(function(e,t,r){return new Promise((function(i,o){var a=function(t){\"init\"===t.data.action?(e.removeEventListener(\"message\",a),i(e)):\"error\"===t.data.action&&o(t.data.error||\"error initializing worker\")};e.addEventListener(\"message\",a),e.postMessage({action:\"init\",url:r?n.S0.GetBabylonScriptURL(r):void 0,wasmBinary:t},[t])}))})(p=new Worker(i),r,h.JSModuleURL).then(e,t)})).catch(t)}))),f).then((function(){var n=_++,o=function(t){\"transcode\"===t.data.action&&t.data.id===n&&(p.removeEventListener(\"message\",o),t.data.success?e(t.data):i(\"Transcode is not supported on this device\"))};p.addEventListener(\"message\",o);var a=new Uint8Array(r.byteLength);a.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)),p.postMessage({action:\"transcode\",id:n,imageData:a,config:t,ignoreSupportedFormats:!1},[a.buffer])}),(function(e){i(e)}))}))},v=function(e,t){var r,n,i=null===(r=t._gl)||void 0===r?void 0:r.TEXTURE_2D;e.isCube&&(i=null===(n=t._gl)||void 0===n?void 0:n.TEXTURE_CUBE_MAP),t._bindTextureDirectly(i,e,!0)},y=function(e,t){for(var r=e.getEngine(),s=function(s){var c=t.fileInfo.images[s].levels[0];if(e._invertVScale=e.invertY,-1===t.format||t.format===l.cTFRGB565)if(e.type=a.Y.TEXTURETYPE_UNSIGNED_SHORT_5_6_5,e.format=a.Y.TEXTUREFORMAT_RGB,!r._features.basisNeedsPOT||Math.log2(c.width)%1==0&&Math.log2(c.height)%1==0)e._invertVScale=!e.invertY,e.width=c.width+3&-4,e.height=c.height+3&-4,e.samplingMode=a.Y.TEXTURE_LINEAR_LINEAR,v(e,r),r._uploadDataToTextureDirectly(e,new Uint16Array(c.transcodedPixels.buffer),s,0,a.Y.TEXTUREFORMAT_RGB,!0);else{var u=new o.h(r,2);e._invertVScale=e.invertY,u.type=a.Y.TEXTURETYPE_UNSIGNED_SHORT_5_6_5,u.format=a.Y.TEXTUREFORMAT_RGB,u.width=c.width+3&-4,u.height=c.height+3&-4,v(u,r),r._uploadDataToTextureDirectly(u,new Uint16Array(c.transcodedPixels.buffer),s,0,a.Y.TEXTUREFORMAT_RGB,!0),r._rescaleTexture(u,e,r.scenes[0],r._getInternalFormat(a.Y.TEXTUREFORMAT_RGB),(function(){r._releaseTexture(u),v(e,r)}))}else{e.width=c.width,e.height=c.height,e.generateMipMaps=t.fileInfo.images[s].levels.length>1;var h=b.GetInternalFormatFromBasisFormat(t.format,r);e.format=h,v(e,r),t.fileInfo.images[s].levels.forEach((function(t,n){r._uploadCompressedDataToTextureDirectly(e,h,t.width,t.height,t.transcodedPixels,s,n)})),!r._features.basisNeedsPOT||Math.log2(e.width)%1==0&&Math.log2(e.height)%1==0||(n.S0.Warn(\"Loaded .basis texture width and height are not a power of two. Texture wrapping will be set to Texture.CLAMP_ADDRESSMODE as other modes are not supported with non power of two dimensions in webGL 1.\"),e._cachedWrapU=i.g.CLAMP_ADDRESSMODE,e._cachedWrapV=i.g.CLAMP_ADDRESSMODE)}},c=0;c<t.fileInfo.images.length;c++)s(c)},b={JSModuleURL:h.JSModuleURL,WasmModuleURL:h.WasmModuleURL,GetInternalFormatFromBasisFormat:d,TranscodeAsync:g,LoadTextureFromTranscodeResult:y};Object.defineProperty(b,\"JSModuleURL\",{get:function(){return h.JSModuleURL},set:function(e){h.JSModuleURL=e}}),Object.defineProperty(b,\"WasmModuleURL\",{get:function(){return h.WasmModuleURL},set:function(e){h.WasmModuleURL=e}})},75838:(e,t,r)=>{r.d(t,{D8:()=>s,c9:()=>i,lP:()=>o,nh:()=>a});var n=r(78322);function i(e,t,r){void 0===r&&(r=!1);var n=t.width,i=t.height;if(e instanceof Float32Array){for(var o=e.byteLength/e.BYTES_PER_ELEMENT,a=new Uint8Array(o);--o>=0;){var s=e[o];s<0?s=0:s>1&&(s=1),a[o]=255*s}e=a}var l=document.createElement(\"canvas\");l.width=n,l.height=i;var c=l.getContext(\"2d\");if(!c)return null;var u=c.createImageData(n,i);if(u.data.set(e),c.putImageData(u,0,0),r){var h=document.createElement(\"canvas\");h.width=n,h.height=i;var d=h.getContext(\"2d\");return d?(d.translate(0,i),d.scale(1,-1),d.drawImage(l,0,0),h.toDataURL(\"image/png\")):null}return l.toDataURL(\"image/png\")}function o(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0);var n=e.getInternalTexture();if(!n)return null;var o=e._readPixelsSync(t,r);return o?i(o,e.getSize(),n.invertY):null}function a(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=0),(0,n.sH)(this,void 0,void 0,(function(){var o,a;return(0,n.YH)(this,(function(n){switch(n.label){case 0:return(o=e.getInternalTexture())?[4,e.readPixels(t,r)]:[2,null];case 1:return(a=n.sent())?[2,i(a,e.getSize(),o.invertY)]:[2,null]}}))}))}var s={GenerateBase64StringFromPixelData:i,GenerateBase64StringFromTexture:o,GenerateBase64StringFromTextureAsync:a}},49611:(e,t,r)=>{r.d(t,{D:()=>_});var n=r(48810),i=r(81152),o=r(7164),a=r(75768),s=r(35877),l=(r(19966),r(71974),131072),c=131072;function u(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var h=u(\"DXT1\"),d=u(\"DXT3\"),f=u(\"DXT5\"),p=u(\"DX10\"),_=function(){function e(){}return e.GetDDSInfo=function(e){var t=new Int32Array(e.buffer,e.byteOffset,31),r=new Int32Array(e.buffer,e.byteOffset,35),n=1;t[2]&l&&(n=Math.max(1,t[7]));var o=t[21],a=o===p?r[32]:0,s=i.Y.TEXTURETYPE_UNSIGNED_INT;switch(o){case 113:s=i.Y.TEXTURETYPE_HALF_FLOAT;break;case 116:s=i.Y.TEXTURETYPE_FLOAT;break;case p:if(10===a){s=i.Y.TEXTURETYPE_HALF_FLOAT;break}if(2===a){s=i.Y.TEXTURETYPE_FLOAT;break}}return{width:t[4],height:t[3],mipmapCount:n,isFourCC:!(4&~t[20]),isRGB:!(64&~t[20]),isLuminance:(t[20]&c)===c,isCube:!(512&~t[28]),isCompressed:o===h||o===d||o===f,dxgiFormat:a,textureType:s}},e._GetHalfFloatAsFloatRGBAArrayBuffer=function(t,r,n,i,o,a){for(var l=new Float32Array(i),c=new Uint16Array(o,n),u=0,h=0;h<r;h++)for(var d=0;d<t;d++){var f=4*(d+h*t);l[u]=(0,s.SX)(c[f]),l[u+1]=(0,s.SX)(c[f+1]),l[u+2]=(0,s.SX)(c[f+2]),e.StoreLODInAlphaChannel?l[u+3]=a:l[u+3]=(0,s.SX)(c[f+3]),u+=4}return l},e._GetHalfFloatRGBAArrayBuffer=function(t,r,n,i,o,a){if(e.StoreLODInAlphaChannel){for(var l=new Uint16Array(i),c=new Uint16Array(o,n),u=0,h=0;h<r;h++)for(var d=0;d<t;d++){var f=4*(d+h*t);l[u]=c[f],l[u+1]=c[f+1],l[u+2]=c[f+2],l[u+3]=(0,s.LZ)(a),u+=4}return l}return new Uint16Array(o,n,i)},e._GetFloatRGBAArrayBuffer=function(t,r,n,i,o,a){if(e.StoreLODInAlphaChannel){for(var s=new Float32Array(i),l=new Float32Array(o,n),c=0,u=0;u<r;u++)for(var h=0;h<t;h++){var d=4*(h+u*t);s[c]=l[d],s[c+1]=l[d+1],s[c+2]=l[d+2],s[c+3]=a,c+=4}return s}return new Float32Array(o,n,i)},e._GetFloatAsHalfFloatRGBAArrayBuffer=function(t,r,n,i,o,a){for(var l=new Uint16Array(i),c=new Float32Array(o,n),u=0,h=0;h<r;h++)for(var d=0;d<t;d++)l[u]=(0,s.LZ)(c[u]),l[u+1]=(0,s.LZ)(c[u+1]),l[u+2]=(0,s.LZ)(c[u+2]),e.StoreLODInAlphaChannel?l[u+3]=(0,s.LZ)(a):l[u+3]=(0,s.LZ)(c[u+3]),u+=4;return l},e._GetFloatAsUIntRGBAArrayBuffer=function(t,r,i,o,a,s){for(var l=new Uint8Array(o),c=new Float32Array(a,i),u=0,h=0;h<r;h++)for(var d=0;d<t;d++){var f=4*(d+h*t);l[u]=255*(0,n.Clamp)(c[f]),l[u+1]=255*(0,n.Clamp)(c[f+1]),l[u+2]=255*(0,n.Clamp)(c[f+2]),e.StoreLODInAlphaChannel?l[u+3]=s:l[u+3]=255*(0,n.Clamp)(c[f+3]),u+=4}return l},e._GetHalfFloatAsUIntRGBAArrayBuffer=function(t,r,i,o,a,l){for(var c=new Uint8Array(o),u=new Uint16Array(a,i),h=0,d=0;d<r;d++)for(var f=0;f<t;f++){var p=4*(f+d*t);c[h]=255*(0,n.Clamp)((0,s.SX)(u[p])),c[h+1]=255*(0,n.Clamp)((0,s.SX)(u[p+1])),c[h+2]=255*(0,n.Clamp)((0,s.SX)(u[p+2])),e.StoreLODInAlphaChannel?c[h+3]=l:c[h+3]=255*(0,n.Clamp)((0,s.SX)(u[p+3])),h+=4}return c},e._GetRGBAArrayBuffer=function(e,t,r,n,i,o,a,s,l){for(var c=new Uint8Array(n),u=new Uint8Array(i,r),h=0,d=0;d<t;d++)for(var f=0;f<e;f++){var p=4*(f+d*e);c[h]=u[p+o],c[h+1]=u[p+a],c[h+2]=u[p+s],c[h+3]=u[p+l],h+=4}return c},e._ExtractLongWordOrder=function(t){return 0===t||255===t||-16777216===t?0:1+e._ExtractLongWordOrder(t>>8)},e._GetRGBArrayBuffer=function(e,t,r,n,i,o,a,s){for(var l=new Uint8Array(n),c=new Uint8Array(i,r),u=0,h=0;h<t;h++)for(var d=0;d<e;d++){var f=3*(d+h*e);l[u]=c[f+o],l[u+1]=c[f+a],l[u+2]=c[f+s],u+=3}return l},e._GetLuminanceArrayBuffer=function(e,t,r,n,i){for(var o=new Uint8Array(n),a=new Uint8Array(i,r),s=0,l=0;l<t;l++)for(var c=0;c<e;c++){var u=c+l*e;o[s]=a[u],s++}return o},e.UploadDDSLevels=function(t,r,n,s,c,u,_,m,g){void 0===_&&(_=-1),void 0===g&&(g=!0);var v=null;s.sphericalPolynomial&&(v=[]);var y=!!t.getCaps().s3tc;r.generateMipMaps=c;var b,S,T,E,x,P,C,A=new Int32Array(n.buffer,n.byteOffset,31),R=0,I=0,M=1;if(542327876===A[0])if(s.isFourCC||s.isRGB||s.isLuminance)if(!s.isCompressed||y){var O=A[22];E=A[1]+4;var D,N=!1;if(s.isFourCC)switch(b=A[21]){case h:M=8,I=i.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1;break;case d:M=16,I=i.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3;break;case f:M=16,I=i.Y.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5;break;case 113:N=!0,O=64;break;case 116:N=!0,O=128;break;case p:E+=20;var L=!1;switch(s.dxgiFormat){case 10:N=!0,O=64,L=!0;break;case 2:N=!0,O=128,L=!0;break;case 88:s.isRGB=!0,s.isFourCC=!1,O=32,L=!0}if(L)break;default:return void o.V.Error([\"Unsupported FourCC code:\",(D=b,String.fromCharCode(255&D,D>>8&255,D>>16&255,D>>24&255))])}var F=e._ExtractLongWordOrder(A[23]),w=e._ExtractLongWordOrder(A[24]),B=e._ExtractLongWordOrder(A[25]),V=e._ExtractLongWordOrder(A[26]);N&&(I=t._getRGBABufferInternalSizedFormat(s.textureType)),P=1,A[2]&l&&!1!==c&&(P=Math.max(1,A[7]));for(var U=m||0,G=t.getCaps(),k=U;k<u;k++){for(S=A[4],T=A[3],C=0;C<P;++C){if(-1===_||_===C){var z=-1===_?C:0;if(!s.isCompressed&&s.isFourCC){r.format=i.Y.TEXTUREFORMAT_RGBA,R=S*T*4;var W=null;if(t._badOS||t._badDesktopOS||!G.textureHalfFloat&&!G.textureFloat)128===O?(W=e._GetFloatAsUIntRGBAArrayBuffer(S,T,n.byteOffset+E,R,n.buffer,z),v&&0==z&&v.push(e._GetFloatRGBAArrayBuffer(S,T,n.byteOffset+E,R,n.buffer,z))):64===O&&(W=e._GetHalfFloatAsUIntRGBAArrayBuffer(S,T,n.byteOffset+E,R,n.buffer,z),v&&0==z&&v.push(e._GetHalfFloatAsFloatRGBAArrayBuffer(S,T,n.byteOffset+E,R,n.buffer,z))),r.type=i.Y.TEXTURETYPE_UNSIGNED_INT;else{var Y=G.textureFloat&&(g&&G.textureFloatLinearFiltering||!g),H=G.textureHalfFloat&&(g&&G.textureHalfFloatLinearFiltering||!g),X=(128===O||64===O&&!H)&&Y?i.Y.TEXTURETYPE_FLOAT:(64===O||128===O&&!Y)&&H?i.Y.TEXTURETYPE_HALF_FLOAT:i.Y.TEXTURETYPE_UNSIGNED_BYTE,j=void 0,q=null;if(128===O)switch(X){case i.Y.TEXTURETYPE_FLOAT:j=e._GetFloatRGBAArrayBuffer,q=null;break;case i.Y.TEXTURETYPE_HALF_FLOAT:j=e._GetFloatAsHalfFloatRGBAArrayBuffer,q=e._GetFloatRGBAArrayBuffer;break;case i.Y.TEXTURETYPE_UNSIGNED_BYTE:j=e._GetFloatAsUIntRGBAArrayBuffer,q=e._GetFloatRGBAArrayBuffer}else switch(X){case i.Y.TEXTURETYPE_FLOAT:j=e._GetHalfFloatAsFloatRGBAArrayBuffer,q=null;break;case i.Y.TEXTURETYPE_HALF_FLOAT:j=e._GetHalfFloatRGBAArrayBuffer,q=e._GetHalfFloatAsFloatRGBAArrayBuffer;break;case i.Y.TEXTURETYPE_UNSIGNED_BYTE:j=e._GetHalfFloatAsUIntRGBAArrayBuffer,q=e._GetHalfFloatAsFloatRGBAArrayBuffer}r.type=X,W=j(S,T,n.byteOffset+E,R,n.buffer,z),v&&0==z&&v.push(q?q(S,T,n.byteOffset+E,R,n.buffer,z):W)}W&&t._uploadDataToTextureDirectly(r,W,k,z)}else if(s.isRGB)r.type=i.Y.TEXTURETYPE_UNSIGNED_INT,24===O?(r.format=i.Y.TEXTUREFORMAT_RGB,R=S*T*3,x=e._GetRGBArrayBuffer(S,T,n.byteOffset+E,R,n.buffer,F,w,B),t._uploadDataToTextureDirectly(r,x,k,z)):(r.format=i.Y.TEXTUREFORMAT_RGBA,R=S*T*4,x=e._GetRGBAArrayBuffer(S,T,n.byteOffset+E,R,n.buffer,F,w,B,V),t._uploadDataToTextureDirectly(r,x,k,z));else if(s.isLuminance){var K=t._getUnpackAlignement(),Q=S;R=Math.floor((S+K-1)/K)*K*(T-1)+Q,x=e._GetLuminanceArrayBuffer(S,T,n.byteOffset+E,R,n.buffer),r.format=i.Y.TEXTUREFORMAT_LUMINANCE,r.type=i.Y.TEXTURETYPE_UNSIGNED_INT,t._uploadDataToTextureDirectly(r,x,k,z)}else R=Math.max(4,S)/4*Math.max(4,T)/4*M,x=new Uint8Array(n.buffer,n.byteOffset+E,R),r.type=i.Y.TEXTURETYPE_UNSIGNED_INT,t._uploadCompressedDataToTextureDirectly(r,I,S,T,x,k,z)}E+=O?S*T*(O/8):R,S*=.5,T*=.5,S=Math.max(1,S),T=Math.max(1,T)}if(void 0!==m)break}v&&v.length>0?s.sphericalPolynomial=a.d.ConvertCubeMapToSphericalPolynomial({size:A[4],right:v[0],left:v[1],up:v[2],down:v[3],front:v[4],back:v[5],format:i.Y.TEXTUREFORMAT_RGBA,type:i.Y.TEXTURETYPE_FLOAT,gammaSpace:!1}):s.sphericalPolynomial=void 0}else o.V.Error(\"Compressed textures are not supported on this platform.\");else o.V.Error(\"Unsupported format, must contain a FourCC, RGB or LUMINANCE code\");else o.V.Error(\"Invalid magic number in DDS header\")},e.StoreLODInAlphaChannel=!1,e}()},36729:(e,t,r)=>{r.d(t,{B:()=>o,K:()=>a});var n={},i={};function o(e){var t=e.getClassName();return i[t]||(i[t]={}),i[t]}function a(e){var t=e.getClassName();if(n[t])return n[t];n[t]={};for(var r=n[t],o=e,a=t;a;){var s=i[a];for(var l in s)r[l]=s[l];var c=void 0,u=!1;do{if(!(c=Object.getPrototypeOf(o)).getClassName){u=!0;break}if(c.getClassName()!==a)break;o=c}while(c);if(u)break;a=c.getClassName(),o=c}return r}},12028:(e,t,r)=>{r.d(t,{p:()=>c});var n=r(41190),i=r(31985),o=r(64726),a=r(8046),s=r(36729),l=function(e,t,r,n){void 0===n&&(n={});var o=e();i.Y&&i.Y.HasTags(t)&&i.Y.AddTagsTo(o,i.Y.GetTags(t,!0));var a=(0,s.K)(o),l={};for(var u in a){var h=a[u],d=t[u],f=h.type;if(null!=d&&(\"uniqueId\"!==u||c.AllowLoadingUniqueId))switch(f){case 0:case 6:case 11:o[u]=d;break;case 1:n.cloneTexturesOnlyOnce&&l[d.uniqueId]?o[u]=l[d.uniqueId]:(o[u]=r||d.isRenderTarget?d:d.clone(),l[d.uniqueId]=o[u]);break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:o[u]=r?d:d.clone()}}return o},c=function(){function e(){}return e.AppendSerializedAnimations=function(e,t){if(e.animations){t.animations=[];for(var r=0;r<e.animations.length;r++){var n=e.animations[r];t.animations.push(n.serialize())}}},e.Serialize=function(t,r){r||(r={}),i.Y&&(r.tags=i.Y.GetTags(t));var n=(0,s.K)(t);for(var o in n){var a=n[o],l=a.sourceName||o,c=a.type,u=t[o];if(null!=u&&(\"uniqueId\"!==o||e.AllowLoadingUniqueId))switch(c){case 0:r[l]=u;break;case 1:case 3:case 7:case 9:r[l]=u.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:r[l]=u.asArray();break;case 6:case 11:r[l]=u.id}}return r},e.ParseProperties=function(t,r,n,i){i||(i=\"\");var l=(0,s.K)(r);for(var c in l){var u=l[c],h=t[u.sourceName||c],d=u.type;if(null!=h&&(\"uniqueId\"!==c||e.AllowLoadingUniqueId)){var f=r;switch(d){case 0:f[c]=h;break;case 1:n&&(f[c]=e._TextureParser(h,n,i));break;case 2:f[c]=o.v9.FromArray(h);break;case 3:f[c]=e._FresnelParametersParser(h);break;case 4:f[c]=a.I9.FromArray(h);break;case 5:f[c]=a.Pq.FromArray(h);break;case 6:n&&(f[c]=n.getLastMeshById(h));break;case 7:f[c]=e._ColorCurvesParser(h);break;case 8:f[c]=o.ov.FromArray(h);break;case 9:f[c]=e._ImageProcessingConfigurationParser(h);break;case 10:f[c]=a.PT.FromArray(h);break;case 11:n&&(f[c]=n.getCameraById(h));break;case 12:f[c]=a.uq.FromArray(h)}}}},e.Parse=function(t,r,n,o){void 0===o&&(o=null);var a=t();return i.Y&&i.Y.AddTagsTo(a,r.tags),e.ParseProperties(r,a,n,o),a},e.Clone=function(e,t,r){return void 0===r&&(r={}),l(e,t,!1,r)},e.Instanciate=function(e,t){return l(e,t,!0)},e.AllowLoadingUniqueId=!1,e._ImageProcessingConfigurationParser=function(e){throw(0,n.n)(\"ImageProcessingConfiguration\")},e._FresnelParametersParser=function(e){throw(0,n.n)(\"FresnelParameters\")},e._ColorCurvesParser=function(e){throw(0,n.n)(\"ColorCurves\")},e._TextureParser=function(e,t,r){throw(0,n.n)(\"Texture\")},e}()},6174:(e,t,r)=>{r.d(t,{$z:()=>o,Cx:()=>y,GG:()=>g,P_:()=>h,WM:()=>u,Y9:()=>c,bR:()=>m,fW:()=>v,jT:()=>l,lK:()=>a,n1:()=>_,qK:()=>p,uM:()=>s,wL:()=>f,xG:()=>d});var n=r(36729);function i(e,t){return function(r,i){var o=(0,n.B)(r);o[i]||(o[i]={type:e,sourceName:t})}}function o(e,t){return void 0===t&&(t=null),function(e,t){return void 0===t&&(t=null),function(r,n){var i=t||\"_\"+n;Object.defineProperty(r,n,{get:function(){return this[i]},set:function(t){\"function\"==typeof this.equals&&this.equals(t)||this[i]!==t&&(this[i]=t,r[e].apply(this))},enumerable:!0,configurable:!0})}}(e,t)}function a(e){return i(0,e)}function s(e){return i(1,e)}function l(e){return i(2,e)}function c(e){return i(3,e)}function u(e){return i(4,e)}function h(e){return i(5,e)}function d(e){return i(6,e)}function f(e){return i(7,e)}function p(e){return i(8,e)}function _(e){return i(9,e)}function m(e){return i(10,e)}function g(e){return i(12,e)}function v(e){return i(11,e)}function y(e,t,r,n){var i=r.value;r.value=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=i;if(\"undefined\"!=typeof _native&&_native[t]){var s=_native[t];a=n?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)?s.apply(void 0,e):i.apply(void 0,e)}:s}return e[t]=a,a.apply(void 0,r)}}y.filter=function(e){return function(t,r,n){return y(t,r,n,e)}}},44576:(e,t,r)=>{r.d(t,{r:()=>a});var n=r(78322),i=r(7164),o=function(e,t,r){return e?e.getClassName&&\"Mesh\"===e.getClassName()?null:!e.getClassName||\"SubMesh\"!==e.getClassName()&&\"PhysicsBody\"!==e.getClassName()?e.clone?e.clone():Array.isArray(e)?e.slice():r&&\"object\"==typeof e?(0,n.Cl)({},e):null:e.clone(t):null},a=function(){function e(){}return e.DeepCopy=function(e,t,r,n,a){void 0===a&&(a=!1);for(var s=function(e){var t=[];do{Object.getOwnPropertyNames(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)}))}while(e=Object.getPrototypeOf(e));return t}(e),l=0,c=s;l<c.length;l++){var u=c[l];if((\"_\"!==u[0]||n&&-1!==n.indexOf(u))&&!(u.endsWith(\"Observable\")||r&&-1!==r.indexOf(u))){var h=e[u],d=typeof h;if(\"function\"!==d)try{if(\"object\"===d)if(h instanceof Uint8Array)t[u]=Uint8Array.from(h);else if(h instanceof Array){if(t[u]=[],h.length>0)if(\"object\"==typeof h[0])for(var f=0;f<h.length;f++){var p=o(h[f],t,a);-1===t[u].indexOf(p)&&t[u].push(p)}else t[u]=h.slice(0)}else t[u]=o(h,t,a);else t[u]=h}catch(e){i.V.Warn(e.message)}}}},e}()},41190:(e,t,r)=>{r.d(t,{n:()=>i});var n={};function i(e,t){if(void 0===t&&(t=!1),!t||!n[e])return n[e]=!0,\"\".concat(e,\" needs to be imported before as it contains a side-effect required by your code.\")}},5153:(e,t,r)=>{function n(){return\"undefined\"!=typeof window}function i(){return\"undefined\"!=typeof navigator}function o(){return\"undefined\"!=typeof document}function a(e){for(var t=\"\",r=e.firstChild;r;)3===r.nodeType&&(t+=r.textContent),r=r.nextSibling;return t}r.d(t,{Az:()=>s,BA:()=>n,Nf:()=>o,XD:()=>i,Zl:()=>a});var s={IsWindowObjectExist:n,IsNavigatorAvailable:i,IsDocumentAvailable:o,GetDOMTextContent:a}},24687:(e,t,r)=>{r.d(t,{RJ:()=>p,dq:()=>f,e9:()=>m,yp:()=>d});var n,i=r(78322),o=r(96352),a=r(81152),s=r(93540),l=r(44957),c=r(56017),u=r(48810),h=r(66614);function d(e,t,r,n,o,a,s){return void 0===o&&(o=\"image/png\"),(0,i.sH)(this,void 0,void 0,(function(){var l,c;return(0,i.YH)(this,(function(i){switch(i.label){case 0:return[4,r.readPixels(0,0,e,t)];case 1:return l=i.sent(),c=new Uint8Array(l.buffer),p(e,t,c,n,o,a,!0,void 0,s),[2]}}))}))}function f(e,t,r,n,i,o,a,s){return void 0===n&&(n=\"image/png\"),void 0===o&&(o=!1),void 0===a&&(a=!1),new Promise((function(l){p(e,t,r,(function(e){return l(e)}),n,i,o,a,s)}))}function p(e,t,r,i,d,f,p,m,g){void 0===d&&(d=\"image/png\"),void 0===p&&(p=!1),void 0===m&&(m=!1);var v=function(){if(!n){var e=void 0,t=null,r={preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};try{e=new OffscreenCanvas(100,100),t=new o.w(e,!1,r)}catch(n){e=document.createElement(\"canvas\"),t=new o.w(e,!1,r)}h.q.Instances.pop(),h.q.OnEnginesDisposedObservable.add((function(e){t&&e!==t&&!t.isDisposed&&0===h.q.Instances.length&&_()})),t.getCaps().parallelShaderCompile=void 0;var i=new s.J(t),a=new s.$({engine:t,name:c.passPixelShader.name,fragmentShader:c.passPixelShader.shader,samplerNames:[\"textureSampler\"]});n={canvas:e,engine:t,renderer:i,wrapper:a}}return n}();if(v.engine.setSize(e,t,!0),r instanceof Float32Array){for(var y=new Uint8Array(r.length),b=r.length;b--;){var S=r[b];y[b]=Math.round(255*(0,u.Clamp)(S))}r=y}var T=v.engine.createRawTexture(r,e,t,a.Y.TEXTUREFORMAT_RGBA,!1,!p,a.Y.TEXTURE_NEAREST_NEAREST);v.renderer.setViewport(),v.renderer.applyEffectWrapper(v.wrapper),v.wrapper.effect._bindTexture(\"textureSampler\",T),v.renderer.draw(),m?l.S0.ToBlob(v.canvas,(function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;i&&i(t)},t.readAsArrayBuffer(e)}),d,g):l.S0.EncodeScreenshotCanvasData(v.canvas,i,d,f,g),T.dispose()}function _(){n&&(n.wrapper.dispose(),n.renderer.dispose(),n.engine.dispose()),n=null}var m={DumpData:p,DumpDataAsync:f,DumpFramebuffer:d,Dispose:_};l.S0.DumpData=p,l.S0.DumpDataAsync=f,l.S0.DumpFramebuffer=d},88309:(e,t,r)=>{r.d(t,{$h:()=>E,Hx:()=>S,RZ:()=>b,bv:()=>C,cU:()=>y,gW:()=>R,o5:()=>x,ow:()=>A,qY:()=>I});var n=r(78322),i=r(44957),o=r(8046),a=r(48810),s=r(51428),l=r(19133),c=r(28081),u=r(81152),h=r(76170),d=r(30622),f=r(7164),p=r(97411),_=(r(8864),r(82345),r(39813),r(24687)),m=\"image/png\",g=2,v=[134,22,135,150,246,214,150,54];function y(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),r=0,n=0;n<v.length;n++)if(t.getUint8(r++)!==v[n])return f.V.Error(\"Not a babylon environment map\"),null;for(var i=\"\",o=0;o=t.getUint8(r++);)i+=String.fromCharCode(o);var a=JSON.parse(i);return(a=b(a)).specular&&(a.specular.specularDataPosition=r,a.specular.lodGenerationScale=a.specular.lodGenerationScale||.8),a}function b(e){if(e.version>g)throw new Error('Unsupported babylon environment map version \"'.concat(e.version,'\". Latest supported version is \"').concat(g,'\".'));return 2===e.version?e:e=(0,n.Cl)((0,n.Cl)({},e),{version:2,imageType:m})}function S(e,t){var r,i;return void 0===t&&(t={}),(0,n.sH)(this,void 0,void 0,(function(){var o,s,l,c,d,f,y,b,S,E,x,P,C,A,R,I,M,O,D,N,L,F,w,B,V,U,G,k,z,W,Y,H,X;return(0,n.YH)(this,(function(n){switch(n.label){case 0:if(!(o=e.getInternalTexture()))return[2,Promise.reject(\"The cube texture is invalid.\")];if(s=null!==(r=t.imageType)&&void 0!==r?r:m,l=o.getEngine(),e.textureType!==u.Y.TEXTURETYPE_HALF_FLOAT&&e.textureType!==u.Y.TEXTURETYPE_FLOAT&&e.textureType!==u.Y.TEXTURETYPE_UNSIGNED_BYTE&&e.textureType!==u.Y.TEXTURETYPE_UNSIGNED_INT&&e.textureType!==u.Y.TEXTURETYPE_UNSIGNED_INTEGER&&-1!==e.textureType)return[2,Promise.reject(\"The cube texture should allow HDR (Full Float or Half Float).\")];if(c=u.Y.TEXTURETYPE_FLOAT,!l.getCaps().textureFloatRender&&(c=u.Y.TEXTURETYPE_HALF_FLOAT,!l.getCaps().textureHalfFloatRender))return[2,Promise.reject(\"Env texture can only be created when the browser supports half float or full float rendering.\")];e.sphericalPolynomial,d=null===(i=e.getInternalTexture())||void 0===i?void 0:i._sphericalPolynomialPromise,f=o.width,y=new h.Z(l),b={},l.flushFramebuffer(),S=(0,a.ILog2)(o.width),Y=0,n.label=1;case 1:if(!(Y<=S))return[3,9];E=Math.pow(2,S-Y),H=0,n.label=2;case 2:return H<6?[4,e.readPixels(H,Y,void 0,!1)]:[3,8];case 3:if((x=n.sent())&&x.byteLength===x.length){for(P=new Float32Array(4*x.byteLength),C=0;C<x.byteLength;C++)P[C]=x[C]/255,P[C]=Math.pow(P[C],2.2);x=P}else if(x&&e.gammaSpace)for(A=x,R=0;R<A.length;R++)A[R]=Math.pow(A[R],2.2);return I=l.createRawTexture(x,E,E,u.Y.TEXTUREFORMAT_RGBA,!1,!0,u.Y.TEXTURE_NEAREST_SAMPLINGMODE,null,c),[4,p.G.EncodeTextureToRGBD(I,y,c)];case 4:return n.sent(),[4,l._readTexturePixels(I,E,E)];case 5:return M=n.sent(),[4,(0,_.dq)(E,E,M,s,void 0,!1,!0,t.imageQuality)];case 6:O=n.sent(),b[6*Y+H]=O,I.dispose(),n.label=7;case 7:return H++,[3,2];case 8:return Y++,[3,1];case 9:return y.dispose(),d?[4,d]:[3,11];case 10:n.sent(),n.label=11;case 11:for(D={version:g,width:f,imageType:s,irradiance:T(e),specular:{mipmaps:[],lodGenerationScale:e.lodGenerationScale}},N=0,Y=0;Y<=S;Y++)for(H=0;H<6;H++)L=b[6*Y+H].byteLength,D.specular.mipmaps.push({length:L,position:N}),N+=L;for(F=JSON.stringify(D),w=new ArrayBuffer(F.length+1),B=new Uint8Array(w),Y=0,V=F.length;Y<V;Y++)B[Y]=F.charCodeAt(Y);for(B[F.length]=0,U=v.length+N+w.byteLength,G=new ArrayBuffer(U),k=new Uint8Array(G),z=new DataView(G),W=0,Y=0;Y<v.length;Y++)z.setUint8(W++,v[Y]);for(k.set(new Uint8Array(w),W),W+=w.byteLength,Y=0;Y<=S;Y++)for(H=0;H<6;H++)X=b[6*Y+H],k.set(new Uint8Array(X),W),W+=X.byteLength;return[2,G]}}))}))}function T(e){var t=e.sphericalPolynomial;return null==t?null:{x:[t.x.x,t.x.y,t.x.z],y:[t.y.x,t.y.y,t.y.z],z:[t.z.x,t.z.y,t.z.z],xx:[t.xx.x,t.xx.y,t.xx.z],yy:[t.yy.x,t.yy.y,t.yy.z],zz:[t.zz.x,t.zz.y,t.zz.z],yz:[t.yz.x,t.yz.y,t.yz.z],zx:[t.zx.x,t.zx.y,t.zx.z],xy:[t.xy.x,t.xy.y,t.xy.z]}}function E(e,t){var r=(t=b(t)).specular,n=Math.log2(t.width);if(n=Math.round(n)+1,r.mipmaps.length!==6*n)throw new Error('Unsupported specular mipmaps number \"'.concat(r.mipmaps.length,'\"'));for(var i=new Array(n),o=0;o<n;o++){i[o]=new Array(6);for(var a=0;a<6;a++){var s=r.mipmaps[6*o+a];i[o][a]=new Uint8Array(e.buffer,e.byteOffset+r.specularDataPosition+s.position,s.length)}}return i}function x(e,t,r){var n=(r=b(r)).specular;return n?(e._lodGenerationScale=n.lodGenerationScale,C(e,E(t,r),r.imageType)):Promise.resolve()}function P(e,t,r,n,i,o,a,s,l,c,h){return new Promise((function(d,f){if(r){var p=t.createTexture(null,!0,!0,null,u.Y.TEXTURE_NEAREST_SAMPLINGMODE,null,(function(e){f(e)}),e);null==n||n.onEffectCreatedObservable.addOnce((function(r){r.executeWhenCompiled((function(){n.externalTextureSamplerBinding=!0,n.onApply=function(r){r._bindTexture(\"textureSampler\",p),r.setFloat2(\"scale\",1,t._features.needsInvertingBitmap&&e instanceof ImageBitmap?-1:1)},t.scenes.length&&(t.scenes[0].postProcessManager.directRender([n],c,!0,o,a),t.restoreDefaultFramebuffer(),p.dispose(),URL.revokeObjectURL(i),d())}))}))}else{if(t._uploadImageToTexture(h,e,o,a),s){var _=l[a];_&&t._uploadImageToTexture(_._texture,e,o,0)}d()}}))}function C(e,t,o){return void 0===o&&(o=m),(0,n.sH)(this,void 0,void 0,(function(){var s,h,f,p,_,m,g,v,y,b,S,T,E,x,C,A,R,I,M,O,D,N,L,F;return(0,n.YH)(this,(function(n){switch(n.label){case 0:if(!i.S0.IsExponentOfTwo(e.width))throw new Error(\"Texture size must be a power of two\");return s=(0,a.ILog2)(e.width)+1,h=e.getEngine(),f=!1,p=!1,_=null,m=null,g=null,v=h.getCaps(),e.format=u.Y.TEXTUREFORMAT_RGBA,e.type=u.Y.TEXTURETYPE_UNSIGNED_INT,e.generateMipMaps=!0,e._cachedAnisotropicFilteringLevel=null,h.updateTextureSamplingMode(u.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,e),v.textureLOD?h._features.supportRenderAndCopyToLodForFloatTextures?v.textureHalfFloatRender&&v.textureHalfFloatLinearFiltering?(f=!0,e.type=u.Y.TEXTURETYPE_HALF_FLOAT):v.textureFloatRender&&v.textureFloatLinearFiltering&&(f=!0,e.type=u.Y.TEXTURETYPE_FLOAT):f=!1:(f=!1,p=!0,g={}),y=0,f?h.isWebGPU?(y=1,[4,Promise.resolve().then(r.bind(r,37494))]):[3,2]:[3,5];case 1:return n.sent(),[3,4];case 2:return[4,Promise.resolve().then(r.bind(r,32407))];case 3:n.sent(),n.label=4;case 4:return _=new d.w(\"rgbdDecode\",\"rgbdDecode\",null,null,1,null,u.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,h,!1,void 0,e.type,void 0,null,!1,void 0,y),e._isRGBD=!1,e.invertY=!1,m=h.createRenderTargetCubeTexture(e.width,{generateDepthBuffer:!1,generateMipMaps:!0,generateStencilBuffer:!1,samplingMode:u.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,type:e.type,format:u.Y.TEXTUREFORMAT_RGBA}),[3,6];case 5:if(e._isRGBD=!0,e.invertY=!0,p)for(b=e._lodGenerationScale,S=e._lodGenerationOffset,L=0;L<3;L++)switch(x=(T=S)+((E=(s-1)*b+S)-T)*(1-L/2),C=Math.round(Math.min(Math.max(x,0),E)),(A=new l.h(h,2)).isCube=!0,A.invertY=!0,A.generateMipMaps=!1,h.updateTextureSamplingMode(u.Y.TEXTURE_LINEAR_LINEAR,A),(R=new c.t(null))._isCube=!0,R._texture=A,g[C]=R,L){case 0:e._lodTextureLow=R;break;case 1:e._lodTextureMid=R;break;case 2:e._lodTextureHigh=R}n.label=6;case 6:for(I=[],M=function(r){for(var n=function(n){var i=t[r][n],a=new Blob([i],{type:o}),s=URL.createObjectURL(a),l=void 0;if(h._features.forceBitmapOverHTMLImageElement)l=h.createImageBitmap(a,{premultiplyAlpha:\"none\"}).then((function(t){return P(t,h,f,_,s,n,r,p,g,m,e)}));else{var c=new Image;c.src=s,l=new Promise((function(t,i){c.onload=function(){P(c,h,f,_,s,n,r,p,g,m,e).then((function(){return t()})).catch((function(e){i(e)}))},c.onerror=function(e){i(e)}}))}I.push(l)},i=0;i<6;i++)n(i)},L=0;L<t.length;L++)M(L);if(t.length<s){switch(O=void 0,D=Math.pow(2,s-1-t.length),N=D*D*4,e.type){case u.Y.TEXTURETYPE_UNSIGNED_INT:O=new Uint8Array(N);break;case u.Y.TEXTURETYPE_HALF_FLOAT:O=new Uint16Array(N);break;case u.Y.TEXTURETYPE_FLOAT:O=new Float32Array(N)}for(L=t.length;L<s;L++)for(F=0;F<6;F++)h._uploadArrayBufferViewToTexture(e,O,F,L)}return[2,Promise.all(I).then((function(){m&&(h._releaseTexture(e),m._swapAndDie(e)),_&&_.dispose(),p&&(e._lodTextureHigh&&e._lodTextureHigh._texture&&(e._lodTextureHigh._texture.isReady=!0),e._lodTextureMid&&e._lodTextureMid._texture&&(e._lodTextureMid._texture.isReady=!0),e._lodTextureLow&&e._lodTextureLow._texture&&(e._lodTextureLow._texture.isReady=!0))}))]}}))}))}function A(e,t){var r=(t=b(t)).irradiance;if(r){var n=new s.Q;o.Pq.FromArrayToRef(r.x,0,n.x),o.Pq.FromArrayToRef(r.y,0,n.y),o.Pq.FromArrayToRef(r.z,0,n.z),o.Pq.FromArrayToRef(r.xx,0,n.xx),o.Pq.FromArrayToRef(r.yy,0,n.yy),o.Pq.FromArrayToRef(r.zz,0,n.zz),o.Pq.FromArrayToRef(r.yz,0,n.yz),o.Pq.FromArrayToRef(r.zx,0,n.zx),o.Pq.FromArrayToRef(r.xy,0,n.xy),e._sphericalPolynomial=n}}function R(e,t,r,n,i){var o=C(e.getEngine().createRawCubeTexture(null,e.width,e.format,e.type,e.generateMipMaps,e.invertY,e.samplingMode,e._compression),t).then((function(){return e}));return e.onRebuildCallback=function(e){return{proxy:o,isReady:!0,isAsync:!0}},e._source=13,e._bufferViewArrayArray=t,e._lodGenerationScale=n,e._lodGenerationOffset=i,e._sphericalPolynomial=r,C(e,t).then((function(){return e.isReady=!0,e}))}var I={GetEnvInfo:y,CreateEnvTextureAsync:S,CreateImageDataArrayBufferViews:E,UploadEnvLevelsAsync:x,UploadLevelsAsync:C,UploadEnvSpherical:A}},91016:(e,t,r)=>{r.d(t,{Cf:()=>i,bu:()=>a,tG:()=>o});var n=r(78322),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.C6)(t,e),t._setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t}(Error),o={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002},a=function(e){function t(r,n,o){var a=e.call(this,r)||this;return a.errorCode=n,a.innerError=o,a.name=\"RuntimeError\",i._setPrototypeOf(a,t.prototype),a}return(0,n.C6)(t,e),t}(i)},17347:(e,t,r)=>{r.d(t,{M1:()=>T,Mi:()=>y,NJ:()=>P,VB:()=>b,W$:()=>x,ZP:()=>M,dy:()=>N,eC:()=>S,f2:()=>I,hX:()=>v,my:()=>R,qc:()=>E,rh:()=>L,rz:()=>O,sh:()=>A,wS:()=>D,zU:()=>C});var n=r(78322),i=r(46799),o=r(5153),a=r(66377),s=r(23148),l=r(49449),c=r(91016),u=r(37530),h=r(35930),d=r(66614),f=r(7164),p=r(53695),_=r(24894),m=r(82673),g=new RegExp(/^data:([^,]+\\/[^,]+)?;base64,/i),v=function(e){function t(r,n){var o=e.call(this,r,c.tG.LoadFileError)||this;return o.name=\"LoadFileError\",c.Cf._setPrototypeOf(o,t.prototype),n instanceof i.u?o.request=n:o.file=n,o}return(0,n.C6)(t,e),t}(c.bu),y=function(e){function t(r,n){var i=e.call(this,r,c.tG.RequestFileError)||this;return i.request=n,i.name=\"RequestFileError\",c.Cf._setPrototypeOf(i,t.prototype),i}return(0,n.C6)(t,e),t}(c.bu),b=function(e){function t(r,n){var i=e.call(this,r,c.tG.ReadFileError)||this;return i.file=n,i.name=\"ReadFileError\",c.Cf._setPrototypeOf(i,t.prototype),i}return(0,n.C6)(t,e),t}(c.bu),S={DefaultRetryStrategy:l.a.ExponentialBackoff(),BaseUrl:\"\",CorsBehavior:\"anonymous\",PreprocessUrl:function(e){return e},ScriptBaseUrl:\"\",ScriptPreprocessUrl:function(e){return e},CleanUrl:function(e){return e.replace(/#/gm,\"%23\")}},T=function(e,t){if((!e||0!==e.indexOf(\"data:\"))&&S.CorsBehavior)if(\"string\"==typeof S.CorsBehavior||S.CorsBehavior instanceof String)t.crossOrigin=S.CorsBehavior;else{var r=S.CorsBehavior(e);r&&(t.crossOrigin=r)}},E={getRequiredSize:null},x=function(e,t,r,o,a,l){void 0===a&&(a=\"\");var c,h=d.q.LastCreatedEngine;if(\"undefined\"==typeof HTMLImageElement&&!(null==h?void 0:h._features.forceBitmapOverHTMLImageElement))return r(\"LoadImage is only supported in web or BabylonNative environments.\"),null;var f=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?\"undefined\"!=typeof Blob&&\"undefined\"!=typeof URL?(c=URL.createObjectURL(new Blob([e],{type:a})),f=!0):c=\"data:\".concat(a,\";base64,\")+(0,u.EL)(e):e instanceof Blob?(c=URL.createObjectURL(e),f=!0):(c=S.CleanUrl(e),c=S.PreprocessUrl(c));var p=function(t){if(r){var n=c||e.toString();r(\"Error while trying to load image: \".concat(0===n.indexOf(\"http\")||n.length<=128?n:n.slice(0,128)+\"...\"),t)}};if(null==h?void 0:h._features.forceBitmapOverHTMLImageElement)return C(c,(function(i){h.createImageBitmap(new Blob([i],{type:a}),(0,n.Cl)({premultiplyAlpha:\"none\"},l)).then((function(e){t(e),f&&URL.revokeObjectURL(c)})).catch((function(t){r&&r(\"Error while trying to load image: \"+e,t)}))}),void 0,o||void 0,!0,(function(e,t){p(t)})),null;var _=new Image;if(E.getRequiredSize){var m=E.getRequiredSize(e);m.width&&(_.width=m.width),m.height&&(_.height=m.height)}T(c,_);var g=[],v=function(){g.forEach((function(e){e.target.removeEventListener(e.name,e.handler)})),g.length=0};g.push({target:_,name:\"load\",handler:function(){v(),t(_),f&&_.src&&URL.revokeObjectURL(_.src)}}),g.push({target:_,name:\"error\",handler:function(e){v(),p(e),f&&_.src&&URL.revokeObjectURL(_.src)}}),g.push({target:document,name:\"securitypolicyviolation\",handler:function(e){if(e.blockedURI===_.src&&\"report\"!==e.disposition){v();var t=new Error(\"CSP violation of policy \".concat(e.effectiveDirective,\" \").concat(e.blockedURI,\". Current policy is \").concat(e.originalPolicy));d.q.UseFallbackTexture=!1,p(t),f&&_.src&&URL.revokeObjectURL(_.src),_.src=\"\"}}}),g.forEach((function(e){e.target.addEventListener(e.name,e.handler)}));var y=\"blob:\"===c.substring(0,5),b=\"data:\"===c.substring(0,5),x=function(){y||b||!i.u.IsCustomRequestAvailable?_.src=c:C(c,(function(e,t,r){var n=new Blob([e],{type:!a&&r?r:a}),i=URL.createObjectURL(n);f=!0,_.src=i}),void 0,o||void 0,!0,(function(e,t){p(t)}))};if(!y&&!b&&o&&o.enableTexturesOffline)o.open((function(){o&&o.loadImage(c,_)}),x);else{if(-1!==c.indexOf(\"file:\")){var P=decodeURIComponent(c.substring(5).toLowerCase());if(s.T.FilesToLoad[P]&&\"undefined\"!=typeof URL){try{var A=void 0;try{A=URL.createObjectURL(s.T.FilesToLoad[P])}catch(e){A=URL.createObjectURL(s.T.FilesToLoad[P])}_.src=A,f=!0}catch(e){_.src=\"\"}return _}}x()}return _},P=function(e,t,r,n,i){var o=new FileReader,s={onCompleteObservable:new a.cP,abort:function(){return o.abort()}};return o.onloadend=function(){return s.onCompleteObservable.notifyObservers(s)},i&&(o.onerror=function(){i(new b(\"Unable to read \".concat(e.name),e))}),o.onload=function(e){t(e.target.result)},r&&(o.onprogress=r),n?o.readAsArrayBuffer(e):o.readAsText(e),s},C=function(e,t,r,n,i,o,l){if(e.name)return P(e,t,r,i,o?function(e){o(void 0,e)}:void 0);var c=e;if(-1!==c.indexOf(\"file:\")){var u=decodeURIComponent(c.substring(5).toLowerCase());0===u.indexOf(\"./\")&&(u=u.substring(2));var h=s.T.FilesToLoad[u];if(h)return P(h,t,r,i,o?function(e){return o(void 0,new v(e.message,e.file))}:void 0)}var d=M(c),_=d.match,m=d.type;if(_){var g={onCompleteObservable:new a.cP,abort:function(){return function(){}}};try{var y=i?O(c):N(c);t(y,void 0,m)}catch(e){o?o(void 0,e):f.V.Error(e.message||\"Failed to parse the Data URL\")}return p._.SetImmediate((function(){g.onCompleteObservable.notifyObservers(g)})),g}return A(c,(function(e,r){t(e,null==r?void 0:r.responseURL,null==r?void 0:r.getResponseHeader(\"content-type\"))}),r,n,i,o?function(e){o(e.request,new v(e.message,e.request))}:void 0,l)},A=function(e,t,r,n,s,l,c){e=S.CleanUrl(e),e=S.PreprocessUrl(e);var u=S.BaseUrl+e,h=!1,d={onCompleteObservable:new a.cP,abort:function(){return h=!0}},p=function(){var e,n=new i.u,a=null,p=function(){n&&(r&&n.removeEventListener(\"progress\",r),e&&n.removeEventListener(\"readystatechange\",e),n.removeEventListener(\"loadend\",_))},_=function(){p(),d.onCompleteObservable.notifyObservers(d),d.onCompleteObservable.clear(),r=void 0,e=null,_=null,l=void 0,c=void 0,t=void 0};d.abort=function(){h=!0,_&&_(),n&&n.readyState!==(XMLHttpRequest.DONE||4)&&n.abort(),null!==a&&(clearTimeout(a),a=null),n=null};var m=function(e){var t=e.message||\"Unknown error\";l&&n?l(new y(t,n)):f.V.Error(t)},g=function(d){if(n){if(n.open(\"GET\",u),c)try{c(n)}catch(e){return void m(e)}s&&(n.responseType=\"arraybuffer\"),r&&n.addEventListener(\"progress\",r),_&&n.addEventListener(\"loadend\",_),e=function(){if(!h&&n&&n.readyState===(XMLHttpRequest.DONE||4)){if(e&&n.removeEventListener(\"readystatechange\",e),n.status>=200&&n.status<300||0===n.status&&(!(0,o.BA)()||R())){try{t&&t(s?n.response:n.responseText,n)}catch(e){m(e)}return}var r=S.DefaultRetryStrategy;if(r){var c=r(u,n,d);if(-1!==c)return p(),n=new i.u,void(a=setTimeout((function(){return g(d+1)}),c))}var f=new y(\"Error status: \"+n.status+\" \"+n.statusText+\" - Unable to load \"+u,n);l&&l(f)}},n.addEventListener(\"readystatechange\",e),n.send()}};g(0)};if(n&&n.enableSceneOffline){var _=function(e){e&&e.status>400?l&&l(e):p()};n.open((function(){n&&n.loadFile(S.BaseUrl+e,(function(e){!h&&t&&t(e),d.onCompleteObservable.notifyObservers(d)}),r?function(e){!h&&r&&r(e)}:void 0,_,s)}),_)}else p();return d},R=function(){return\"undefined\"!=typeof location&&\"file:\"===location.protocol},I=function(e){return g.test(e)},M=function(e){var t=g.exec(e);return null===t||0===t.length?{match:!1,type:\"\"}:{match:!0,type:t[0].replace(\"data:\",\"\").replace(\"base64,\",\"\")}};function O(e){return(0,u.yS)(e.split(\",\")[1])}var D,N=function(e){return(0,u.AV)(e.split(\",\")[1])};m.$._FileToolsLoadImage=x,_.sg.loadFile=C,h.J.loadFile=C;var L=function(e,t,r,n,i,o,a,s,l,c){D={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:r.DefaultRetryStrategy,BaseUrl:r.BaseUrl,CorsBehavior:r.CorsBehavior,PreprocessUrl:r.PreprocessUrl,IsBase64DataUrl:n,IsFileURL:i,LoadFile:o,LoadImage:a,ReadFile:s,RequestFile:l,SetCorsBehavior:c},Object.defineProperty(D,\"DefaultRetryStrategy\",{get:function(){return r.DefaultRetryStrategy},set:function(e){r.DefaultRetryStrategy=e}}),Object.defineProperty(D,\"BaseUrl\",{get:function(){return r.BaseUrl},set:function(e){r.BaseUrl=e}}),Object.defineProperty(D,\"PreprocessUrl\",{get:function(){return r.PreprocessUrl},set:function(e){r.PreprocessUrl=e}}),Object.defineProperty(D,\"CorsBehavior\",{get:function(){return r.CorsBehavior},set:function(e){r.CorsBehavior=e}})};L(O,N,S,I,R,C,x,P,A,T)},23148:(e,t,r)=>{r.d(t,{T:()=>n});var n=function(){function e(){}return e.FilesToLoad={},e}()},23885:(e,t,r)=>{function n(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return(\"x\"===e?t:3&t|8).toString(16)}))}r.d(t,{S:()=>i,z:()=>n});var i={RandomId:n}},252:(e,t,r)=>{r.d(t,{n:()=>o});var n=r(7164),i=r(34623),o=function(){function e(){}return e.Instantiate=function(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];var t=(0,i.n9)(e);if(t)return t;n.V.Warn(e+\" not found, you may have missed an import.\");for(var r=e.split(\".\"),o=window||this,a=0,s=r.length;a<s;a++)o=o[r[a]];return\"function\"!=typeof o?null:o},e.RegisteredExternalClasses={},e}()},88188:(e,t,r)=>{r.d(t,{H:()=>i});var n=r(7164),i=function(){function e(t,r){if(this.data=t,this.isInvalid=!1,!e.IsValid(t))return this.isInvalid=!0,void n.V.Error(\"texture missing KTX identifier\");var i=Uint32Array.BYTES_PER_ELEMENT,o=new DataView(this.data.buffer,this.data.byteOffset+12,13*i),a=67305985===o.getUint32(0,!0);return this.glType=o.getUint32(1*i,a),this.glTypeSize=o.getUint32(2*i,a),this.glFormat=o.getUint32(3*i,a),this.glInternalFormat=o.getUint32(4*i,a),this.glBaseInternalFormat=o.getUint32(5*i,a),this.pixelWidth=o.getUint32(6*i,a),this.pixelHeight=o.getUint32(7*i,a),this.pixelDepth=o.getUint32(8*i,a),this.numberOfArrayElements=o.getUint32(9*i,a),this.numberOfFaces=o.getUint32(10*i,a),this.numberOfMipmapLevels=o.getUint32(11*i,a),this.bytesOfKeyValueData=o.getUint32(12*i,a),0!==this.glType?(n.V.Error(\"only compressed formats currently supported\"),void(this.isInvalid=!0)):(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0===this.pixelHeight||0!==this.pixelDepth?(n.V.Error(\"only 2D textures currently supported\"),void(this.isInvalid=!0)):0!==this.numberOfArrayElements?(n.V.Error(\"texture arrays not currently supported\"),void(this.isInvalid=!0)):this.numberOfFaces!==r?(n.V.Error(\"number of faces expected\"+r+\", but found \"+this.numberOfFaces),void(this.isInvalid=!0)):void(this.loadType=e.COMPRESSED_2D))}return e.prototype.uploadLevels=function(t,r){switch(this.loadType){case e.COMPRESSED_2D:this._upload2DCompressedLevels(t,r);case e.TEX_2D:case e.COMPRESSED_3D:case e.TEX_3D:}},e.prototype._upload2DCompressedLevels=function(t,r){for(var n=e.HEADER_LEN+this.bytesOfKeyValueData,i=this.pixelWidth,o=this.pixelHeight,a=r?this.numberOfMipmapLevels:1,s=0;s<a;s++){var l=new Int32Array(this.data.buffer,this.data.byteOffset+n,1)[0];n+=4;for(var c=0;c<this.numberOfFaces;c++){var u=new Uint8Array(this.data.buffer,this.data.byteOffset+n,l);t.getEngine()._uploadCompressedDataToTextureDirectly(t,t.format,i,o,u,c,s),n+=l,n+=3-(l+3)%4}i=Math.max(1,.5*i),o=Math.max(1,.5*o)}},e.IsValid=function(e){if(e.byteLength>=12){var t=new Uint8Array(e.buffer,e.byteOffset,12);if(171===t[0]&&75===t[1]&&84===t[2]&&88===t[3]&&32===t[4]&&49===t[5]&&49===t[6]&&187===t[7]&&13===t[8]&&10===t[9]&&26===t[10]&&10===t[11])return!0}return!1},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}()},47347:(e,t,r)=>{r.d(t,{$:()=>u,Z:()=>h});var n=r(81152),i=r(80244),o=r(44957),a=r(54665),s=r(78322);function l(e,t){var r=(null==t?void 0:t.jsDecoderModule)||KTX2DECODER;e&&(e.wasmUASTCToASTC&&(r.LiteTranscoder_UASTC_ASTC.WasmModuleURL=e.wasmUASTCToASTC),e.wasmUASTCToBC7&&(r.LiteTranscoder_UASTC_BC7.WasmModuleURL=e.wasmUASTCToBC7),e.wasmUASTCToRGBA_UNORM&&(r.LiteTranscoder_UASTC_RGBA_UNORM.WasmModuleURL=e.wasmUASTCToRGBA_UNORM),e.wasmUASTCToRGBA_SRGB&&(r.LiteTranscoder_UASTC_RGBA_SRGB.WasmModuleURL=e.wasmUASTCToRGBA_SRGB),e.wasmUASTCToR8_UNORM&&(r.LiteTranscoder_UASTC_R8_UNORM.WasmModuleURL=e.wasmUASTCToR8_UNORM),e.wasmUASTCToRG8_UNORM&&(r.LiteTranscoder_UASTC_RG8_UNORM.WasmModuleURL=e.wasmUASTCToRG8_UNORM),e.jsMSCTranscoder&&(r.MSCTranscoder.JSModuleURL=e.jsMSCTranscoder),e.wasmMSCTranscoder&&(r.MSCTranscoder.WasmModuleURL=e.wasmMSCTranscoder),e.wasmZSTDDecoder&&(r.ZSTDDecoder.WasmModuleURL=e.wasmZSTDDecoder)),t&&(t.wasmUASTCToASTC&&(r.LiteTranscoder_UASTC_ASTC.WasmBinary=t.wasmUASTCToASTC),t.wasmUASTCToBC7&&(r.LiteTranscoder_UASTC_BC7.WasmBinary=t.wasmUASTCToBC7),t.wasmUASTCToRGBA_UNORM&&(r.LiteTranscoder_UASTC_RGBA_UNORM.WasmBinary=t.wasmUASTCToRGBA_UNORM),t.wasmUASTCToRGBA_SRGB&&(r.LiteTranscoder_UASTC_RGBA_SRGB.WasmBinary=t.wasmUASTCToRGBA_SRGB),t.wasmUASTCToR8_UNORM&&(r.LiteTranscoder_UASTC_R8_UNORM.WasmBinary=t.wasmUASTCToR8_UNORM),t.wasmUASTCToRG8_UNORM&&(r.LiteTranscoder_UASTC_RG8_UNORM.WasmBinary=t.wasmUASTCToRG8_UNORM),t.jsMSCTranscoder&&(r.MSCTranscoder.JSModule=t.jsMSCTranscoder),t.wasmMSCTranscoder&&(r.MSCTranscoder.WasmBinary=t.wasmMSCTranscoder),t.wasmZSTDDecoder&&(r.ZSTDDecoder.WasmBinary=t.wasmZSTDDecoder))}function c(e){var t;void 0===e&&\"undefined\"!=typeof KTX2DECODER&&(e=KTX2DECODER),onmessage=function(r){if(r.data)switch(r.data.action){case\"init\":var n=r.data.urls;n&&(n.jsDecoderModule&&void 0===e&&(importScripts(n.jsDecoderModule),e=KTX2DECODER),l(n)),r.data.wasmBinaries&&l(void 0,(0,s.Cl)((0,s.Cl)({},r.data.wasmBinaries),{jsDecoderModule:e})),t=new e.KTX2Decoder,postMessage({action:\"init\"});break;case\"setDefaultDecoderOptions\":e.KTX2Decoder.DefaultDecoderOptions=r.data.options;break;case\"decode\":t.decode(r.data.data,r.data.caps,r.data.options).then((function(e){for(var t=[],r=0;r<e.mipmaps.length;++r){var n=e.mipmaps[r];n&&n.data&&t.push(n.data.buffer)}postMessage({action:\"decoded\",success:!0,decodedData:e},t)})).catch((function(e){postMessage({action:\"decoded\",success:!1,msg:e})}))}}}var u=function(){function e(){this._isDirty=!0,this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC=!0,this._ktx2DecoderOptions={}}return Object.defineProperty(e.prototype,\"isDirty\",{get:function(){return this._isDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"useRGBAIfASTCBC7NotAvailableWhenUASTC\",{get:function(){return this._useRGBAIfASTCBC7NotAvailableWhenUASTC},set:function(e){this._useRGBAIfASTCBC7NotAvailableWhenUASTC!==e&&(this._useRGBAIfASTCBC7NotAvailableWhenUASTC=e,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"useRGBAIfOnlyBC1BC3AvailableWhenUASTC\",{get:function(){return this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC},set:function(e){this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC!==e&&(this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC=e,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"forceRGBA\",{get:function(){return this._forceRGBA},set:function(e){this._forceRGBA!==e&&(this._forceRGBA=e,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"forceR8\",{get:function(){return this._forceR8},set:function(e){this._forceR8!==e&&(this._forceR8=e,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"forceRG8\",{get:function(){return this._forceRG8},set:function(e){this._forceRG8!==e&&(this._forceRG8=e,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"bypassTranscoders\",{get:function(){return this._bypassTranscoders},set:function(e){this._bypassTranscoders!==e&&(this._bypassTranscoders=e,this._isDirty=!0)},enumerable:!1,configurable:!0}),e.prototype._getKTX2DecoderOptions=function(){if(!this._isDirty)return this._ktx2DecoderOptions;this._isDirty=!1;var e={useRGBAIfASTCBC7NotAvailableWhenUASTC:this._useRGBAIfASTCBC7NotAvailableWhenUASTC,forceRGBA:this._forceRGBA,forceR8:this._forceR8,forceRG8:this._forceRG8,bypassTranscoders:this._bypassTranscoders};return this.useRGBAIfOnlyBC1BC3AvailableWhenUASTC&&(e.transcodeFormatDecisionTree={UASTC:{transcodeFormat:[a.Xl.BC1_RGB,a.Xl.BC3_RGBA],yes:{transcodeFormat:a.Xl.RGBA32,engineFormat:32856,roundToMultiple4:!1}}}),this._ktx2DecoderOptions=e,e},e}(),h=function(){function e(t,r){var n,i;void 0===r&&(r=e.DefaultNumWorkers),this._engine=t;var o=\"object\"==typeof r&&r.workerPool||e.WorkerPool;if(o)e._WorkerPoolPromise=Promise.resolve(o);else{\"object\"==typeof r?e._KTX2DecoderModule=null===(n=null==r?void 0:r.binariesAndModulesContainer)||void 0===n?void 0:n.jsDecoderModule:\"undefined\"!=typeof KTX2DECODER&&(e._KTX2DecoderModule=KTX2DECODER);var a=\"number\"==typeof r?r:null!==(i=r.numWorkers)&&void 0!==i?i:e.DefaultNumWorkers;e._Initialize(a)}}return e.GetDefaultNumWorkers=function(){return\"object\"==typeof navigator&&navigator.hardwareConcurrency?Math.min(Math.floor(.5*navigator.hardwareConcurrency),4):1},e._Initialize=function(t){if(!e._WorkerPoolPromise&&!e._DecoderModulePromise){var r={jsDecoderModule:o.S0.GetBabylonScriptURL(this.URLConfig.jsDecoderModule,!0),wasmUASTCToASTC:o.S0.GetBabylonScriptURL(this.URLConfig.wasmUASTCToASTC,!0),wasmUASTCToBC7:o.S0.GetBabylonScriptURL(this.URLConfig.wasmUASTCToBC7,!0),wasmUASTCToRGBA_UNORM:o.S0.GetBabylonScriptURL(this.URLConfig.wasmUASTCToRGBA_UNORM,!0),wasmUASTCToRGBA_SRGB:o.S0.GetBabylonScriptURL(this.URLConfig.wasmUASTCToRGBA_SRGB,!0),wasmUASTCToR8_UNORM:o.S0.GetBabylonScriptURL(this.URLConfig.wasmUASTCToR8_UNORM,!0),wasmUASTCToRG8_UNORM:o.S0.GetBabylonScriptURL(this.URLConfig.wasmUASTCToRG8_UNORM,!0),jsMSCTranscoder:o.S0.GetBabylonScriptURL(this.URLConfig.jsMSCTranscoder,!0),wasmMSCTranscoder:o.S0.GetBabylonScriptURL(this.URLConfig.wasmMSCTranscoder,!0),wasmZSTDDecoder:o.S0.GetBabylonScriptURL(this.URLConfig.wasmZSTDDecoder,!0)};t&&\"function\"==typeof Worker&&\"undefined\"!=typeof URL?e._WorkerPoolPromise=new Promise((function(e){var n=\"\".concat(l,\"(\").concat(c,\")()\"),o=URL.createObjectURL(new Blob([n],{type:\"application/javascript\"}));e(new i.h(t,(function(){return function(e,t,r){return new Promise((function(t,n){var i=function(t){e.removeEventListener(\"error\",i),e.removeEventListener(\"message\",o),n(t)},o=function(r){\"init\"===r.data.action&&(e.removeEventListener(\"error\",i),e.removeEventListener(\"message\",o),t(e))};e.addEventListener(\"error\",i),e.addEventListener(\"message\",o),e.postMessage({action:\"init\",urls:r,wasmBinaries:undefined})}))}(new Worker(o),0,r)})))})):void 0===e._KTX2DecoderModule?e._DecoderModulePromise=o.S0.LoadBabylonScriptAsync(r.jsDecoderModule).then((function(){return e._KTX2DecoderModule=KTX2DECODER,e._KTX2DecoderModule.MSCTranscoder.UseFromWorkerThread=!1,e._KTX2DecoderModule.WASMMemoryManager.LoadBinariesFromCurrentThread=!0,l(r,e._KTX2DecoderModule),new e._KTX2DecoderModule.KTX2Decoder})):(e._KTX2DecoderModule.MSCTranscoder.UseFromWorkerThread=!1,e._KTX2DecoderModule.WASMMemoryManager.LoadBinariesFromCurrentThread=!0,e._DecoderModulePromise=Promise.resolve(new e._KTX2DecoderModule.KTX2Decoder))}},e.prototype._uploadAsync=function(t,r,n){var i=this,o=this._engine.getCaps(),a={astc:!!o.astc,bptc:!!o.bptc,s3tc:!!o.s3tc,pvrtc:!!o.pvrtc,etc2:!!o.etc2,etc1:!!o.etc1};if(e._WorkerPoolPromise)return e._WorkerPoolPromise.then((function(o){return new Promise((function(s,l){o.push((function(o,c){var u=function(e){o.removeEventListener(\"error\",u),o.removeEventListener(\"message\",h),l(e),c()},h=function(e){if(\"decoded\"===e.data.action){if(o.removeEventListener(\"error\",u),o.removeEventListener(\"message\",h),e.data.success)try{i._createTexture(e.data.decodedData,r,n),s()}catch(e){l({message:e})}else l({message:e.data.msg});c()}};o.addEventListener(\"error\",u),o.addEventListener(\"message\",h),o.postMessage({action:\"setDefaultDecoderOptions\",options:e.DefaultDecoderOptions._getKTX2DecoderOptions()});var d=new Uint8Array(t.byteLength);d.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),o.postMessage({action:\"decode\",data:d,caps:a,options:n},[d.buffer])}))}))}));if(e._DecoderModulePromise)return e._DecoderModulePromise.then((function(n){return e.DefaultDecoderOptions.isDirty&&(e._KTX2DecoderModule.KTX2Decoder.DefaultDecoderOptions=e.DefaultDecoderOptions._getKTX2DecoderOptions()),new Promise((function(e,a){n.decode(t,o).then((function(t){i._createTexture(t,r),e()})).catch((function(e){a({message:e})}))}))}));throw new Error(\"KTX2 decoder module is not available\")},e.prototype._createTexture=function(e,t,r){this._engine._bindTextureDirectly(3553,t),r&&(r.transcodedFormat=e.transcodedFormat,r.isInGammaSpace=e.isInGammaSpace,r.hasAlpha=e.hasAlpha,r.transcoderName=e.transcoderName);var i=!0;switch(e.transcodedFormat){case 32856:t.type=n.Y.TEXTURETYPE_UNSIGNED_BYTE,t.format=n.Y.TEXTUREFORMAT_RGBA;break;case 33321:t.type=n.Y.TEXTURETYPE_UNSIGNED_BYTE,t.format=n.Y.TEXTUREFORMAT_R;break;case 33323:t.type=n.Y.TEXTURETYPE_UNSIGNED_BYTE,t.format=n.Y.TEXTUREFORMAT_RG;break;default:t.format=e.transcodedFormat,i=!1}if(t._gammaSpace=e.isInGammaSpace,t.generateMipMaps=e.mipmaps.length>1,e.errors)throw new Error(\"KTX2 container - could not transcode the data. \"+e.errors);for(var o=0;o<e.mipmaps.length;++o){var a=e.mipmaps[o];if(!a||!a.data)throw new Error(\"KTX2 container - could not transcode one of the image\");i?(t.width=a.width,t.height=a.height,this._engine._uploadDataToTextureDirectly(t,a.data,0,o,void 0,!0)):this._engine._uploadCompressedDataToTextureDirectly(t,e.transcodedFormat,a.width,a.height,a.data,0,o)}t._extension=\".ktx2\",t.width=e.mipmaps[0].width,t.height=e.mipmaps[0].height,t.isReady=!0,this._engine._bindTextureDirectly(3553,null)},e.IsValid=function(e){if(e.byteLength>=12){var t=new Uint8Array(e.buffer,e.byteOffset,12);if(171===t[0]&&75===t[1]&&84===t[2]&&88===t[3]&&32===t[4]&&50===t[5]&&48===t[6]&&187===t[7]&&13===t[8]&&10===t[9]&&26===t[10]&&10===t[11])return!0}return!1},e.URLConfig={jsDecoderModule:\"https://cdn.babylonjs.com/babylon.ktx2Decoder.js\",wasmUASTCToASTC:null,wasmUASTCToBC7:null,wasmUASTCToRGBA_UNORM:null,wasmUASTCToRGBA_SRGB:null,wasmUASTCToR8_UNORM:null,wasmUASTCToRG8_UNORM:null,jsMSCTranscoder:null,wasmMSCTranscoder:null,wasmZSTDDecoder:null},e.DefaultNumWorkers=e.GetDefaultNumWorkers(),e.DefaultDecoderOptions=new u,e}()},7164:(e,t,r)=>{r.d(t,{V:()=>i});var n=r(78322),i=function(){function e(){}return e._CheckLimit=function(t,r){var n=e._LogLimitOutputs[t];return n?n.current++:(n={limit:r,current:1},e._LogLimitOutputs[t]=n),n.current<=n.limit},e._GenerateLimitMessage=function(t,r){var n;void 0===r&&(r=1);var i=e._LogLimitOutputs[t];if(i&&e.MessageLimitReached){var o=this._Levels[r];i.current===i.limit&&e[o.name](e.MessageLimitReached.replace(/%LIMIT%/g,\"\"+i.limit).replace(/%TYPE%/g,null!==(n=o.name)&&void 0!==n?n:\"\"))}},e._AddLogEntry=function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)},e._FormatMessage=function(e){var t=function(e){return e<10?\"0\"+e:\"\"+e},r=new Date;return\"[\"+t(r.getHours())+\":\"+t(r.getMinutes())+\":\"+t(r.getSeconds())+\"]: \"+e},e._LogDisabled=function(e,t){},e._LogEnabled=function(t,r,i){void 0===t&&(t=1);var o=Array.isArray(r)?r[0]:r;if(void 0===i||e._CheckLimit(o,i)){var a=e._FormatMessage(o),s=this._Levels[t],l=Array.isArray(r)?r.slice(1):[];s.logFunc&&s.logFunc.apply(s,(0,n.fX)([\"BJS - \"+a],l,!1));var c=\"<div style='color:\".concat(s.color,\"'>\").concat(a,\"</div><br>\");e._AddLogEntry(c),e._GenerateLimitMessage(o,t)}},Object.defineProperty(e,\"LogCache\",{get:function(){return e._LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){e._LogCache=\"\",e._LogLimitOutputs={},e.errorsCount=0},Object.defineProperty(e,\"LogLevels\",{set:function(t){var r=this;e.Log=e._LogDisabled,e.Warn=e._LogDisabled,e.Error=e._LogDisabled,[e.MessageLogLevel,e.WarningLogLevel,e.ErrorLogLevel].forEach((function(n){(t&n)===n&&(e[r._Levels[n].name]=e._LogEnabled.bind(e,n))}))},enumerable:!1,configurable:!0}),e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e.MessageLimitReached=\"Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.\",e._LogCache=\"\",e._LogLimitOutputs={},e._Levels=[{},{color:\"white\",logFunc:console.log,name:\"Log\"},{color:\"orange\",logFunc:console.warn,name:\"Warn\"},{},{color:\"red\",logFunc:console.error,name:\"Error\"}],e.errorsCount=0,e.Log=e._LogEnabled.bind(e,e.MessageLogLevel),e.Warn=e._LogEnabled.bind(e,e.WarningLogLevel),e.Error=e._LogEnabled.bind(e,e.ErrorLogLevel),e}()},66377:(e,t,r)=>{r.d(t,{cP:()=>o,nu:()=>i,qO:()=>n});var n=function(){function e(e,t,r,n){void 0===t&&(t=!1),this.initialize(e,t,r,n)}return e.prototype.initialize=function(e,t,r,n){return void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t,this.target=r,this.currentTarget=n,this},e}(),i=function(){function e(e,t,r){void 0===r&&(r=null),this.callback=e,this.mask=t,this.scope=r,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}return e.prototype.remove=function(){this._remove&&this._remove()},e}(),o=function(){function e(e,t){void 0===t&&(t=!1),this.notifyIfTriggered=t,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new n(0),e&&(this._onObserverAdded=e)}return e.FromPromise=function(t,r){var n=new e;return t.then((function(e){n.notifyObservers(e)})).catch((function(e){if(!r)throw e;r.notifyObservers(e)})),n},Object.defineProperty(e.prototype,\"observers\",{get:function(){return this._observers},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t,r,n,o){var a=this;if(void 0===t&&(t=-1),void 0===r&&(r=!1),void 0===n&&(n=null),void 0===o&&(o=!1),!e)return null;var s=new i(e,t,n);return s.unregisterOnNextCall=o,r?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(s,this._lastNotifiedValue),s._remove=function(){a.remove(s)},s},e.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)},e.prototype.remove=function(e){return!!e&&(e._remove=null,-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))},e.prototype.removeCallback=function(e,t){for(var r=0;r<this._observers.length;r++){var n=this._observers[r];if(!(n._willBeUnregistered||n.callback!==e||t&&t!==n.scope))return this._deferUnregister(n),!0}return!1},e.prototype._deferUnregister=function(e){var t=this;e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((function(){t._remove(e)}),0))},e.prototype._remove=function(e,t){if(void 0===t&&(t=!0),!e)return!1;var r=this._observers.indexOf(e);return-1!==r&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(r,1),!0)},e.prototype.makeObserverTopPriority=function(e){this._remove(e,!1),this._observers.unshift(e)},e.prototype.makeObserverBottomPriority=function(e){this._remove(e,!1),this._observers.push(e)},e.prototype.notifyObservers=function(e,t,r,n,i){if(void 0===t&&(t=-1),this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;var o=this._eventState;o.mask=t,o.target=r,o.currentTarget=n,o.skipNextObservers=!1,o.lastReturnValue=e,o.userInfo=i;for(var a=0,s=this._observers;a<s.length;a++){var l=s[a];if(!l._willBeUnregistered&&(l.mask&t&&(l.unregisterOnNextCall&&this._deferUnregister(l),l.scope?o.lastReturnValue=l.callback.apply(l.scope,[e,o]):o.lastReturnValue=l.callback(e,o)),o.skipNextObservers))return!1}return!0},e.prototype.notifyObserver=function(e,t,r){if(void 0===r&&(r=-1),this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),!e._willBeUnregistered){var n=this._eventState;n.mask=r,n.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,n)}},e.prototype.hasObservers=function(){return this._observers.length-this._numObserversMarkedAsDeleted>0},e.prototype.clear=function(){for(;this._observers.length;){var e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()},e.prototype.cleanLastNotifiedState=function(){this._hasNotified=!1,this._lastNotifiedValue=void 0},e.prototype.clone=function(){var t=new e;return t._observers=this._observers.slice(0),t},e.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,r=this._observers;t<r.length;t++){var n=r[t];if(n.mask&e||n.mask===e)return!0}return!1},e}()},70511:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(85258),i=function(){function e(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}return Object.defineProperty(e.prototype,\"min\",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"max\",{get:function(){return this._max},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"average\",{get:function(){return this._average},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"lastSecAverage\",{get:function(){return this._lastSecAverage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"current\",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"total\",{get:function(){return this._totalAccumulated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"count\",{get:function(){return this._totalValueCount},enumerable:!1,configurable:!0}),e.prototype.fetchNewFrame=function(){this._totalValueCount++,this._current=0,this._lastSecValueCount++},e.prototype.addCount=function(t,r){e.Enabled&&(this._current+=t,r&&this._fetchResult())},e.prototype.beginMonitoring=function(){e.Enabled&&(this._startMonitoringTime=n.j.Now)},e.prototype.endMonitoring=function(t){if(void 0===t&&(t=!0),e.Enabled){t&&this.fetchNewFrame();var r=n.j.Now;this._current=r-this._startMonitoringTime,t&&this._fetchResult()}},e.prototype.endFrame=function(){this._fetchResult()},e.prototype._fetchResult=function(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;var e=n.j.Now;e-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=e,this._lastSecAccumulated=0,this._lastSecValueCount=0)},e.Enabled=!0,e}()},85258:(e,t,r)=>{r.d(t,{j:()=>i});var n=r(5153),i=function(){function e(){}return Object.defineProperty(e,\"Now\",{get:function(){return(0,n.BA)()&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!1,configurable:!0}),e}()},49449:(e,t,r)=>{r.d(t,{a:()=>n});var n=function(){function e(){}return e.ExponentialBackoff=function(e,t){return void 0===e&&(e=3),void 0===t&&(t=500),function(r,n,i){return 0!==n.status||i>=e||-1!==r.indexOf(\"file:\")?-1:Math.pow(2,i)*t}},e}()},97411:(e,t,r)=>{r.d(t,{G:()=>s});var n=r(78322),i=r(81152),o=r(30622),a=(r(71073),r(35877)),s=function(){function e(){}return e.ExpandRGBDTexture=function(e){var t=this,a=e._texture;if(a&&e.isRGBD){var s=a.getEngine(),l=s.getCaps(),c=a.isReady,u=!1;l.textureHalfFloatRender&&l.textureHalfFloatLinearFiltering?(u=!0,a.type=i.Y.TEXTURETYPE_HALF_FLOAT):l.textureFloatRender&&l.textureFloatLinearFiltering&&(u=!0,a.type=i.Y.TEXTURETYPE_FLOAT),u&&(a.isReady=!1,a._isRGBD=!1,a.invertY=!1);var h=function(){return(0,n.sH)(t,void 0,void 0,(function(){var t,l,c,u;return(0,n.YH)(this,(function(n){switch(n.label){case 0:return t=s.isWebGPU,l=t?1:0,a.isReady=!1,this._ShaderImported?[3,4]:(this._ShaderImported=!0,t?[4,Promise.all([Promise.resolve().then(r.bind(r,37494)),Promise.resolve().then(r.bind(r,86558))])]:[3,2]);case 1:return n.sent(),[3,4];case 2:return[4,Promise.all([Promise.resolve().then(r.bind(r,32407)),Promise.resolve().then(r.bind(r,22955))])];case 3:n.sent(),n.label=4;case 4:return(c=new o.w(\"rgbdDecode\",\"rgbdDecode\",null,null,1,null,i.Y.TEXTURE_TRILINEAR_SAMPLINGMODE,s,!1,void 0,a.type,void 0,null,!1,void 0,l)).externalTextureSamplerBinding=!0,u=s.createRenderTargetTexture(a.width,{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:a.samplingMode,type:a.type,format:i.Y.TEXTUREFORMAT_RGBA}),c.onEffectCreatedObservable.addOnce((function(t){t.executeWhenCompiled((function(){c.onApply=function(e){e._bindTexture(\"textureSampler\",a),e.setFloat2(\"scale\",1,1)},e.getScene().postProcessManager.directRender([c],u,!0),s.restoreDefaultFramebuffer(),s._releaseTexture(a),c&&c.dispose(),u._swapAndDie(a),a.isReady=!0}))})),[2]}}))}))};u&&(c?h():e.onLoadObservable.addOnce(h))}},e.EncodeTextureToRGBD=function(e,t,r){return void 0===r&&(r=i.Y.TEXTURETYPE_UNSIGNED_BYTE),(0,a.Qs)(\"rgbdEncode\",e,t,r,i.Y.TEXTURE_NEAREST_SAMPLINGMODE,i.Y.TEXTUREFORMAT_RGBA)},e._ShaderImported=!1,e}()},53770:(e,t,r)=>{r.d(t,{L:()=>i,b:()=>o});var n=r(78322),i=function(){function e(t){this.length=0,this.data=new Array(t),this._id=e._GlobalId++}return e.prototype.push=function(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2)},e.prototype.forEach=function(e){for(var t=0;t<this.length;t++)e(this.data[t])},e.prototype.sort=function(e){this.data.sort(e)},e.prototype.reset=function(){this.length=0},e.prototype.dispose=function(){this.reset(),this.data&&(this.data.length=0)},e.prototype.concat=function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}},e.prototype.indexOf=function(e){var t=this.data.indexOf(e);return t>=this.length?-1:t},e.prototype.contains=function(e){return-1!==this.indexOf(e)},e._GlobalId=0,e}(),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._duplicateId=0,t}return(0,n.C6)(t,e),t.prototype.push=function(t){e.prototype.push.call(this,t),t.__smartArrayFlags||(t.__smartArrayFlags={}),t.__smartArrayFlags[this._id]=this._duplicateId},t.prototype.pushNoDuplicate=function(e){return!(e.__smartArrayFlags&&e.__smartArrayFlags[this._id]===this._duplicateId||(this.push(e),0))},t.prototype.reset=function(){e.prototype.reset.call(this),this._duplicateId++},t.prototype.concatWithNoDuplicate=function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++){var r=(e.data||e)[t];this.pushNoDuplicate(r)}}},t}(i)},59437:(e,t,r)=>{r.d(t,{w:()=>n});var n=function(){function e(){this._count=0,this._data={}}return e.prototype.copyFrom=function(e){var t=this;this.clear(),e.forEach((function(e,r){return t.add(e,r)}))},e.prototype.get=function(e){var t=this._data[e];if(void 0!==t)return t},e.prototype.getOrAddWithFactory=function(e,t){var r=this.get(e);return void 0!==r||(r=t(e))&&this.add(e,r),r},e.prototype.getOrAdd=function(e,t){var r=this.get(e);return void 0!==r?r:(this.add(e,t),t)},e.prototype.contains=function(e){return void 0!==this._data[e]},e.prototype.add=function(e,t){return void 0===this._data[e]&&(this._data[e]=t,++this._count,!0)},e.prototype.set=function(e,t){return void 0!==this._data[e]&&(this._data[e]=t,!0)},e.prototype.getAndRemove=function(e){var t=this.get(e);return void 0!==t?(delete this._data[e],--this._count,t):null},e.prototype.remove=function(e){return!!this.contains(e)&&(delete this._data[e],--this._count,!0)},e.prototype.clear=function(){this._data={},this._count=0},Object.defineProperty(e.prototype,\"count\",{get:function(){return this._count},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){for(var t in this._data)e(t,this._data[t])},e.prototype.first=function(e){for(var t in this._data){var r=e(t,this._data[t]);if(r)return r}return null},e}()},37530:(e,t,r)=>{r.d(t,{AV:()=>s,EL:()=>a,LW:()=>c,Tq:()=>o,UH:()=>i,jq:()=>n,nQ:()=>u,yS:()=>l});var n=function(e,t){return e.endsWith(t)},i=function(e,t){return!!e&&e.startsWith(t)},o=function(e){if(\"undefined\"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t=\"\",r=0;r<e.byteLength;r++)t+=String.fromCharCode(e[r]);return t},a=function(e){for(var t,r,n,i,o,a,s,l=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",c=\"\",u=0,h=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);u<h.length;)i=(t=h[u++])>>2,o=(3&t)<<4|(r=u<h.length?h[u++]:Number.NaN)>>4,a=(15&r)<<2|(n=u<h.length?h[u++]:Number.NaN)>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),c+=l.charAt(i)+l.charAt(o)+l.charAt(a)+l.charAt(s);return c},s=function(e){return atob(e)},l=function(e){for(var t=s(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n.buffer},c=function(e,t){for(var r=String(e);r.length<t;)r=\"0\"+r;return r},u={EndsWith:n,StartsWith:i,Decode:o,EncodeArrayBufferToBase64:a,DecodeBase64ToString:s,DecodeBase64ToBinary:l,PadNumber:c}},31985:(e,t,r)=>{r.d(t,{Y:()=>i});var n=r(92548),i=function(){function e(){}return e.EnableFor=function(t){t._tags=t._tags||{},t.hasTags=function(){return e.HasTags(t)},t.addTags=function(r){return e.AddTagsTo(t,r)},t.removeTags=function(r){return e.RemoveTagsFrom(t,r)},t.matchesTagsQuery=function(r){return e.MatchesQuery(t,r)}},e.DisableFor=function(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery},e.HasTags=function(e){if(!e._tags)return!1;var t=e._tags;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))return!0;return!1},e.GetTags=function(e,t){if(void 0===t&&(t=!0),!e._tags)return null;if(t){var r=[];for(var n in e._tags)Object.prototype.hasOwnProperty.call(e._tags,n)&&!0===e._tags[n]&&r.push(n);return r.join(\" \")}return e._tags},e.AddTagsTo=function(t,r){r&&\"string\"==typeof r&&r.split(\" \").forEach((function(r){e._AddTagTo(t,r)}))},e._AddTagTo=function(t,r){\"\"!==(r=r.trim())&&\"true\"!==r&&\"false\"!==r&&(r.match(/[\\s]/)||r.match(/^([!]|([|]|[&]){2})/)||(e.EnableFor(t),t._tags[r]=!0))},e.RemoveTagsFrom=function(t,r){if(e.HasTags(t)){var n=r.split(\" \");for(var i in n)e._RemoveTagFrom(t,n[i])}},e._RemoveTagFrom=function(e,t){delete e._tags[t]},e.MatchesQuery=function(t,r){return void 0===r||(\"\"===r?e.HasTags(t):n.Z.Eval(r,(function(r){return e.HasTags(t)&&t._tags[r]})))},e}()},35877:(e,t,r)=>{r.d(t,{Qs:()=>f,EE:()=>d,SX:()=>_,Oz:()=>g,LO:()=>v,LZ:()=>p});var n=r(78322),i=r(50582),o=r(41085),a=r(73441),s=r(81152),l=r(30622),c=r(98519);c.l.ShadersStore.lodPixelShader=\"#extension GL_EXT_shader_texture_lod : enable\\nprecision highp float;const float GammaEncodePowerApprox=1.0/2.2;varying vec2 vUV;uniform sampler2D textureSampler;uniform float lod;uniform vec2 texSize;uniform bool gamma;void main(void)\\n{gl_FragColor=textureLod(textureSampler,vUV,lod);if (!gamma) {gl_FragColor.rgb=pow(gl_FragColor.rgb,vec3(GammaEncodePowerApprox));}}\\n\";var u,h;function d(e,t,r,n){void 0===n&&(n=!0);var l=e.getScene(),c=l.getEngine(),u=new o.$(\"resized\"+e.name,{width:t,height:r},l,!e.noMipmap,!0,e._texture.type,!1,e.samplingMode,!1);u.wrapU=e.wrapU,u.wrapV=e.wrapV,u.uOffset=e.uOffset,u.vOffset=e.vOffset,u.uScale=e.uScale,u.vScale=e.vScale,u.uAng=e.uAng,u.vAng=e.vAng,u.wAng=e.wAng,u.coordinatesIndex=e.coordinatesIndex,u.level=e.level,u.anisotropicFilteringLevel=e.anisotropicFilteringLevel,u._texture.isReady=!1,e.wrapU=i.g.CLAMP_ADDRESSMODE,e.wrapV=i.g.CLAMP_ADDRESSMODE;var h=new a.v(\"pass\",1,null,n?i.g.BILINEAR_SAMPLINGMODE:i.g.NEAREST_SAMPLINGMODE,c,!1,s.Y.TEXTURETYPE_UNSIGNED_INT);return h.externalTextureSamplerBinding=!0,h.onEffectCreatedObservable.addOnce((function(t){t.executeWhenCompiled((function(){h.onApply=function(t){t.setTexture(\"textureSampler\",e)};var t=u.renderTarget;t&&(l.postProcessManager.directRender([h],t),c.unBindFramebuffer(t),u.disposeFramebufferObjects(),h.dispose(),u.getInternalTexture().isReady=!0)}))})),u}function f(e,t,r,n,i,o,a,c){var u=t.getEngine();return t.isReady=!1,i=null!=i?i:t.samplingMode,n=null!=n?n:t.type,o=null!=o?o:t.format,a=null!=a?a:t.width,c=null!=c?c:t.height,-1===n&&(n=s.Y.TEXTURETYPE_UNSIGNED_BYTE),new Promise((function(h){var d=new l.w(\"postprocess\",e,null,null,1,null,i,u,!1,void 0,n,void 0,null,!1,o);d.externalTextureSamplerBinding=!0;var f=u.createRenderTargetTexture({width:a,height:c},{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:i,type:n,format:o});d.onEffectCreatedObservable.addOnce((function(e){e.executeWhenCompiled((function(){d.onApply=function(e){e._bindTexture(\"textureSampler\",t),e.setFloat2(\"scale\",1,1)},r.postProcessManager.directRender([d],f,!0),u.restoreDefaultFramebuffer(),u._releaseTexture(t),d&&d.dispose(),f._swapAndDie(t),t.type=n,t.format=s.Y.TEXTUREFORMAT_RGBA,t.isReady=!0,h(t)}))}))}))}function p(e){u||(u=new Float32Array(1),h=new Int32Array(u.buffer)),u[0]=e;var t=h[0],r=t>>16&32768,n=t>>12&2047,i=t>>23&255;return i<103?r:i>142?(r|=31744,r|=(255==i?0:1)&&8388607&t):i<113?r|=((n|=2048)>>114-i)+(n>>113-i&1):(r|=i-112<<10|n>>1,r+=1&n)}function _(e){var t=(32768&e)>>15,r=(31744&e)>>10,n=1023&e;return 0===r?(t?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):31==r?n?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}c.l.ShadersStore.lodCubePixelShader=\"precision highp float;const float GammaEncodePowerApprox=1.0/2.2;varying vec2 vUV;uniform samplerCube textureSampler;uniform float lod;uniform bool gamma;void main(void)\\n{vec2 uv=vUV*2.0-1.0;\\n#ifdef POSITIVEX\\ngl_FragColor=textureCube(textureSampler,vec3(1.001,uv.y,uv.x),lod);\\n#endif\\n#ifdef NEGATIVEX\\ngl_FragColor=textureCube(textureSampler,vec3(-1.001,uv.y,uv.x),lod);\\n#endif\\n#ifdef POSITIVEY\\ngl_FragColor=textureCube(textureSampler,vec3(uv.y,1.001,uv.x),lod);\\n#endif\\n#ifdef NEGATIVEY\\ngl_FragColor=textureCube(textureSampler,vec3(uv.y,-1.001,uv.x),lod);\\n#endif\\n#ifdef POSITIVEZ\\ngl_FragColor=textureCube(textureSampler,vec3(uv,1.001),lod);\\n#endif\\n#ifdef NEGATIVEZ\\ngl_FragColor=textureCube(textureSampler,vec3(uv,-1.001),lod);\\n#endif\\nif (!gamma) {gl_FragColor.rgb=pow(gl_FragColor.rgb,vec3(GammaEncodePowerApprox));}}\\n\";var m=function(e,t,r,a,s){return(0,n.sH)(void 0,void 0,void 0,(function(){var c,u,h,d,f,p,_,m,g;return(0,n.YH)(this,(function(n){switch(n.label){case 0:return c=e.getScene(),u=c.getEngine(),e.isCube?(d=[\"#define POSITIVEX\",\"#define NEGATIVEX\",\"#define POSITIVEY\",\"#define NEGATIVEY\",\"#define POSITIVEZ\",\"#define NEGATIVEZ\"],h=new l.w(\"lodCube\",\"lodCube\",[\"lod\",\"gamma\"],null,1,null,i.g.NEAREST_NEAREST_MIPNEAREST,u,!1,d[a])):h=new l.w(\"lod\",\"lod\",[\"lod\",\"gamma\"],null,1,null,i.g.NEAREST_NEAREST_MIPNEAREST,u),[4,new Promise((function(e){h.onEffectCreatedObservable.addOnce((function(t){t.executeWhenCompiled((function(){e(0)}))}))}))];case 1:n.sent(),f=new o.$(\"temp\",{width:t,height:r},c,!1),h.onApply=function(t){t.setTexture(\"textureSampler\",e),t.setFloat(\"lod\",s),t.setBool(\"gamma\",e.gammaSpace)},p=e.getInternalTexture(),n.label=2;case 2:return n.trys.push([2,,6,7]),f.renderTarget&&p?(_=p.samplingMode,0!==s?e.updateSamplingMode(i.g.NEAREST_NEAREST_MIPNEAREST):e.updateSamplingMode(i.g.NEAREST_NEAREST),c.postProcessManager.directRender([h],f.renderTarget,!0),e.updateSamplingMode(_),[4,u.readPixels(0,0,t,r)]):[3,4];case 3:return m=n.sent(),g=new Uint8Array(m.buffer,0,m.byteLength),u.unBindFramebuffer(f.renderTarget),[2,g];case 4:throw Error(\"Render to texture failed.\");case 5:return[3,7];case 6:return f.dispose(),h.dispose(),[7];case 7:return[2]}}))}))};function g(e,t,r,i,o){return void 0===i&&(i=0),void 0===o&&(o=0),(0,n.sH)(this,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return e.isReady()||!e._texture?[3,2]:[4,new Promise((function(t,r){null!==e._texture?e._texture.onLoadedObservable.addOnce((function(){t(0)})):r(0)}))];case 1:n.sent(),n.label=2;case 2:return[4,m(e,t,r,i,o)];case 3:return[2,n.sent()]}}))}))}var v={CreateResizedCopy:d,ApplyPostProcess:f,ToHalfFloat:p,FromHalfFloat:_,GetTextureDataAsync:g}},65054:(e,t,r)=>{r.d(t,{FA:()=>g,O_:()=>m,uT:()=>v});var n=r(7164),i=1,o=2,a=3,s=9,l=10,c=11,u=48,h=4,d=0,f=1,p=2,_=3;function m(e){var t=0;return{id_length:e[t++],colormap_type:e[t++],image_type:e[t++],colormap_index:e[t++]|e[t++]<<8,colormap_length:e[t++]|e[t++]<<8,colormap_size:e[t++],origin:[e[t++]|e[t++]<<8,e[t++]|e[t++]<<8],width:e[t++]|e[t++]<<8,height:e[t++]|e[t++]<<8,pixel_size:e[t++],flags:e[t++]}}function g(e,t){if(t.length<19)n.V.Error(\"Unable to load TGA file - Not enough data to contain header\");else{var r=18,g=m(t);if(g.id_length+r>t.length)n.V.Error(\"Unable to load TGA file - Not enough data\");else{r+=g.id_length;var y,b=!1,S=!1,T=!1;switch(g.image_type){case s:b=!0;case i:S=!0;break;case l:b=!0;case o:break;case c:b=!0;case a:T=!0}var E,x,P,C,A,R,I,M=g.pixel_size>>3,O=g.width*g.height*M;if(S&&(E=t.subarray(r,r+=g.colormap_length*(g.colormap_size>>3))),b){y=new Uint8Array(O);for(var D=void 0,N=void 0,L=void 0,F=0,w=new Uint8Array(M);r<O&&F<O;)if(N=1+(127&(D=t[r++])),128&D){for(L=0;L<M;++L)w[L]=t[r++];for(L=0;L<N;++L)y.set(w,F+L*M);F+=M*N}else{for(N*=M,L=0;L<N;++L)y[F+L]=t[r++];F+=N}}else y=t.subarray(r,r+=S?g.width*g.height:O);switch((g.flags&u)>>h){default:case p:x=0,C=1,I=g.width,P=0,A=1,R=g.height;break;case d:x=0,C=1,I=g.width,P=g.height-1,A=-1,R=-1;break;case _:x=g.width-1,C=-1,I=-1,P=0,A=1,R=g.height;break;case f:x=g.width-1,C=-1,I=-1,P=g.height-1,A=-1,R=-1}var B=\"_getImageData\"+(T?\"Grey\":\"\")+g.pixel_size+\"bits\",V=v[B](g,E,y,P,A,R,x,C,I);e.getEngine()._uploadDataToTextureDirectly(e,V)}}}var v={GetTGAHeader:m,UploadContent:g,_getImageData8bits:function(e,t,r,n,i,o,a,s,l){var c,u,h,d=r,f=t,p=e.width,_=e.height,m=0,g=new Uint8Array(p*_*4);for(h=n;h!==o;h+=i)for(u=a;u!==l;u+=s,m++)c=d[m],g[4*(u+p*h)+3]=255,g[4*(u+p*h)+2]=f[3*c+0],g[4*(u+p*h)+1]=f[3*c+1],g[4*(u+p*h)+0]=f[3*c+2];return g},_getImageData16bits:function(e,t,r,n,i,o,a,s,l){var c,u,h,d=r,f=e.width,p=e.height,_=0,m=new Uint8Array(f*p*4);for(h=n;h!==o;h+=i)for(u=a;u!==l;u+=s,_+=2){var g=255*((31744&(c=d[_+0]+(d[_+1]<<8)))>>10)/31|0,v=255*((992&c)>>5)/31|0,y=255*(31&c)/31|0;m[4*(u+f*h)+0]=g,m[4*(u+f*h)+1]=v,m[4*(u+f*h)+2]=y,m[4*(u+f*h)+3]=32768&c?0:255}return m},_getImageData24bits:function(e,t,r,n,i,o,a,s,l){var c,u,h=r,d=e.width,f=e.height,p=0,_=new Uint8Array(d*f*4);for(u=n;u!==o;u+=i)for(c=a;c!==l;c+=s,p+=3)_[4*(c+d*u)+3]=255,_[4*(c+d*u)+2]=h[p+0],_[4*(c+d*u)+1]=h[p+1],_[4*(c+d*u)+0]=h[p+2];return _},_getImageData32bits:function(e,t,r,n,i,o,a,s,l){var c,u,h=r,d=e.width,f=e.height,p=0,_=new Uint8Array(d*f*4);for(u=n;u!==o;u+=i)for(c=a;c!==l;c+=s,p+=4)_[4*(c+d*u)+2]=h[p+0],_[4*(c+d*u)+1]=h[p+1],_[4*(c+d*u)+0]=h[p+2],_[4*(c+d*u)+3]=h[p+3];return _},_getImageDataGrey8bits:function(e,t,r,n,i,o,a,s,l){var c,u,h,d=r,f=e.width,p=e.height,_=0,m=new Uint8Array(f*p*4);for(h=n;h!==o;h+=i)for(u=a;u!==l;u+=s,_++)c=d[_],m[4*(u+f*h)+0]=c,m[4*(u+f*h)+1]=c,m[4*(u+f*h)+2]=c,m[4*(u+f*h)+3]=255;return m},_getImageDataGrey16bits:function(e,t,r,n,i,o,a,s,l){var c,u,h=r,d=e.width,f=e.height,p=0,_=new Uint8Array(d*f*4);for(u=n;u!==o;u+=i)for(c=a;c!==l;c+=s,p+=2)_[4*(c+d*u)+0]=h[p+0],_[4*(c+d*u)+1]=h[p+0],_[4*(c+d*u)+2]=h[p+0],_[4*(c+d*u)+3]=h[p+1];return _}}},53695:(e,t,r)=>{r.d(t,{_:()=>i});var n=r(5153),i=function(){function e(){}return e.SetImmediate=function(e){(0,n.BA)()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)},e}()},87074:(e,t,r)=>{r.d(t,{C4:()=>l,L8:()=>i,OG:()=>a,R:()=>c,zF:()=>o});var n=r(81152);function i(e){var t=1;do{t*=2}while(t<e);return t===e}function o(e,t,r){return e*(1-r)+t*r}function a(e){var t=s(e),r=l(e);return t-e>e-r?r:t}function s(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function l(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)}function c(e,t,r){var i;switch(void 0===r&&(r=n.Y.SCALEMODE_NEAREST),r){case n.Y.SCALEMODE_FLOOR:i=l(e);break;case n.Y.SCALEMODE_NEAREST:i=a(e);break;case n.Y.SCALEMODE_CEILING:default:i=s(e)}return Math.min(i,t)}},44957:(e,t,r)=>{r.d(t,{LV:()=>y,S0:()=>g,s7:()=>v});var n=r(78322),i=r(66377),o=r(5153),a=r(7164),s=r(44576),l=r(85258),c=r(41190),u=r(46799),h=r(66614),d=r(17347),f=r(53695),p=r(252),_=r(23885),m=r(87074),g=function(){function e(){}return Object.defineProperty(e,\"BaseUrl\",{get:function(){return d.eC.BaseUrl},set:function(e){d.eC.BaseUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"CleanUrl\",{get:function(){return d.eC.CleanUrl},set:function(e){d.eC.CleanUrl=e},enumerable:!1,configurable:!0}),e.IsAbsoluteUrl=function(e){return 0===e.indexOf(\"//\")||-1!==e.indexOf(\"://\")&&-1!==e.indexOf(\".\")&&-1!==e.indexOf(\"/\")&&!(e.indexOf(\":\")>e.indexOf(\"/\"))&&(e.indexOf(\"://\")<e.indexOf(\".\")||0===e.indexOf(\"data:\")||0===e.indexOf(\"blob:\"))},Object.defineProperty(e,\"ScriptBaseUrl\",{get:function(){return d.eC.ScriptBaseUrl},set:function(e){d.eC.ScriptBaseUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"ScriptPreprocessUrl\",{get:function(){return d.eC.ScriptPreprocessUrl},set:function(e){d.eC.ScriptPreprocessUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"DefaultRetryStrategy\",{get:function(){return d.eC.DefaultRetryStrategy},set:function(e){d.eC.DefaultRetryStrategy=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"CorsBehavior\",{get:function(){return d.eC.CorsBehavior},set:function(e){d.eC.CorsBehavior=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"UseFallbackTexture\",{get:function(){return h.q.UseFallbackTexture},set:function(e){h.q.UseFallbackTexture=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"RegisteredExternalClasses\",{get:function(){return p.n.RegisteredExternalClasses},set:function(e){p.n.RegisteredExternalClasses=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"fallbackTexture\",{get:function(){return h.q.FallbackTexture},set:function(e){h.q.FallbackTexture=e},enumerable:!1,configurable:!0}),e.FetchToRef=function(e,t,r,n,i,o){var a=4*((Math.abs(e)*r%r|0)+(Math.abs(t)*n%n|0)*r);o.r=i[a]/255,o.g=i[a+1]/255,o.b=i[a+2]/255,o.a=i[a+3]/255},e.Mix=function(e,t,r){return 0},e.Instantiate=function(e){return p.n.Instantiate(e)},e.SetImmediate=function(e){f._.SetImmediate(e)},e.IsExponentOfTwo=function(e){return!0},e.FloatRound=function(e){return Math.fround(e)},e.GetFilename=function(e){var t=e.lastIndexOf(\"/\");return t<0?e:e.substring(t+1)},e.GetFolderPath=function(e,t){void 0===t&&(t=!1);var r=e.lastIndexOf(\"/\");return r<0?t?e:\"\":e.substring(0,r+1)},e.ToDegrees=function(e){return 180*e/Math.PI},e.ToRadians=function(e){return e*Math.PI/180},e.SmoothAngleChange=function(e,t,r){void 0===r&&(r=.9);var n=this.ToRadians(e),i=this.ToRadians(t);return this.ToDegrees(Math.atan2((1-r)*Math.sin(i)+r*Math.sin(n),(1-r)*Math.cos(i)+r*Math.cos(n)))},e.MakeArray=function(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null},e.GetPointerPrefix=function(e){var t=\"pointer\";return(0,o.BA)()&&!window.PointerEvent&&(t=\"mouse\"),!e._badDesktopOS||e._badOS||document&&\"ontouchend\"in document||(t=\"mouse\"),t},e.SetCorsBehavior=function(e,t){(0,d.M1)(e,t)},e.SetReferrerPolicyBehavior=function(e,t){t.referrerPolicy=e},Object.defineProperty(e,\"PreprocessUrl\",{get:function(){return d.eC.PreprocessUrl},set:function(e){d.eC.PreprocessUrl=e},enumerable:!1,configurable:!0}),e.LoadImage=function(e,t,r,n,i,o){return(0,d.W$)(e,t,r,n,i,o)},e.LoadFile=function(e,t,r,n,i,o){return(0,d.zU)(e,t,r,n,i,o)},e.LoadFileAsync=function(e,t){return void 0===t&&(t=!0),new Promise((function(r,n){(0,d.zU)(e,(function(e){r(e)}),void 0,void 0,t,(function(e,t){n(t)}))}))},e.GetBabylonScriptURL=function(t,r){if(!t)return\"\";if(e.ScriptBaseUrl&&t.startsWith(e._DefaultCdnUrl)){var n=\"/\"===e.ScriptBaseUrl[e.ScriptBaseUrl.length-1]?e.ScriptBaseUrl.substring(0,e.ScriptBaseUrl.length-1):e.ScriptBaseUrl;t=t.replace(e._DefaultCdnUrl,n)}return t=e.ScriptPreprocessUrl(t),r&&(t=e.GetAbsoluteUrl(t)),t},e.LoadBabylonScript=function(t,r,n,i){t=e.GetBabylonScriptURL(t),e.LoadScript(t,r,n)},e.LoadBabylonScriptAsync=function(t){return t=e.GetBabylonScriptURL(t),e.LoadScriptAsync(t)},e.LoadScript=function(e,t,r,n){if(\"function\"!=typeof importScripts)if((0,o.BA)()){var i=document.getElementsByTagName(\"head\")[0],a=document.createElement(\"script\");a.setAttribute(\"type\",\"text/javascript\"),a.setAttribute(\"src\",e),n&&(a.id=n),a.onload=function(){t&&t()},a.onerror=function(t){r&&r(\"Unable to load script '\".concat(e,\"'\"),t)},i.appendChild(a)}else null==r||r(\"Cannot load script '\".concat(e,\"' outside of a window or a worker\"));else try{importScripts(e),t()}catch(t){null==r||r(\"Unable to load script '\".concat(e,\"' in worker\"),t)}},e.LoadScriptAsync=function(e,t){var r=this;return new Promise((function(n,i){r.LoadScript(e,(function(){n()}),(function(e,t){i(t||new Error(e))}),t)}))},e.ReadFileAsDataURL=function(e,t,r){var n=new FileReader,o={onCompleteObservable:new i.cP,abort:function(){return n.abort()}};return n.onloadend=function(){o.onCompleteObservable.notifyObservers(o)},n.onload=function(e){t(e.target.result)},n.onprogress=r,n.readAsDataURL(e),o},e.ReadFile=function(e,t,r,n,i){return(0,d.NJ)(e,t,r,n,i)},e.FileAsURL=function(e){var t=new Blob([e]);return window.URL.createObjectURL(t)},e.Format=function(e,t){return void 0===t&&(t=2),e.toFixed(t)},e.DeepCopy=function(e,t,r,n){s.r.DeepCopy(e,t,r,n)},e.IsEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},e.RegisterTopRootEvents=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];e.addEventListener(n.name,n.handler,!1);try{window.parent&&window.parent.addEventListener(n.name,n.handler,!1)}catch(e){}}},e.UnregisterTopRootEvents=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];e.removeEventListener(n.name,n.handler);try{e.parent&&e.parent.removeEventListener(n.name,n.handler)}catch(e){}}},e.DumpFramebuffer=function(e,t,r,i,o,a,s){return void 0===o&&(o=\"image/png\"),(0,n.sH)(this,void 0,void 0,(function(){return(0,n.YH)(this,(function(e){throw(0,c.n)(\"DumpTools\")}))}))},e.DumpData=function(e,t,r,n,i,o,a,s,l){throw void 0===i&&(i=\"image/png\"),void 0===a&&(a=!1),void 0===s&&(s=!1),(0,c.n)(\"DumpTools\")},e.DumpDataAsync=function(e,t,r,n,i,o,a,s){throw void 0===n&&(n=\"image/png\"),void 0===o&&(o=!1),void 0===a&&(a=!1),(0,c.n)(\"DumpTools\")},e._IsOffScreenCanvas=function(e){return void 0!==e.convertToBlob},e.ToBlob=function(t,r,n,i){void 0===n&&(n=\"image/png\"),e._IsOffScreenCanvas(t)||t.toBlob||(t.toBlob=function(e,t,r){var n=this;setTimeout((function(){for(var i=atob(n.toDataURL(t,r).split(\",\")[1]),o=i.length,a=new Uint8Array(o),s=0;s<o;s++)a[s]=i.charCodeAt(s);e(new Blob([a]))}))}),e._IsOffScreenCanvas(t)?t.convertToBlob({type:n,quality:i}).then((function(e){return r(e)})):t.toBlob((function(e){r(e)}),n,i)},e.DownloadBlob=function(t,r){if(\"download\"in document.createElement(\"a\")){if(!r){var n=new Date;r=\"screenshot_\"+(n.getFullYear()+\"-\"+(n.getMonth()+1)).slice(2)+\"-\"+n.getDate()+\"_\"+n.getHours()+\"-\"+(\"0\"+n.getMinutes()).slice(-2)+\".png\"}e.Download(t,r)}else if(t&&\"undefined\"!=typeof URL){var i=URL.createObjectURL(t),o=window.open(\"\");if(!o)return;var a=o.document.createElement(\"img\");a.onload=function(){URL.revokeObjectURL(i)},a.src=i,o.document.body.appendChild(a)}},e.EncodeScreenshotCanvasData=function(t,r,n,i,o){if(void 0===n&&(n=\"image/png\"),\"string\"!=typeof i&&r){if(r){if(e._IsOffScreenCanvas(t))return void t.convertToBlob({type:n,quality:o}).then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){var e=t.result;r(e)}}));var a=t.toDataURL(n,o);r(a)}}else this.ToBlob(t,(function(t){t&&e.DownloadBlob(t,i),r&&r(\"\")}),n,o)},e.Download=function(e,t){if(\"undefined\"!=typeof URL){var r=window.URL.createObjectURL(e),n=document.createElement(\"a\");document.body.appendChild(n),n.style.display=\"none\",n.href=r,n.download=t,n.addEventListener(\"click\",(function(){n.parentElement&&n.parentElement.removeChild(n)})),n.click(),window.URL.revokeObjectURL(r)}},e.BackCompatCameraNoPreventDefault=function(e){return\"boolean\"==typeof e[0]?e[0]:\"boolean\"==typeof e[1]&&e[1]},e.CreateScreenshot=function(e,t,r,n,i,o,a){throw void 0===i&&(i=\"image/png\"),void 0===o&&(o=!1),(0,c.n)(\"ScreenshotTools\")},e.CreateScreenshotAsync=function(e,t,r,n,i){throw void 0===n&&(n=\"image/png\"),(0,c.n)(\"ScreenshotTools\")},e.CreateScreenshotUsingRenderTarget=function(e,t,r,n,i,o,a,s,l,u,h,d,f){throw void 0===i&&(i=\"image/png\"),void 0===o&&(o=1),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===h&&(h=!0),(0,c.n)(\"ScreenshotTools\")},e.CreateScreenshotUsingRenderTargetAsync=function(e,t,r,n,i,o,a,s,l,u,h,d){throw void 0===n&&(n=\"image/png\"),void 0===i&&(i=1),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===u&&(u=!0),(0,c.n)(\"ScreenshotTools\")},e.RandomId=function(){return(0,_.z)()},e.IsBase64=function(e){return(0,d.f2)(e)},e.DecodeBase64=function(e){return(0,d.rz)(e)},Object.defineProperty(e,\"errorsCount\",{get:function(){return a.V.errorsCount},enumerable:!1,configurable:!0}),e.Log=function(e){a.V.Log(e)},e.Warn=function(e){a.V.Warn(e)},e.Error=function(e){a.V.Error(e)},Object.defineProperty(e,\"LogCache\",{get:function(){return a.V.LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){a.V.ClearLogCache()},Object.defineProperty(e,\"LogLevels\",{set:function(e){a.V.LogLevels=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,\"PerformanceLogLevel\",{set:function(t){return(t&e.PerformanceUserMarkLogLevel)===e.PerformanceUserMarkLogLevel?(e.StartPerformanceCounter=e._StartUserMark,void(e.EndPerformanceCounter=e._EndUserMark)):(t&e.PerformanceConsoleLogLevel)===e.PerformanceConsoleLogLevel?(e.StartPerformanceCounter=e._StartPerformanceConsole,void(e.EndPerformanceCounter=e._EndPerformanceConsole)):(e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,void(e.EndPerformanceCounter=e._EndPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),e._StartPerformanceCounterDisabled=function(e,t){},e._EndPerformanceCounterDisabled=function(e,t){},e._StartUserMark=function(t,r){if(void 0===r&&(r=!0),!e._Performance){if(!(0,o.BA)())return;e._Performance=window.performance}r&&e._Performance.mark&&e._Performance.mark(t+\"-Begin\")},e._EndUserMark=function(t,r){void 0===r&&(r=!0),r&&e._Performance.mark&&(e._Performance.mark(t+\"-End\"),e._Performance.measure(t,t+\"-Begin\",t+\"-End\"))},e._StartPerformanceConsole=function(t,r){void 0===r&&(r=!0),r&&(e._StartUserMark(t,r),console.time&&console.time(t))},e._EndPerformanceConsole=function(t,r){void 0===r&&(r=!0),r&&(e._EndUserMark(t,r),console.timeEnd(t))},Object.defineProperty(e,\"Now\",{get:function(){return l.j.Now},enumerable:!1,configurable:!0}),e.GetClassName=function(e,t){void 0===t&&(t=!1);var r=null;return!t&&e.getClassName?r=e.getClassName():(e instanceof Object&&(r=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__),r||(r=typeof e)),r},e.First=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(t(i))return i}return null},e.getFullClassName=function(e,t){void 0===t&&(t=!1);var r=null,n=null;if(!t&&e.getClassName)r=e.getClassName();else{if(e instanceof Object){var i=t?e:Object.getPrototypeOf(e);r=i.constructor.__bjsclassName__,n=i.constructor.__bjsmoduleName__}r||(r=typeof e)}return r?(null!=n?n+\".\":\"\")+r:null},e.DelayAsync=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},e.IsSafari=function(){return!!(0,o.XD)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.UseCustomRequestHeaders=!1,e.CustomRequestHeaders=u.u.CustomRequestHeaders,e.GetDOMTextContent=o.Zl,e._DefaultCdnUrl=\"https://cdn.babylonjs.com\",e.GetAbsoluteUrl=\"object\"==typeof document?function(e){var t=document.createElement(\"a\");return t.href=e,t.href}:\"function\"==typeof URL&&\"object\"==typeof location?function(e){return new URL(e,location.origin).href}:function(){throw new Error(\"Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.\")},e.NoneLogLevel=a.V.NoneLogLevel,e.MessageLogLevel=a.V.MessageLogLevel,e.WarningLogLevel=a.V.WarningLogLevel,e.ErrorLogLevel=a.V.ErrorLogLevel,e.AllLogLevel=a.V.AllLogLevel,e.IsWindowObjectExist=o.BA,e.PerformanceNoneLogLevel=0,e.PerformanceUserMarkLogLevel=1,e.PerformanceConsoleLogLevel=2,e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,e.EndPerformanceCounter=e._EndPerformanceCounterDisabled,e}();function v(e,t){return function(r){r.__bjsclassName__=e,r.__bjsmoduleName__=null!=t?t:null}}var y=function(){function e(e,t,r,n){void 0===n&&(n=0),this.iterations=e,this.index=n-1,this._done=!1,this._fn=t,this._successCallback=r}return e.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},e.prototype.breakLoop=function(){this._done=!0,this._successCallback()},e.Run=function(t,r,n,i){void 0===i&&(i=0);var o=new e(t,r,n,i);return o.executeNext(),o},e.SyncAsyncForLoop=function(t,r,n,i,o,a){return void 0===a&&(a=0),e.Run(Math.ceil(t/r),(function(e){o&&o()?e.breakLoop():setTimeout((function(){for(var i=0;i<r;++i){var a=e.index*r+i;if(a>=t)break;if(n(a),o&&o()){e.breakLoop();break}}e.executeNext()}),a)}),i)},e}();g.Mix=m.zF,g.IsExponentOfTwo=m.L8,h.q.FallbackTexture=\"data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z\"},34623:(e,t,r)=>{r.d(t,{Uu:()=>a,Y5:()=>i,n9:()=>o});var n={};function i(e,t){n[e]=t}function o(e){return n[e]}function a(e){for(var t in n)if(e instanceof n[t]&&!t.includes(\"Abstract\"))return t;return\"Unknown\"}},62273:(e,t,r)=>{r.d(t,{K:()=>n});var n=function(){function e(){}return Object.defineProperty(e,\"UniqueId\",{get:function(){var e=this._UniqueIdCounter;return this._UniqueIdCounter++,e},enumerable:!1,configurable:!0}),e._UniqueIdCounter=1,e}()},46799:(e,t,r)=>{r.d(t,{u:()=>n});var n=function(){function e(){this._xhr=\"undefined\"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=\"\"}return Object.defineProperty(e,\"IsCustomRequestAvailable\",{get:function(){return Object.keys(e.CustomRequestHeaders).length>0||e.CustomRequestModifiers.length>0},enumerable:!1,configurable:!0}),e.prototype._injectCustomRequestHeaders=function(){if(!this._shouldSkipRequestModifications(this._requestURL))for(var t in e.CustomRequestHeaders){var r=e.CustomRequestHeaders[t];r&&this._xhr.setRequestHeader(t,r)}},e.prototype._shouldSkipRequestModifications=function(t){return e.SkipRequestModificationForBabylonCDN&&(t.includes(\"preview.babylonjs.com\")||t.includes(\"cdn.babylonjs.com\"))},Object.defineProperty(e.prototype,\"onprogress\",{get:function(){return this._xhr.onprogress},set:function(e){this._xhr.onprogress=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"readyState\",{get:function(){return this._xhr.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"status\",{get:function(){return this._xhr.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"statusText\",{get:function(){return this._xhr.statusText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"response\",{get:function(){return this._xhr.response},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"responseURL\",{get:function(){return this._xhr.responseURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"responseText\",{get:function(){return this._xhr.responseText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"responseType\",{get:function(){return this._xhr.responseType},set:function(e){this._xhr.responseType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"timeout\",{get:function(){return this._xhr.timeout},set:function(e){this._xhr.timeout=e},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e,t,r){this._xhr.addEventListener(e,t,r)},e.prototype.removeEventListener=function(e,t,r){this._xhr.removeEventListener(e,t,r)},e.prototype.abort=function(){this._xhr.abort()},e.prototype.send=function(t){e.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)},e.prototype.open=function(t,r){for(var n=0,i=e.CustomRequestModifiers;n<i.length;n++){var o=i[n];if(this._shouldSkipRequestModifications(r))return;o(this._xhr,r)}r=(r=r.replace(\"file:http:\",\"http:\")).replace(\"file:https:\",\"https:\"),this._requestURL=r,this._xhr.open(t,r,!0)},e.prototype.setRequestHeader=function(e,t){this._xhr.setRequestHeader(e,t)},e.prototype.getResponseHeader=function(e){return this._xhr.getResponseHeader(e)},e.CustomRequestHeaders={},e.CustomRequestModifiers=new Array,e.SkipRequestModificationForBabylonCDN=!0,e}()},80244:(e,t,r)=>{r.d(t,{T:()=>i,h:()=>o});var n=r(78322),i=function(){function e(e){this._pendingActions=new Array,this._workerInfos=e.map((function(e){return{workerPromise:Promise.resolve(e),idle:!0}}))}return e.prototype.dispose=function(){for(var e=0,t=this._workerInfos;e<t.length;e++)t[e].workerPromise.then((function(e){e.terminate()}));this._workerInfos.length=0,this._pendingActions.length=0},e.prototype.push=function(e){this._executeOnIdleWorker(e)||this._pendingActions.push(e)},e.prototype._executeOnIdleWorker=function(e){for(var t=0,r=this._workerInfos;t<r.length;t++){var n=r[t];if(n.idle)return this._execute(n,e),!0}return!1},e.prototype._execute=function(e,t){var r=this;e.idle=!1,e.workerPromise.then((function(n){t(n,(function(){var t=r._pendingActions.shift();t?r._execute(e,t):e.idle=!0}))}))},e}(),o=function(e){function t(r,n,i){void 0===i&&(i=t.DefaultOptions);var o=e.call(this,[])||this;return o._maxWorkers=r,o._createWorkerAsync=n,o._options=i,o}return(0,n.C6)(t,e),t.prototype.push=function(e){if(!this._executeOnIdleWorker(e))if(this._workerInfos.length<this._maxWorkers){var t={workerPromise:this._createWorkerAsync(),idle:!1};this._workerInfos.push(t),this._execute(t,e)}else this._pendingActions.push(e)},t.prototype._execute=function(t,r){var n=this;t.timeoutId&&(clearTimeout(t.timeoutId),delete t.timeoutId),e.prototype._execute.call(this,t,(function(e,i){r(e,(function(){i(),t.idle&&(t.timeoutId=setTimeout((function(){t.workerPromise.then((function(e){e.terminate()}));var e=n._workerInfos.indexOf(t);-1!==e&&n._workerInfos.splice(e,1)}),n._options.idleTimeElapsedBeforeRelease))}))}))},t.DefaultOptions={idleTimeElapsedBeforeRelease:1e3},t}(i)},73441:(e,t,r)=>{r.d(t,{s:()=>u,v:()=>c});var n=r(78322),i=r(81152),o=r(30622),a=r(82673),s=r(34623),l=r(12028),c=function(e){function t(t,r,n,o,a,s,l,c){return void 0===n&&(n=null),void 0===l&&(l=i.Y.TEXTURETYPE_UNSIGNED_INT),void 0===c&&(c=!1),e.call(this,t,\"pass\",null,null,r,n,o,a,s,void 0,l,void 0,null,c)||this}return(0,n.C6)(t,e),t.prototype.getClassName=function(){return\"PassPostProcess\"},t.prototype._gatherImports=function(t,n){t?(this._webGPUReady=!0,n.push(Promise.all([Promise.resolve().then(r.bind(r,59448))]))):n.push(Promise.all([Promise.resolve().then(r.bind(r,56017))])),e.prototype._gatherImports.call(this,t,n)},t._Parse=function(e,r,n,i){return l.p.Parse((function(){return new t(e.name,e.options,r,e.renderTargetSamplingMode,e._engine,e.reusable)}),e,n,i)},t}(o.w);(0,s.Y5)(\"BABYLON.PassPostProcess\",c);var u=function(e){function t(t,r,n,o,a,s,l,c){void 0===n&&(n=null),void 0===l&&(l=i.Y.TEXTURETYPE_UNSIGNED_INT),void 0===c&&(c=!1);var u=e.call(this,t,\"passCube\",null,null,r,n,o,a,s,\"#define POSITIVEX\",l,void 0,null,c)||this;return u._face=0,u}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,\"face\",{get:function(){return this._face},set:function(e){if(!(e<0||e>5))switch(this._face=e,this._face){case 0:this.updateEffect(\"#define POSITIVEX\");break;case 1:this.updateEffect(\"#define NEGATIVEX\");break;case 2:this.updateEffect(\"#define POSITIVEY\");break;case 3:this.updateEffect(\"#define NEGATIVEY\");break;case 4:this.updateEffect(\"#define POSITIVEZ\");break;case 5:this.updateEffect(\"#define NEGATIVEZ\")}},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return\"PassCubePostProcess\"},t.prototype._gatherImports=function(t,n){t?(this._webGPUReady=!0,n.push(Promise.all([Promise.resolve().then(r.bind(r,33739))]))):n.push(Promise.all([Promise.resolve().then(r.bind(r,25750))])),e.prototype._gatherImports.call(this,t,n)},t._Parse=function(e,r,n,i){return l.p.Parse((function(){return new t(e.name,e.options,r,e.renderTargetSamplingMode,e._engine,e.reusable)}),e,n,i)},t}(o.w);a.$._RescalePostProcessFactory=function(e){return new c(\"rescale\",1,null,i.Y.TEXTURE_BILINEAR_SAMPLINGMODE,e,!1,i.Y.TEXTURETYPE_UNSIGNED_INT)}},30622:(e,t,r)=>{r.d(t,{w:()=>_});var n=r(78322),i=r(53770),o=r(66377),a=r(8046),s=r(74239),l=r(81152),c=(r(96795),r(71073),r(6174)),u=r(12028),h=r(34623),d=r(14777),f=r(82673),p=r(87074);f.$.prototype.setTextureFromPostProcess=function(e,t,r){var n,i=null;t&&(t._forcedOutputTexture?i=t._forcedOutputTexture:t._textures.data[t._currentRenderTextureInd]&&(i=t._textures.data[t._currentRenderTextureInd])),this._bindTexture(e,null!==(n=null==i?void 0:i.texture)&&void 0!==n?n:null,r)},f.$.prototype.setTextureFromPostProcessOutput=function(e,t,r){var n,i;this._bindTexture(e,null!==(i=null===(n=null==t?void 0:t._outputTexture)||void 0===n?void 0:n.texture)&&void 0!==i?i:null,r)},s.M.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)},s.M.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)};var _=function(){function e(e,t,r,n,s,c,u,h,f,p,_,m,g,v,y,b,S){var T,E,x,P,C,A,R,I,M,O,D,N;void 0===u&&(u=l.Y.TEXTURE_NEAREST_SAMPLINGMODE),void 0===p&&(p=null),void 0===_&&(_=l.Y.TEXTURETYPE_UNSIGNED_INT),void 0===m&&(m=\"postprocess\"),void 0===v&&(v=!1),void 0===y&&(y=l.Y.TEXTUREFORMAT_RGBA),this._parentContainer=null,this.width=-1,this.height=-1,this.nodeMaterialSource=null,this._outputTexture=null,this.autoClear=!0,this.forceAutoClearInAlphaMode=!1,this.alphaMode=l.Y.ALPHA_DISABLE,this.animations=[],this.enablePixelPerfectMode=!1,this.forceFullscreenViewport=!0,this.scaleMode=l.Y.SCALEMODE_FLOOR,this.alwaysForcePOT=!1,this._samples=1,this.adaptScaleToCurrentViewport=!1,this._shadersLoaded=!1,this._webGPUReady=!1,this._reusable=!1,this._renderId=0,this.externalTextureSamplerBinding=!1,this._textures=new i.L(2),this._textureCache=[],this._currentRenderTextureInd=0,this._scaleRatio=new a.I9(1,1),this._texelSize=a.I9.Zero(),this.onEffectCreatedObservable=new o.cP(void 0,!0),this.onActivateObservable=new o.cP,this.onSizeChangedObservable=new o.cP,this.onApplyObservable=new o.cP,this.onBeforeRenderObservable=new o.cP,this.onAfterRenderObservable=new o.cP,this._importPromises=[],this.name=e;var L=1,F=null;if(r&&!Array.isArray(r)){var w=r;r=null!==(T=w.uniforms)&&void 0!==T?T:null,n=null!==(E=w.samplers)&&void 0!==E?E:null,L=null!==(x=w.size)&&void 0!==x?x:1,c=null!==(P=w.camera)&&void 0!==P?P:null,u=null!==(C=w.samplingMode)&&void 0!==C?C:l.Y.TEXTURE_NEAREST_SAMPLINGMODE,h=w.engine,f=w.reusable,p=null!==(A=w.defines)&&void 0!==A?A:null,_=null!==(R=w.textureType)&&void 0!==R?R:l.Y.TEXTURETYPE_UNSIGNED_INT,m=null!==(I=w.vertexUrl)&&void 0!==I?I:\"postprocess\",g=w.indexParameters,v=null!==(M=w.blockCompilation)&&void 0!==M&&M,y=null!==(O=w.textureFormat)&&void 0!==O?O:l.Y.TEXTUREFORMAT_RGBA,b=null!==(D=w.shaderLanguage)&&void 0!==D?D:0,F=null!==(N=w.uniformBuffers)&&void 0!==N?N:null,S=w.extraInitializations}else s&&(L=\"number\"==typeof s?s:{width:s.width,height:s.height});null!=c?(this._camera=c,this._scene=c.getScene(),c.attachPostProcess(this),this._engine=this._scene.getEngine(),this._scene.postProcesses.push(this),this.uniqueId=this._scene.getUniqueId()):h&&(this._engine=h,this._engine.postProcesses.push(this)),this._options=L,this.renderTargetSamplingMode=u||l.Y.TEXTURE_NEAREST_SAMPLINGMODE,this._reusable=f||!1,this._textureType=_,this._textureFormat=y,this._shaderLanguage=b||0,this._samplers=n||[],this._samplers.push(\"textureSampler\"),this._fragmentUrl=t,this._vertexUrl=m,this._parameters=r||[],this._parameters.push(\"scale\"),this._uniformBuffers=F||[],this._indexParameters=g,this._drawWrapper=new d.E(this._engine),this._webGPUReady=1===this._shaderLanguage,this._postConstructor(v,p,S)}return e.RegisterShaderCodeProcessing=function(t,r){r?e._CustomShaderCodeProcessing[null!=t?t:\"\"]=r:delete e._CustomShaderCodeProcessing[null!=t?t:\"\"]},e._GetShaderCodeProcessing=function(t){var r;return null!==(r=e._CustomShaderCodeProcessing[t])&&void 0!==r?r:e._CustomShaderCodeProcessing[\"\"]},Object.defineProperty(e.prototype,\"samples\",{get:function(){return this._samples},set:function(e){var t=this;this._samples=Math.min(e,this._engine.getCaps().maxMSAASamples),this._textures.forEach((function(e){e.setSamples(t._samples)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"shaderLanguage\",{get:function(){return this._shaderLanguage},enumerable:!1,configurable:!0}),e.prototype.getEffectName=function(){return this._fragmentUrl},Object.defineProperty(e.prototype,\"onActivate\",{set:function(e){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver),e&&(this._onActivateObserver=this.onActivateObservable.add(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onSizeChanged\",{set:function(e){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver),this._onSizeChangedObserver=this.onSizeChangedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onApply\",{set:function(e){this._onApplyObserver&&this.onApplyObservable.remove(this._onApplyObserver),this._onApplyObserver=this.onApplyObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onBeforeRender\",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onAfterRender\",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"inputTexture\",{get:function(){return this._textures.data[this._currentRenderTextureInd]},set:function(e){this._forcedOutputTexture=e},enumerable:!1,configurable:!0}),e.prototype.restoreDefaultInputTexture=function(){this._forcedOutputTexture&&(this._forcedOutputTexture=null,this.markTextureDirty())},e.prototype.getCamera=function(){return this._camera},Object.defineProperty(e.prototype,\"texelSize\",{get:function(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.texelSize:(this._forcedOutputTexture&&this._texelSize.copyFromFloats(1/this._forcedOutputTexture.width,1/this._forcedOutputTexture.height),this._texelSize)},enumerable:!1,configurable:!0}),e.prototype._gatherImports=function(e,t){void 0===e&&(e=!1),e&&this._webGPUReady?t.push(Promise.all([Promise.resolve().then(r.bind(r,3072))])):t.push(Promise.all([Promise.resolve().then(r.bind(r,96795))]))},e.prototype._postConstructor=function(t,r,n){void 0===r&&(r=null);var i=this.getEngine().isWebGPU&&!e.ForceGLSL;this._gatherImports(i,this._importPromises),n&&n(i,this._importPromises),i&&this._webGPUReady&&(this._shaderLanguage=1),t||this.updateEffect(r)},e.prototype.getClassName=function(){return\"PostProcess\"},e.prototype.getEngine=function(){return this._engine},e.prototype.getEffect=function(){return this._drawWrapper.effect},e.prototype.shareOutputWith=function(e){return this._disposeTextures(),this._shareOutputWithPostProcess=e,this},e.prototype.useOwnOutput=function(){0==this._textures.length&&(this._textures=new i.L(2)),this._shareOutputWithPostProcess=null},e.prototype.updateEffect=function(t,r,i,o,a,s,l,c){var u,h,d=this;void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=null);var f=e._GetShaderCodeProcessing(this.name);if(null==f?void 0:f.defineCustomBindings){var p=null!==(u=null==r?void 0:r.slice())&&void 0!==u?u:[];p.push.apply(p,this._parameters);var _=null!==(h=null==i?void 0:i.slice())&&void 0!==h?h:[];_.push.apply(_,this._samplers),t=f.defineCustomBindings(this.name,t,p,_),r=p,i=_}this._postProcessDefines=t,this._drawWrapper.effect=this._engine.createEffect({vertex:null!=l?l:this._vertexUrl,fragment:null!=c?c:this._fragmentUrl},{attributes:[\"position\"],uniformsNames:r||this._parameters,uniformBuffersNames:this._uniformBuffers,samplers:i||this._samplers,defines:null!==t?t:\"\",fallbacks:null,onCompiled:null!=a?a:null,onError:null!=s?s:null,indexParameters:o||this._indexParameters,processCodeAfterIncludes:(null==f?void 0:f.processCodeAfterIncludes)?function(e,t){return f.processCodeAfterIncludes(d.name,e,t)}:null,processFinalCode:(null==f?void 0:f.processFinalCode)?function(e,t){return f.processFinalCode(d.name,e,t)}:null,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:function(){return(0,n.sH)(d,void 0,void 0,(function(){return(0,n.YH)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(this._importPromises)];case 1:return e.sent(),this._shadersLoaded=!0,[2]}}))}))}},this._engine),this.onEffectCreatedObservable.notifyObservers(this._drawWrapper.effect)},e.prototype.isReusable=function(){return this._reusable},e.prototype.markTextureDirty=function(){this.width=-1},e.prototype._createRenderTargetTexture=function(e,t,r){void 0===r&&(r=0);for(var n=0;n<this._textureCache.length;n++)if(this._textureCache[n].texture.width===e.width&&this._textureCache[n].texture.height===e.height&&this._textureCache[n].postProcessChannel===r&&this._textureCache[n].texture._generateDepthBuffer===t.generateDepthBuffer&&this._textureCache[n].texture.samples===t.samples)return this._textureCache[n].texture;var i=this._engine.createRenderTargetTexture(e,t);return this._textureCache.push({texture:i,postProcessChannel:r,lastUsedRenderId:-1}),i},e.prototype._flushTextureCache=function(){for(var e=this._renderId,t=this._textureCache.length-1;t>=0;t--)if(e-this._textureCache[t].lastUsedRenderId>100){for(var r=!1,n=0;n<this._textures.length;n++)if(this._textures.data[n]===this._textureCache[t].texture){r=!0;break}r||(this._textureCache[t].texture.dispose(),this._textureCache.splice(t,1))}},e.prototype.resize=function(e,t,r,n,i){void 0===r&&(r=null),void 0===n&&(n=!1),void 0===i&&(i=!1),this._textures.length>0&&this._textures.reset(),this.width=e,this.height=t;var o=null;if(r)for(var a=0;a<r._postProcesses.length;a++)if(null!==r._postProcesses[a]){o=r._postProcesses[a];break}var s={width:this.width,height:this.height},l={generateMipMaps:n,generateDepthBuffer:i||o===this,generateStencilBuffer:(i||o===this)&&this._engine.isStencilEnable,samplingMode:this.renderTargetSamplingMode,type:this._textureType,format:this._textureFormat,samples:this._samples,label:\"PostProcessRTT-\"+this.name};this._textures.push(this._createRenderTargetTexture(s,l,0)),this._reusable&&this._textures.push(this._createRenderTargetTexture(s,l,1)),this._texelSize.copyFromFloats(1/this.width,1/this.height),this.onSizeChangedObservable.notifyObservers(this)},e.prototype._getTarget=function(){var e;if(this._shareOutputWithPostProcess)e=this._shareOutputWithPostProcess.inputTexture;else if(this._forcedOutputTexture)e=this._forcedOutputTexture,this.width=this._forcedOutputTexture.width,this.height=this._forcedOutputTexture.height;else{e=this.inputTexture;for(var t=void 0,r=0;r<this._textureCache.length;r++)if(this._textureCache[r].texture===e){t=this._textureCache[r];break}t&&(t.lastUsedRenderId=this._renderId)}return e},e.prototype.activate=function(e,t,r){var n,i,o=this;void 0===t&&(t=null);var a=(e=e||this._camera).getScene(),s=a.getEngine(),c=s.getCaps().maxTextureSize,u=(t?t.width:this._engine.getRenderWidth(!0))*this._options|0,h=(t?t.height:this._engine.getRenderHeight(!0))*this._options|0,d=this._options.width||u,f=this._options.height||h,_=this.renderTargetSamplingMode!==l.Y.TEXTURE_NEAREST_LINEAR&&this.renderTargetSamplingMode!==l.Y.TEXTURE_NEAREST_NEAREST&&this.renderTargetSamplingMode!==l.Y.TEXTURE_LINEAR_LINEAR,m=null;if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this.adaptScaleToCurrentViewport){var g=s.currentViewport;g&&(d*=g.width,f*=g.height)}(_||this.alwaysForcePOT)&&(this._options.width||(d=s.needPOTTextures?(0,p.R)(d,c,this.scaleMode):d),this._options.height||(f=s.needPOTTextures?(0,p.R)(f,c,this.scaleMode):f)),this.width===d&&this.height===f&&(m=this._getTarget())||this.resize(d,f,e,_,r),this._textures.forEach((function(e){e.samples!==o.samples&&o._engine.updateRenderTargetTextureSampleCount(e,o.samples)})),this._flushTextureCache(),this._renderId++}return m||(m=this._getTarget()),this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(u/d,h/f),this._engine.bindFramebuffer(m,0,u,h,this.forceFullscreenViewport)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(m,0,void 0,void 0,this.forceFullscreenViewport)),null===(i=(n=this._engine)._debugInsertMarker)||void 0===i||i.call(n,\"post process \".concat(this.name,\" input\")),this.onActivateObservable.notifyObservers(e),this.autoClear&&(this.alphaMode===l.Y.ALPHA_DISABLE||this.forceAutoClearInAlphaMode)&&this._engine.clear(this.clearColor?this.clearColor:a.clearColor,a._allowPostProcessClearColor,!0,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2),m},Object.defineProperty(e.prototype,\"isSupported\",{get:function(){return this._drawWrapper.effect.isSupported},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"aspectRatio\",{get:function(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.aspectRatio:this._forcedOutputTexture?this._forcedOutputTexture.width/this._forcedOutputTexture.height:this.width/this.height},enumerable:!1,configurable:!0}),e.prototype.isReady=function(){var e,t;return null!==(t=null===(e=this._drawWrapper.effect)||void 0===e?void 0:e.isReady())&&void 0!==t&&t},e.prototype.apply=function(){var t,r,n,i;return(null===(t=this._drawWrapper.effect)||void 0===t?void 0:t.isReady())?(this._engine.enableEffect(this._drawWrapper),this._engine.setState(!1),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._engine.setAlphaMode(this.alphaMode),this.alphaConstants&&this.getEngine().setAlphaConstants(this.alphaConstants.r,this.alphaConstants.g,this.alphaConstants.b,this.alphaConstants.a),i=this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?this._forcedOutputTexture:this.inputTexture,this.externalTextureSamplerBinding||this._drawWrapper.effect._bindTexture(\"textureSampler\",null==i?void 0:i.texture),this._drawWrapper.effect.setVector2(\"scale\",this._scaleRatio),this.onApplyObservable.notifyObservers(this._drawWrapper.effect),null===(n=null===(r=e._GetShaderCodeProcessing(this.name))||void 0===r?void 0:r.bindCustomBindings)||void 0===n||n.call(r,this.name,this._drawWrapper.effect),this._drawWrapper.effect):null},e.prototype._disposeTextures=function(){this._shareOutputWithPostProcess||this._forcedOutputTexture?this._disposeTextureCache():(this._disposeTextureCache(),this._textures.dispose())},e.prototype._disposeTextureCache=function(){for(var e=this._textureCache.length-1;e>=0;e--)this._textureCache[e].texture.dispose();this._textureCache.length=0},e.prototype.setPrePassRenderer=function(e){return!!this._prePassEffectConfiguration&&(this._prePassEffectConfiguration=e.addEffectConfiguration(this._prePassEffectConfiguration),this._prePassEffectConfiguration.enabled=!0,!0)},e.prototype.dispose=function(e){var t;if(e=e||this._camera,this._disposeTextures(),this._scene&&-1!==(t=this._scene.postProcesses.indexOf(this))&&this._scene.postProcesses.splice(t,1),this._parentContainer){var r=this._parentContainer.postProcesses.indexOf(this);r>-1&&this._parentContainer.postProcesses.splice(r,1),this._parentContainer=null}if(-1!==(t=this._engine.postProcesses.indexOf(this))&&this._engine.postProcesses.splice(t,1),e){if(e.detachPostProcess(this),0===(t=e._postProcesses.indexOf(this))&&e._postProcesses.length>0){var n=this._camera._getFirstPostProcess();n&&n.markTextureDirty()}this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear(),this.onEffectCreatedObservable.clear()}},e.prototype.serialize=function(){var e=u.p.Serialize(this),t=this.getCamera()||this._scene&&this._scene.activeCamera;return e.customType=\"BABYLON.\"+this.getClassName(),e.cameraId=t?t.id:null,e.reusable=this._reusable,e.textureType=this._textureType,e.fragmentUrl=this._fragmentUrl,e.parameters=this._parameters,e.samplers=this._samplers,e.options=this._options,e.defines=this._postProcessDefines,e.textureFormat=this._textureFormat,e.vertexUrl=this._vertexUrl,e.indexParameters=this._indexParameters,e},e.prototype.clone=function(){var t=this.serialize();t._engine=this._engine,t.cameraId=null;var r=e.Parse(t,this._scene,\"\");return r?(r.onActivateObservable=this.onActivateObservable.clone(),r.onSizeChangedObservable=this.onSizeChangedObservable.clone(),r.onApplyObservable=this.onApplyObservable.clone(),r.onBeforeRenderObservable=this.onBeforeRenderObservable.clone(),r.onAfterRenderObservable=this.onAfterRenderObservable.clone(),r._prePassEffectConfiguration=this._prePassEffectConfiguration,r):null},e.Parse=function(e,t,r){var n=(0,h.n9)(e.customType);if(!n||!n._Parse)return null;var i=t?t.getCameraById(e.cameraId):null;return n._Parse(e,i,t,r)},e._Parse=function(t,r,n,i){return u.p.Parse((function(){return new e(t.name,t.fragmentUrl,t.parameters,t.samplers,t.options,r,t.renderTargetSamplingMode,t._engine,t.reusable,t.defines,t.textureType,t.vertexUrl,t.indexParameters,!1,t.textureFormat)}),t,n,i)},e.ForceGLSL=!1,e._CustomShaderCodeProcessing={},(0,n.Cg)([(0,c.lK)()],e.prototype,\"uniqueId\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"name\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"width\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"height\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"renderTargetSamplingMode\",void 0),(0,n.Cg)([(0,c.qK)()],e.prototype,\"clearColor\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"autoClear\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"forceAutoClearInAlphaMode\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"alphaMode\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"alphaConstants\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"enablePixelPerfectMode\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"forceFullscreenViewport\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"scaleMode\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"alwaysForcePOT\",void 0),(0,n.Cg)([(0,c.lK)(\"samples\")],e.prototype,\"_samples\",void 0),(0,n.Cg)([(0,c.lK)()],e.prototype,\"adaptScaleToCurrentViewport\",void 0),e}();(0,h.Y5)(\"BABYLON.PostProcess\",_)},63639:(e,t,r)=>{r.d(t,{X:()=>a});var n=r(62623),i=r(81152),o=r(66377),a=function(){function e(e){this._vertexBuffers={},this.onBeforeRenderObservable=new o.cP,this._scene=e}return e.prototype._prepareBuffers=function(){if(!this._vertexBuffers[n.R.PositionKind]){var e=[];e.push(1,1),e.push(-1,1),e.push(-1,-1),e.push(1,-1),this._vertexBuffers[n.R.PositionKind]=new n.R(this._scene.getEngine(),e,n.R.PositionKind,!1,!1,2),this._buildIndexBuffer()}},e.prototype._buildIndexBuffer=function(){var e=[];e.push(0),e.push(1),e.push(2),e.push(0),e.push(2),e.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(e)},e.prototype._rebuild=function(){var e=this._vertexBuffers[n.R.PositionKind];e&&(e._rebuild(),this._buildIndexBuffer())},e.prototype._prepareFrame=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var r=this._scene.activeCamera;return!(!r||!(t=t||r._postProcesses.filter((function(e){return null!=e})))||0===t.length||!this._scene.postProcessesEnabled||(t[0].activate(r,e,null!=t),0))},e.prototype.directRender=function(e,t,r,n,o,a){var s;void 0===t&&(t=null),void 0===r&&(r=!1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=!1);for(var l=this._scene.getEngine(),c=0;c<e.length;c++){c<e.length-1?e[c+1].activate(this._scene.activeCamera,null==t?void 0:t.texture):(t?l.bindFramebuffer(t,n,void 0,void 0,r,o):a||l.restoreDefaultFramebuffer(),null===(s=l._debugInsertMarker)||void 0===s||s.call(l,\"post process \".concat(e[c].name,\" output\")));var u=e[c],h=u.apply();h&&(u.onBeforeRenderObservable.notifyObservers(h),this._prepareBuffers(),l.bindBuffers(this._vertexBuffers,this._indexBuffer,h),l.drawElementsType(i.Y.MATERIAL_TriangleFillMode,0,6),u.onAfterRenderObservable.notifyObservers(h))}l.setDepthBuffer(!0),l.setDepthWrite(!0)},e.prototype._finalizeFrame=function(e,t,r,n,o){var a;void 0===o&&(o=!1);var s=this._scene.activeCamera;if(s&&(this.onBeforeRenderObservable.notifyObservers(this),n=n||s._postProcesses.filter((function(e){return null!=e})),0!==n.length&&this._scene.postProcessesEnabled)){for(var l=this._scene.getEngine(),c=0,u=n.length;c<u;c++){var h=n[c];if(c<u-1?h._outputTexture=n[c+1].activate(s,null==t?void 0:t.texture):(t?(l.bindFramebuffer(t,r,void 0,void 0,o),h._outputTexture=t):(l.restoreDefaultFramebuffer(),h._outputTexture=null),null===(a=l._debugInsertMarker)||void 0===a||a.call(l,\"post process \".concat(n[c].name,\" output\"))),e)break;var d=h.apply();d&&(h.onBeforeRenderObservable.notifyObservers(d),this._prepareBuffers(),l.bindBuffers(this._vertexBuffers,this._indexBuffer,d),l.drawElementsType(i.Y.MATERIAL_TriangleFillMode,0,6),h.onAfterRenderObservable.notifyObservers(d))}l.setDepthBuffer(!0),l.setDepthWrite(!0),l.setAlphaMode(i.Y.ALPHA_DISABLE)}},e.prototype.dispose=function(){var e=this._vertexBuffers[n.R.PositionKind];e&&(e.dispose(),this._vertexBuffers[n.R.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)},e}()},85043:(e,t,r)=>{r.d(t,{U:()=>a});var n=r(53770),i=r(8046),o=r(81152),a=function(){function e(e,t,r,i,o){void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.index=e,this._opaqueSubMeshes=new n.L(256),this._transparentSubMeshes=new n.L(256),this._alphaTestSubMeshes=new n.L(256),this._depthOnlySubMeshes=new n.L(256),this._particleSystems=new n.L(256),this._spriteManagers=new n.L(256),this._empty=!0,this._edgesRenderers=new n.b(16),this._scene=t,this.opaqueSortCompareFn=r,this.alphaTestSortCompareFn=i,this.transparentSortCompareFn=o}return Object.defineProperty(e.prototype,\"opaqueSortCompareFn\",{set:function(t){this._opaqueSortCompareFn=t||e.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"alphaTestSortCompareFn\",{set:function(t){this._alphaTestSortCompareFn=t||e.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"transparentSortCompareFn\",{set:function(t){this._transparentSortCompareFn=t||e.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted},enumerable:!1,configurable:!0}),e.prototype.render=function(e,t,r,n){if(e)e(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);else{var i=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(i.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),i.setColorWrite(!0)),0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes),0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);var a=i.getStencilBuffer();if(i.setStencilBuffer(!1),t&&this._renderSprites(),r&&this._renderParticles(n),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length||this._scene.useOrderIndependentTransparency){if(i.setStencilBuffer(a),this._scene.useOrderIndependentTransparency){var s=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);s.length&&this._renderTransparent(s)}else this._renderTransparent(this._transparentSubMeshes);i.setAlphaMode(o.Y.ALPHA_DISABLE)}if(i.setStencilBuffer(!1),this._edgesRenderers.length){for(var l=0;l<this._edgesRenderers.length;l++)this._edgesRenderers.data[l].render();i.setAlphaMode(o.Y.ALPHA_DISABLE)}i.setStencilBuffer(a)}},e.prototype._renderOpaqueSorted=function(t){e._RenderSorted(t,this._opaqueSortCompareFn,this._scene.activeCamera,!1)},e.prototype._renderAlphaTestSorted=function(t){e._RenderSorted(t,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)},e.prototype._renderTransparentSorted=function(t){e._RenderSorted(t,this._transparentSortCompareFn,this._scene.activeCamera,!0)},e._RenderSorted=function(t,r,n,a){var s,l=0,c=n?n.globalPosition:e._ZeroVector;if(a)for(;l<t.length;l++)(s=t.data[l])._alphaIndex=s.getMesh().alphaIndex,s._distanceToCamera=i.Pq.Distance(s.getBoundingInfo().boundingSphere.centerWorld,c);var u=t.length===t.data.length?t.data:t.data.slice(0,t.length);r&&u.sort(r);var h=u[0].getMesh().getScene();for(l=0;l<u.length;l++)if(s=u[l],!h._activeMeshesFrozenButKeepClipping||s.isInFrustum(h._frustumPlanes)){if(a){var d=s.getMaterial();if(d&&d.needDepthPrePass){var f=d.getScene().getEngine();f.setColorWrite(!1),f.setAlphaMode(o.Y.ALPHA_DISABLE),s.render(!1),f.setColorWrite(!0)}}s.render(a)}},e.defaultTransparentSortCompare=function(t,r){return t._alphaIndex>r._alphaIndex?1:t._alphaIndex<r._alphaIndex?-1:e.backToFrontSortCompare(t,r)},e.backToFrontSortCompare=function(e,t){return e._distanceToCamera<t._distanceToCamera?1:e._distanceToCamera>t._distanceToCamera?-1:0},e.frontToBackSortCompare=function(e,t){return e._distanceToCamera<t._distanceToCamera?-1:e._distanceToCamera>t._distanceToCamera?1:0},e.PainterSortCompare=function(e,t){var r=e.getMesh(),n=t.getMesh();return r.material&&n.material?r.material.uniqueId-n.material.uniqueId:r.uniqueId-n.uniqueId},e.prototype.prepare=function(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this.prepareSprites(),this._edgesRenderers.reset(),this._empty=!0},e.prototype.prepareSprites=function(){this._spriteManagers.reset()},e.prototype.dispose=function(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()},e.prototype.dispatch=function(e,t,r){void 0===t&&(t=e.getMesh()),void 0===r&&(r=e.getMaterial()),null!=r&&(r.needAlphaBlendingForMesh(t)?this._transparentSubMeshes.push(e):r.needAlphaTesting()?(r.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._alphaTestSubMeshes.push(e)):(r.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._opaqueSubMeshes.push(e)),t._renderingGroup=this,t._edgesRenderer&&t.isEnabled()&&t.isVisible&&t._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(t._edgesRenderer),this._empty=!1)},e.prototype.dispatchSprites=function(e){this._spriteManagers.push(e),this._empty=!1},e.prototype.dispatchParticles=function(e){this._particleSystems.push(e),this._empty=!1},e.prototype._renderParticles=function(e){if(0!==this._particleSystems.length){var t=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(var r=0;r<this._particleSystems.length;r++){var n=this._particleSystems.data[r];if(0!==(t&&t.layerMask&n.layerMask)){var i=n.emitter;i.position&&e&&-1===e.indexOf(i)||this._scene._activeParticles.addCount(n.render(),!1)}}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}},e.prototype._renderSprites=function(){if(this._scene.spritesEnabled&&0!==this._spriteManagers.length){var e=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(var t=0;t<this._spriteManagers.length;t++){var r=this._spriteManagers.data[t];0!==(e&&e.layerMask&r.layerMask)&&r.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}},e._ZeroVector=i.Pq.Zero(),e}()},7931:(e,t,r)=>{r.d(t,{m:()=>o,o:()=>i});var n=r(85043),i=function(){},o=function(){function e(t){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new i,this._maintainStateBetweenFrames=!1,this._scene=t;for(var r=e.MIN_RENDERINGGROUPS;r<e.MAX_RENDERINGGROUPS;r++)this._autoClearDepthStencil[r]={autoClear:!0,depth:!0,stencil:!0}}return Object.defineProperty(e.prototype,\"maintainStateBetweenFrames\",{get:function(){return this._maintainStateBetweenFrames},set:function(e){e!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=e,this._maintainStateBetweenFrames||this.restoreDispachedFlags())},enumerable:!1,configurable:!0}),e.prototype.restoreDispachedFlags=function(){for(var e=0,t=this._scene.meshes;e<t.length;e++){var r=t[e];if(r.subMeshes)for(var n=0,i=r.subMeshes;n<i.length;n++)i[n]._wasDispatched=!1}if(this._scene.spriteManagers)for(var o=0,a=this._scene.spriteManagers;o<a.length;o++)a[o]._wasDispatched=!1;for(var s=0,l=this._scene.particleSystems;s<l.length;s++)l[s]._wasDispatched=!1},e.prototype.getRenderingGroup=function(e){var t=e||0;return this._prepareRenderingGroup(t),this._renderingGroups[t]},e.prototype._clearDepthStencilBuffer=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,e,t),this._depthStencilBufferAlreadyCleaned=!0)},e.prototype.render=function(t,r,n,i){var o=this._renderingGroupInfo;if(o.scene=this._scene,o.camera=this._scene.activeCamera,this._scene.spriteManagers&&i)for(var a=0;a<this._scene.spriteManagers.length;a++){var s=this._scene.spriteManagers[a];this.dispatchSprites(s)}for(a=e.MIN_RENDERINGGROUPS;a<e.MAX_RENDERINGGROUPS;a++){this._depthStencilBufferAlreadyCleaned=a===e.MIN_RENDERINGGROUPS;var l=this._renderingGroups[a];if(l&&!l._empty){var c=1<<a;if(o.renderingGroupId=a,this._scene.onBeforeRenderingGroupObservable.notifyObservers(o,c),e.AUTOCLEAR){var u=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(a):this._autoClearDepthStencil[a];u&&u.autoClear&&this._clearDepthStencilBuffer(u.depth,u.stencil)}for(var h=0,d=this._scene._beforeRenderingGroupDrawStage;h<d.length;h++)d[h].action(a);l.render(t,i,n,r);for(var f=0,p=this._scene._afterRenderingGroupDrawStage;f<p.length;f++)p[f].action(a);this._scene.onAfterRenderingGroupObservable.notifyObservers(o,c)}}},e.prototype.reset=function(){if(!this.maintainStateBetweenFrames)for(var t=e.MIN_RENDERINGGROUPS;t<e.MAX_RENDERINGGROUPS;t++){var r=this._renderingGroups[t];r&&r.prepare()}},e.prototype.resetSprites=function(){if(!this.maintainStateBetweenFrames)for(var t=e.MIN_RENDERINGGROUPS;t<e.MAX_RENDERINGGROUPS;t++){var r=this._renderingGroups[t];r&&r.prepareSprites()}},e.prototype.dispose=function(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null},e.prototype.freeRenderingGroups=function(){for(var t=e.MIN_RENDERINGGROUPS;t<e.MAX_RENDERINGGROUPS;t++){var r=this._renderingGroups[t];r&&r.dispose()}},e.prototype._prepareRenderingGroup=function(e){void 0===this._renderingGroups[e]&&(this._renderingGroups[e]=new n.U(e,this._scene,this._customOpaqueSortCompareFn[e],this._customAlphaTestSortCompareFn[e],this._customTransparentSortCompareFn[e]))},e.prototype.dispatchSprites=function(e){this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatchSprites(e))},e.prototype.dispatchParticles=function(e){this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatchParticles(e))},e.prototype.dispatch=function(e,t,r){void 0===t&&(t=e.getMesh()),this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(t.renderingGroupId).dispatch(e,t,r))},e.prototype.setRenderingOrder=function(e,t,r,n){if(void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null),this._customOpaqueSortCompareFn[e]=t,this._customAlphaTestSortCompareFn[e]=r,this._customTransparentSortCompareFn[e]=n,this._renderingGroups[e]){var i=this._renderingGroups[e];i.opaqueSortCompareFn=this._customOpaqueSortCompareFn[e],i.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[e],i.transparentSortCompareFn=this._customTransparentSortCompareFn[e]}},e.prototype.setRenderingAutoClearDepthStencil=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),this._autoClearDepthStencil[e]={autoClear:t,depth:r,stencil:n}},e.prototype.getAutoClearDepthStencilSetup=function(e){return this._autoClearDepthStencil[e]},e.MAX_RENDERINGGROUPS=4,e.MIN_RENDERINGGROUPS=0,e.AUTOCLEAR=!0,e}()},27947:(e,t,r)=>{var n=r(98519),i=(r(50851),\"backgroundUboDeclaration\");n.l.IncludesShadersStore[i]=\"layout(std140,column_major) uniform;uniform Material\\n{uniform vec4 vPrimaryColor;uniform vec4 vPrimaryColorShadow;uniform vec2 vDiffuseInfos;uniform vec2 vReflectionInfos;uniform mat4 diffuseMatrix;uniform mat4 reflectionMatrix;uniform vec3 vReflectionMicrosurfaceInfos;uniform float fFovMultiplier;uniform float pointSize;uniform float shadowLevel;uniform float alpha;uniform vec3 vBackgroundCenter;uniform vec4 vReflectionControl;uniform vec2 projectedGroundInfos;};\\n#include<sceneUboDeclaration>\\n\"},49334:(e,t,r)=>{r(98519).l.IncludesShadersStore.bakedVertexAnimation=\"#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\\n{\\n#ifdef INSTANCES\\n#define BVASNAME bakedVertexAnimationSettingsInstanced\\n#else\\n#define BVASNAME bakedVertexAnimationSettings\\n#endif\\nfloat VATStartFrame=BVASNAME.x;float VATEndFrame=BVASNAME.y;float VATOffsetFrame=BVASNAME.z;float VATSpeed=BVASNAME.w;float totalFrames=VATEndFrame-VATStartFrame+1.0;float time=bakedVertexAnimationTime*VATSpeed/totalFrames;float frameCorrection=time<1.0 ? 0.0 : 1.0;float numOfFrames=totalFrames-frameCorrection;float VATFrameNum=fract(time)*numOfFrames;VATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);VATFrameNum=floor(VATFrameNum);VATFrameNum+=VATStartFrame+frameCorrection;mat4 VATInfluence;VATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];\\n#if NUM_BONE_INFLUENCERS>1\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];\\n#endif\\n#if NUM_BONE_INFLUENCERS>2\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];\\n#endif\\n#if NUM_BONE_INFLUENCERS>3\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];\\n#endif\\n#if NUM_BONE_INFLUENCERS>4\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];\\n#endif\\n#if NUM_BONE_INFLUENCERS>5\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];\\n#endif\\n#if NUM_BONE_INFLUENCERS>6\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];\\n#endif\\n#if NUM_BONE_INFLUENCERS>7\\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];\\n#endif\\nfinalWorld=finalWorld*VATInfluence;}\\n#endif\\n\"},64400:(e,t,r)=>{r(98519).l.IncludesShadersStore.bakedVertexAnimationDeclaration=\"#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\\nuniform float bakedVertexAnimationTime;uniform vec2 bakedVertexAnimationTextureSizeInverted;uniform vec4 bakedVertexAnimationSettings;uniform sampler2D bakedVertexAnimationTexture;\\n#ifdef INSTANCES\\nattribute vec4 bakedVertexAnimationSettingsInstanced;\\n#endif\\n#define inline\\nmat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)\\n{float offset=index*4.0;float frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;float dx=bakedVertexAnimationTextureSizeInverted.x;vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));return mat4(m0,m1,m2,m3);}\\n#endif\\n\"},36470:(e,t,r)=>{r.r(t),r.d(t,{bonesDeclaration:()=>o});var n=\"bonesDeclaration\",i=\"#if NUM_BONE_INFLUENCERS>0\\nattribute vec4 matricesIndices;attribute vec4 matricesWeights;\\n#if NUM_BONE_INFLUENCERS>4\\nattribute vec4 matricesIndicesExtra;attribute vec4 matricesWeightsExtra;\\n#endif\\n#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\\n#ifdef BONETEXTURE\\nuniform highp sampler2D boneSampler;uniform float boneTextureWidth;\\n#else\\nuniform mat4 mBones[BonesPerMesh];\\n#endif\\n#ifdef BONES_VELOCITY_ENABLED\\nuniform mat4 mPreviousBones[BonesPerMesh];\\n#endif\\n#ifdef BONETEXTURE\\n#define inline\\nmat4 readMatrixFromRawSampler(sampler2D smp,float index)\\n{float offset=index *4.0;float dx=1.0/boneTextureWidth;vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));return mat4(m0,m1,m2,m3);}\\n#endif\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},76898:(e,t,r)=>{r.r(t),r.d(t,{bonesVertex:()=>o});var n=\"bonesVertex\",i=\"#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\\n#if NUM_BONE_INFLUENCERS>0\\nmat4 influence;\\n#ifdef BONETEXTURE\\ninfluence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];\\n#if NUM_BONE_INFLUENCERS>1\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];\\n#endif\\n#if NUM_BONE_INFLUENCERS>2\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];\\n#endif\\n#if NUM_BONE_INFLUENCERS>3\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];\\n#endif\\n#if NUM_BONE_INFLUENCERS>4\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];\\n#endif\\n#if NUM_BONE_INFLUENCERS>5\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];\\n#endif\\n#if NUM_BONE_INFLUENCERS>6\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];\\n#endif\\n#if NUM_BONE_INFLUENCERS>7\\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];\\n#endif\\n#else\\ninfluence=mBones[int(matricesIndices[0])]*matricesWeights[0];\\n#if NUM_BONE_INFLUENCERS>1\\ninfluence+=mBones[int(matricesIndices[1])]*matricesWeights[1];\\n#endif\\n#if NUM_BONE_INFLUENCERS>2\\ninfluence+=mBones[int(matricesIndices[2])]*matricesWeights[2];\\n#endif\\n#if NUM_BONE_INFLUENCERS>3\\ninfluence+=mBones[int(matricesIndices[3])]*matricesWeights[3];\\n#endif\\n#if NUM_BONE_INFLUENCERS>4\\ninfluence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\\n#endif\\n#if NUM_BONE_INFLUENCERS>5\\ninfluence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\\n#endif\\n#if NUM_BONE_INFLUENCERS>6\\ninfluence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\\n#endif\\n#if NUM_BONE_INFLUENCERS>7\\ninfluence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\\n#endif\\n#endif\\nfinalWorld=finalWorld*influence;\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},90253:(e,t,r)=>{r(98519).l.IncludesShadersStore.boundingBoxRendererUboDeclaration=\"#ifdef WEBGL2\\nuniform vec4 color;uniform mat4 world;uniform mat4 viewProjection;\\n#ifdef MULTIVIEW\\nuniform mat4 viewProjectionR;\\n#endif\\n#else\\nlayout(std140,column_major) uniform;uniform BoundingBoxRenderer {vec4 color;mat4 world;mat4 viewProjection;mat4 viewProjectionR;};\\n#endif\\n\"},56159:(e,t,r)=>{r.r(t),r.d(t,{bumpFragment:()=>o});var n=\"bumpFragment\",i=\"vec2 uvOffset=vec2(0.0,0.0);\\n#if defined(BUMP) || defined(PARALLAX) || defined(DETAIL)\\n#ifdef NORMALXYSCALE\\nfloat normalScale=1.0;\\n#elif defined(BUMP)\\nfloat normalScale=vBumpInfos.y;\\n#else\\nfloat normalScale=1.0;\\n#endif\\n#if defined(TANGENT) && defined(NORMAL)\\nmat3 TBN=vTBN;\\n#elif defined(BUMP)\\nvec2 TBNUV=gl_FrontFacing ? vBumpUV : -vBumpUV;mat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vTangentSpaceParams);\\n#else\\nvec2 TBNUV=gl_FrontFacing ? vDetailUV : -vDetailUV;mat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vec2(1.,1.));\\n#endif\\n#elif defined(ANISOTROPIC)\\n#if defined(TANGENT) && defined(NORMAL)\\nmat3 TBN=vTBN;\\n#else\\nvec2 TBNUV=gl_FrontFacing ? vMainUV1 : -vMainUV1;mat3 TBN=cotangent_frame(normalW,vPositionW,TBNUV,vec2(1.,1.));\\n#endif\\n#endif\\n#ifdef PARALLAX\\nmat3 invTBN=transposeMat3(TBN);\\n#ifdef PARALLAXOCCLUSION\\nuvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,vBumpUV,vBumpInfos.z);\\n#else\\nuvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);\\n#endif\\n#endif\\n#ifdef DETAIL\\nvec4 detailColor=texture2D(detailSampler,vDetailUV+uvOffset);vec2 detailNormalRG=detailColor.wy*2.0-1.0;float detailNormalB=sqrt(1.-saturate(dot(detailNormalRG,detailNormalRG)));vec3 detailNormal=vec3(detailNormalRG,detailNormalB);\\n#endif\\n#ifdef BUMP\\n#ifdef OBJECTSPACE_NORMALMAP\\n#define CUSTOM_FRAGMENT_BUMP_FRAGMENT\\nnormalW=normalize(texture2D(bumpSampler,vBumpUV).xyz *2.0-1.0);normalW=normalize(mat3(normalMatrix)*normalW);\\n#elif !defined(DETAIL)\\nnormalW=perturbNormal(TBN,texture2D(bumpSampler,vBumpUV+uvOffset).xyz,vBumpInfos.y);\\n#else\\nvec3 bumpNormal=texture2D(bumpSampler,vBumpUV+uvOffset).xyz*2.0-1.0;\\n#if DETAIL_NORMALBLENDMETHOD==0 \\ndetailNormal.xy*=vDetailInfos.z;vec3 blendedNormal=normalize(vec3(bumpNormal.xy+detailNormal.xy,bumpNormal.z*detailNormal.z));\\n#elif DETAIL_NORMALBLENDMETHOD==1 \\ndetailNormal.xy*=vDetailInfos.z;bumpNormal+=vec3(0.0,0.0,1.0);detailNormal*=vec3(-1.0,-1.0,1.0);vec3 blendedNormal=bumpNormal*dot(bumpNormal,detailNormal)/bumpNormal.z-detailNormal;\\n#endif\\nnormalW=perturbNormalBase(TBN,blendedNormal,vBumpInfos.y);\\n#endif\\n#elif defined(DETAIL)\\ndetailNormal.xy*=vDetailInfos.z;normalW=perturbNormalBase(TBN,detailNormal,vDetailInfos.z);\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},75394:(e,t,r)=>{r.r(t),r.d(t,{bumpFragmentFunctions:()=>a});var n=r(98519),i=(r(37755),\"bumpFragmentFunctions\"),o=\"#if defined(BUMP)\\n#include<samplerFragmentDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_SAMPLERNAME_,bump)\\n#endif\\n#if defined(DETAIL)\\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_SAMPLERNAME_,detail)\\n#endif\\n#if defined(BUMP) && defined(PARALLAX)\\nconst float minSamples=4.;const float maxSamples=15.;const int iMaxSamples=15;vec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {float parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;parallaxLimit*=parallaxScale;vec2 vOffsetDir=normalize(vViewDirCoT.xy);vec2 vMaxOffset=vOffsetDir*parallaxLimit;float numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));float stepSize=1.0/numSamples;float currRayHeight=1.0;vec2 vCurrOffset=vec2(0,0);vec2 vLastOffset=vec2(0,0);float lastSampledHeight=1.0;float currSampledHeight=1.0;bool keepWorking=true;for (int i=0; i<iMaxSamples; i++)\\n{currSampledHeight=texture2D(bumpSampler,texCoord+vCurrOffset).w;if (!keepWorking)\\n{}\\nelse if (currSampledHeight>currRayHeight)\\n{float delta1=currSampledHeight-currRayHeight;float delta2=(currRayHeight+stepSize)-lastSampledHeight;float ratio=delta1/(delta1+delta2);vCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;keepWorking=false;}\\nelse\\n{currRayHeight-=stepSize;vLastOffset=vCurrOffset;\\n#ifdef PARALLAX_RHS\\nvCurrOffset-=stepSize*vMaxOffset;\\n#else\\nvCurrOffset+=stepSize*vMaxOffset;\\n#endif\\nlastSampledHeight=currSampledHeight;}}\\nreturn vCurrOffset;}\\nvec2 parallaxOffset(vec3 viewDir,float heightScale)\\n{float height=texture2D(bumpSampler,vBumpUV).w;vec2 texCoordOffset=heightScale*viewDir.xy*height;\\n#ifdef PARALLAX_RHS\\nreturn texCoordOffset;\\n#else\\nreturn -texCoordOffset;\\n#endif\\n}\\n#endif\\n\";n.l.IncludesShadersStore[i]=o;var a={name:i,shader:o}},48661:(e,t,r)=>{r.r(t),r.d(t,{bumpFragmentMainFunctions:()=>o});var n=\"bumpFragmentMainFunctions\",i=\"#if defined(BUMP) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC) || defined(DETAIL)\\n#if defined(TANGENT) && defined(NORMAL) \\nvarying mat3 vTBN;\\n#endif\\n#ifdef OBJECTSPACE_NORMALMAP\\nuniform mat4 normalMatrix;\\n#if defined(WEBGL2) || defined(WEBGPU)\\nmat4 toNormalMatrix(mat4 wMatrix)\\n{mat4 ret=inverse(wMatrix);ret=transpose(ret);ret[0][3]=0.;ret[1][3]=0.;ret[2][3]=0.;ret[3]=vec4(0.,0.,0.,1.);return ret;}\\n#else\\nmat4 toNormalMatrix(mat4 m)\\n{float\\na00=m[0][0],a01=m[0][1],a02=m[0][2],a03=m[0][3],\\na10=m[1][0],a11=m[1][1],a12=m[1][2],a13=m[1][3],\\na20=m[2][0],a21=m[2][1],a22=m[2][2],a23=m[2][3],\\na30=m[3][0],a31=m[3][1],a32=m[3][2],a33=m[3][3],\\nb00=a00*a11-a01*a10,\\nb01=a00*a12-a02*a10,\\nb02=a00*a13-a03*a10,\\nb03=a01*a12-a02*a11,\\nb04=a01*a13-a03*a11,\\nb05=a02*a13-a03*a12,\\nb06=a20*a31-a21*a30,\\nb07=a20*a32-a22*a30,\\nb08=a20*a33-a23*a30,\\nb09=a21*a32-a22*a31,\\nb10=a21*a33-a23*a31,\\nb11=a22*a33-a23*a32,\\ndet=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;mat4 mi=mat4(\\na11*b11-a12*b10+a13*b09,\\na02*b10-a01*b11-a03*b09,\\na31*b05-a32*b04+a33*b03,\\na22*b04-a21*b05-a23*b03,\\na12*b08-a10*b11-a13*b07,\\na00*b11-a02*b08+a03*b07,\\na32*b02-a30*b05-a33*b01,\\na20*b05-a22*b02+a23*b01,\\na10*b10-a11*b08+a13*b06,\\na01*b08-a00*b10-a03*b06,\\na30*b04-a31*b02+a33*b00,\\na21*b02-a20*b04-a23*b00,\\na11*b07-a10*b09-a12*b06,\\na00*b09-a01*b07+a02*b06,\\na31*b01-a30*b03-a32*b00,\\na20*b03-a21*b01+a22*b00)/det;return mat4(mi[0][0],mi[1][0],mi[2][0],mi[3][0],\\nmi[0][1],mi[1][1],mi[2][1],mi[3][1],\\nmi[0][2],mi[1][2],mi[2][2],mi[3][2],\\nmi[0][3],mi[1][3],mi[2][3],mi[3][3]);}\\n#endif\\n#endif\\nvec3 perturbNormalBase(mat3 cotangentFrame,vec3 normal,float scale)\\n{\\n#ifdef NORMALXYSCALE\\nnormal=normalize(normal*vec3(scale,scale,1.0));\\n#endif\\nreturn normalize(cotangentFrame*normal);}\\nvec3 perturbNormal(mat3 cotangentFrame,vec3 textureSample,float scale)\\n{return perturbNormalBase(cotangentFrame,textureSample*2.0-1.0,scale);}\\nmat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv,vec2 tangentSpaceParams)\\n{vec3 dp1=dFdx(p);vec3 dp2=dFdy(p);vec2 duv1=dFdx(uv);vec2 duv2=dFdy(uv);vec3 dp2perp=cross(dp2,normal);vec3 dp1perp=cross(normal,dp1);vec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;vec3 bitangent=dp2perp*duv1.y+dp1perp*duv2.y;tangent*=tangentSpaceParams.x;bitangent*=tangentSpaceParams.y;float det=max(dot(tangent,tangent),dot(bitangent,bitangent));float invmax=det==0.0 ? 0.0 : inversesqrt(det);return mat3(tangent*invmax,bitangent*invmax,normal);}\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},35845:(e,t,r)=>{r(98519).l.IncludesShadersStore.bumpVertex=\"#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\\n#if defined(TANGENT) && defined(NORMAL)\\nvec3 tbnNormal=normalize(normalUpdated);vec3 tbnTangent=normalize(tangentUpdated.xyz);vec3 tbnBitangent=cross(tbnNormal,tbnTangent)*tangentUpdated.w;vTBN=mat3(finalWorld)*mat3(tbnTangent,tbnBitangent,tbnNormal);\\n#endif\\n#endif\\n\"},42513:(e,t,r)=>{r(98519).l.IncludesShadersStore.bumpVertexDeclaration=\"#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\\n#if defined(TANGENT) && defined(NORMAL) \\nvarying mat3 vTBN;\\n#endif\\n#endif\\n\"},39643:(e,t,r)=>{r.r(t),r.d(t,{clipPlaneFragment:()=>o});var n=\"clipPlaneFragment\",i=\"#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)\\nif (false) {}\\n#endif\\n#ifdef CLIPPLANE\\nelse if (fClipDistance>0.0)\\n{discard;}\\n#endif\\n#ifdef CLIPPLANE2\\nelse if (fClipDistance2>0.0)\\n{discard;}\\n#endif\\n#ifdef CLIPPLANE3\\nelse if (fClipDistance3>0.0)\\n{discard;}\\n#endif\\n#ifdef CLIPPLANE4\\nelse if (fClipDistance4>0.0)\\n{discard;}\\n#endif\\n#ifdef CLIPPLANE5\\nelse if (fClipDistance5>0.0)\\n{discard;}\\n#endif\\n#ifdef CLIPPLANE6\\nelse if (fClipDistance6>0.0)\\n{discard;}\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},27003:(e,t,r)=>{r.r(t),r.d(t,{clipPlaneFragmentDeclaration:()=>o});var n=\"clipPlaneFragmentDeclaration\",i=\"#ifdef CLIPPLANE\\nvarying float fClipDistance;\\n#endif\\n#ifdef CLIPPLANE2\\nvarying float fClipDistance2;\\n#endif\\n#ifdef CLIPPLANE3\\nvarying float fClipDistance3;\\n#endif\\n#ifdef CLIPPLANE4\\nvarying float fClipDistance4;\\n#endif\\n#ifdef CLIPPLANE5\\nvarying float fClipDistance5;\\n#endif\\n#ifdef CLIPPLANE6\\nvarying float fClipDistance6;\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},83057:(e,t,r)=>{r.r(t),r.d(t,{clipPlaneVertex:()=>o});var n=\"clipPlaneVertex\",i=\"#ifdef CLIPPLANE\\nfClipDistance=dot(worldPos,vClipPlane);\\n#endif\\n#ifdef CLIPPLANE2\\nfClipDistance2=dot(worldPos,vClipPlane2);\\n#endif\\n#ifdef CLIPPLANE3\\nfClipDistance3=dot(worldPos,vClipPlane3);\\n#endif\\n#ifdef CLIPPLANE4\\nfClipDistance4=dot(worldPos,vClipPlane4);\\n#endif\\n#ifdef CLIPPLANE5\\nfClipDistance5=dot(worldPos,vClipPlane5);\\n#endif\\n#ifdef CLIPPLANE6\\nfClipDistance6=dot(worldPos,vClipPlane6);\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},85637:(e,t,r)=>{r.r(t),r.d(t,{clipPlaneVertexDeclaration:()=>o});var n=\"clipPlaneVertexDeclaration\",i=\"#ifdef CLIPPLANE\\nuniform vec4 vClipPlane;varying float fClipDistance;\\n#endif\\n#ifdef CLIPPLANE2\\nuniform vec4 vClipPlane2;varying float fClipDistance2;\\n#endif\\n#ifdef CLIPPLANE3\\nuniform vec4 vClipPlane3;varying float fClipDistance3;\\n#endif\\n#ifdef CLIPPLANE4\\nuniform vec4 vClipPlane4;varying float fClipDistance4;\\n#endif\\n#ifdef CLIPPLANE5\\nuniform vec4 vClipPlane5;varying float fClipDistance5;\\n#endif\\n#ifdef CLIPPLANE6\\nuniform vec4 vClipPlane6;varying float fClipDistance6;\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},93130:(e,t,r)=>{r(98519).l.IncludesShadersStore.decalFragment=\"#ifdef DECAL\\n#ifdef GAMMADECAL\\ndecalColor.rgb=toLinearSpace(decalColor.rgb);\\n#endif\\n#ifdef DECAL_SMOOTHALPHA\\ndecalColor.a*=decalColor.a;\\n#endif\\nsurfaceAlbedo.rgb=mix(surfaceAlbedo.rgb,decalColor.rgb,decalColor.a);\\n#endif\\n\"},77740:(e,t,r)=>{r(98519).l.IncludesShadersStore.decalFragmentDeclaration=\"#ifdef DECAL\\nuniform vec4 vDecalInfos;\\n#endif\\n\"},42858:(e,t,r)=>{r(98519).l.IncludesShadersStore.decalVertexDeclaration=\"#ifdef DECAL\\nuniform vec4 vDecalInfos;uniform mat4 decalMatrix;\\n#endif\\n\"},51578:(e,t,r)=>{var n=r(98519),i=(r(50851),r(56174),\"defaultUboDeclaration\");n.l.IncludesShadersStore[i]=\"layout(std140,column_major) uniform;uniform Material\\n{vec4 diffuseLeftColor;vec4 diffuseRightColor;vec4 opacityParts;vec4 reflectionLeftColor;vec4 reflectionRightColor;vec4 refractionLeftColor;vec4 refractionRightColor;vec4 emissiveLeftColor;vec4 emissiveRightColor;vec2 vDiffuseInfos;vec2 vAmbientInfos;vec2 vOpacityInfos;vec2 vReflectionInfos;vec3 vReflectionPosition;vec3 vReflectionSize;vec2 vEmissiveInfos;vec2 vLightmapInfos;vec2 vSpecularInfos;vec3 vBumpInfos;mat4 diffuseMatrix;mat4 ambientMatrix;mat4 opacityMatrix;mat4 reflectionMatrix;mat4 emissiveMatrix;mat4 lightmapMatrix;mat4 specularMatrix;mat4 bumpMatrix;vec2 vTangentSpaceParams;float pointSize;float alphaCutOff;mat4 refractionMatrix;vec4 vRefractionInfos;vec3 vRefractionPosition;vec3 vRefractionSize;vec4 vSpecularColor;vec3 vEmissiveColor;vec4 vDiffuseColor;vec3 vAmbientColor;\\n#define ADDITIONAL_UBO_DECLARATION\\n};\\n#include<sceneUboDeclaration>\\n#include<meshUboDeclaration>\\n\"},15656:(e,t,r)=>{r(98519).l.IncludesShadersStore.depthPrePass=\"#ifdef DEPTHPREPASS\\ngl_FragColor=vec4(0.,0.,0.,1.0);return;\\n#endif\\n\"},86343:(e,t,r)=>{r(98519).l.IncludesShadersStore.fogFragment=\"#ifdef FOG\\nfloat fog=CalcFogFactor();\\n#ifdef PBR\\nfog=toLinearSpace(fog);\\n#endif\\ncolor.rgb=mix(vFogColor,color.rgb,fog);\\n#endif\\n\"},52767:(e,t,r)=>{r.r(t),r.d(t,{fogFragmentDeclaration:()=>o});var n=\"fogFragmentDeclaration\",i=\"#ifdef FOG\\n#define FOGMODE_NONE 0.\\n#define FOGMODE_EXP 1.\\n#define FOGMODE_EXP2 2.\\n#define FOGMODE_LINEAR 3.\\n#define E 2.71828\\nuniform vec4 vFogInfos;uniform vec3 vFogColor;varying vec3 vFogDistance;float CalcFogFactor()\\n{float fogCoeff=1.0;float fogStart=vFogInfos.y;float fogEnd=vFogInfos.z;float fogDensity=vFogInfos.w;float fogDistance=length(vFogDistance);if (FOGMODE_LINEAR==vFogInfos.x)\\n{fogCoeff=(fogEnd-fogDistance)/(fogEnd-fogStart);}\\nelse if (FOGMODE_EXP==vFogInfos.x)\\n{fogCoeff=1.0/pow(E,fogDistance*fogDensity);}\\nelse if (FOGMODE_EXP2==vFogInfos.x)\\n{fogCoeff=1.0/pow(E,fogDistance*fogDistance*fogDensity*fogDensity);}\\nreturn clamp(fogCoeff,0.0,1.0);}\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},62589:(e,t,r)=>{r(98519).l.IncludesShadersStore.fogVertex=\"#ifdef FOG\\nvFogDistance=(view*worldPos).xyz;\\n#endif\\n\"},72153:(e,t,r)=>{r(98519).l.IncludesShadersStore.fogVertexDeclaration=\"#ifdef FOG\\nvarying vec3 vFogDistance;\\n#endif\\n\"},18644:(e,t,r)=>{r(98519).l.IncludesShadersStore.fresnelFunction=\"#ifdef FRESNEL\\nfloat computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)\\n{float fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);return clamp(fresnelTerm,0.,1.);}\\n#endif\\n\"},92518:(e,t,r)=>{r(98519).l.IncludesShadersStore.harmonicsFunctions=\"#ifdef USESPHERICALFROMREFLECTIONMAP\\n#ifdef SPHERICAL_HARMONICS\\nvec3 computeEnvironmentIrradiance(vec3 normal) {return vSphericalL00\\n+ vSphericalL1_1*(normal.y)\\n+ vSphericalL10*(normal.z)\\n+ vSphericalL11*(normal.x)\\n+ vSphericalL2_2*(normal.y*normal.x)\\n+ vSphericalL2_1*(normal.y*normal.z)\\n+ vSphericalL20*((3.0*normal.z*normal.z)-1.0)\\n+ vSphericalL21*(normal.z*normal.x)\\n+ vSphericalL22*(normal.x*normal.x-(normal.y*normal.y));}\\n#else\\nvec3 computeEnvironmentIrradiance(vec3 normal) {float Nx=normal.x;float Ny=normal.y;float Nz=normal.z;vec3 C1=vSphericalZZ.rgb;vec3 Cx=vSphericalX.rgb;vec3 Cy=vSphericalY.rgb;vec3 Cz=vSphericalZ.rgb;vec3 Cxx_zz=vSphericalXX_ZZ.rgb;vec3 Cyy_zz=vSphericalYY_ZZ.rgb;vec3 Cxy=vSphericalXY.rgb;vec3 Cyz=vSphericalYZ.rgb;vec3 Czx=vSphericalZX.rgb;vec3 a1=Cyy_zz*Ny+Cy;vec3 a2=Cyz*Nz+a1;vec3 b1=Czx*Nz+Cx;vec3 b2=Cxy*Ny+b1;vec3 b3=Cxx_zz*Nx+b2;vec3 t1=Cz *Nz+C1;vec3 t2=a2 *Ny+t1;vec3 t3=b3 *Nx+t2;return t3;}\\n#endif\\n#endif\\n\"},10114:(e,t,r)=>{r(98519).l.IncludesShadersStore.hdrFilteringFunctions=\"#ifdef NUM_SAMPLES\\n#if NUM_SAMPLES>0\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\nfloat radicalInverse_VdC(uint bits) \\n{bits=(bits<<16u) | (bits>>16u);bits=((bits & 0x55555555u)<<1u) | ((bits & 0xAAAAAAAAu)>>1u);bits=((bits & 0x33333333u)<<2u) | ((bits & 0xCCCCCCCCu)>>2u);bits=((bits & 0x0F0F0F0Fu)<<4u) | ((bits & 0xF0F0F0F0u)>>4u);bits=((bits & 0x00FF00FFu)<<8u) | ((bits & 0xFF00FF00u)>>8u);return float(bits)*2.3283064365386963e-10; }\\nvec2 hammersley(uint i,uint N)\\n{return vec2(float(i)/float(N),radicalInverse_VdC(i));}\\n#else\\nfloat vanDerCorpus(int n,int base)\\n{float invBase=1.0/float(base);float denom =1.0;float result =0.0;for(int i=0; i<32; ++i)\\n{if(n>0)\\n{denom =mod(float(n),2.0);result+=denom*invBase;invBase=invBase/2.0;n =int(float(n)/2.0);}}\\nreturn result;}\\nvec2 hammersley(int i,int N)\\n{return vec2(float(i)/float(N),vanDerCorpus(i,2));}\\n#endif\\nfloat log4(float x) {return log2(x)/2.;}\\nconst float NUM_SAMPLES_FLOAT=float(NUM_SAMPLES);const float NUM_SAMPLES_FLOAT_INVERSED=1./NUM_SAMPLES_FLOAT;const float K=4.;\\n#define inline\\nvec3 irradiance(samplerCube inputTexture,vec3 inputN,vec2 filteringInfo)\\n{vec3 n=normalize(inputN);vec3 result=vec3(0.0);vec3 tangent=abs(n.z)<0.999 ? vec3(0.,0.,1.) : vec3(1.,0.,0.);tangent=normalize(cross(tangent,n));vec3 bitangent=cross(n,tangent);mat3 tbn=mat3(tangent,bitangent,n);float maxLevel=filteringInfo.y;float dim0=filteringInfo.x;float omegaP=(4.*PI)/(6.*dim0*dim0);\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\nfor(uint i=0u; i<NUM_SAMPLES; ++i)\\n#else\\nfor(int i=0; i<NUM_SAMPLES; ++i)\\n#endif\\n{vec2 Xi=hammersley(i,NUM_SAMPLES);vec3 Ls=hemisphereCosSample(Xi);Ls=normalize(Ls);vec3 Ns=vec3(0.,0.,1.);float NoL=dot(Ns,Ls);if (NoL>0.) {float pdf_inversed=PI/NoL;float omegaS=NUM_SAMPLES_FLOAT_INVERSED*pdf_inversed;float l=log4(omegaS)-log4(omegaP)+log4(K);float mipLevel=clamp(l,0.0,maxLevel);vec3 c=textureCubeLodEXT(inputTexture,tbn*Ls,mipLevel).rgb;\\n#ifdef GAMMA_INPUT\\nc=toLinearSpace(c);\\n#endif\\nresult+=c;}}\\nresult=result*NUM_SAMPLES_FLOAT_INVERSED;return result;}\\n#define inline\\nvec3 radiance(float alphaG,samplerCube inputTexture,vec3 inputN,vec2 filteringInfo)\\n{vec3 n=normalize(inputN);vec3 c=textureCube(inputTexture,n).rgb; \\nif (alphaG==0.) {\\n#ifdef GAMMA_INPUT\\nc=toLinearSpace(c);\\n#endif\\nreturn c;} else {vec3 result=vec3(0.);vec3 tangent=abs(n.z)<0.999 ? vec3(0.,0.,1.) : vec3(1.,0.,0.);tangent=normalize(cross(tangent,n));vec3 bitangent=cross(n,tangent);mat3 tbn=mat3(tangent,bitangent,n);float maxLevel=filteringInfo.y;float dim0=filteringInfo.x;float omegaP=(4.*PI)/(6.*dim0*dim0);float weight=0.;\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\nfor(uint i=0u; i<NUM_SAMPLES; ++i)\\n#else\\nfor(int i=0; i<NUM_SAMPLES; ++i)\\n#endif\\n{vec2 Xi=hammersley(i,NUM_SAMPLES);vec3 H=hemisphereImportanceSampleDggx(Xi,alphaG);float NoV=1.;float NoH=H.z;float NoH2=H.z*H.z;float NoL=2.*NoH2-1.;vec3 L=vec3(2.*NoH*H.x,2.*NoH*H.y,NoL);L=normalize(L);if (NoL>0.) {float pdf_inversed=4./normalDistributionFunction_TrowbridgeReitzGGX(NoH,alphaG);float omegaS=NUM_SAMPLES_FLOAT_INVERSED*pdf_inversed;float l=log4(omegaS)-log4(omegaP)+log4(K);float mipLevel=clamp(float(l),0.0,maxLevel);weight+=NoL;vec3 c=textureCubeLodEXT(inputTexture,tbn*L,mipLevel).rgb;\\n#ifdef GAMMA_INPUT\\nc=toLinearSpace(c);\\n#endif\\nresult+=c*NoL;}}\\nresult=result/weight;return result;}}\\n#endif\\n#endif\\n\"},75334:(e,t,r)=>{r.r(t),r.d(t,{helperFunctions:()=>o});var n=\"helperFunctions\",i=\"const float PI=3.1415926535897932384626433832795;const float RECIPROCAL_PI=0.3183098861837907;const float RECIPROCAL_PI2=0.15915494309189535;const float HALF_MIN=5.96046448e-08; \\nconst float LinearEncodePowerApprox=2.2;const float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;const vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);const float Epsilon=0.0000001;\\n#define saturate(x) clamp(x,0.0,1.0)\\n#define absEps(x) abs(x)+Epsilon\\n#define maxEps(x) max(x,Epsilon)\\n#define saturateEps(x) clamp(x,Epsilon,1.0)\\nmat3 transposeMat3(mat3 inMatrix) {vec3 i0=inMatrix[0];vec3 i1=inMatrix[1];vec3 i2=inMatrix[2];mat3 outMatrix=mat3(\\nvec3(i0.x,i1.x,i2.x),\\nvec3(i0.y,i1.y,i2.y),\\nvec3(i0.z,i1.z,i2.z)\\n);return outMatrix;}\\nmat3 inverseMat3(mat3 inMatrix) {float a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];float a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];float a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];float b01=a22*a11-a12*a21;float b11=-a22*a10+a12*a20;float b21=a21*a10-a11*a20;float det=a00*b01+a01*b11+a02*b21;return mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),\\nb11,(a22*a00-a02*a20),(-a12*a00+a02*a10),\\nb21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;}\\n#if USE_EXACT_SRGB_CONVERSIONS\\nvec3 toLinearSpaceExact(vec3 color)\\n{vec3 nearZeroSection=0.0773993808*color;vec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));\\n#else\\nreturn\\nvec3(\\ncolor.r<=0.04045 ? nearZeroSection.r : remainingSection.r,\\ncolor.g<=0.04045 ? nearZeroSection.g : remainingSection.g,\\ncolor.b<=0.04045 ? nearZeroSection.b : remainingSection.b);\\n#endif\\n}\\nvec3 toGammaSpaceExact(vec3 color)\\n{vec3 nearZeroSection=12.92*color;vec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));\\n#else\\nreturn\\nvec3(\\ncolor.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,\\ncolor.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,\\ncolor.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);\\n#endif\\n}\\n#endif\\nfloat toLinearSpace(float color)\\n{\\n#if USE_EXACT_SRGB_CONVERSIONS\\nfloat nearZeroSection=0.0773993808*color;float remainingSection=pow(0.947867299*(color+0.055),2.4);return color<=0.04045 ? nearZeroSection : remainingSection;\\n#else\\nreturn pow(color,LinearEncodePowerApprox);\\n#endif\\n}\\nvec3 toLinearSpace(vec3 color)\\n{\\n#if USE_EXACT_SRGB_CONVERSIONS\\nreturn toLinearSpaceExact(color);\\n#else\\nreturn pow(color,vec3(LinearEncodePowerApprox));\\n#endif\\n}\\nvec4 toLinearSpace(vec4 color)\\n{\\n#if USE_EXACT_SRGB_CONVERSIONS\\nreturn vec4(toLinearSpaceExact(color.rgb),color.a);\\n#else\\nreturn vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);\\n#endif\\n}\\nfloat toGammaSpace(float color)\\n{\\n#if USE_EXACT_SRGB_CONVERSIONS\\nfloat nearZeroSection=12.92*color;float remainingSection=1.055*pow(color,0.41666)-0.055;return color<=0.0031308 ? nearZeroSection : remainingSection;\\n#else\\nreturn pow(color,GammaEncodePowerApprox);\\n#endif\\n}\\nvec3 toGammaSpace(vec3 color)\\n{\\n#if USE_EXACT_SRGB_CONVERSIONS\\nreturn toGammaSpaceExact(color);\\n#else\\nreturn pow(color,vec3(GammaEncodePowerApprox));\\n#endif\\n}\\nvec4 toGammaSpace(vec4 color)\\n{\\n#if USE_EXACT_SRGB_CONVERSIONS\\nreturn vec4(toGammaSpaceExact(color.rgb),color.a);\\n#else\\nreturn vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);\\n#endif\\n}\\nfloat square(float value)\\n{return value*value;}\\nvec3 square(vec3 value)\\n{return value*value;}\\nfloat pow5(float value) {float sq=value*value;return sq*sq*value;}\\nfloat getLuminance(vec3 color)\\n{return clamp(dot(color,LuminanceEncodeApprox),0.,1.);}\\nfloat getRand(vec2 seed) {return fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);}\\nfloat dither(vec2 seed,float varianceAmount) {float rand=getRand(seed);float normVariance=varianceAmount/255.0;float dither=mix(-normVariance,normVariance,rand);return dither;}\\nconst float rgbdMaxRange=255.0;vec4 toRGBD(vec3 color) {float maxRGB=maxEps(max(color.r,max(color.g,color.b)));float D =max(rgbdMaxRange/maxRGB,1.);D =clamp(floor(D)/255.0,0.,1.);vec3 rgb=color.rgb*D;rgb=toGammaSpace(rgb);return vec4(clamp(rgb,0.,1.),D); }\\nvec3 fromRGBD(vec4 rgbd) {rgbd.rgb=toLinearSpace(rgbd.rgb);return rgbd.rgb/rgbd.a;}\\nvec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {vec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;vec3 halfSize=cubeSize*0.5;vec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;vec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;vec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);float distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);vec3 intersectPositionWS=vertexPos+origVec*distance;return intersectPositionWS-cubePos;}\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},59581:(e,t,r)=>{r.r(t),r.d(t,{imageProcessingDeclaration:()=>o});var n=\"imageProcessingDeclaration\",i=\"#ifdef EXPOSURE\\nuniform float exposureLinear;\\n#endif\\n#ifdef CONTRAST\\nuniform float contrast;\\n#endif\\n#if defined(VIGNETTE) || defined(DITHER)\\nuniform vec2 vInverseScreenSize;\\n#endif\\n#ifdef VIGNETTE\\nuniform vec4 vignetteSettings1;uniform vec4 vignetteSettings2;\\n#endif\\n#ifdef COLORCURVES\\nuniform vec4 vCameraColorCurveNegative;uniform vec4 vCameraColorCurveNeutral;uniform vec4 vCameraColorCurvePositive;\\n#endif\\n#ifdef COLORGRADING\\n#ifdef COLORGRADING3D\\nuniform highp sampler3D txColorTransform;\\n#else\\nuniform sampler2D txColorTransform;\\n#endif\\nuniform vec4 colorTransformSettings;\\n#endif\\n#ifdef DITHER\\nuniform float ditherIntensity;\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},40688:(e,t,r)=>{r.r(t),r.d(t,{imageProcessingFunctions:()=>o});var n=\"imageProcessingFunctions\",i=\"#if defined(COLORGRADING) && !defined(COLORGRADING3D)\\n/** \\n* Polyfill for SAMPLE_TEXTURE_3D,which is unsupported in WebGL.\\n* sampler3dSetting.x=textureOffset (0.5/textureSize).\\n* sampler3dSetting.y=textureSize.\\n*/\\n#define inline\\nvec3 sampleTexture3D(sampler2D colorTransform,vec3 color,vec2 sampler3dSetting)\\n{float sliceSize=2.0*sampler3dSetting.x; \\n#ifdef SAMPLER3DGREENDEPTH\\nfloat sliceContinuous=(color.g-sampler3dSetting.x)*sampler3dSetting.y;\\n#else\\nfloat sliceContinuous=(color.b-sampler3dSetting.x)*sampler3dSetting.y;\\n#endif\\nfloat sliceInteger=floor(sliceContinuous);float sliceFraction=sliceContinuous-sliceInteger;\\n#ifdef SAMPLER3DGREENDEPTH\\nvec2 sliceUV=color.rb;\\n#else\\nvec2 sliceUV=color.rg;\\n#endif\\nsliceUV.x*=sliceSize;sliceUV.x+=sliceInteger*sliceSize;sliceUV=saturate(sliceUV);vec4 slice0Color=texture2D(colorTransform,sliceUV);sliceUV.x+=sliceSize;sliceUV=saturate(sliceUV);vec4 slice1Color=texture2D(colorTransform,sliceUV);vec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);\\n#ifdef SAMPLER3DBGRMAP\\ncolor.rgb=result.rgb;\\n#else\\ncolor.rgb=result.bgr;\\n#endif\\nreturn color;}\\n#endif\\n#if TONEMAPPING==3\\nconst float PBRNeutralStartCompression=0.8-0.04;const float PBRNeutralDesaturation=0.15;vec3 PBRNeutralToneMapping( vec3 color ) {float x=min(color.r,min(color.g,color.b));float offset=x<0.08 ? x-6.25*x*x : 0.04;color-=offset;float peak=max(color.r,max(color.g,color.b));if (peak<PBRNeutralStartCompression) return color;float d=1.-PBRNeutralStartCompression;float newPeak=1.-d*d/(peak+d-PBRNeutralStartCompression);color*=newPeak/peak;float g=1.-1./(PBRNeutralDesaturation*(peak-newPeak)+1.);return mix(color,newPeak*vec3(1,1,1),g);}\\n#endif\\n#if TONEMAPPING==2\\nconst mat3 ACESInputMat=mat3(\\nvec3(0.59719,0.07600,0.02840),\\nvec3(0.35458,0.90834,0.13383),\\nvec3(0.04823,0.01566,0.83777)\\n);const mat3 ACESOutputMat=mat3(\\nvec3( 1.60475,-0.10208,-0.00327),\\nvec3(-0.53108, 1.10813,-0.07276),\\nvec3(-0.07367,-0.00605, 1.07602)\\n);vec3 RRTAndODTFit(vec3 v)\\n{vec3 a=v*(v+0.0245786)-0.000090537;vec3 b=v*(0.983729*v+0.4329510)+0.238081;return a/b;}\\nvec3 ACESFitted(vec3 color)\\n{color=ACESInputMat*color;color=RRTAndODTFit(color);color=ACESOutputMat*color;color=saturate(color);return color;}\\n#endif\\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_DEFINITIONS\\nvec4 applyImageProcessing(vec4 result) {\\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATSTART\\n#ifdef EXPOSURE\\nresult.rgb*=exposureLinear;\\n#endif\\n#ifdef VIGNETTE\\nvec2 viewportXY=gl_FragCoord.xy*vInverseScreenSize;viewportXY=viewportXY*2.0-1.0;vec3 vignetteXY1=vec3(viewportXY*vignetteSettings1.xy+vignetteSettings1.zw,1.0);float vignetteTerm=dot(vignetteXY1,vignetteXY1);float vignette=pow(vignetteTerm,vignetteSettings2.w);vec3 vignetteColor=vignetteSettings2.rgb;\\n#ifdef VIGNETTEBLENDMODEMULTIPLY\\nvec3 vignetteColorMultiplier=mix(vignetteColor,vec3(1,1,1),vignette);result.rgb*=vignetteColorMultiplier;\\n#endif\\n#ifdef VIGNETTEBLENDMODEOPAQUE\\nresult.rgb=mix(vignetteColor,result.rgb,vignette);\\n#endif\\n#endif\\n#if TONEMAPPING==3\\nresult.rgb=PBRNeutralToneMapping(result.rgb);\\n#elif TONEMAPPING==2\\nresult.rgb=ACESFitted(result.rgb);\\n#elif TONEMAPPING==1\\nconst float tonemappingCalibration=1.590579;result.rgb=1.0-exp2(-tonemappingCalibration*result.rgb);\\n#endif\\nresult.rgb=toGammaSpace(result.rgb);result.rgb=saturate(result.rgb);\\n#ifdef CONTRAST\\nvec3 resultHighContrast=result.rgb*result.rgb*(3.0-2.0*result.rgb);if (contrast<1.0) {result.rgb=mix(vec3(0.5,0.5,0.5),result.rgb,contrast);} else {result.rgb=mix(result.rgb,resultHighContrast,contrast-1.0);}\\n#endif\\n#ifdef COLORGRADING\\nvec3 colorTransformInput=result.rgb*colorTransformSettings.xxx+colorTransformSettings.yyy;\\n#ifdef COLORGRADING3D\\nvec3 colorTransformOutput=texture(txColorTransform,colorTransformInput).rgb;\\n#else\\nvec3 colorTransformOutput=sampleTexture3D(txColorTransform,colorTransformInput,colorTransformSettings.yz).rgb;\\n#endif\\nresult.rgb=mix(result.rgb,colorTransformOutput,colorTransformSettings.www);\\n#endif\\n#ifdef COLORCURVES\\nfloat luma=getLuminance(result.rgb);vec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0),vec2(1.0));vec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;result.rgb*=colorCurve.rgb;result.rgb=mix(vec3(luma),result.rgb,colorCurve.a);\\n#endif\\n#ifdef DITHER\\nfloat rand=getRand(gl_FragCoord.xy*vInverseScreenSize);float dither=mix(-ditherIntensity,ditherIntensity,rand);result.rgb=saturate(result.rgb+vec3(dither));\\n#endif\\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATEND\\nreturn result;}\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},19568:(e,t,r)=>{r(98519).l.IncludesShadersStore.importanceSampling=\"vec3 hemisphereCosSample(vec2 u) {float phi=2.*PI*u.x;float cosTheta2=1.-u.y;float cosTheta=sqrt(cosTheta2);float sinTheta=sqrt(1.-cosTheta2);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}\\nvec3 hemisphereImportanceSampleDggx(vec2 u,float a) {float phi=2.*PI*u.x;float cosTheta2=(1.-u.y)/(1.+(a+1.)*((a-1.)*u.y));float cosTheta=sqrt(cosTheta2);float sinTheta=sqrt(1.-cosTheta2);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}\\nvec3 hemisphereImportanceSampleDCharlie(vec2 u,float a) { \\nfloat phi=2.*PI*u.x;float sinTheta=pow(u.y,a/(2.*a+1.));float cosTheta=sqrt(1.-sinTheta*sinTheta);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}\"},38615:(e,t,r)=>{r(98519).l.IncludesShadersStore.instancesDeclaration=\"#ifdef INSTANCES\\nattribute vec4 world0;attribute vec4 world1;attribute vec4 world2;attribute vec4 world3;\\n#ifdef INSTANCESCOLOR\\nattribute vec4 instanceColor;\\n#endif\\n#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)\\nuniform mat4 world;\\n#endif\\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nattribute vec4 previousWorld0;attribute vec4 previousWorld1;attribute vec4 previousWorld2;attribute vec4 previousWorld3;\\n#ifdef THIN_INSTANCES\\nuniform mat4 previousWorld;\\n#endif\\n#endif\\n#else\\n#if !defined(WORLD_UBO)\\nuniform mat4 world;\\n#endif\\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nuniform mat4 previousWorld;\\n#endif\\n#endif\\n\"},35397:(e,t,r)=>{r(98519).l.IncludesShadersStore.instancesVertex=\"#ifdef INSTANCES\\nmat4 finalWorld=mat4(world0,world1,world2,world3);\\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nmat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,\\npreviousWorld2,previousWorld3);\\n#endif\\n#ifdef THIN_INSTANCES\\nfinalWorld=world*finalWorld;\\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nfinalPreviousWorld=previousWorld*finalPreviousWorld;\\n#endif\\n#endif\\n#else\\nmat4 finalWorld=world;\\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nmat4 finalPreviousWorld=previousWorld;\\n#endif\\n#endif\\n\"},67303:(e,t,r)=>{r(98519).l.IncludesShadersStore.kernelBlurVaryingDeclaration=\"varying vec2 sampleCoord{X};\"},7363:(e,t,r)=>{r.r(t),r.d(t,{lightFragment:()=>o});var n=\"lightFragment\",i=\"#ifdef LIGHT{X}\\n#if defined(SHADOWONLY) || defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X}) && defined(LIGHTMAPNOSPECULAR{X})\\n#else\\nvec4 diffuse{X}=light{X}.vLightDiffuse;\\n#define CUSTOM_LIGHT{X}_COLOR \\n#ifdef PBR\\n#ifdef SPOTLIGHT{X}\\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW,vPositionW);\\n#elif defined(POINTLIGHT{X})\\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW,vPositionW);\\n#elif defined(HEMILIGHT{X})\\npreInfo=computeHemisphericPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\\n#elif defined(DIRLIGHT{X})\\npreInfo=computeDirectionalPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\\n#endif\\npreInfo.NdotV=NdotV;\\n#ifdef SPOTLIGHT{X}\\n#ifdef LIGHT_FALLOFF_GLTF{X}\\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);preInfo.attenuation*=computeDirectionalLightFalloff_GLTF(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);preInfo.attenuation*=computeDirectionalLightFalloff_Physical(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w);\\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);preInfo.attenuation*=computeDirectionalLightFalloff_Standard(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w);\\n#else\\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);preInfo.attenuation*=computeDirectionalLightFalloff(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\\n#endif\\n#elif defined(POINTLIGHT{X})\\n#ifdef LIGHT_FALLOFF_GLTF{X}\\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\\n#else\\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\\n#endif\\n#else\\npreInfo.attenuation=1.0;\\n#endif\\n#ifdef HEMILIGHT{X}\\npreInfo.roughness=roughness;\\n#else\\npreInfo.roughness=adjustRoughnessFromLightProperties(roughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\\n#endif\\n#ifdef IRIDESCENCE\\npreInfo.iridescenceIntensity=iridescenceIntensity;\\n#endif\\n#ifdef HEMILIGHT{X}\\ninfo.diffuse=computeHemisphericDiffuseLighting(preInfo,diffuse{X}.rgb,light{X}.vLightGround);\\n#elif defined(SS_TRANSLUCENCY)\\ninfo.diffuse=computeDiffuseAndTransmittedLighting(preInfo,diffuse{X}.rgb,subSurfaceOut.transmittance);\\n#else\\ninfo.diffuse=computeDiffuseLighting(preInfo,diffuse{X}.rgb);\\n#endif\\n#ifdef SPECULARTERM\\n#ifdef ANISOTROPIC\\ninfo.specular=computeAnisotropicSpecularLighting(preInfo,viewDirectionW,normalW,anisotropicOut.anisotropicTangent,anisotropicOut.anisotropicBitangent,anisotropicOut.anisotropy,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,diffuse{X}.rgb);\\n#else\\ninfo.specular=computeSpecularLighting(preInfo,normalW,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,diffuse{X}.rgb);\\n#endif\\n#endif\\n#ifdef SHEEN\\n#ifdef SHEEN_LINKWITHALBEDO\\npreInfo.roughness=sheenOut.sheenIntensity;\\n#else\\n#ifdef HEMILIGHT{X}\\npreInfo.roughness=sheenOut.sheenRoughness;\\n#else\\npreInfo.roughness=adjustRoughnessFromLightProperties(sheenOut.sheenRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\\n#endif\\n#endif\\ninfo.sheen=computeSheenLighting(preInfo,normalW,sheenOut.sheenColor,specularEnvironmentR90,AARoughnessFactors.x,diffuse{X}.rgb);\\n#endif\\n#ifdef CLEARCOAT\\n#ifdef HEMILIGHT{X}\\npreInfo.roughness=clearcoatOut.clearCoatRoughness;\\n#else\\npreInfo.roughness=adjustRoughnessFromLightProperties(clearcoatOut.clearCoatRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\\n#endif\\ninfo.clearCoat=computeClearCoatLighting(preInfo,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatAARoughnessFactors.x,clearcoatOut.clearCoatIntensity,diffuse{X}.rgb);\\n#ifdef CLEARCOAT_TINT\\nabsorption=computeClearCoatLightingAbsorption(clearcoatOut.clearCoatNdotVRefract,preInfo.L,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatColor,clearcoatOut.clearCoatThickness,clearcoatOut.clearCoatIntensity);info.diffuse*=absorption;\\n#ifdef SPECULARTERM\\ninfo.specular*=absorption;\\n#endif\\n#endif\\ninfo.diffuse*=info.clearCoat.w;\\n#ifdef SPECULARTERM\\ninfo.specular*=info.clearCoat.w;\\n#endif\\n#ifdef SHEEN\\ninfo.sheen*=info.clearCoat.w;\\n#endif\\n#endif\\n#else\\n#ifdef SPOTLIGHT{X}\\ninfo=computeSpotLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDirection,diffuse{X}.rgb,light{X}.vLightSpecular.rgb,diffuse{X}.a,glossiness);\\n#elif defined(HEMILIGHT{X})\\ninfo=computeHemisphericLighting(viewDirectionW,normalW,light{X}.vLightData,diffuse{X}.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightGround,glossiness);\\n#elif defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})\\ninfo=computeLighting(viewDirectionW,normalW,light{X}.vLightData,diffuse{X}.rgb,light{X}.vLightSpecular.rgb,diffuse{X}.a,glossiness);\\n#endif\\n#endif\\n#ifdef PROJECTEDLIGHTTEXTURE{X}\\ninfo.diffuse*=computeProjectionTextureDiffuseLighting(projectionLightTexture{X},textureProjectionMatrix{X},vPositionW);\\n#endif\\n#endif\\n#ifdef SHADOW{X}\\n#ifdef SHADOWCSM{X}\\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) \\n{\\n#ifdef SHADOWCSM_RIGHTHANDED{X}\\ndiff{X}=viewFrustumZ{X}[i]+vPositionFromCamera{X}.z;\\n#else\\ndiff{X}=viewFrustumZ{X}[i]-vPositionFromCamera{X}.z;\\n#endif\\nif (diff{X}>=0.) {index{X}=i;break;}}\\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\\nif (index{X}>=0)\\n#endif\\n{\\n#if defined(SHADOWPCF{X})\\n#if defined(SHADOWLOWQUALITY{X})\\nshadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#elif defined(SHADOWMEDIUMQUALITY{X})\\nshadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#else\\nshadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#elif defined(SHADOWPCSS{X})\\n#if defined(SHADOWLOWQUALITY{X})\\nshadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\\n#elif defined(SHADOWMEDIUMQUALITY{X})\\nshadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\\n#else\\nshadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\\n#endif\\n#else\\nshadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#ifdef SHADOWCSMDEBUG{X}\\nshadowDebug{X}=vec3(shadow)*vCascadeColorsMultiplier{X}[index{X}];\\n#endif\\n#ifndef SHADOWCSMNOBLEND{X}\\nfloat frustumLength=frustumLengths{X}[index{X}];float diffRatio=clamp(diff{X}/frustumLength,0.,1.)*cascadeBlendFactor{X};if (index{X}<(SHADOWCSMNUM_CASCADES{X}-1) && diffRatio<1.)\\n{index{X}+=1;float nextShadow=0.;\\n#if defined(SHADOWPCF{X})\\n#if defined(SHADOWLOWQUALITY{X})\\nnextShadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#elif defined(SHADOWMEDIUMQUALITY{X})\\nnextShadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#else\\nnextShadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#elif defined(SHADOWPCSS{X})\\n#if defined(SHADOWLOWQUALITY{X})\\nnextShadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\\n#elif defined(SHADOWMEDIUMQUALITY{X})\\nnextShadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\\n#else\\nnextShadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\\n#endif\\n#else\\nnextShadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\nshadow=mix(nextShadow,shadow,diffRatio);\\n#ifdef SHADOWCSMDEBUG{X}\\nshadowDebug{X}=mix(vec3(nextShadow)*vCascadeColorsMultiplier{X}[index{X}],shadowDebug{X},diffRatio);\\n#endif\\n}\\n#endif\\n}\\n#elif defined(SHADOWCLOSEESM{X})\\n#if defined(SHADOWCUBE{X})\\nshadow=computeShadowWithCloseESMCube(vPositionW,light{X}.vLightData.xyz,shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\\n#else\\nshadow=computeShadowWithCloseESM(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\\n#endif\\n#elif defined(SHADOWESM{X})\\n#if defined(SHADOWCUBE{X})\\nshadow=computeShadowWithESMCube(vPositionW,light{X}.vLightData.xyz,shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\\n#else\\nshadow=computeShadowWithESM(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\\n#endif\\n#elif defined(SHADOWPOISSON{X})\\n#if defined(SHADOWCUBE{X})\\nshadow=computeShadowWithPoissonSamplingCube(vPositionW,light{X}.vLightData.xyz,shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.depthValues);\\n#else\\nshadow=computeShadowWithPoissonSampling(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#elif defined(SHADOWPCF{X})\\n#if defined(SHADOWLOWQUALITY{X})\\nshadow=computeShadowWithPCF1(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#elif defined(SHADOWMEDIUMQUALITY{X})\\nshadow=computeShadowWithPCF3(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#else\\nshadow=computeShadowWithPCF5(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#elif defined(SHADOWPCSS{X})\\n#if defined(SHADOWLOWQUALITY{X})\\nshadow=computeShadowWithPCSS16(vPositionFromLight{X},vDepthMetric{X},depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#elif defined(SHADOWMEDIUMQUALITY{X})\\nshadow=computeShadowWithPCSS32(vPositionFromLight{X},vDepthMetric{X},depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#else\\nshadow=computeShadowWithPCSS64(vPositionFromLight{X},vDepthMetric{X},depthTexture{X},shadowTexture{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#else\\n#if defined(SHADOWCUBE{X})\\nshadow=computeShadowCube(vPositionW,light{X}.vLightData.xyz,shadowTexture{X},light{X}.shadowsInfo.x,light{X}.depthValues);\\n#else\\nshadow=computeShadow(vPositionFromLight{X},vDepthMetric{X},shadowTexture{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\\n#endif\\n#endif\\n#ifdef SHADOWONLY\\n#ifndef SHADOWINUSE\\n#define SHADOWINUSE\\n#endif\\nglobalShadow+=shadow;shadowLightCount+=1.0;\\n#endif\\n#else\\nshadow=1.;\\n#endif\\naggShadow+=shadow;numLights+=1.0;\\n#ifndef SHADOWONLY\\n#ifdef CUSTOMUSERLIGHTING\\ndiffuseBase+=computeCustomDiffuseLighting(info,diffuseBase,shadow);\\n#ifdef SPECULARTERM\\nspecularBase+=computeCustomSpecularLighting(info,specularBase,shadow);\\n#endif\\n#elif defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X})\\ndiffuseBase+=lightmapColor.rgb*shadow;\\n#ifdef SPECULARTERM\\n#ifndef LIGHTMAPNOSPECULAR{X}\\nspecularBase+=info.specular*shadow*lightmapColor.rgb;\\n#endif\\n#endif\\n#ifdef CLEARCOAT\\n#ifndef LIGHTMAPNOSPECULAR{X}\\nclearCoatBase+=info.clearCoat.rgb*shadow*lightmapColor.rgb;\\n#endif\\n#endif\\n#ifdef SHEEN\\n#ifndef LIGHTMAPNOSPECULAR{X}\\nsheenBase+=info.sheen.rgb*shadow;\\n#endif\\n#endif\\n#else\\n#ifdef SHADOWCSMDEBUG{X}\\ndiffuseBase+=info.diffuse*shadowDebug{X};\\n#else \\ndiffuseBase+=info.diffuse*shadow;\\n#endif\\n#ifdef SPECULARTERM\\nspecularBase+=info.specular*shadow;\\n#endif\\n#ifdef CLEARCOAT\\nclearCoatBase+=info.clearCoat.rgb*shadow;\\n#endif\\n#ifdef SHEEN\\nsheenBase+=info.sheen.rgb*shadow;\\n#endif\\n#endif\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},87283:(e,t,r)=>{r.r(t),r.d(t,{lightFragmentDeclaration:()=>o});var n=\"lightFragmentDeclaration\",i=\"#ifdef LIGHT{X}\\nuniform vec4 vLightData{X};uniform vec4 vLightDiffuse{X};\\n#ifdef SPECULARTERM\\nuniform vec4 vLightSpecular{X};\\n#else\\nvec4 vLightSpecular{X}=vec4(0.);\\n#endif\\n#ifdef SHADOW{X}\\n#ifdef SHADOWCSM{X}\\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];uniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];uniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];uniform float cascadeBlendFactor{X};varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};\\n#if defined(SHADOWPCSS{X})\\nuniform highp sampler2DArrayShadow shadowTexture{X};uniform highp sampler2DArray depthTexture{X};uniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float penumbraDarkness{X};\\n#elif defined(SHADOWPCF{X})\\nuniform highp sampler2DArrayShadow shadowTexture{X};\\n#else\\nuniform highp sampler2DArray shadowTexture{X};\\n#endif\\n#ifdef SHADOWCSMDEBUG{X}\\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\\n(\\nvec3 ( 1.5,0.0,0.0 ),\\nvec3 ( 0.0,1.5,0.0 ),\\nvec3 ( 0.0,0.0,5.5 ),\\nvec3 ( 1.5,0.0,5.5 ),\\nvec3 ( 1.5,1.5,0.0 ),\\nvec3 ( 1.0,1.0,1.0 ),\\nvec3 ( 0.0,1.0,5.5 ),\\nvec3 ( 0.5,3.5,0.75 )\\n);vec3 shadowDebug{X};\\n#endif\\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\\nint index{X}=-1;\\n#else\\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\\n#endif\\nfloat diff{X}=0.;\\n#elif defined(SHADOWCUBE{X})\\nuniform samplerCube shadowTexture{X};\\n#else\\nvarying vec4 vPositionFromLight{X};varying float vDepthMetric{X};\\n#if defined(SHADOWPCSS{X})\\nuniform highp sampler2DShadow shadowTexture{X};uniform highp sampler2D depthTexture{X};\\n#elif defined(SHADOWPCF{X})\\nuniform highp sampler2DShadow shadowTexture{X};\\n#else\\nuniform sampler2D shadowTexture{X};\\n#endif\\nuniform mat4 lightMatrix{X};\\n#endif\\nuniform vec4 shadowsInfo{X};uniform vec2 depthValues{X};\\n#endif\\n#ifdef SPOTLIGHT{X}\\nuniform vec4 vLightDirection{X};uniform vec4 vLightFalloff{X};\\n#elif defined(POINTLIGHT{X})\\nuniform vec4 vLightFalloff{X};\\n#elif defined(HEMILIGHT{X})\\nuniform vec3 vLightGround{X};\\n#endif\\n#ifdef PROJECTEDLIGHTTEXTURE{X}\\nuniform mat4 textureProjectionMatrix{X};uniform sampler2D projectionLightTexture{X};\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},32823:(e,t,r)=>{r.r(t),r.d(t,{lightUboDeclaration:()=>o});var n=\"lightUboDeclaration\",i=\"#ifdef LIGHT{X}\\nuniform Light{X}\\n{vec4 vLightData;vec4 vLightDiffuse;vec4 vLightSpecular;\\n#ifdef SPOTLIGHT{X}\\nvec4 vLightDirection;vec4 vLightFalloff;\\n#elif defined(POINTLIGHT{X})\\nvec4 vLightFalloff;\\n#elif defined(HEMILIGHT{X})\\nvec3 vLightGround;\\n#endif\\nvec4 shadowsInfo;vec2 depthValues;} light{X};\\n#ifdef PROJECTEDLIGHTTEXTURE{X}\\nuniform mat4 textureProjectionMatrix{X};uniform sampler2D projectionLightTexture{X};\\n#endif\\n#ifdef SHADOW{X}\\n#ifdef SHADOWCSM{X}\\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];uniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];uniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];uniform float cascadeBlendFactor{X};varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};\\n#if defined(SHADOWPCSS{X})\\nuniform highp sampler2DArrayShadow shadowTexture{X};uniform highp sampler2DArray depthTexture{X};uniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];uniform float penumbraDarkness{X};\\n#elif defined(SHADOWPCF{X})\\nuniform highp sampler2DArrayShadow shadowTexture{X};\\n#else\\nuniform highp sampler2DArray shadowTexture{X};\\n#endif\\n#ifdef SHADOWCSMDEBUG{X}\\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\\n(\\nvec3 ( 1.5,0.0,0.0 ),\\nvec3 ( 0.0,1.5,0.0 ),\\nvec3 ( 0.0,0.0,5.5 ),\\nvec3 ( 1.5,0.0,5.5 ),\\nvec3 ( 1.5,1.5,0.0 ),\\nvec3 ( 1.0,1.0,1.0 ),\\nvec3 ( 0.0,1.0,5.5 ),\\nvec3 ( 0.5,3.5,0.75 )\\n);vec3 shadowDebug{X};\\n#endif\\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\\nint index{X}=-1;\\n#else\\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\\n#endif\\nfloat diff{X}=0.;\\n#elif defined(SHADOWCUBE{X})\\nuniform samplerCube shadowTexture{X}; \\n#else\\nvarying vec4 vPositionFromLight{X};varying float vDepthMetric{X};\\n#if defined(SHADOWPCSS{X})\\nuniform highp sampler2DShadow shadowTexture{X};uniform highp sampler2D depthTexture{X};\\n#elif defined(SHADOWPCF{X})\\nuniform highp sampler2DShadow shadowTexture{X};\\n#else\\nuniform sampler2D shadowTexture{X};\\n#endif\\nuniform mat4 lightMatrix{X};\\n#endif\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},94785:(e,t,r)=>{r.r(t),r.d(t,{lightVxFragmentDeclaration:()=>o});var n=\"lightVxFragmentDeclaration\",i=\"#ifdef LIGHT{X}\\nuniform vec4 vLightData{X};uniform vec4 vLightDiffuse{X};\\n#ifdef SPECULARTERM\\nuniform vec4 vLightSpecular{X};\\n#else\\nvec4 vLightSpecular{X}=vec4(0.);\\n#endif\\n#ifdef SHADOW{X}\\n#ifdef SHADOWCSM{X}\\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};\\n#elif defined(SHADOWCUBE{X})\\n#else\\nvarying vec4 vPositionFromLight{X};varying float vDepthMetric{X};uniform mat4 lightMatrix{X};\\n#endif\\nuniform vec4 shadowsInfo{X};uniform vec2 depthValues{X};\\n#endif\\n#ifdef SPOTLIGHT{X}\\nuniform vec4 vLightDirection{X};uniform vec4 vLightFalloff{X};\\n#elif defined(POINTLIGHT{X})\\nuniform vec4 vLightFalloff{X};\\n#elif defined(HEMILIGHT{X})\\nuniform vec3 vLightGround{X};\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},48961:(e,t,r)=>{r.r(t),r.d(t,{lightVxUboDeclaration:()=>o});var n=\"lightVxUboDeclaration\",i=\"#ifdef LIGHT{X}\\nuniform Light{X}\\n{vec4 vLightData;vec4 vLightDiffuse;vec4 vLightSpecular;\\n#ifdef SPOTLIGHT{X}\\nvec4 vLightDirection;vec4 vLightFalloff;\\n#elif defined(POINTLIGHT{X})\\nvec4 vLightFalloff;\\n#elif defined(HEMILIGHT{X})\\nvec3 vLightGround;\\n#endif\\nvec4 shadowsInfo;vec2 depthValues;} light{X};\\n#ifdef SHADOW{X}\\n#ifdef SHADOWCSM{X}\\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];varying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];varying vec4 vPositionFromCamera{X};\\n#elif defined(SHADOWCUBE{X})\\n#else\\nvarying vec4 vPositionFromLight{X};varying float vDepthMetric{X};uniform mat4 lightMatrix{X};\\n#endif\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},54409:(e,t,r)=>{r.r(t),r.d(t,{lightsFragmentFunctions:()=>o});var n=\"lightsFragmentFunctions\",i=\"struct lightingInfo\\n{vec3 diffuse;\\n#ifdef SPECULARTERM\\nvec3 specular;\\n#endif\\n#ifdef NDOTL\\nfloat ndl;\\n#endif\\n};lightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {lightingInfo result;vec3 lightVectorW;float attenuation=1.0;if (lightData.w==0.)\\n{vec3 direction=lightData.xyz-vPositionW;attenuation=max(0.,1.0-length(direction)/range);lightVectorW=normalize(direction);}\\nelse\\n{lightVectorW=normalize(-lightData.xyz);}\\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\\n#ifdef NDOTL\\nresult.ndl=ndl;\\n#endif\\nresult.diffuse=ndl*diffuseColor*attenuation;\\n#ifdef SPECULARTERM\\nvec3 angleW=normalize(viewDirectionW+lightVectorW);float specComp=max(0.,dot(vNormal,angleW));specComp=pow(specComp,max(1.,glossiness));result.specular=specComp*specularColor*attenuation;\\n#endif\\nreturn result;}\\nlightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {lightingInfo result;vec3 direction=lightData.xyz-vPositionW;vec3 lightVectorW=normalize(direction);float attenuation=max(0.,1.0-length(direction)/range);float cosAngle=max(0.,dot(lightDirection.xyz,-lightVectorW));if (cosAngle>=lightDirection.w)\\n{cosAngle=max(0.,pow(cosAngle,lightData.w));attenuation*=cosAngle;float ndl=max(0.,dot(vNormal,lightVectorW));\\n#ifdef NDOTL\\nresult.ndl=ndl;\\n#endif\\nresult.diffuse=ndl*diffuseColor*attenuation;\\n#ifdef SPECULARTERM\\nvec3 angleW=normalize(viewDirectionW+lightVectorW);float specComp=max(0.,dot(vNormal,angleW));specComp=pow(specComp,max(1.,glossiness));result.specular=specComp*specularColor*attenuation;\\n#endif\\nreturn result;}\\nresult.diffuse=vec3(0.);\\n#ifdef SPECULARTERM\\nresult.specular=vec3(0.);\\n#endif\\n#ifdef NDOTL\\nresult.ndl=0.;\\n#endif\\nreturn result;}\\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {lightingInfo result;float ndl=dot(vNormal,lightData.xyz)*0.5+0.5;\\n#ifdef NDOTL\\nresult.ndl=ndl;\\n#endif\\nresult.diffuse=mix(groundColor,diffuseColor,ndl);\\n#ifdef SPECULARTERM\\nvec3 angleW=normalize(viewDirectionW+lightData.xyz);float specComp=max(0.,dot(vNormal,angleW));specComp=pow(specComp,max(1.,glossiness));result.specular=specComp*specularColor;\\n#endif\\nreturn result;}\\n#define inline\\nvec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix,vec3 posW){vec4 strq=textureProjectionMatrix*vec4(posW,1.0);strq/=strq.w;vec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;return textureColor;}\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},59262:(e,t,r)=>{r(98519).l.IncludesShadersStore.logDepthDeclaration=\"#ifdef LOGARITHMICDEPTH\\nuniform float logarithmicDepthConstant;varying float vFragmentDepth;\\n#endif\\n\"},13088:(e,t,r)=>{r(98519).l.IncludesShadersStore.logDepthFragment=\"#ifdef LOGARITHMICDEPTH\\ngl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;\\n#endif\\n\"},56458:(e,t,r)=>{r(98519).l.IncludesShadersStore.logDepthVertex=\"#ifdef LOGARITHMICDEPTH\\nvFragmentDepth=1.0+gl_Position.w;gl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;\\n#endif\\n\"},48493:(e,t,r)=>{r(98519).l.IncludesShadersStore.mainUVVaryingDeclaration=\"#ifdef MAINUV{X}\\nvarying vec2 vMainUV{X};\\n#endif\\n\"},56174:(e,t,r)=>{r(98519).l.IncludesShadersStore.meshUboDeclaration=\"#ifdef WEBGL2\\nuniform mat4 world;uniform float visibility;\\n#else\\nlayout(std140,column_major) uniform;uniform Mesh\\n{mat4 world;float visibility;};\\n#endif\\n#define WORLD_UBO\\n\"},84589:(e,t,r)=>{r.r(t),r.d(t,{morphTargetsVertex:()=>o});var n=\"morphTargetsVertex\",i=\"#ifdef MORPHTARGETS\\n#ifdef MORPHTARGETS_TEXTURE\\n#if {X}==0\\nfor (int i=0; i<NUM_MORPH_INFLUENCERS; i++) {if (i>=morphTargetCount) break;vertexID=float(gl_VertexID)*morphTargetTextureInfo.x;positionUpdated+=(readVector3FromRawSampler(i,vertexID)-position)*morphTargetInfluences[i];vertexID+=1.0;\\n#ifdef MORPHTARGETS_NORMAL\\nnormalUpdated+=(readVector3FromRawSampler(i,vertexID) -normal)*morphTargetInfluences[i];vertexID+=1.0;\\n#endif\\n#ifdef MORPHTARGETS_UV\\nuvUpdated+=(readVector3FromRawSampler(i,vertexID).xy-uv)*morphTargetInfluences[i];vertexID+=1.0;\\n#endif\\n#ifdef MORPHTARGETS_TANGENT\\ntangentUpdated.xyz+=(readVector3FromRawSampler(i,vertexID) -tangent.xyz)*morphTargetInfluences[i];\\n#endif\\n}\\n#endif\\n#else\\npositionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];\\n#ifdef MORPHTARGETS_NORMAL\\nnormalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];\\n#endif\\n#ifdef MORPHTARGETS_TANGENT\\ntangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];\\n#endif\\n#ifdef MORPHTARGETS_UV\\nuvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];\\n#endif\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},67369:(e,t,r)=>{r.r(t),r.d(t,{morphTargetsVertexDeclaration:()=>o});var n=\"morphTargetsVertexDeclaration\",i=\"#ifdef MORPHTARGETS\\n#ifndef MORPHTARGETS_TEXTURE\\nattribute vec3 position{X};\\n#ifdef MORPHTARGETS_NORMAL\\nattribute vec3 normal{X};\\n#endif\\n#ifdef MORPHTARGETS_TANGENT\\nattribute vec3 tangent{X};\\n#endif\\n#ifdef MORPHTARGETS_UV\\nattribute vec2 uv_{X};\\n#endif\\n#elif {X}==0\\nuniform int morphTargetCount;\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},58266:(e,t,r)=>{r.r(t),r.d(t,{morphTargetsVertexGlobal:()=>o});var n=\"morphTargetsVertexGlobal\",i=\"#ifdef MORPHTARGETS\\n#ifdef MORPHTARGETS_TEXTURE\\nfloat vertexID;\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},24444:(e,t,r)=>{r.r(t),r.d(t,{morphTargetsVertexGlobalDeclaration:()=>o});var n=\"morphTargetsVertexGlobalDeclaration\",i=\"#ifdef MORPHTARGETS\\nuniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];\\n#ifdef MORPHTARGETS_TEXTURE \\nuniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];uniform vec3 morphTargetTextureInfo;uniform highp sampler2DArray morphTargets;vec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)\\n{ \\nfloat y=floor(vertexIndex/morphTargetTextureInfo.y);float x=vertexIndex-y*morphTargetTextureInfo.y;vec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);return texture(morphTargets,textureUV).xyz;}\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},81751:(e,t,r)=>{r(98519).l.IncludesShadersStore.oitDeclaration=\"#ifdef ORDER_INDEPENDENT_TRANSPARENCY\\n#extension GL_EXT_draw_buffers : require\\nlayout(location=0) out vec2 depth; \\nlayout(location=1) out vec4 frontColor;layout(location=2) out vec4 backColor;\\n#define MAX_DEPTH 99999.0\\nhighp vec4 gl_FragColor;uniform sampler2D oitDepthSampler;uniform sampler2D oitFrontColorSampler;\\n#endif\\n\"},11135:(e,t,r)=>{r(98519).l.IncludesShadersStore.oitFragment=\"#ifdef ORDER_INDEPENDENT_TRANSPARENCY\\nfloat fragDepth=gl_FragCoord.z; \\n#ifdef ORDER_INDEPENDENT_TRANSPARENCY_16BITS\\nuint halfFloat=packHalf2x16(vec2(fragDepth));vec2 full=unpackHalf2x16(halfFloat);fragDepth=full.x;\\n#endif\\nivec2 fragCoord=ivec2(gl_FragCoord.xy);vec2 lastDepth=texelFetch(oitDepthSampler,fragCoord,0).rg;vec4 lastFrontColor=texelFetch(oitFrontColorSampler,fragCoord,0);depth.rg=vec2(-MAX_DEPTH);frontColor=lastFrontColor;backColor=vec4(0.0);\\n#ifdef USE_REVERSE_DEPTHBUFFER\\nfloat furthestDepth=-lastDepth.x;float nearestDepth=lastDepth.y;\\n#else\\nfloat nearestDepth=-lastDepth.x;float furthestDepth=lastDepth.y;\\n#endif\\nfloat alphaMultiplier=1.0-lastFrontColor.a;\\n#ifdef USE_REVERSE_DEPTHBUFFER\\nif (fragDepth>nearestDepth || fragDepth<furthestDepth) {\\n#else\\nif (fragDepth<nearestDepth || fragDepth>furthestDepth) {\\n#endif\\nreturn;}\\n#ifdef USE_REVERSE_DEPTHBUFFER\\nif (fragDepth<nearestDepth && fragDepth>furthestDepth) {\\n#else\\nif (fragDepth>nearestDepth && fragDepth<furthestDepth) {\\n#endif\\ndepth.rg=vec2(-fragDepth,fragDepth);return;}\\n#endif\\n\"},78531:(e,t,r)=>{r.r(t),r.d(t,{packingFunctions:()=>o});var n=\"packingFunctions\",i=\"vec4 pack(float depth)\\n{const vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const vec4 bit_mask=vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\\nfloat unpack(vec4 color)\\n{const vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(color,bit_shift);}\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},64244:(e,t,r)=>{r(98519).l.IncludesShadersStore.pbrBRDFFunctions=\"#define FRESNEL_MAXIMUM_ON_ROUGH 0.25\\n#ifdef MS_BRDF_ENERGY_CONSERVATION\\nvec3 getEnergyConservationFactor(const vec3 specularEnvironmentR0,const vec3 environmentBrdf) {return 1.0+specularEnvironmentR0*(1.0/environmentBrdf.y-1.0);}\\n#endif\\n#ifdef ENVIRONMENTBRDF\\nvec3 getBRDFLookup(float NdotV,float perceptualRoughness) {vec2 UV=vec2(NdotV,perceptualRoughness);vec4 brdfLookup=texture2D(environmentBrdfSampler,UV);\\n#ifdef ENVIRONMENTBRDF_RGBD\\nbrdfLookup.rgb=fromRGBD(brdfLookup.rgba);\\n#endif\\nreturn brdfLookup.rgb;}\\nvec3 getReflectanceFromBRDFLookup(const vec3 specularEnvironmentR0,const vec3 specularEnvironmentR90,const vec3 environmentBrdf) {\\n#ifdef BRDF_V_HEIGHT_CORRELATED\\nvec3 reflectance=(specularEnvironmentR90-specularEnvironmentR0)*environmentBrdf.x+specularEnvironmentR0*environmentBrdf.y;\\n#else\\nvec3 reflectance=specularEnvironmentR0*environmentBrdf.x+specularEnvironmentR90*environmentBrdf.y;\\n#endif\\nreturn reflectance;}\\nvec3 getReflectanceFromBRDFLookup(const vec3 specularEnvironmentR0,const vec3 environmentBrdf) {\\n#ifdef BRDF_V_HEIGHT_CORRELATED\\nvec3 reflectance=mix(environmentBrdf.xxx,environmentBrdf.yyy,specularEnvironmentR0);\\n#else\\nvec3 reflectance=specularEnvironmentR0*environmentBrdf.x+environmentBrdf.y;\\n#endif\\nreturn reflectance;}\\n#endif\\n/* NOT USED\\n#if defined(SHEEN) && defined(SHEEN_SOFTER)\\nfloat getBRDFLookupCharlieSheen(float NdotV,float perceptualRoughness)\\n{float c=1.0-NdotV;float c3=c*c*c;return 0.65584461*c3+1.0/(4.16526551+exp(-7.97291361*perceptualRoughness+6.33516894));}\\n#endif\\n*/\\n#if !defined(ENVIRONMENTBRDF) || defined(REFLECTIONMAP_SKYBOX) || defined(ALPHAFRESNEL)\\nvec3 getReflectanceFromAnalyticalBRDFLookup_Jones(float VdotN,vec3 reflectance0,vec3 reflectance90,float smoothness)\\n{float weight=mix(FRESNEL_MAXIMUM_ON_ROUGH,1.0,smoothness);return reflectance0+weight*(reflectance90-reflectance0)*pow5(saturate(1.0-VdotN));}\\n#endif\\n#if defined(SHEEN) && defined(ENVIRONMENTBRDF)\\n/**\\n* The sheen BRDF not containing F can be easily stored in the blue channel of the BRDF texture.\\n* The blue channel contains DCharlie*VAshikhmin*NdotL as a lokkup table\\n*/\\nvec3 getSheenReflectanceFromBRDFLookup(const vec3 reflectance0,const vec3 environmentBrdf) {vec3 sheenEnvironmentReflectance=reflectance0*environmentBrdf.b;return sheenEnvironmentReflectance;}\\n#endif\\nvec3 fresnelSchlickGGX(float VdotH,vec3 reflectance0,vec3 reflectance90)\\n{return reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);}\\nfloat fresnelSchlickGGX(float VdotH,float reflectance0,float reflectance90)\\n{return reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);}\\n#ifdef CLEARCOAT\\nvec3 getR0RemappedForClearCoat(vec3 f0) {\\n#ifdef CLEARCOAT_DEFAULTIOR\\n#ifdef MOBILE\\nreturn saturate(f0*(f0*0.526868+0.529324)-0.0482256);\\n#else\\nreturn saturate(f0*(f0*(0.941892-0.263008*f0)+0.346479)-0.0285998);\\n#endif\\n#else\\nvec3 s=sqrt(f0);vec3 t=(vClearCoatRefractionParams.z+vClearCoatRefractionParams.w*s)/(vClearCoatRefractionParams.w+vClearCoatRefractionParams.z*s);return square(t);\\n#endif\\n}\\n#endif\\n#ifdef IRIDESCENCE\\nconst mat3 XYZ_TO_REC709=mat3(\\n3.2404542,-0.9692660, 0.0556434,\\n-1.5371385, 1.8760108,-0.2040259,\\n-0.4985314, 0.0415560, 1.0572252\\n);vec3 getIORTfromAirToSurfaceR0(vec3 f0) {vec3 sqrtF0=sqrt(f0);return (1.+sqrtF0)/(1.-sqrtF0);}\\nvec3 getR0fromIORs(vec3 iorT,float iorI) {return square((iorT-vec3(iorI))/(iorT+vec3(iorI)));}\\nfloat getR0fromIORs(float iorT,float iorI) {return square((iorT-iorI)/(iorT+iorI));}\\nvec3 evalSensitivity(float opd,vec3 shift) {float phase=2.0*PI*opd*1.0e-9;const vec3 val=vec3(5.4856e-13,4.4201e-13,5.2481e-13);const vec3 pos=vec3(1.6810e+06,1.7953e+06,2.2084e+06);const vec3 var=vec3(4.3278e+09,9.3046e+09,6.6121e+09);vec3 xyz=val*sqrt(2.0*PI*var)*cos(pos*phase+shift)*exp(-square(phase)*var);xyz.x+=9.7470e-14*sqrt(2.0*PI*4.5282e+09)*cos(2.2399e+06*phase+shift[0])*exp(-4.5282e+09*square(phase));xyz/=1.0685e-7;vec3 srgb=XYZ_TO_REC709*xyz;return srgb;}\\nvec3 evalIridescence(float outsideIOR,float eta2,float cosTheta1,float thinFilmThickness,vec3 baseF0) {vec3 I=vec3(1.0);float iridescenceIOR=mix(outsideIOR,eta2,smoothstep(0.0,0.03,thinFilmThickness));float sinTheta2Sq=square(outsideIOR/iridescenceIOR)*(1.0-square(cosTheta1));float cosTheta2Sq=1.0-sinTheta2Sq;if (cosTheta2Sq<0.0) {return I;}\\nfloat cosTheta2=sqrt(cosTheta2Sq);float R0=getR0fromIORs(iridescenceIOR,outsideIOR);float R12=fresnelSchlickGGX(cosTheta1,R0,1.);float R21=R12;float T121=1.0-R12;float phi12=0.0;if (iridescenceIOR<outsideIOR) phi12=PI;float phi21=PI-phi12;vec3 baseIOR=getIORTfromAirToSurfaceR0(clamp(baseF0,0.0,0.9999)); \\nvec3 R1=getR0fromIORs(baseIOR,iridescenceIOR);vec3 R23=fresnelSchlickGGX(cosTheta2,R1,vec3(1.));vec3 phi23=vec3(0.0);if (baseIOR[0]<iridescenceIOR) phi23[0]=PI;if (baseIOR[1]<iridescenceIOR) phi23[1]=PI;if (baseIOR[2]<iridescenceIOR) phi23[2]=PI;float opd=2.0*iridescenceIOR*thinFilmThickness*cosTheta2;vec3 phi=vec3(phi21)+phi23;vec3 R123=clamp(R12*R23,1e-5,0.9999);vec3 r123=sqrt(R123);vec3 Rs=square(T121)*R23/(vec3(1.0)-R123);vec3 C0=R12+Rs;I=C0;vec3 Cm=Rs-T121;for (int m=1; m<=2; ++m)\\n{Cm*=r123;vec3 Sm=2.0*evalSensitivity(float(m)*opd,float(m)*phi);I+=Cm*Sm;}\\nreturn max(I,vec3(0.0));}\\n#endif\\nfloat normalDistributionFunction_TrowbridgeReitzGGX(float NdotH,float alphaG)\\n{float a2=square(alphaG);float d=NdotH*NdotH*(a2-1.0)+1.0;return a2/(PI*d*d);}\\n#ifdef SHEEN\\nfloat normalDistributionFunction_CharlieSheen(float NdotH,float alphaG)\\n{float invR=1./alphaG;float cos2h=NdotH*NdotH;float sin2h=1.-cos2h;return (2.+invR)*pow(sin2h,invR*.5)/(2.*PI);}\\n#endif\\n#ifdef ANISOTROPIC\\nfloat normalDistributionFunction_BurleyGGX_Anisotropic(float NdotH,float TdotH,float BdotH,const vec2 alphaTB) {float a2=alphaTB.x*alphaTB.y;vec3 v=vec3(alphaTB.y*TdotH,alphaTB.x *BdotH,a2*NdotH);float v2=dot(v,v);float w2=a2/v2;return a2*w2*w2*RECIPROCAL_PI;}\\n#endif\\n#ifdef BRDF_V_HEIGHT_CORRELATED\\nfloat smithVisibility_GGXCorrelated(float NdotL,float NdotV,float alphaG) {\\n#ifdef MOBILE\\nfloat GGXV=NdotL*(NdotV*(1.0-alphaG)+alphaG);float GGXL=NdotV*(NdotL*(1.0-alphaG)+alphaG);return 0.5/(GGXV+GGXL);\\n#else\\nfloat a2=alphaG*alphaG;float GGXV=NdotL*sqrt(NdotV*(NdotV-a2*NdotV)+a2);float GGXL=NdotV*sqrt(NdotL*(NdotL-a2*NdotL)+a2);return 0.5/(GGXV+GGXL);\\n#endif\\n}\\n#else\\nfloat smithVisibilityG1_TrowbridgeReitzGGXFast(float dot,float alphaG)\\n{\\n#ifdef MOBILE\\nreturn 1.0/(dot+alphaG+(1.0-alphaG)*dot ));\\n#else\\nfloat alphaSquared=alphaG*alphaG;return 1.0/(dot+sqrt(alphaSquared+(1.0-alphaSquared)*dot*dot));\\n#endif\\n}\\nfloat smithVisibility_TrowbridgeReitzGGXFast(float NdotL,float NdotV,float alphaG)\\n{float visibility=smithVisibilityG1_TrowbridgeReitzGGXFast(NdotL,alphaG)*smithVisibilityG1_TrowbridgeReitzGGXFast(NdotV,alphaG);return visibility;}\\n#endif\\n#ifdef ANISOTROPIC\\nfloat smithVisibility_GGXCorrelated_Anisotropic(float NdotL,float NdotV,float TdotV,float BdotV,float TdotL,float BdotL,const vec2 alphaTB) {float lambdaV=NdotL*length(vec3(alphaTB.x*TdotV,alphaTB.y*BdotV,NdotV));float lambdaL=NdotV*length(vec3(alphaTB.x*TdotL,alphaTB.y*BdotL,NdotL));float v=0.5/(lambdaV+lambdaL);return v;}\\n#endif\\n#ifdef CLEARCOAT\\nfloat visibility_Kelemen(float VdotH) {return 0.25/(VdotH*VdotH); }\\n#endif\\n#ifdef SHEEN\\nfloat visibility_Ashikhmin(float NdotL,float NdotV)\\n{return 1./(4.*(NdotL+NdotV-NdotL*NdotV));}\\n/* NOT USED\\n#ifdef SHEEN_SOFTER\\nfloat l(float x,float alphaG)\\n{float oneMinusAlphaSq=(1.0-alphaG)*(1.0-alphaG);float a=mix(21.5473,25.3245,oneMinusAlphaSq);float b=mix(3.82987,3.32435,oneMinusAlphaSq);float c=mix(0.19823,0.16801,oneMinusAlphaSq);float d=mix(-1.97760,-1.27393,oneMinusAlphaSq);float e=mix(-4.32054,-4.85967,oneMinusAlphaSq);return a/(1.0+b*pow(x,c))+d*x+e;}\\nfloat lambdaSheen(float cosTheta,float alphaG)\\n{return abs(cosTheta)<0.5 ? exp(l(cosTheta,alphaG)) : exp(2.0*l(0.5,alphaG)-l(1.0-cosTheta,alphaG));}\\nfloat visibility_CharlieSheen(float NdotL,float NdotV,float alphaG)\\n{float G=1.0/(1.0+lambdaSheen(NdotV,alphaG)+lambdaSheen(NdotL,alphaG));return G/(4.0*NdotV*NdotL);}\\n#endif\\n*/\\n#endif\\nfloat diffuseBRDF_Burley(float NdotL,float NdotV,float VdotH,float roughness) {float diffuseFresnelNV=pow5(saturateEps(1.0-NdotL));float diffuseFresnelNL=pow5(saturateEps(1.0-NdotV));float diffuseFresnel90=0.5+2.0*VdotH*VdotH*roughness;float fresnel =\\n(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNL) *\\n(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNV);return fresnel/PI;}\\n#ifdef SS_TRANSLUCENCY\\nvec3 transmittanceBRDF_Burley(const vec3 tintColor,const vec3 diffusionDistance,float thickness) {vec3 S=1./maxEps(diffusionDistance);vec3 temp=exp((-0.333333333*thickness)*S);return tintColor.rgb*0.25*(temp*temp*temp+3.0*temp);}\\nfloat computeWrappedDiffuseNdotL(float NdotL,float w) {float t=1.0+w;float invt2=1.0/square(t);return saturate((NdotL+w)*invt2);}\\n#endif\\n\"},48915:(e,t,r)=>{var n=r(98519),i=(r(50851),r(56174),\"pbrUboDeclaration\");n.l.IncludesShadersStore[i]=\"layout(std140,column_major) uniform;uniform Material {vec2 vAlbedoInfos;vec4 vAmbientInfos;vec2 vOpacityInfos;vec2 vEmissiveInfos;vec2 vLightmapInfos;vec3 vReflectivityInfos;vec2 vMicroSurfaceSamplerInfos;vec2 vReflectionInfos;vec2 vReflectionFilteringInfo;vec3 vReflectionPosition;vec3 vReflectionSize;vec3 vBumpInfos;mat4 albedoMatrix;mat4 ambientMatrix;mat4 opacityMatrix;mat4 emissiveMatrix;mat4 lightmapMatrix;mat4 reflectivityMatrix;mat4 microSurfaceSamplerMatrix;mat4 bumpMatrix;vec2 vTangentSpaceParams;mat4 reflectionMatrix;vec3 vReflectionColor;vec4 vAlbedoColor;vec4 vLightingIntensity;vec3 vReflectionMicrosurfaceInfos;float pointSize;vec4 vReflectivityColor;vec3 vEmissiveColor;vec3 vAmbientColor;vec2 vDebugMode;vec4 vMetallicReflectanceFactors;vec2 vMetallicReflectanceInfos;mat4 metallicReflectanceMatrix;vec2 vReflectanceInfos;mat4 reflectanceMatrix;vec3 vSphericalL00;vec3 vSphericalL1_1;vec3 vSphericalL10;vec3 vSphericalL11;vec3 vSphericalL2_2;vec3 vSphericalL2_1;vec3 vSphericalL20;vec3 vSphericalL21;vec3 vSphericalL22;vec3 vSphericalX;vec3 vSphericalY;vec3 vSphericalZ;vec3 vSphericalXX_ZZ;vec3 vSphericalYY_ZZ;vec3 vSphericalZZ;vec3 vSphericalXY;vec3 vSphericalYZ;vec3 vSphericalZX;\\n#define ADDITIONAL_UBO_DECLARATION\\n};\\n#include<sceneUboDeclaration>\\n#include<meshUboDeclaration>\\n\"},52226:(e,t,r)=>{r(98519).l.IncludesShadersStore.pointCloudVertex=\"#if defined(POINTSIZE) && !defined(WEBGPU)\\ngl_PointSize=pointSize;\\n#endif\\n\"},42107:(e,t,r)=>{r(98519).l.IncludesShadersStore.prePassDeclaration=\"#ifdef PREPASS\\n#extension GL_EXT_draw_buffers : require\\nlayout(location=0) out highp vec4 glFragData[{X}];highp vec4 gl_FragColor;\\n#ifdef PREPASS_LOCAL_POSITION\\nvarying highp vec3 vPosition;\\n#endif\\n#ifdef PREPASS_DEPTH\\nvarying highp vec3 vViewPos;\\n#endif\\n#if defined(PREPASS_VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nvarying highp vec4 vCurrentPosition;varying highp vec4 vPreviousPosition;\\n#endif\\n#endif\\n\"},7761:(e,t,r)=>{r(98519).l.IncludesShadersStore.prePassVertex=\"#ifdef PREPASS_DEPTH\\nvViewPos=(view*worldPos).rgb;\\n#endif\\n#ifdef PREPASS_LOCAL_POSITION\\nvPosition=positionUpdated.xyz;\\n#endif\\n#if defined(PREPASS_VELOCITY) && defined(BONES_VELOCITY_ENABLED) || defined(PREPASS_VELOCITY_LINEAR)\\nvCurrentPosition=viewProjection*worldPos;\\n#if NUM_BONE_INFLUENCERS>0\\nmat4 previousInfluence;previousInfluence=mPreviousBones[int(matricesIndices[0])]*matricesWeights[0];\\n#if NUM_BONE_INFLUENCERS>1\\npreviousInfluence+=mPreviousBones[int(matricesIndices[1])]*matricesWeights[1];\\n#endif \\n#if NUM_BONE_INFLUENCERS>2\\npreviousInfluence+=mPreviousBones[int(matricesIndices[2])]*matricesWeights[2];\\n#endif \\n#if NUM_BONE_INFLUENCERS>3\\npreviousInfluence+=mPreviousBones[int(matricesIndices[3])]*matricesWeights[3];\\n#endif\\n#if NUM_BONE_INFLUENCERS>4\\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\\n#endif \\n#if NUM_BONE_INFLUENCERS>5\\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\\n#endif \\n#if NUM_BONE_INFLUENCERS>6\\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\\n#endif \\n#if NUM_BONE_INFLUENCERS>7\\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\\n#endif\\nvPreviousPosition=previousViewProjection*finalPreviousWorld*previousInfluence*vec4(positionUpdated,1.0);\\n#else\\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\\n#endif\\n#endif\\n\"},60965:(e,t,r)=>{r(98519).l.IncludesShadersStore.prePassVertexDeclaration=\"#ifdef PREPASS\\n#ifdef PREPASS_LOCAL_POSITION\\nvarying vec3 vPosition;\\n#endif\\n#ifdef PREPASS_DEPTH\\nvarying vec3 vViewPos;\\n#endif\\n#if defined(PREPASS_VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\\nuniform mat4 previousViewProjection;varying vec4 vCurrentPosition;varying vec4 vPreviousPosition;\\n#endif\\n#endif\\n\"},40150:(e,t,r)=>{r.r(t),r.d(t,{reflectionFunction:()=>o});var n=\"reflectionFunction\",i=\"vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\\n{float lon=atan(direction.z,direction.x);float lat=acos(direction.y);vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;float s=sphereCoords.x*0.5+0.5;float t=sphereCoords.y;return vec3(s,t,0); }\\nvec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\\n{float lon=atan(direction.z,direction.x);float lat=acos(direction.y);vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;float s=sphereCoords.x*0.5+0.5;float t=sphereCoords.y;return vec3(1.0-s,t,0); }\\nvec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\\n{vec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);vec3 r=normalize(reflect(cameraToVertex,worldNormal));r=vec3(reflectionMatrix*vec4(r,0));float lon=atan(r.z,r.x);float lat=acos(r.y);vec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;float s=sphereCoords.x*0.5+0.5;float t=sphereCoords.y;return vec3(s,t,0);}\\nvec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)\\n{vec3 viewDir=normalize(vec3(view*worldPos));vec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));vec3 r=reflect(viewDir,viewNormal);r=vec3(reflectionMatrix*vec4(r,0));r.z=r.z-1.0;float m=2.0*length(r);return vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);}\\nvec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\\n{vec3 viewDir=worldPos.xyz-eyePosition;vec3 coords=normalize(reflect(viewDir,worldNormal));return vec3(reflectionMatrix*vec4(coords,1));}\\nvec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\\n{vec3 viewDir=normalize(worldPos.xyz-eyePosition);vec3 coords=reflect(viewDir,worldNormal);coords=vec3(reflectionMatrix*vec4(coords,0));\\n#ifdef INVERTCUBICMAP\\ncoords.y*=-1.0;\\n#endif\\nreturn coords;}\\nvec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)\\n{vec3 viewDir=normalize(worldPos.xyz-eyePosition);vec3 coords=reflect(viewDir,worldNormal);coords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);coords=vec3(reflectionMatrix*vec4(coords,0));\\n#ifdef INVERTCUBICMAP\\ncoords.y*=-1.0;\\n#endif\\nreturn coords;}\\nvec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)\\n{return vec3(reflectionMatrix*(view*worldPos));}\\nvec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)\\n{return vec3(reflectionMatrix*vec4(positionW,1.));}\\n#ifdef REFLECTION\\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\\n{\\n#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED\\nvec3 direction=normalize(vDirectionW);return computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);\\n#endif\\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\\nvec3 direction=normalize(vDirectionW);return computeFixedEquirectangularCoords(worldPos,worldNormal,direction);\\n#endif\\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\\nreturn computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\\n#endif\\n#ifdef REFLECTIONMAP_SPHERICAL\\nreturn computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);\\n#endif\\n#ifdef REFLECTIONMAP_PLANAR\\nreturn computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\\n#endif\\n#ifdef REFLECTIONMAP_CUBIC\\n#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC\\nreturn computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);\\n#else\\nreturn computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\\n#endif\\n#endif\\n#ifdef REFLECTIONMAP_PROJECTION\\nreturn computeProjectionCoords(worldPos,view,reflectionMatrix);\\n#endif\\n#ifdef REFLECTIONMAP_SKYBOX\\nreturn computeSkyBoxCoords(vPositionUVW,reflectionMatrix);\\n#endif\\n#ifdef REFLECTIONMAP_EXPLICIT\\nreturn vec3(0,0,0);\\n#endif\\n}\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},37755:(e,t,r)=>{r(98519).l.IncludesShadersStore.samplerFragmentDeclaration=\"#ifdef _DEFINENAME_\\n#if _DEFINENAME_DIRECTUV==1\\n#define v_VARYINGNAME_UV vMainUV1\\n#elif _DEFINENAME_DIRECTUV==2\\n#define v_VARYINGNAME_UV vMainUV2\\n#elif _DEFINENAME_DIRECTUV==3\\n#define v_VARYINGNAME_UV vMainUV3\\n#elif _DEFINENAME_DIRECTUV==4\\n#define v_VARYINGNAME_UV vMainUV4\\n#elif _DEFINENAME_DIRECTUV==5\\n#define v_VARYINGNAME_UV vMainUV5\\n#elif _DEFINENAME_DIRECTUV==6\\n#define v_VARYINGNAME_UV vMainUV6\\n#else\\nvarying vec2 v_VARYINGNAME_UV;\\n#endif\\nuniform sampler2D _SAMPLERNAME_Sampler;\\n#endif\\n\"},60581:(e,t,r)=>{r(98519).l.IncludesShadersStore.samplerVertexDeclaration=\"#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\\nvarying vec2 v_VARYINGNAME_UV;\\n#endif\\n\"},81067:(e,t,r)=>{r(98519).l.IncludesShadersStore.samplerVertexImplementation=\"#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\\nif (v_INFONAME_==0.)\\n{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uvUpdated,1.0,0.0));}\\n#ifdef UV2\\nelse if (v_INFONAME_==1.)\\n{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv2,1.0,0.0));}\\n#endif\\n#ifdef UV3\\nelse if (v_INFONAME_==2.)\\n{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv3,1.0,0.0));}\\n#endif\\n#ifdef UV4\\nelse if (v_INFONAME_==3.)\\n{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv4,1.0,0.0));}\\n#endif\\n#ifdef UV5\\nelse if (v_INFONAME_==4.)\\n{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv5,1.0,0.0));}\\n#endif\\n#ifdef UV6\\nelse if (v_INFONAME_==5.)\\n{v_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv6,1.0,0.0));}\\n#endif\\n#endif\\n\"},50851:(e,t,r)=>{r(98519).l.IncludesShadersStore.sceneUboDeclaration=\"layout(std140,column_major) uniform;uniform Scene {mat4 viewProjection;\\n#ifdef MULTIVIEW\\nmat4 viewProjectionR;\\n#endif \\nmat4 view;mat4 projection;vec4 vEyePosition;};\\n\"},93664:(e,t,r)=>{r(98519).l.IncludesShadersStore.screenSpaceRayTrace=\"float distanceSquared(vec2 a,vec2 b) { a-=b; return dot(a,a); }\\n/**\\nparam csOrigin Camera-space ray origin,which must be \\nwithin the view volume and must have z>0.01 and project within the valid screen rectangle\\nparam csDirection Unit length camera-space ray direction\\nparam projectToPixelMatrix A projection matrix that maps to **pixel** coordinates \\n(**not** [-1,+1] normalized device coordinates).\\nparam csZBuffer The camera-space Z buffer\\nparam csZBufferSize Dimensions of csZBuffer\\nparam csZThickness Camera space csZThickness to ascribe to each pixel in the depth buffer\\nparam nearPlaneZ Positive number. Doesn't have to be THE actual near plane,just a reasonable value\\nfor clipping rays headed towards the camera\\nparam stride Step in horizontal or vertical pixels between samples. This is a float\\nbecause integer math is slow on GPUs,but should be set to an integer>=1\\nparam jitterFraction Number between 0 and 1 for how far to bump the ray in stride units\\nto conceal banding artifacts,plus the stride ray offset.\\nparam maxSteps Maximum number of iterations. Higher gives better images but may be slow\\nparam maxRayTraceDistance Maximum camera-space distance to trace before returning a miss\\nparam selfCollisionNumSkip Number of steps to skip at start when raytracing to avoid self collisions.\\n1 is a reasonable value,depending on the scene you may need to set this value to 2\\nparam hitPixel Pixel coordinates of the first intersection with the scene\\nparam numIterations number of iterations performed\\nparam csHitPoint Camera space location of the ray hit\\n*/\\n#define inline\\nbool traceScreenSpaceRay1(\\nvec3 csOrigin,\\nvec3 csDirection,\\nmat4 projectToPixelMatrix,\\nsampler2D csZBuffer,\\nvec2 csZBufferSize,\\n#ifdef SSRAYTRACE_USE_BACK_DEPTHBUFFER\\nsampler2D csZBackBuffer,\\nfloat csZBackSizeFactor,\\n#endif\\nfloat csZThickness,\\nfloat nearPlaneZ,\\nfloat stride,\\nfloat jitterFraction,\\nfloat maxSteps,\\nfloat maxRayTraceDistance,\\nfloat selfCollisionNumSkip,\\nout vec2 startPixel,\\nout vec2 hitPixel,\\nout vec3 csHitPoint,\\nout float numIterations\\n#ifdef SSRAYTRACE_DEBUG\\n,out vec3 debugColor\\n#endif\\n)\\n{\\n#ifdef SSRAYTRACE_RIGHT_HANDED_SCENE\\nfloat rayLength=(csOrigin.z+csDirection.z*maxRayTraceDistance)>-nearPlaneZ ? (-nearPlaneZ-csOrigin.z)/csDirection.z : maxRayTraceDistance;\\n#else\\nfloat rayLength=(csOrigin.z+csDirection.z*maxRayTraceDistance)<nearPlaneZ ? (nearPlaneZ-csOrigin.z)/csDirection.z : maxRayTraceDistance;\\n#endif\\nvec3 csEndPoint=csOrigin+csDirection*rayLength;hitPixel=vec2(-1.0,-1.0);vec4 H0=projectToPixelMatrix*vec4(csOrigin,1.0);vec4 H1=projectToPixelMatrix*vec4(csEndPoint,1.0);float k0=1.0/H0.w;float k1=1.0/H1.w;vec3 Q0=csOrigin*k0;vec3 Q1=csEndPoint*k1;vec2 P0=H0.xy*k0;vec2 P1=H1.xy*k1;\\n#ifdef SSRAYTRACE_CLIP_TO_FRUSTUM\\nfloat xMax=csZBufferSize.x-0.5,xMin=0.5,yMax=csZBufferSize.y-0.5,yMin=0.5;float alpha=0.0;if ((P1.y>yMax) || (P1.y<yMin)) {alpha=(P1.y-((P1.y>yMax) ? yMax : yMin))/(P1.y-P0.y);}\\nif ((P1.x>xMax) || (P1.x<xMin)) {alpha=max(alpha,(P1.x-((P1.x>xMax) ? xMax : xMin))/(P1.x-P0.x));}\\nP1=mix(P1,P0,alpha); k1=mix(k1,k0,alpha); Q1=mix(Q1,Q0,alpha);\\n#endif\\nP1+=vec2((distanceSquared(P0,P1)<0.0001) ? 0.01 : 0.0);vec2 delta=P1-P0;bool permute=false;if (abs(delta.x)<abs(delta.y)) { \\npermute=true;delta=delta.yx;P0=P0.yx;P1=P1.yx; }\\nfloat stepDirection=sign(delta.x);float invdx=stepDirection/delta.x;vec2 dP=vec2(stepDirection,delta.y*invdx);vec3 dQ=(Q1-Q0)*invdx;float dk=(k1-k0)*invdx;float zMin=min(csEndPoint.z,csOrigin.z);float zMax=max(csEndPoint.z,csOrigin.z);dP*=stride; dQ*=stride; dk*=stride;P0+=dP*jitterFraction; Q0+=dQ*jitterFraction; k0+=dk*jitterFraction;vec4 pqk=vec4(P0,Q0.z,k0);vec4 dPQK=vec4(dP,dQ.z,dk);startPixel=permute ? P0.yx : P0.xy;float prevZMaxEstimate=csOrigin.z;float rayZMin=prevZMaxEstimate,rayZMax=prevZMaxEstimate;float sceneZMax=rayZMax+1e4;float end=P1.x*stepDirection;bool hit=false;float stepCount;for (stepCount=0.0;stepCount<=selfCollisionNumSkip ||\\n(pqk.x*stepDirection)<=end &&\\nstepCount<maxSteps &&\\n!hit &&\\nsceneZMax != 0.0; \\npqk+=dPQK,++stepCount)\\n{hitPixel=permute ? pqk.yx : pqk.xy;rayZMin=prevZMaxEstimate;rayZMax=(dPQK.z*0.5+pqk.z)/(dPQK.w*0.5+pqk.w);rayZMax=clamp(rayZMax,zMin,zMax);prevZMaxEstimate=rayZMax;if (rayZMin>rayZMax) { \\nfloat t=rayZMin; rayZMin=rayZMax; rayZMax=t;}\\nsceneZMax=texelFetch(csZBuffer,ivec2(hitPixel),0).r;\\n#ifdef SSRAYTRACE_RIGHT_HANDED_SCENE\\n#ifdef SSRAYTRACE_USE_BACK_DEPTHBUFFER\\nfloat sceneBackZ=texelFetch(csZBackBuffer,ivec2(hitPixel/csZBackSizeFactor),0).r;hit=(rayZMax>=sceneBackZ-csZThickness) && (rayZMin<=sceneZMax);\\n#else\\nhit=(rayZMax>=sceneZMax-csZThickness) && (rayZMin<=sceneZMax);\\n#endif\\n#else\\n#ifdef SSRAYTRACE_USE_BACK_DEPTHBUFFER\\nfloat sceneBackZ=texelFetch(csZBackBuffer,ivec2(hitPixel/csZBackSizeFactor),0).r;hit=(rayZMin<=sceneBackZ+csZThickness) && (rayZMax>=sceneZMax) && (sceneZMax != 0.0);\\n#else\\nhit=(rayZMin<=sceneZMax+csZThickness) && (rayZMax>=sceneZMax);\\n#endif\\n#endif\\n}\\npqk-=dPQK;stepCount-=1.0;if (((pqk.x+dPQK.x)*stepDirection)>end || (stepCount+1.0)>=maxSteps || sceneZMax==0.0) {hit=false;}\\n#ifdef SSRAYTRACE_ENABLE_REFINEMENT\\nif (stride>1.0 && hit) {pqk-=dPQK;stepCount-=1.0;float invStride=1.0/stride;dPQK*=invStride;float refinementStepCount=0.0;prevZMaxEstimate=pqk.z/pqk.w;rayZMax=prevZMaxEstimate;sceneZMax=rayZMax+1e7;for (;refinementStepCount<=1.0 ||\\n(refinementStepCount<=stride*1.4) &&\\n(rayZMax<sceneZMax) && (sceneZMax != 0.0);pqk+=dPQK,refinementStepCount+=1.0)\\n{rayZMin=prevZMaxEstimate;rayZMax=(dPQK.z*0.5+pqk.z)/(dPQK.w*0.5+pqk.w);rayZMax=clamp(rayZMax,zMin,zMax);prevZMaxEstimate=rayZMax;rayZMax=max(rayZMax,rayZMin);hitPixel=permute ? pqk.yx : pqk.xy;sceneZMax=texelFetch(csZBuffer,ivec2(hitPixel),0).r;}\\npqk-=dPQK;refinementStepCount-=1.0;stepCount+=refinementStepCount/stride;}\\n#endif\\nQ0.xy+=dQ.xy*stepCount;Q0.z=pqk.z;csHitPoint=Q0/pqk.w;numIterations=stepCount+1.0;\\n#ifdef SSRAYTRACE_DEBUG\\nif (((pqk.x+dPQK.x)*stepDirection)>end) {debugColor=vec3(0,0,1);} else if ((stepCount+1.0)>=maxSteps) {debugColor=vec3(1,0,0);} else if (sceneZMax==0.0) {debugColor=vec3(1,1,0);} else {debugColor=vec3(0,stepCount/maxSteps,0);}\\n#endif\\nreturn hit;}\\n/**\\ntexCoord: in the [0,1] range\\ndepth: depth in view space (range [znear,zfar]])\\n*/\\nvec3 computeViewPosFromUVDepth(vec2 texCoord,float depth,mat4 projection,mat4 invProjectionMatrix) {vec4 ndc;ndc.xy=texCoord*2.0-1.0;\\n#ifdef SSRAYTRACE_RIGHT_HANDED_SCENE\\n#ifdef ORTHOGRAPHIC_CAMERA\\nndc.z=-projection[2].z*depth+projection[3].z;\\n#else\\nndc.z=-projection[2].z-projection[3].z/depth;\\n#endif\\n#else\\n#ifdef ORTHOGRAPHIC_CAMERA\\nndc.z=projection[2].z*depth+projection[3].z;\\n#else\\nndc.z=projection[2].z+projection[3].z/depth;\\n#endif\\n#endif\\nndc.w=1.0;vec4 eyePos=invProjectionMatrix*ndc;eyePos.xyz/=eyePos.w;return eyePos.xyz;}\\n\"},29313:(e,t,r)=>{r.r(t),r.d(t,{shadowMapFragment:()=>o});var n=\"shadowMapFragment\",i=\"float depthSM=vDepthMetricSM;\\n#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1\\n#if SM_USEDISTANCE==1\\ndepthSM=(length(vPositionWSM-lightDataSM)+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\\n#else\\n#ifdef USE_REVERSE_DEPTHBUFFER\\ndepthSM=(-zSM+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\\n#else\\ndepthSM=(zSM+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\\n#endif\\n#endif\\n#ifdef USE_REVERSE_DEPTHBUFFER\\ngl_FragDepth=clamp(1.0-depthSM,0.0,1.0);\\n#else\\ngl_FragDepth=clamp(depthSM,0.0,1.0); \\n#endif\\n#elif SM_USEDISTANCE==1\\ndepthSM=(length(vPositionWSM-lightDataSM)+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\\n#endif\\n#if SM_ESM==1\\ndepthSM=clamp(exp(-min(87.,biasAndScaleSM.z*depthSM)),0.,1.);\\n#endif\\n#if SM_FLOAT==1\\ngl_FragColor=vec4(depthSM,1.0,1.0,1.0);\\n#else\\ngl_FragColor=pack(depthSM);\\n#endif\\nreturn;\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},61195:(e,t,r)=>{r.r(t),r.d(t,{shadowMapFragmentSoftTransparentShadow:()=>o});var n=\"shadowMapFragmentSoftTransparentShadow\",i=\"#if SM_SOFTTRANSPARENTSHADOW==1\\nif ((bayerDither8(floor(mod(gl_FragCoord.xy,8.0))))/64.0>=softTransparentShadowSM.x*alpha) discard;\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},62371:(e,t,r)=>{r.r(t),r.d(t,{shadowMapVertexMetric:()=>o});var n=\"shadowMapVertexMetric\",i=\"#if SM_USEDISTANCE==1\\nvPositionWSM=worldPos.xyz;\\n#endif\\n#if SM_DEPTHTEXTURE==1\\n#ifdef IS_NDC_HALF_ZRANGE\\n#define BIASFACTOR 0.5\\n#else\\n#define BIASFACTOR 1.0\\n#endif\\n#ifdef USE_REVERSE_DEPTHBUFFER\\ngl_Position.z-=biasAndScaleSM.x*gl_Position.w*BIASFACTOR;\\n#else\\ngl_Position.z+=biasAndScaleSM.x*gl_Position.w*BIASFACTOR;\\n#endif\\n#endif\\n#if defined(SM_DEPTHCLAMP) && SM_DEPTHCLAMP==1\\nzSM=gl_Position.z;gl_Position.z=0.0;\\n#elif SM_USEDISTANCE==0\\n#ifdef USE_REVERSE_DEPTHBUFFER\\nvDepthMetricSM=(-gl_Position.z+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\\n#else\\nvDepthMetricSM=(gl_Position.z+depthValuesSM.x)/depthValuesSM.y+biasAndScaleSM.x;\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},46837:(e,t,r)=>{r.r(t),r.d(t,{shadowsFragmentFunctions:()=>o});var n=\"shadowsFragmentFunctions\",i=\"#ifdef SHADOWS\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\n#define TEXTUREFUNC(s,c,l) texture2DLodEXT(s,c,l)\\n#else\\n#define TEXTUREFUNC(s,c,b) texture2D(s,c,b)\\n#endif\\n#ifndef SHADOWFLOAT\\nfloat unpack(vec4 color)\\n{const vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(color,bit_shift);}\\n#endif\\nfloat computeFallOff(float value,vec2 clipSpace,float frustumEdgeFalloff)\\n{float mask=smoothstep(1.0-frustumEdgeFalloff,1.00000012,clamp(dot(clipSpace,clipSpace),0.,1.));return mix(value,1.0,mask);}\\n#define inline\\nfloat computeShadowCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float darkness,vec2 depthValues)\\n{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);depth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;\\n#ifndef SHADOWFLOAT\\nfloat shadow=unpack(textureCube(shadowSampler,directionToLight));\\n#else\\nfloat shadow=textureCube(shadowSampler,directionToLight).x;\\n#endif\\nreturn depth>shadow ? darkness : 1.0;}\\n#define inline\\nfloat computeShadowWithPoissonSamplingCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float mapSize,float darkness,vec2 depthValues)\\n{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);depth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;float visibility=1.;vec3 poissonDisk[4];poissonDisk[0]=vec3(-1.0,1.0,-1.0);poissonDisk[1]=vec3(1.0,-1.0,-1.0);poissonDisk[2]=vec3(-1.0,-1.0,-1.0);poissonDisk[3]=vec3(1.0,-1.0,1.0);\\n#ifndef SHADOWFLOAT\\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<depth) visibility-=0.25;if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<depth) visibility-=0.25;if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<depth) visibility-=0.25;if (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<depth) visibility-=0.25;\\n#else\\nif (textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize).x<depth) visibility-=0.25;if (textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize).x<depth) visibility-=0.25;if (textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize).x<depth) visibility-=0.25;if (textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize).x<depth) visibility-=0.25;\\n#endif\\nreturn min(1.0,visibility+darkness);}\\n#define inline\\nfloat computeShadowWithESMCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\\n{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);float shadowPixelDepth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;\\n#ifndef SHADOWFLOAT\\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\\n#else\\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\\n#endif\\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);return esm;}\\n#define inline\\nfloat computeShadowWithCloseESMCube(vec3 worldPos,vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\\n{vec3 directionToLight=worldPos-lightPosition;float depth=length(directionToLight);depth=(depth+depthValues.x)/(depthValues.y);float shadowPixelDepth=clamp(depth,0.,1.0);directionToLight=normalize(directionToLight);directionToLight.y=-directionToLight.y;\\n#ifndef SHADOWFLOAT\\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\\n#else\\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\\n#endif\\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);return esm;}\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\n#define inline\\nfloat computeShadowCSM(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray shadowSampler,float darkness,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);vec3 uvLayer=vec3(uv.x,uv.y,layer);float shadowPixelDepth=clamp(depthMetric,0.,1.0);\\n#ifndef SHADOWFLOAT\\nfloat shadow=unpack(texture2D(shadowSampler,uvLayer));\\n#else\\nfloat shadow=texture2D(shadowSampler,uvLayer).x;\\n#endif\\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;}\\n#endif\\n#define inline\\nfloat computeShadow(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\\n{return 1.0;}\\nelse\\n{float shadowPixelDepth=clamp(depthMetric,0.,1.0);\\n#ifndef SHADOWFLOAT\\nfloat shadow=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\\n#else\\nfloat shadow=TEXTUREFUNC(shadowSampler,uv,0.).x;\\n#endif\\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;}}\\n#define inline\\nfloat computeShadowWithPoissonSampling(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float mapSize,float darkness,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\\n{return 1.0;}\\nelse\\n{float shadowPixelDepth=clamp(depthMetric,0.,1.0);float visibility=1.;vec2 poissonDisk[4];poissonDisk[0]=vec2(-0.94201624,-0.39906216);poissonDisk[1]=vec2(0.94558609,-0.76890725);poissonDisk[2]=vec2(-0.094184101,-0.92938870);poissonDisk[3]=vec2(0.34495938,0.29387760);\\n#ifndef SHADOWFLOAT\\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;if (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\\n#else\\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;if (TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\\n#endif\\nreturn computeFallOff(min(1.0,visibility+darkness),clipSpace.xy,frustumEdgeFalloff);}}\\n#define inline\\nfloat computeShadowWithESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\\n{return 1.0;}\\nelse\\n{float shadowPixelDepth=clamp(depthMetric,0.,1.0);\\n#ifndef SHADOWFLOAT\\nfloat shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\\n#else\\nfloat shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;\\n#endif\\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);return computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);}}\\n#define inline\\nfloat computeShadowWithCloseESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec2 uv=0.5*clipSpace.xy+vec2(0.5);if (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\\n{return 1.0;}\\nelse\\n{float shadowPixelDepth=clamp(depthMetric,0.,1.0); \\n#ifndef SHADOWFLOAT\\nfloat shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\\n#else\\nfloat shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;\\n#endif\\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);return computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);}}\\n#ifdef IS_NDC_HALF_ZRANGE\\n#define ZINCLIP clipSpace.z\\n#else\\n#define ZINCLIP uvDepth.z\\n#endif\\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\\n#define GREATEST_LESS_THAN_ONE 0.99999994\\n#define DISABLE_UNIFORMITY_ANALYSIS\\n#define inline\\nfloat computeShadowWithCSMPCF1(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,float darkness,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);float shadow=texture2D(shadowSampler,uvDepthLayer);shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}\\n#define inline\\nfloat computeShadowWithCSMPCF3(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \\nuv+=0.5; \\nvec2 st=fract(uv); \\nvec2 base_uv=floor(uv)-0.5; \\nbase_uv*=shadowMapSizeAndInverse.y; \\nvec2 uvw0=3.-2.*st;vec2 uvw1=1.+2.*st;vec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;vec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));shadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));shadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));shadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));shadow=shadow/16.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}\\n#define inline\\nfloat computeShadowWithCSMPCF5(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \\nuv+=0.5; \\nvec2 st=fract(uv); \\nvec2 base_uv=floor(uv)-0.5; \\nbase_uv*=shadowMapSizeAndInverse.y; \\nvec2 uvw0=4.-3.*st;vec2 uvw1=vec2(7.);vec2 uvw2=1.+3.*st;vec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;vec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));shadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));shadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[0]),layer,uvDepth.z));shadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));shadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));shadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[1]),layer,uvDepth.z));shadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[2]),layer,uvDepth.z));shadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[2]),layer,uvDepth.z));shadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[2]),layer,uvDepth.z));shadow=shadow/144.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}\\n#define inline\\nfloat computeShadowWithPCF1(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,float darkness,float frustumEdgeFalloff)\\n{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}\\nelse\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;float shadow=TEXTUREFUNC(shadowSampler,uvDepth,0.);shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}\\n#define inline\\nfloat computeShadowWithPCF3(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\\n{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}\\nelse\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \\nuv+=0.5; \\nvec2 st=fract(uv); \\nvec2 base_uv=floor(uv)-0.5; \\nbase_uv*=shadowMapSizeAndInverse.y; \\nvec2 uvw0=3.-2.*st;vec2 uvw1=1.+2.*st;vec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;vec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);shadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);shadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);shadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);shadow=shadow/16.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}\\n#define inline\\nfloat computeShadowWithPCF5(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\\n{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}\\nelse\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;vec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \\nuv+=0.5; \\nvec2 st=fract(uv); \\nvec2 base_uv=floor(uv)-0.5; \\nbase_uv*=shadowMapSizeAndInverse.y; \\nvec2 uvw0=4.-3.*st;vec2 uvw1=vec2(7.);vec2 uvw2=1.+3.*st;vec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;vec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;float shadow=0.;shadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);shadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);shadow+=uvw2.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[0]),uvDepth.z),0.);shadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);shadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);shadow+=uvw2.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[1]),uvDepth.z),0.);shadow+=uvw0.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[2]),uvDepth.z),0.);shadow+=uvw1.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[2]),uvDepth.z),0.);shadow+=uvw2.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[2]),uvDepth.z),0.);shadow=shadow/144.;shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}\\nconst vec3 PoissonSamplers32[64]=vec3[64](\\nvec3(0.06407013,0.05409927,0.),\\nvec3(0.7366577,0.5789394,0.),\\nvec3(-0.6270542,-0.5320278,0.),\\nvec3(-0.4096107,0.8411095,0.),\\nvec3(0.6849564,-0.4990818,0.),\\nvec3(-0.874181,-0.04579735,0.),\\nvec3(0.9989998,0.0009880066,0.),\\nvec3(-0.004920578,-0.9151649,0.),\\nvec3(0.1805763,0.9747483,0.),\\nvec3(-0.2138451,0.2635818,0.),\\nvec3(0.109845,0.3884785,0.),\\nvec3(0.06876755,-0.3581074,0.),\\nvec3(0.374073,-0.7661266,0.),\\nvec3(0.3079132,-0.1216763,0.),\\nvec3(-0.3794335,-0.8271583,0.),\\nvec3(-0.203878,-0.07715034,0.),\\nvec3(0.5912697,0.1469799,0.),\\nvec3(-0.88069,0.3031784,0.),\\nvec3(0.5040108,0.8283722,0.),\\nvec3(-0.5844124,0.5494877,0.),\\nvec3(0.6017799,-0.1726654,0.),\\nvec3(-0.5554981,0.1559997,0.),\\nvec3(-0.3016369,-0.3900928,0.),\\nvec3(-0.5550632,-0.1723762,0.),\\nvec3(0.925029,0.2995041,0.),\\nvec3(-0.2473137,0.5538505,0.),\\nvec3(0.9183037,-0.2862392,0.),\\nvec3(0.2469421,0.6718712,0.),\\nvec3(0.3916397,-0.4328209,0.),\\nvec3(-0.03576927,-0.6220032,0.),\\nvec3(-0.04661255,0.7995201,0.),\\nvec3(0.4402924,0.3640312,0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.),\\nvec3(0.)\\n);const vec3 PoissonSamplers64[64]=vec3[64](\\nvec3(-0.613392,0.617481,0.),\\nvec3(0.170019,-0.040254,0.),\\nvec3(-0.299417,0.791925,0.),\\nvec3(0.645680,0.493210,0.),\\nvec3(-0.651784,0.717887,0.),\\nvec3(0.421003,0.027070,0.),\\nvec3(-0.817194,-0.271096,0.),\\nvec3(-0.705374,-0.668203,0.),\\nvec3(0.977050,-0.108615,0.),\\nvec3(0.063326,0.142369,0.),\\nvec3(0.203528,0.214331,0.),\\nvec3(-0.667531,0.326090,0.),\\nvec3(-0.098422,-0.295755,0.),\\nvec3(-0.885922,0.215369,0.),\\nvec3(0.566637,0.605213,0.),\\nvec3(0.039766,-0.396100,0.),\\nvec3(0.751946,0.453352,0.),\\nvec3(0.078707,-0.715323,0.),\\nvec3(-0.075838,-0.529344,0.),\\nvec3(0.724479,-0.580798,0.),\\nvec3(0.222999,-0.215125,0.),\\nvec3(-0.467574,-0.405438,0.),\\nvec3(-0.248268,-0.814753,0.),\\nvec3(0.354411,-0.887570,0.),\\nvec3(0.175817,0.382366,0.),\\nvec3(0.487472,-0.063082,0.),\\nvec3(-0.084078,0.898312,0.),\\nvec3(0.488876,-0.783441,0.),\\nvec3(0.470016,0.217933,0.),\\nvec3(-0.696890,-0.549791,0.),\\nvec3(-0.149693,0.605762,0.),\\nvec3(0.034211,0.979980,0.),\\nvec3(0.503098,-0.308878,0.),\\nvec3(-0.016205,-0.872921,0.),\\nvec3(0.385784,-0.393902,0.),\\nvec3(-0.146886,-0.859249,0.),\\nvec3(0.643361,0.164098,0.),\\nvec3(0.634388,-0.049471,0.),\\nvec3(-0.688894,0.007843,0.),\\nvec3(0.464034,-0.188818,0.),\\nvec3(-0.440840,0.137486,0.),\\nvec3(0.364483,0.511704,0.),\\nvec3(0.034028,0.325968,0.),\\nvec3(0.099094,-0.308023,0.),\\nvec3(0.693960,-0.366253,0.),\\nvec3(0.678884,-0.204688,0.),\\nvec3(0.001801,0.780328,0.),\\nvec3(0.145177,-0.898984,0.),\\nvec3(0.062655,-0.611866,0.),\\nvec3(0.315226,-0.604297,0.),\\nvec3(-0.780145,0.486251,0.),\\nvec3(-0.371868,0.882138,0.),\\nvec3(0.200476,0.494430,0.),\\nvec3(-0.494552,-0.711051,0.),\\nvec3(0.612476,0.705252,0.),\\nvec3(-0.578845,-0.768792,0.),\\nvec3(-0.772454,-0.090976,0.),\\nvec3(0.504440,0.372295,0.),\\nvec3(0.155736,0.065157,0.),\\nvec3(0.391522,0.849605,0.),\\nvec3(-0.620106,-0.328104,0.),\\nvec3(0.789239,-0.419965,0.),\\nvec3(-0.545396,0.538133,0.),\\nvec3(-0.178564,-0.596057,0.)\\n);\\n#define inline\\nfloat computeShadowWithCSMPCSS(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);vec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);float blockerDepth=0.0;float sumBlockerDepth=0.0;float numBlocker=0.0;for (int i=0; i<searchTapCount; i ++) {blockerDepth=texture2D(depthSampler,vec3(uvDepth.xy+(lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse*PoissonSamplers32[i].xy),layer)).r;if (blockerDepth<depthMetric) {sumBlockerDepth+=blockerDepth;numBlocker++;}}\\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;float AAOffset=shadowMapSizeInverse*10.;float penumbraRatio=((depthMetric-avgBlockerDepth)*depthCorrection+AAOffset);vec4 filterRadius=vec4(penumbraRatio*lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse,0.,0.);float random=getRand(vPositionFromLight.xy);float rotationAngle=random*3.1415926;vec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));float shadow=0.;for (int i=0; i<pcfTapCount; i++) {vec4 offset=vec4(poissonSamplers[i],0.);offset=vec4(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.,0.);shadow+=texture2D(shadowSampler,uvDepthLayer+offset*filterRadius);}\\nshadow/=float(pcfTapCount);shadow=mix(shadow,1.,min((depthMetric-avgBlockerDepth)*depthCorrection*penumbraDarkness,1.));shadow=mix(darkness,1.,shadow);if (numBlocker<1.0) {return 1.0;}\\nelse\\n{return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}\\n#define inline\\nfloat computeShadowWithPCSS(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers)\\n{if (depthMetric>1.0 || depthMetric<0.0) {return 1.0;}\\nelse\\n{vec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;vec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));uvDepth.z=ZINCLIP;float blockerDepth=0.0;float sumBlockerDepth=0.0;float numBlocker=0.0;for (int i=0; i<searchTapCount; i ++) {blockerDepth=TEXTUREFUNC(depthSampler,uvDepth.xy+(lightSizeUV*shadowMapSizeInverse*PoissonSamplers32[i].xy),0.).r;if (blockerDepth<depthMetric) {sumBlockerDepth+=blockerDepth;numBlocker++;}}\\nif (numBlocker<1.0) {return 1.0;}\\nelse\\n{float avgBlockerDepth=sumBlockerDepth/numBlocker;float AAOffset=shadowMapSizeInverse*10.;float penumbraRatio=((depthMetric-avgBlockerDepth)+AAOffset);float filterRadius=penumbraRatio*lightSizeUV*shadowMapSizeInverse;float random=getRand(vPositionFromLight.xy);float rotationAngle=random*3.1415926;vec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));float shadow=0.;for (int i=0; i<pcfTapCount; i++) {vec3 offset=poissonSamplers[i];offset=vec3(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.);shadow+=TEXTUREFUNC(shadowSampler,uvDepth+offset*filterRadius,0.);}\\nshadow/=float(pcfTapCount);shadow=mix(shadow,1.,depthMetric-avgBlockerDepth);shadow=mix(darkness,1.,shadow);return computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);}}}\\n#define inline\\nfloat computeShadowWithPCSS16(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\\n{return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32);}\\n#define inline\\nfloat computeShadowWithPCSS32(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\\n{return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32);}\\n#define inline\\nfloat computeShadowWithPCSS64(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\\n{return computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64);}\\n#define inline\\nfloat computeShadowWithCSMPCSS16(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\\n{return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);}\\n#define inline\\nfloat computeShadowWithCSMPCSS32(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\\n{return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);}\\n#define inline\\nfloat computeShadowWithCSMPCSS64(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\\n{return computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64,lightSizeUVCorrection,depthCorrection,penumbraDarkness);}\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},62136:(e,t,r)=>{r.r(t),r.d(t,{shadowsVertex:()=>o});var n=\"shadowsVertex\",i=\"#ifdef SHADOWS\\n#if defined(SHADOWCSM{X})\\nvPositionFromCamera{X}=view*worldPos;for (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) {vPositionFromLight{X}[i]=lightMatrix{X}[i]*worldPos;\\n#ifdef USE_REVERSE_DEPTHBUFFER\\nvDepthMetric{X}[i]=(-vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\\n#else\\nvDepthMetric{X}[i]=(vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\\n#endif\\n}\\n#elif defined(SHADOW{X}) && !defined(SHADOWCUBE{X})\\nvPositionFromLight{X}=lightMatrix{X}*worldPos;\\n#ifdef USE_REVERSE_DEPTHBUFFER\\nvDepthMetric{X}=(-vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\\n#else\\nvDepthMetric{X}=(vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\\n#endif\\n#endif\\n#endif\\n\";r(98519).l.IncludesShadersStore[n]=i;var o={name:n,shader:i}},5447:(e,t,r)=>{r(98519).l.IncludesShadersStore.subSurfaceScatteringFunctions=\"bool testLightingForSSS(float diffusionProfile)\\n{return diffusionProfile<1.;}\"},77976:(e,t,r)=>{r(98519).l.IncludesShadersStore.uvAttributeDeclaration=\"#ifdef UV{X}\\nattribute vec2 uv{X};\\n#endif\\n\"},45858:(e,t,r)=>{r(98519).l.IncludesShadersStore.uvVariableDeclaration=\"#if !defined(UV{X}) && defined(MAINUV{X})\\nvec2 uv{X}=vec2(0.,0.);\\n#endif\\n#ifdef MAINUV{X}\\nvMainUV{X}=uv{X};\\n#endif\\n\"},45812:(e,t,r)=>{r(98519).l.IncludesShadersStore.vertexColorMixing=\"#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\\nvColor=vec4(1.0);\\n#ifdef VERTEXCOLOR\\n#ifdef VERTEXALPHA\\nvColor*=color;\\n#else\\nvColor.rgb*=color.rgb;\\n#endif\\n#endif\\n#ifdef INSTANCESCOLOR\\nvColor*=instanceColor;\\n#endif\\n#endif\\n\"},10534:(e,t,r)=>{r.r(t),r.d(t,{anaglyphPixelShader:()=>o});var n=\"anaglyphPixelShader\",i=\"varying vec2 vUV;uniform sampler2D textureSampler;uniform sampler2D leftSampler;\\n#define CUSTOM_FRAGMENT_DEFINITIONS\\nvoid main(void)\\n{vec4 leftFrag=texture2D(leftSampler,vUV);leftFrag=vec4(1.0,leftFrag.g,leftFrag.b,1.0);vec4 rightFrag=texture2D(textureSampler,vUV);rightFrag=vec4(rightFrag.r,1.0,1.0,1.0);gl_FragColor=vec4(rightFrag.rgb*leftFrag.rgb,1.0);}\";r(98519).l.ShadersStore[n]=i;var o={name:n,shader:i}},7590:(e,t,r)=>{r.r(t),r.d(t,{backgroundPixelShader:()=>a});var n=r(98519);n.l.IncludesShadersStore.backgroundFragmentDeclaration=\"uniform vec4 vEyePosition;uniform vec4 vPr